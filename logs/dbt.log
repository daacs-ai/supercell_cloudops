

============================== 21:59:35.449547 | 98501f52-b893-47fd-9e65-acef3777a96e ==============================
[0m21:59:35.449547 [info ] [MainThread]: Running with dbt=1.9.4
[0m21:59:35.454789 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/harsha/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt init', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'False'}
[0m21:59:35.455251 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality

User config should be moved from the 'config' key in profiles.yml to the 'flags' key in dbt_project.yml.
[0m22:00:14.810292 [debug] [MainThread]: Starter project path: /home/harsha/data_actions/supercell_dbt/supercell_env/lib/python3.12/site-packages/dbt/include/starter_project
[0m22:00:14.813840 [info ] [MainThread]: 
Your new dbt project "supercell" was created!

For more information on how to configure the profiles.yml file,
please consult the dbt documentation here:

  https://docs.getdbt.com/docs/configure-your-profile

One more thing:

Need help? Don't hesitate to reach out to us via GitHub issues or on Slack:

  https://community.getdbt.com/

Happy modeling!

[0m22:00:14.814632 [info ] [MainThread]: Setting up your profile.
[0m22:00:14.816848 [error] [MainThread]: Encountered an error:
Runtime Error
  No adapters available. Learn how to install an adapter by going to https://docs.getdbt.com/docs/connect-adapters#install-using-the-cli
[0m22:00:14.818383 [debug] [MainThread]: Resource report: {"command_name": "init", "command_success": false, "command_wall_clock_time": 39.432167, "process_in_blocks": "1096", "process_kernel_time": 0.123689, "process_mem_max_rss": "96932", "process_out_blocks": "72", "process_user_time": 1.57869}
[0m22:00:14.818987 [debug] [MainThread]: Command `dbt init` failed at 22:00:14.818864 after 39.43 seconds
[0m22:00:14.819917 [debug] [MainThread]: Flushing usage events


============================== 22:17:42.601641 | 7d812d2a-d411-4ba0-bcc1-c3325494815d ==============================
[0m22:17:42.601641 [info ] [MainThread]: Running with dbt=1.9.4
[0m22:17:42.606883 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/harsha/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/harsha/data_actions/supercell_dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run --select models/example/my_first_dbt_model.sql', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'False'}
[0m22:17:42.607568 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality

User config should be moved from the 'config' key in profiles.yml to the 'flags' key in dbt_project.yml.
[0m22:17:42.612719 [error] [MainThread]: Encountered an error:
Runtime Error
  Could not find profile named 'supercell'
[0m22:17:42.614883 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.075832024, "process_in_blocks": "0", "process_kernel_time": 0.153664, "process_mem_max_rss": "94912", "process_out_blocks": "8", "process_user_time": 1.527663}
[0m22:17:42.615965 [debug] [MainThread]: Command `dbt run` failed at 22:17:42.615754 after 0.08 seconds
[0m22:17:42.616697 [debug] [MainThread]: Flushing usage events


============================== 22:18:05.649881 | fe1223b5-9469-46e7-9954-414800dc3465 ==============================
[0m22:18:05.649881 [info ] [MainThread]: Running with dbt=1.9.4
[0m22:18:05.654733 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/harsha/data_actions/supercell_dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/harsha/data_actions/supercell_dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run --select models/example/my_first_dbt_model.sql', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'False'}
[0m22:18:05.655407 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality

User config should be moved from the 'config' key in profiles.yml to the 'flags' key in dbt_project.yml.
[0m22:18:05.663165 [info ] [MainThread]: Error importing adapter: No module named 'dbt.adapters.clickhouse'
[0m22:18:05.664245 [error] [MainThread]: Encountered an error:
Runtime Error
  Credentials in profile "supercell", target "default" invalid: Runtime Error
    Could not find adapter type clickhouse!
[0m22:18:05.666794 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.079584524, "process_in_blocks": "0", "process_kernel_time": 0.109692, "process_mem_max_rss": "94880", "process_out_blocks": "8", "process_user_time": 1.564609}
[0m22:18:05.667866 [debug] [MainThread]: Command `dbt run` failed at 22:18:05.667652 after 0.08 seconds
[0m22:18:05.668589 [debug] [MainThread]: Flushing usage events


============================== 23:30:52.803197 | eee3d708-9fb1-4aa1-b8be-54e64e0b23d5 ==============================
[0m23:30:52.803197 [info ] [MainThread]: Running with dbt=1.9.4
[0m23:30:52.807374 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/home/harsha/data_actions/supercell_dbt', 'log_path': '/home/harsha/data_actions/supercell_dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select models/example/supercell_logsfacts.sql', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'False'}
[0m23:30:52.807835 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality

User config should be moved from the 'config' key in profiles.yml to the 'flags' key in dbt_project.yml.
[0m23:30:52.965532 [info ] [MainThread]: Registered adapter: duckdb=1.9.3
[0m23:30:53.005122 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m23:30:53.005545 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m23:30:53.690346 [debug] [MainThread]: Wrote artifact WritableManifest to /home/harsha/data_actions/supercell_dbt/target/manifest.json
[0m23:30:53.691240 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/harsha/data_actions/supercell_dbt/target/semantic_manifest.json
[0m23:30:53.702771 [info ] [MainThread]: Found 3 models, 4 data tests, 428 macros
[0m23:30:53.704129 [info ] [MainThread]: 
[0m23:30:53.704437 [info ] [MainThread]: Concurrency: 4 threads (target='default')
[0m23:30:53.704646 [info ] [MainThread]: 
[0m23:30:53.704967 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m23:30:53.705767 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_supercell'
[0m23:30:53.728357 [debug] [ThreadPool]: Using duckdb connection "list_supercell"
[0m23:30:53.728686 [debug] [ThreadPool]: On list_supercell: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "connection_name": "list_supercell"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"supercell"'
    
  
  
[0m23:30:53.728862 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:30:53.735835 [debug] [ThreadPool]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "connection_name": "list_supercell"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"supercell"'
    
  
  
[0m23:30:53.736118 [debug] [ThreadPool]: DuckDB adapter: Rolling back transaction.
[0m23:30:53.736772 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:30:53.737018 [debug] [MainThread]: Connection 'list_supercell' was properly closed.
[0m23:30:53.737210 [info ] [MainThread]: 
[0m23:30:53.737432 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.03 seconds (0.03s).
[0m23:30:53.737724 [error] [MainThread]: Encountered an error:
Runtime Error
  IO Error: Could not set lock on file "/home/harsha/data_actions/supercell_dbt/supercell.duckdb": Conflicting lock is held in /usr/bin/python3.12 (PID 2406907) by user harsha. See also https://duckdb.org/docs/connect/concurrency
[0m23:30:53.738425 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.9662292, "process_in_blocks": "42456", "process_kernel_time": 0.102277, "process_mem_max_rss": "135576", "process_out_blocks": "1776", "process_user_time": 1.686057}
[0m23:30:53.738793 [debug] [MainThread]: Command `dbt run` failed at 23:30:53.738721 after 0.97 seconds
[0m23:30:53.739028 [debug] [MainThread]: Flushing usage events


============================== 23:31:33.160724 | 74f35780-8d3b-46c9-b7e7-3681ac5b4b52 ==============================
[0m23:31:33.160724 [info ] [MainThread]: Running with dbt=1.9.4
[0m23:31:33.162791 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/harsha/data_actions/supercell_dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/harsha/data_actions/supercell_dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run --select models/example/supercell_logsfacts.sql', 'send_anonymous_usage_stats': 'False'}
[0m23:31:33.163044 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality

User config should be moved from the 'config' key in profiles.yml to the 'flags' key in dbt_project.yml.
[0m23:31:33.316787 [info ] [MainThread]: Registered adapter: duckdb=1.9.3
[0m23:31:33.353786 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m23:31:33.406201 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:31:33.406496 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:31:33.461725 [debug] [MainThread]: Wrote artifact WritableManifest to /home/harsha/data_actions/supercell_dbt/target/manifest.json
[0m23:31:33.462729 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/harsha/data_actions/supercell_dbt/target/semantic_manifest.json
[0m23:31:33.469289 [info ] [MainThread]: Found 3 models, 4 data tests, 428 macros
[0m23:31:33.470666 [info ] [MainThread]: 
[0m23:31:33.470970 [info ] [MainThread]: Concurrency: 4 threads (target='default')
[0m23:31:33.471145 [info ] [MainThread]: 
[0m23:31:33.471437 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m23:31:33.472134 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_supercell'
[0m23:31:33.498043 [debug] [ThreadPool]: Using duckdb connection "list_supercell"
[0m23:31:33.498376 [debug] [ThreadPool]: On list_supercell: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "connection_name": "list_supercell"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"supercell"'
    
  
  
[0m23:31:33.498579 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:31:33.507041 [debug] [ThreadPool]: SQL status: OK in 0.008 seconds
[0m23:31:33.507913 [debug] [ThreadPool]: On list_supercell: Close
[0m23:31:33.508517 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_supercell, now create_supercell_main)
[0m23:31:33.508811 [debug] [ThreadPool]: Creating schema "database: "supercell"
schema: "main"
"
[0m23:31:33.512782 [debug] [ThreadPool]: Using duckdb connection "create_supercell_main"
[0m23:31:33.513024 [debug] [ThreadPool]: On create_supercell_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "connection_name": "create_supercell_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='supercell'
        and type='sqlite'
    
  
[0m23:31:33.513191 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:31:33.514067 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m23:31:33.514843 [debug] [ThreadPool]: Using duckdb connection "create_supercell_main"
[0m23:31:33.515033 [debug] [ThreadPool]: On create_supercell_main: BEGIN
[0m23:31:33.515322 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m23:31:33.515505 [debug] [ThreadPool]: Using duckdb connection "create_supercell_main"
[0m23:31:33.515657 [debug] [ThreadPool]: On create_supercell_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "connection_name": "create_supercell_main"} */

    
    
        create schema if not exists "supercell"."main"
    
[0m23:31:33.515932 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m23:31:33.516420 [debug] [ThreadPool]: On create_supercell_main: COMMIT
[0m23:31:33.516612 [debug] [ThreadPool]: Using duckdb connection "create_supercell_main"
[0m23:31:33.516760 [debug] [ThreadPool]: On create_supercell_main: COMMIT
[0m23:31:33.516991 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m23:31:33.517154 [debug] [ThreadPool]: On create_supercell_main: Close
[0m23:31:33.520565 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_supercell_main, now list_supercell_main)
[0m23:31:33.527308 [debug] [ThreadPool]: Using duckdb connection "list_supercell_main"
[0m23:31:33.527749 [debug] [ThreadPool]: On list_supercell_main: BEGIN
[0m23:31:33.528040 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:31:33.528748 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m23:31:33.529063 [debug] [ThreadPool]: Using duckdb connection "list_supercell_main"
[0m23:31:33.529364 [debug] [ThreadPool]: On list_supercell_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "connection_name": "list_supercell_main"} */
select
      'supercell' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'supercell'
  
[0m23:31:33.543733 [debug] [ThreadPool]: SQL status: OK in 0.014 seconds
[0m23:31:33.544645 [debug] [ThreadPool]: On list_supercell_main: ROLLBACK
[0m23:31:33.545567 [debug] [ThreadPool]: Failed to rollback 'list_supercell_main'
[0m23:31:33.545769 [debug] [ThreadPool]: On list_supercell_main: Close
[0m23:31:33.546624 [debug] [MainThread]: Using duckdb connection "master"
[0m23:31:33.546845 [debug] [MainThread]: On master: BEGIN
[0m23:31:33.547003 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:31:33.547372 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m23:31:33.547557 [debug] [MainThread]: On master: COMMIT
[0m23:31:33.547719 [debug] [MainThread]: Using duckdb connection "master"
[0m23:31:33.547863 [debug] [MainThread]: On master: COMMIT
[0m23:31:33.548113 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m23:31:33.548301 [debug] [MainThread]: On master: Close
[0m23:31:33.550622 [debug] [Thread-1 (]: Began running node model.supercell.supercell_logsfacts
[0m23:31:33.551146 [info ] [Thread-1 (]: 1 of 1 START sql table model main.supercell_logsfacts .......................... [RUN]
[0m23:31:33.551589 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_supercell_main, now model.supercell.supercell_logsfacts)
[0m23:31:33.551859 [debug] [Thread-1 (]: Began compiling node model.supercell.supercell_logsfacts
[0m23:31:33.557072 [debug] [Thread-1 (]: Writing injected SQL for node "model.supercell.supercell_logsfacts"
[0m23:31:33.557803 [debug] [Thread-1 (]: Began executing node model.supercell.supercell_logsfacts
[0m23:31:33.577160 [debug] [Thread-1 (]: Writing runtime sql for node "model.supercell.supercell_logsfacts"
[0m23:31:33.577714 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.supercell_logsfacts"
[0m23:31:33.577960 [debug] [Thread-1 (]: On model.supercell.supercell_logsfacts: BEGIN
[0m23:31:33.578133 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:31:33.578765 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m23:31:33.578980 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.supercell_logsfacts"
[0m23:31:33.579167 [debug] [Thread-1 (]: On model.supercell.supercell_logsfacts: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.supercell_logsfacts"} */

  
    
    

    create  table
      "supercell"."main"."supercell_logsfacts__dbt_tmp"
  
    as (
      


SELECT
    CAST("LinkedAccountId" AS VARCHAR) AS linked_account_id,
    CAST("bill/PayerAccountId" AS VARCHAR) AS payer_account_id,
    CAST("lineItem/UsageStartDate" AS TIMESTAMP) AS usage_start_date,
    CAST("lineItem/UsageEndDate" AS TIMESTAMP) AS usage_end_date,
    CAST("lineItem/UsageAmount" AS DECIMAL(18, 6)) AS usage_amount,
    CAST("lineItem/Operation" AS VARCHAR) AS operation,
    CAST("pricing/PricingModel" AS VARCHAR) AS pricing_model,
    CAST("resourceTags/TagKeys" AS VARCHAR) AS tag_keys,
    CAST("resourceTags/TagValues" AS VARCHAR) AS tag_values,
    CAST("product/Region" AS VARCHAR) AS region,
    CAST("product/ServiceCode" AS VARCHAR) AS service_code,
    CAST("product/InstanceType" AS VARCHAR) AS instance_type,
    CAST("amortized_cost" AS DECIMAL(18, 6)) AS amortized_cost,
    CAST("product/Description" AS VARCHAR) AS description
FROM supercell_usagelogs
    );
  
  
[0m23:31:33.657814 [debug] [Thread-1 (]: SQL status: OK in 0.078 seconds
[0m23:31:33.661868 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.supercell_logsfacts"
[0m23:31:33.662159 [debug] [Thread-1 (]: On model.supercell.supercell_logsfacts: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.supercell_logsfacts"} */
alter table "supercell"."main"."supercell_logsfacts__dbt_tmp" rename to "supercell_logsfacts"
[0m23:31:33.662892 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m23:31:33.670723 [debug] [Thread-1 (]: On model.supercell.supercell_logsfacts: COMMIT
[0m23:31:33.670986 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.supercell_logsfacts"
[0m23:31:33.671165 [debug] [Thread-1 (]: On model.supercell.supercell_logsfacts: COMMIT
[0m23:31:33.763925 [debug] [Thread-1 (]: SQL status: OK in 0.092 seconds
[0m23:31:33.767036 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.supercell_logsfacts"
[0m23:31:33.767304 [debug] [Thread-1 (]: On model.supercell.supercell_logsfacts: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.supercell_logsfacts"} */
drop table if exists "supercell"."main"."supercell_logsfacts__dbt_backup" cascade
[0m23:31:33.767793 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m23:31:33.769181 [debug] [Thread-1 (]: On model.supercell.supercell_logsfacts: Close
[0m23:31:33.772886 [info ] [Thread-1 (]: 1 of 1 OK created sql table model main.supercell_logsfacts ..................... [[32mOK[0m in 0.22s]
[0m23:31:33.773243 [debug] [Thread-1 (]: Finished running node model.supercell.supercell_logsfacts
[0m23:31:33.775062 [debug] [MainThread]: Using duckdb connection "master"
[0m23:31:33.775583 [debug] [MainThread]: On master: BEGIN
[0m23:31:33.775886 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:31:33.776596 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m23:31:33.776873 [debug] [MainThread]: On master: COMMIT
[0m23:31:33.777083 [debug] [MainThread]: Using duckdb connection "master"
[0m23:31:33.777256 [debug] [MainThread]: On master: COMMIT
[0m23:31:33.777792 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m23:31:33.778042 [debug] [MainThread]: On master: Close
[0m23:31:33.778428 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:31:33.778626 [debug] [MainThread]: Connection 'model.supercell.supercell_logsfacts' was properly closed.
[0m23:31:33.778845 [info ] [MainThread]: 
[0m23:31:33.779089 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.31 seconds (0.31s).
[0m23:31:33.779566 [debug] [MainThread]: Command end result
[0m23:31:33.792992 [debug] [MainThread]: Wrote artifact WritableManifest to /home/harsha/data_actions/supercell_dbt/target/manifest.json
[0m23:31:33.794028 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/harsha/data_actions/supercell_dbt/target/semantic_manifest.json
[0m23:31:33.797317 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/harsha/data_actions/supercell_dbt/target/run_results.json
[0m23:31:33.797532 [info ] [MainThread]: 
[0m23:31:33.797765 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:31:33.797943 [info ] [MainThread]: 
[0m23:31:33.798123 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m23:31:33.798656 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.6683834, "process_in_blocks": "2072", "process_kernel_time": 0.100941, "process_mem_max_rss": "189624", "process_out_blocks": "4896", "process_user_time": 1.365209}
[0m23:31:33.798929 [debug] [MainThread]: Command `dbt run` succeeded at 23:31:33.798872 after 0.67 seconds
[0m23:31:33.799117 [debug] [MainThread]: Flushing usage events


============================== 23:36:21.027122 | 49a71eb3-61be-45bc-9179-11ed4f914b77 ==============================
[0m23:36:21.027122 [info ] [MainThread]: Running with dbt=1.9.4
[0m23:36:21.030274 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/harsha/data_actions/supercell_dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/home/harsha/data_actions/supercell_dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select models/supercell_models/cleaned_usagelogs.sql', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'False'}
[0m23:36:21.030844 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality

User config should be moved from the 'config' key in profiles.yml to the 'flags' key in dbt_project.yml.
[0m23:36:21.211242 [info ] [MainThread]: Registered adapter: duckdb=1.9.3
[0m23:36:21.252503 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m23:36:21.311216 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 1 files added, 0 files changed.
[0m23:36:21.311598 [debug] [MainThread]: Partial parsing: added file: supercell://models/supercell_models/cleaned_usagelogs.sql
[0m23:36:21.311778 [debug] [MainThread]: Partial parsing: deleted file: supercell://models/example/supercell_logsfacts.sql
[0m23:36:21.490159 [debug] [MainThread]: Wrote artifact WritableManifest to /home/harsha/data_actions/supercell_dbt/target/manifest.json
[0m23:36:21.491176 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/harsha/data_actions/supercell_dbt/target/semantic_manifest.json
[0m23:36:21.498423 [info ] [MainThread]: Found 3 models, 4 data tests, 428 macros
[0m23:36:21.499845 [info ] [MainThread]: 
[0m23:36:21.500134 [info ] [MainThread]: Concurrency: 4 threads (target='default')
[0m23:36:21.500322 [info ] [MainThread]: 
[0m23:36:21.500604 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m23:36:21.501395 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_supercell'
[0m23:36:21.524620 [debug] [ThreadPool]: Using duckdb connection "list_supercell"
[0m23:36:21.524929 [debug] [ThreadPool]: On list_supercell: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "connection_name": "list_supercell"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"supercell"'
    
  
  
[0m23:36:21.525108 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:36:21.528323 [debug] [ThreadPool]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "connection_name": "list_supercell"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"supercell"'
    
  
  
[0m23:36:21.528582 [debug] [ThreadPool]: DuckDB adapter: Rolling back transaction.
[0m23:36:21.529178 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:36:21.529426 [debug] [MainThread]: Connection 'list_supercell' was properly closed.
[0m23:36:21.529612 [info ] [MainThread]: 
[0m23:36:21.529795 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.03 seconds (0.03s).
[0m23:36:21.530042 [error] [MainThread]: Encountered an error:
Runtime Error
  IO Error: Could not set lock on file "/home/harsha/data_actions/supercell_dbt/supercell.duckdb": Conflicting lock is held in /usr/local/bin/duckdb (PID 2434532) by user harsha. See also https://duckdb.org/docs/connect/concurrency
[0m23:36:21.530685 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.5377297, "process_in_blocks": "0", "process_kernel_time": 0.092, "process_mem_max_rss": "136380", "process_out_blocks": "1776", "process_user_time": 1.294013}
[0m23:36:21.531018 [debug] [MainThread]: Command `dbt run` failed at 23:36:21.530954 after 0.54 seconds
[0m23:36:21.531286 [debug] [MainThread]: Flushing usage events


============================== 23:36:35.278878 | a955ac6f-f864-4c2b-8a52-dced9534ec9d ==============================
[0m23:36:35.278878 [info ] [MainThread]: Running with dbt=1.9.4
[0m23:36:35.281886 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/home/harsha/data_actions/supercell_dbt', 'log_path': '/home/harsha/data_actions/supercell_dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run --select models/supercell_models/cleaned_usagelogs.sql', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'False'}
[0m23:36:35.282328 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality

User config should be moved from the 'config' key in profiles.yml to the 'flags' key in dbt_project.yml.
[0m23:36:35.437073 [info ] [MainThread]: Registered adapter: duckdb=1.9.3
[0m23:36:35.473319 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m23:36:35.524765 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:36:35.525023 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:36:35.579544 [debug] [MainThread]: Wrote artifact WritableManifest to /home/harsha/data_actions/supercell_dbt/target/manifest.json
[0m23:36:35.580454 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/harsha/data_actions/supercell_dbt/target/semantic_manifest.json
[0m23:36:35.587074 [info ] [MainThread]: Found 3 models, 4 data tests, 428 macros
[0m23:36:35.588556 [info ] [MainThread]: 
[0m23:36:35.588872 [info ] [MainThread]: Concurrency: 4 threads (target='default')
[0m23:36:35.589050 [info ] [MainThread]: 
[0m23:36:35.589341 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m23:36:35.590082 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_supercell'
[0m23:36:35.615283 [debug] [ThreadPool]: Using duckdb connection "list_supercell"
[0m23:36:35.615620 [debug] [ThreadPool]: On list_supercell: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "connection_name": "list_supercell"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"supercell"'
    
  
  
[0m23:36:35.615828 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:36:35.623339 [debug] [ThreadPool]: SQL status: OK in 0.007 seconds
[0m23:36:35.624232 [debug] [ThreadPool]: On list_supercell: Close
[0m23:36:35.624854 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_supercell, now create_supercell_main)
[0m23:36:35.625138 [debug] [ThreadPool]: Creating schema "database: "supercell"
schema: "main"
"
[0m23:36:35.629000 [debug] [ThreadPool]: Using duckdb connection "create_supercell_main"
[0m23:36:35.629223 [debug] [ThreadPool]: On create_supercell_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "connection_name": "create_supercell_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='supercell'
        and type='sqlite'
    
  
[0m23:36:35.629412 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:36:35.629972 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m23:36:35.630718 [debug] [ThreadPool]: Using duckdb connection "create_supercell_main"
[0m23:36:35.630915 [debug] [ThreadPool]: On create_supercell_main: BEGIN
[0m23:36:35.631189 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m23:36:35.631389 [debug] [ThreadPool]: Using duckdb connection "create_supercell_main"
[0m23:36:35.631554 [debug] [ThreadPool]: On create_supercell_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "connection_name": "create_supercell_main"} */

    
    
        create schema if not exists "supercell"."main"
    
[0m23:36:35.631992 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m23:36:35.632512 [debug] [ThreadPool]: On create_supercell_main: COMMIT
[0m23:36:35.632745 [debug] [ThreadPool]: Using duckdb connection "create_supercell_main"
[0m23:36:35.632931 [debug] [ThreadPool]: On create_supercell_main: COMMIT
[0m23:36:35.633240 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m23:36:35.633459 [debug] [ThreadPool]: On create_supercell_main: Close
[0m23:36:35.637549 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_supercell_main, now list_supercell_main)
[0m23:36:35.642257 [debug] [ThreadPool]: Using duckdb connection "list_supercell_main"
[0m23:36:35.642712 [debug] [ThreadPool]: On list_supercell_main: BEGIN
[0m23:36:35.642910 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:36:35.643382 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m23:36:35.643560 [debug] [ThreadPool]: Using duckdb connection "list_supercell_main"
[0m23:36:35.643708 [debug] [ThreadPool]: On list_supercell_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "connection_name": "list_supercell_main"} */
select
      'supercell' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'supercell'
  
[0m23:36:35.651751 [debug] [ThreadPool]: SQL status: OK in 0.008 seconds
[0m23:36:35.652623 [debug] [ThreadPool]: On list_supercell_main: ROLLBACK
[0m23:36:35.653324 [debug] [ThreadPool]: Failed to rollback 'list_supercell_main'
[0m23:36:35.653546 [debug] [ThreadPool]: On list_supercell_main: Close
[0m23:36:35.654450 [debug] [MainThread]: Using duckdb connection "master"
[0m23:36:35.654654 [debug] [MainThread]: On master: BEGIN
[0m23:36:35.654814 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:36:35.655171 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m23:36:35.655399 [debug] [MainThread]: On master: COMMIT
[0m23:36:35.655558 [debug] [MainThread]: Using duckdb connection "master"
[0m23:36:35.655701 [debug] [MainThread]: On master: COMMIT
[0m23:36:35.655955 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m23:36:35.656149 [debug] [MainThread]: On master: Close
[0m23:36:35.658088 [debug] [Thread-1 (]: Began running node model.supercell.cleaned_usagelogs
[0m23:36:35.658624 [info ] [Thread-1 (]: 1 of 1 START sql table model main.cleaned_usagelogs ............................ [RUN]
[0m23:36:35.658945 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_supercell_main, now model.supercell.cleaned_usagelogs)
[0m23:36:35.659169 [debug] [Thread-1 (]: Began compiling node model.supercell.cleaned_usagelogs
[0m23:36:35.664251 [debug] [Thread-1 (]: Writing injected SQL for node "model.supercell.cleaned_usagelogs"
[0m23:36:35.665135 [debug] [Thread-1 (]: Began executing node model.supercell.cleaned_usagelogs
[0m23:36:35.684124 [debug] [Thread-1 (]: Writing runtime sql for node "model.supercell.cleaned_usagelogs"
[0m23:36:35.684679 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.cleaned_usagelogs"
[0m23:36:35.684920 [debug] [Thread-1 (]: On model.supercell.cleaned_usagelogs: BEGIN
[0m23:36:35.685114 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:36:35.685715 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m23:36:35.685927 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.cleaned_usagelogs"
[0m23:36:35.686120 [debug] [Thread-1 (]: On model.supercell.cleaned_usagelogs: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.cleaned_usagelogs"} */

  
    
    

    create  table
      "supercell"."main"."cleaned_usagelogs__dbt_tmp"
  
    as (
      


SELECT
    CAST("LinkedAccountId" AS VARCHAR) AS linked_account_id,
    CAST("bill/PayerAccountId" AS VARCHAR) AS payer_account_id,
    CAST("lineItem/UsageStartDate" AS TIMESTAMP) AS usage_start_date,
    CAST("lineItem/UsageEndDate" AS TIMESTAMP) AS usage_end_date,
    CAST("lineItem/UsageAmount" AS DECIMAL(18, 6)) AS usage_amount,
    CAST("lineItem/Operation" AS VARCHAR) AS operation,
    CAST("pricing/PricingModel" AS VARCHAR) AS pricing_model,
    CAST("resourceTags/TagKeys" AS VARCHAR) AS tag_keys,
    CAST("resourceTags/TagValues" AS VARCHAR) AS tag_values,
    CAST("product/Region" AS VARCHAR) AS region,
    CAST("product/ServiceCode" AS VARCHAR) AS service_code,
    CAST("product/InstanceType" AS VARCHAR) AS instance_type,
    CAST("amortized_cost" AS DECIMAL(18, 6)) AS amortized_cost,
    CAST("product/Description" AS VARCHAR) AS description
FROM supercell_usagelogs
    );
  
  
[0m23:36:35.764272 [debug] [Thread-1 (]: SQL status: OK in 0.078 seconds
[0m23:36:35.768166 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.cleaned_usagelogs"
[0m23:36:35.768481 [debug] [Thread-1 (]: On model.supercell.cleaned_usagelogs: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.cleaned_usagelogs"} */
alter table "supercell"."main"."cleaned_usagelogs__dbt_tmp" rename to "cleaned_usagelogs"
[0m23:36:35.769056 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m23:36:35.776571 [debug] [Thread-1 (]: On model.supercell.cleaned_usagelogs: COMMIT
[0m23:36:35.776824 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.cleaned_usagelogs"
[0m23:36:35.777011 [debug] [Thread-1 (]: On model.supercell.cleaned_usagelogs: COMMIT
[0m23:36:35.864781 [debug] [Thread-1 (]: SQL status: OK in 0.087 seconds
[0m23:36:35.867989 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.cleaned_usagelogs"
[0m23:36:35.868266 [debug] [Thread-1 (]: On model.supercell.cleaned_usagelogs: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.cleaned_usagelogs"} */
drop table if exists "supercell"."main"."cleaned_usagelogs__dbt_backup" cascade
[0m23:36:35.869040 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m23:36:35.870552 [debug] [Thread-1 (]: On model.supercell.cleaned_usagelogs: Close
[0m23:36:35.873589 [info ] [Thread-1 (]: 1 of 1 OK created sql table model main.cleaned_usagelogs ....................... [[32mOK[0m in 0.21s]
[0m23:36:35.873934 [debug] [Thread-1 (]: Finished running node model.supercell.cleaned_usagelogs
[0m23:36:35.875539 [debug] [MainThread]: Using duckdb connection "master"
[0m23:36:35.875814 [debug] [MainThread]: On master: BEGIN
[0m23:36:35.875980 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:36:35.876488 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m23:36:35.876685 [debug] [MainThread]: On master: COMMIT
[0m23:36:35.876841 [debug] [MainThread]: Using duckdb connection "master"
[0m23:36:35.876980 [debug] [MainThread]: On master: COMMIT
[0m23:36:35.877269 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m23:36:35.877482 [debug] [MainThread]: On master: Close
[0m23:36:35.877784 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:36:35.877937 [debug] [MainThread]: Connection 'model.supercell.cleaned_usagelogs' was properly closed.
[0m23:36:35.878117 [info ] [MainThread]: 
[0m23:36:35.878345 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.29 seconds (0.29s).
[0m23:36:35.878766 [debug] [MainThread]: Command end result
[0m23:36:35.890716 [debug] [MainThread]: Wrote artifact WritableManifest to /home/harsha/data_actions/supercell_dbt/target/manifest.json
[0m23:36:35.891774 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/harsha/data_actions/supercell_dbt/target/semantic_manifest.json
[0m23:36:35.894992 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/harsha/data_actions/supercell_dbt/target/run_results.json
[0m23:36:35.895200 [info ] [MainThread]: 
[0m23:36:35.895439 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:36:35.895602 [info ] [MainThread]: 
[0m23:36:35.895771 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m23:36:35.896274 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.64822966, "process_in_blocks": "0", "process_kernel_time": 0.119714, "process_mem_max_rss": "190092", "process_out_blocks": "4904", "process_user_time": 1.340801}
[0m23:36:35.896556 [debug] [MainThread]: Command `dbt run` succeeded at 23:36:35.896499 after 0.65 seconds
[0m23:36:35.896746 [debug] [MainThread]: Flushing usage events


============================== 23:50:36.695507 | e197b047-d96b-4371-b964-21dd37007c41 ==============================
[0m23:50:36.695507 [info ] [MainThread]: Running with dbt=1.9.4
[0m23:50:36.697473 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/harsha/data_actions/supercell_dbt/logs', 'debug': 'False', 'profiles_dir': '/home/harsha/data_actions/supercell_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run --select models/supercell_models/metrics/total_cost.sql', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'False'}
[0m23:50:36.697693 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality

User config should be moved from the 'config' key in profiles.yml to the 'flags' key in dbt_project.yml.
[0m23:50:36.850390 [info ] [MainThread]: Registered adapter: duckdb=1.9.3
[0m23:50:36.887316 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m23:50:36.940193 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m23:50:36.940602 [debug] [MainThread]: Partial parsing: added file: supercell://models/supercell_models/metrics/total_cost.sql
[0m23:50:37.121355 [debug] [MainThread]: Wrote artifact WritableManifest to /home/harsha/data_actions/supercell_dbt/target/manifest.json
[0m23:50:37.122401 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/harsha/data_actions/supercell_dbt/target/semantic_manifest.json
[0m23:50:37.129067 [info ] [MainThread]: Found 4 models, 4 data tests, 428 macros
[0m23:50:37.130599 [info ] [MainThread]: 
[0m23:50:37.130905 [info ] [MainThread]: Concurrency: 4 threads (target='default')
[0m23:50:37.131099 [info ] [MainThread]: 
[0m23:50:37.131461 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m23:50:37.132236 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_supercell'
[0m23:50:37.154227 [debug] [ThreadPool]: Using duckdb connection "list_supercell"
[0m23:50:37.154577 [debug] [ThreadPool]: On list_supercell: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "connection_name": "list_supercell"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"supercell"'
    
  
  
[0m23:50:37.154780 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:50:37.162245 [debug] [ThreadPool]: SQL status: OK in 0.007 seconds
[0m23:50:37.163100 [debug] [ThreadPool]: On list_supercell: Close
[0m23:50:37.163769 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_supercell, now create_supercell_main)
[0m23:50:37.164078 [debug] [ThreadPool]: Creating schema "database: "supercell"
schema: "main"
"
[0m23:50:37.167918 [debug] [ThreadPool]: Using duckdb connection "create_supercell_main"
[0m23:50:37.168127 [debug] [ThreadPool]: On create_supercell_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "connection_name": "create_supercell_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='supercell'
        and type='sqlite'
    
  
[0m23:50:37.168290 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:50:37.168908 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m23:50:37.169621 [debug] [ThreadPool]: Using duckdb connection "create_supercell_main"
[0m23:50:37.169798 [debug] [ThreadPool]: On create_supercell_main: BEGIN
[0m23:50:37.170055 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m23:50:37.170240 [debug] [ThreadPool]: Using duckdb connection "create_supercell_main"
[0m23:50:37.170392 [debug] [ThreadPool]: On create_supercell_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "connection_name": "create_supercell_main"} */

    
    
        create schema if not exists "supercell"."main"
    
[0m23:50:37.170663 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m23:50:37.171118 [debug] [ThreadPool]: On create_supercell_main: COMMIT
[0m23:50:37.171321 [debug] [ThreadPool]: Using duckdb connection "create_supercell_main"
[0m23:50:37.171494 [debug] [ThreadPool]: On create_supercell_main: COMMIT
[0m23:50:37.171733 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m23:50:37.171898 [debug] [ThreadPool]: On create_supercell_main: Close
[0m23:50:37.175392 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_supercell_main, now list_supercell_main)
[0m23:50:37.179796 [debug] [ThreadPool]: Using duckdb connection "list_supercell_main"
[0m23:50:37.180058 [debug] [ThreadPool]: On list_supercell_main: BEGIN
[0m23:50:37.180220 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:50:37.180621 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m23:50:37.180815 [debug] [ThreadPool]: Using duckdb connection "list_supercell_main"
[0m23:50:37.180986 [debug] [ThreadPool]: On list_supercell_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "connection_name": "list_supercell_main"} */
select
      'supercell' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'supercell'
  
[0m23:50:37.188778 [debug] [ThreadPool]: SQL status: OK in 0.008 seconds
[0m23:50:37.189560 [debug] [ThreadPool]: On list_supercell_main: ROLLBACK
[0m23:50:37.190189 [debug] [ThreadPool]: Failed to rollback 'list_supercell_main'
[0m23:50:37.190402 [debug] [ThreadPool]: On list_supercell_main: Close
[0m23:50:37.191022 [debug] [MainThread]: Using duckdb connection "master"
[0m23:50:37.191221 [debug] [MainThread]: On master: BEGIN
[0m23:50:37.191400 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:50:37.191753 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m23:50:37.191932 [debug] [MainThread]: On master: COMMIT
[0m23:50:37.192088 [debug] [MainThread]: Using duckdb connection "master"
[0m23:50:37.192233 [debug] [MainThread]: On master: COMMIT
[0m23:50:37.192514 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m23:50:37.192683 [debug] [MainThread]: On master: Close
[0m23:50:37.194714 [debug] [Thread-1 (]: Began running node model.supercell.total_cost
[0m23:50:37.195255 [info ] [Thread-1 (]: 1 of 1 START sql table model main.total_cost ................................... [RUN]
[0m23:50:37.195696 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_supercell_main, now model.supercell.total_cost)
[0m23:50:37.196047 [debug] [Thread-1 (]: Began compiling node model.supercell.total_cost
[0m23:50:37.203672 [debug] [Thread-1 (]: Writing injected SQL for node "model.supercell.total_cost"
[0m23:50:37.204361 [debug] [Thread-1 (]: Began executing node model.supercell.total_cost
[0m23:50:37.225981 [debug] [Thread-1 (]: Writing runtime sql for node "model.supercell.total_cost"
[0m23:50:37.226461 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.total_cost"
[0m23:50:37.226703 [debug] [Thread-1 (]: On model.supercell.total_cost: BEGIN
[0m23:50:37.226890 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:50:37.227453 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m23:50:37.227645 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.total_cost"
[0m23:50:37.227811 [debug] [Thread-1 (]: On model.supercell.total_cost: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.total_cost"} */

  
    
    

    create  table
      "supercell"."main"."total_cost__dbt_tmp"
  
    as (
      


select 
    SUM(pricing_model) as total_cost,
    region,
    instance_type,
    pricing_model,
    service_code,
    tag_keys as tag_types
from "supercell"."main"."cleaned_usagelogs"
    );
  
  
[0m23:50:37.231242 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.total_cost"} */

  
    
    

    create  table
      "supercell"."main"."total_cost__dbt_tmp"
  
    as (
      


select 
    SUM(pricing_model) as total_cost,
    region,
    instance_type,
    pricing_model,
    service_code,
    tag_keys as tag_types
from "supercell"."main"."cleaned_usagelogs"
    );
  
  
[0m23:50:37.231478 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m23:50:37.231729 [debug] [Thread-1 (]: On model.supercell.total_cost: ROLLBACK
[0m23:50:37.235775 [debug] [Thread-1 (]: Failed to rollback 'model.supercell.total_cost'
[0m23:50:37.236000 [debug] [Thread-1 (]: On model.supercell.total_cost: Close
[0m23:50:37.237243 [debug] [Thread-1 (]: Runtime Error in model total_cost (models/supercell_models/metrics/total_cost.sql)
  Binder Error: No function matches the given name and argument types 'sum(VARCHAR)'. You might need to add explicit type casts.
  	Candidate functions:
  	sum(DECIMAL) -> DECIMAL
  	sum(BOOLEAN) -> HUGEINT
  	sum(SMALLINT) -> HUGEINT
  	sum(INTEGER) -> HUGEINT
  	sum(BIGINT) -> HUGEINT
  	sum(HUGEINT) -> HUGEINT
  	sum(DOUBLE) -> DOUBLE
  
  
  LINE 15:     SUM(pricing_model) as total_cost,
               ^
[0m23:50:37.238338 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model main.total_cost .......................... [[31mERROR[0m in 0.04s]
[0m23:50:37.238685 [debug] [Thread-1 (]: Finished running node model.supercell.total_cost
[0m23:50:37.239222 [debug] [Thread-7 (]: Marking all children of 'model.supercell.total_cost' to be skipped because of status 'error'.  Reason: Runtime Error in model total_cost (models/supercell_models/metrics/total_cost.sql)
  Binder Error: No function matches the given name and argument types 'sum(VARCHAR)'. You might need to add explicit type casts.
  	Candidate functions:
  	sum(DECIMAL) -> DECIMAL
  	sum(BOOLEAN) -> HUGEINT
  	sum(SMALLINT) -> HUGEINT
  	sum(INTEGER) -> HUGEINT
  	sum(BIGINT) -> HUGEINT
  	sum(HUGEINT) -> HUGEINT
  	sum(DOUBLE) -> DOUBLE
  
  
  LINE 15:     SUM(pricing_model) as total_cost,
               ^.
[0m23:50:37.241566 [debug] [MainThread]: Using duckdb connection "master"
[0m23:50:37.241833 [debug] [MainThread]: On master: BEGIN
[0m23:50:37.241997 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:50:37.242592 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m23:50:37.243150 [debug] [MainThread]: On master: COMMIT
[0m23:50:37.243848 [debug] [MainThread]: Using duckdb connection "master"
[0m23:50:37.244096 [debug] [MainThread]: On master: COMMIT
[0m23:50:37.244626 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m23:50:37.244908 [debug] [MainThread]: On master: Close
[0m23:50:37.245475 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:50:37.245704 [debug] [MainThread]: Connection 'model.supercell.total_cost' was properly closed.
[0m23:50:37.245955 [info ] [MainThread]: 
[0m23:50:37.246173 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.11 seconds (0.11s).
[0m23:50:37.246595 [debug] [MainThread]: Command end result
[0m23:50:37.255541 [debug] [MainThread]: Wrote artifact WritableManifest to /home/harsha/data_actions/supercell_dbt/target/manifest.json
[0m23:50:37.256444 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/harsha/data_actions/supercell_dbt/target/semantic_manifest.json
[0m23:50:37.259706 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/harsha/data_actions/supercell_dbt/target/run_results.json
[0m23:50:37.259917 [info ] [MainThread]: 
[0m23:50:37.260141 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m23:50:37.260334 [info ] [MainThread]: 
[0m23:50:37.260547 [error] [MainThread]:   Runtime Error in model total_cost (models/supercell_models/metrics/total_cost.sql)
  Binder Error: No function matches the given name and argument types 'sum(VARCHAR)'. You might need to add explicit type casts.
  	Candidate functions:
  	sum(DECIMAL) -> DECIMAL
  	sum(BOOLEAN) -> HUGEINT
  	sum(SMALLINT) -> HUGEINT
  	sum(INTEGER) -> HUGEINT
  	sum(BIGINT) -> HUGEINT
  	sum(HUGEINT) -> HUGEINT
  	sum(DOUBLE) -> DOUBLE
  
  
  LINE 15:     SUM(pricing_model) as total_cost,
               ^
[0m23:50:37.260716 [info ] [MainThread]: 
[0m23:50:37.260905 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m23:50:37.261449 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.59624594, "process_in_blocks": "2128", "process_kernel_time": 0.081771, "process_mem_max_rss": "148224", "process_out_blocks": "2704", "process_user_time": 1.307352}
[0m23:50:37.261744 [debug] [MainThread]: Command `dbt run` failed at 23:50:37.261678 after 0.60 seconds
[0m23:50:37.261974 [debug] [MainThread]: Flushing usage events


============================== 23:50:53.045568 | 471dba94-f3b8-4899-a63b-838aac5926c0 ==============================
[0m23:50:53.045568 [info ] [MainThread]: Running with dbt=1.9.4
[0m23:50:53.047604 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/home/harsha/data_actions/supercell_dbt', 'log_path': '/home/harsha/data_actions/supercell_dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --select models/supercell_models/metrics/total_cost.sql', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'False'}
[0m23:50:53.047844 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality

User config should be moved from the 'config' key in profiles.yml to the 'flags' key in dbt_project.yml.
[0m23:50:53.203389 [info ] [MainThread]: Registered adapter: duckdb=1.9.3
[0m23:50:53.240663 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m23:50:53.293239 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m23:50:53.293646 [debug] [MainThread]: Partial parsing: updated file: supercell://models/supercell_models/metrics/total_cost.sql
[0m23:50:53.471582 [debug] [MainThread]: Wrote artifact WritableManifest to /home/harsha/data_actions/supercell_dbt/target/manifest.json
[0m23:50:53.472522 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/harsha/data_actions/supercell_dbt/target/semantic_manifest.json
[0m23:50:53.478981 [info ] [MainThread]: Found 4 models, 4 data tests, 428 macros
[0m23:50:53.480399 [info ] [MainThread]: 
[0m23:50:53.480700 [info ] [MainThread]: Concurrency: 4 threads (target='default')
[0m23:50:53.480877 [info ] [MainThread]: 
[0m23:50:53.481161 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m23:50:53.481871 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_supercell'
[0m23:50:53.502107 [debug] [ThreadPool]: Using duckdb connection "list_supercell"
[0m23:50:53.502411 [debug] [ThreadPool]: On list_supercell: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "connection_name": "list_supercell"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"supercell"'
    
  
  
[0m23:50:53.502588 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:50:53.510593 [debug] [ThreadPool]: SQL status: OK in 0.008 seconds
[0m23:50:53.511474 [debug] [ThreadPool]: On list_supercell: Close
[0m23:50:53.511952 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_supercell, now create_supercell_main)
[0m23:50:53.512237 [debug] [ThreadPool]: Creating schema "database: "supercell"
schema: "main"
"
[0m23:50:53.516065 [debug] [ThreadPool]: Using duckdb connection "create_supercell_main"
[0m23:50:53.516299 [debug] [ThreadPool]: On create_supercell_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "connection_name": "create_supercell_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='supercell'
        and type='sqlite'
    
  
[0m23:50:53.516463 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:50:53.517065 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m23:50:53.517821 [debug] [ThreadPool]: Using duckdb connection "create_supercell_main"
[0m23:50:53.518003 [debug] [ThreadPool]: On create_supercell_main: BEGIN
[0m23:50:53.518275 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m23:50:53.518453 [debug] [ThreadPool]: Using duckdb connection "create_supercell_main"
[0m23:50:53.518589 [debug] [ThreadPool]: On create_supercell_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "connection_name": "create_supercell_main"} */

    
    
        create schema if not exists "supercell"."main"
    
[0m23:50:53.518843 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m23:50:53.519300 [debug] [ThreadPool]: On create_supercell_main: COMMIT
[0m23:50:53.519507 [debug] [ThreadPool]: Using duckdb connection "create_supercell_main"
[0m23:50:53.519658 [debug] [ThreadPool]: On create_supercell_main: COMMIT
[0m23:50:53.520078 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m23:50:53.520275 [debug] [ThreadPool]: On create_supercell_main: Close
[0m23:50:53.523653 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_supercell_main, now list_supercell_main)
[0m23:50:53.528650 [debug] [ThreadPool]: Using duckdb connection "list_supercell_main"
[0m23:50:53.528863 [debug] [ThreadPool]: On list_supercell_main: BEGIN
[0m23:50:53.529019 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:50:53.529424 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m23:50:53.529596 [debug] [ThreadPool]: Using duckdb connection "list_supercell_main"
[0m23:50:53.529748 [debug] [ThreadPool]: On list_supercell_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "connection_name": "list_supercell_main"} */
select
      'supercell' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'supercell'
  
[0m23:50:53.537775 [debug] [ThreadPool]: SQL status: OK in 0.008 seconds
[0m23:50:53.538584 [debug] [ThreadPool]: On list_supercell_main: ROLLBACK
[0m23:50:53.539216 [debug] [ThreadPool]: Failed to rollback 'list_supercell_main'
[0m23:50:53.539420 [debug] [ThreadPool]: On list_supercell_main: Close
[0m23:50:53.540200 [debug] [MainThread]: Using duckdb connection "master"
[0m23:50:53.540427 [debug] [MainThread]: On master: BEGIN
[0m23:50:53.540576 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:50:53.540903 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m23:50:53.541072 [debug] [MainThread]: On master: COMMIT
[0m23:50:53.541231 [debug] [MainThread]: Using duckdb connection "master"
[0m23:50:53.541390 [debug] [MainThread]: On master: COMMIT
[0m23:50:53.541626 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m23:50:53.541790 [debug] [MainThread]: On master: Close
[0m23:50:53.543631 [debug] [Thread-1 (]: Began running node model.supercell.total_cost
[0m23:50:53.544159 [info ] [Thread-1 (]: 1 of 1 START sql table model main.total_cost ................................... [RUN]
[0m23:50:53.544603 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_supercell_main, now model.supercell.total_cost)
[0m23:50:53.544960 [debug] [Thread-1 (]: Began compiling node model.supercell.total_cost
[0m23:50:53.551875 [debug] [Thread-1 (]: Writing injected SQL for node "model.supercell.total_cost"
[0m23:50:53.552362 [debug] [Thread-1 (]: Began executing node model.supercell.total_cost
[0m23:50:53.570454 [debug] [Thread-1 (]: Writing runtime sql for node "model.supercell.total_cost"
[0m23:50:53.570858 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.total_cost"
[0m23:50:53.571082 [debug] [Thread-1 (]: On model.supercell.total_cost: BEGIN
[0m23:50:53.571254 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:50:53.571876 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m23:50:53.572075 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.total_cost"
[0m23:50:53.572242 [debug] [Thread-1 (]: On model.supercell.total_cost: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.total_cost"} */

  
    
    

    create  table
      "supercell"."main"."total_cost__dbt_tmp"
  
    as (
      


select 
    SUM(pricing_model) as total_cost,
    region,
    instance_type,
    pricing_model,
    service_code,
    tag_keys as tag_types
from "supercell"."main"."cleaned_usagelogs"
group by region, instance_type, pricing_model, service_code, tag_keys
    );
  
  
[0m23:50:53.572887 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.total_cost"} */

  
    
    

    create  table
      "supercell"."main"."total_cost__dbt_tmp"
  
    as (
      


select 
    SUM(pricing_model) as total_cost,
    region,
    instance_type,
    pricing_model,
    service_code,
    tag_keys as tag_types
from "supercell"."main"."cleaned_usagelogs"
group by region, instance_type, pricing_model, service_code, tag_keys
    );
  
  
[0m23:50:53.573114 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m23:50:53.573362 [debug] [Thread-1 (]: On model.supercell.total_cost: ROLLBACK
[0m23:50:53.575301 [debug] [Thread-1 (]: Failed to rollback 'model.supercell.total_cost'
[0m23:50:53.575523 [debug] [Thread-1 (]: On model.supercell.total_cost: Close
[0m23:50:53.576771 [debug] [Thread-1 (]: Runtime Error in model total_cost (models/supercell_models/metrics/total_cost.sql)
  Binder Error: No function matches the given name and argument types 'sum(VARCHAR)'. You might need to add explicit type casts.
  	Candidate functions:
  	sum(DECIMAL) -> DECIMAL
  	sum(BOOLEAN) -> HUGEINT
  	sum(SMALLINT) -> HUGEINT
  	sum(INTEGER) -> HUGEINT
  	sum(BIGINT) -> HUGEINT
  	sum(HUGEINT) -> HUGEINT
  	sum(DOUBLE) -> DOUBLE
  
  
  LINE 15:     SUM(pricing_model) as total_cost,
               ^
[0m23:50:53.577847 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model main.total_cost .......................... [[31mERROR[0m in 0.03s]
[0m23:50:53.578206 [debug] [Thread-1 (]: Finished running node model.supercell.total_cost
[0m23:50:53.578743 [debug] [Thread-7 (]: Marking all children of 'model.supercell.total_cost' to be skipped because of status 'error'.  Reason: Runtime Error in model total_cost (models/supercell_models/metrics/total_cost.sql)
  Binder Error: No function matches the given name and argument types 'sum(VARCHAR)'. You might need to add explicit type casts.
  	Candidate functions:
  	sum(DECIMAL) -> DECIMAL
  	sum(BOOLEAN) -> HUGEINT
  	sum(SMALLINT) -> HUGEINT
  	sum(INTEGER) -> HUGEINT
  	sum(BIGINT) -> HUGEINT
  	sum(HUGEINT) -> HUGEINT
  	sum(DOUBLE) -> DOUBLE
  
  
  LINE 15:     SUM(pricing_model) as total_cost,
               ^.
[0m23:50:53.580876 [debug] [MainThread]: Using duckdb connection "master"
[0m23:50:53.581269 [debug] [MainThread]: On master: BEGIN
[0m23:50:53.581501 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:50:53.582318 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m23:50:53.582630 [debug] [MainThread]: On master: COMMIT
[0m23:50:53.582833 [debug] [MainThread]: Using duckdb connection "master"
[0m23:50:53.583011 [debug] [MainThread]: On master: COMMIT
[0m23:50:53.583343 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m23:50:53.583674 [debug] [MainThread]: On master: Close
[0m23:50:53.584172 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:50:53.584408 [debug] [MainThread]: Connection 'model.supercell.total_cost' was properly closed.
[0m23:50:53.584652 [info ] [MainThread]: 
[0m23:50:53.584857 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.10 seconds (0.10s).
[0m23:50:53.585258 [debug] [MainThread]: Command end result
[0m23:50:53.594793 [debug] [MainThread]: Wrote artifact WritableManifest to /home/harsha/data_actions/supercell_dbt/target/manifest.json
[0m23:50:53.595709 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/harsha/data_actions/supercell_dbt/target/semantic_manifest.json
[0m23:50:53.598941 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/harsha/data_actions/supercell_dbt/target/run_results.json
[0m23:50:53.599143 [info ] [MainThread]: 
[0m23:50:53.599414 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m23:50:53.599602 [info ] [MainThread]: 
[0m23:50:53.599818 [error] [MainThread]:   Runtime Error in model total_cost (models/supercell_models/metrics/total_cost.sql)
  Binder Error: No function matches the given name and argument types 'sum(VARCHAR)'. You might need to add explicit type casts.
  	Candidate functions:
  	sum(DECIMAL) -> DECIMAL
  	sum(BOOLEAN) -> HUGEINT
  	sum(SMALLINT) -> HUGEINT
  	sum(INTEGER) -> HUGEINT
  	sum(BIGINT) -> HUGEINT
  	sum(HUGEINT) -> HUGEINT
  	sum(DOUBLE) -> DOUBLE
  
  
  LINE 15:     SUM(pricing_model) as total_cost,
               ^
[0m23:50:53.599980 [info ] [MainThread]: 
[0m23:50:53.600219 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m23:50:53.601732 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.58571744, "process_in_blocks": "0", "process_kernel_time": 0.089553, "process_mem_max_rss": "147780", "process_out_blocks": "2704", "process_user_time": 1.301516}
[0m23:50:53.602297 [debug] [MainThread]: Command `dbt run` failed at 23:50:53.602171 after 0.59 seconds
[0m23:50:53.602604 [debug] [MainThread]: Flushing usage events


============================== 23:51:33.391309 | 1a40d8d7-41bb-49cf-b2d7-83efff86b036 ==============================
[0m23:51:33.391309 [info ] [MainThread]: Running with dbt=1.9.4
[0m23:51:33.396476 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/harsha/data_actions/supercell_dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/harsha/data_actions/supercell_dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt run --select models/supercell_models/metrics/total_cost.sql', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'False'}
[0m23:51:33.397192 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality

User config should be moved from the 'config' key in profiles.yml to the 'flags' key in dbt_project.yml.
[0m23:51:33.736996 [info ] [MainThread]: Registered adapter: duckdb=1.9.3
[0m23:51:33.807619 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m23:51:33.915567 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m23:51:33.916309 [debug] [MainThread]: Partial parsing: updated file: supercell://models/supercell_models/metrics/total_cost.sql
[0m23:51:34.297519 [debug] [MainThread]: Wrote artifact WritableManifest to /home/harsha/data_actions/supercell_dbt/target/manifest.json
[0m23:51:34.299401 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/harsha/data_actions/supercell_dbt/target/semantic_manifest.json
[0m23:51:34.312106 [info ] [MainThread]: Found 4 models, 4 data tests, 428 macros
[0m23:51:34.314901 [info ] [MainThread]: 
[0m23:51:34.315524 [info ] [MainThread]: Concurrency: 4 threads (target='default')
[0m23:51:34.315900 [info ] [MainThread]: 
[0m23:51:34.316494 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m23:51:34.318062 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_supercell'
[0m23:51:34.357288 [debug] [ThreadPool]: Using duckdb connection "list_supercell"
[0m23:51:34.357871 [debug] [ThreadPool]: On list_supercell: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "connection_name": "list_supercell"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"supercell"'
    
  
  
[0m23:51:34.358234 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:51:34.372313 [debug] [ThreadPool]: SQL status: OK in 0.014 seconds
[0m23:51:34.373958 [debug] [ThreadPool]: On list_supercell: Close
[0m23:51:34.374919 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_supercell, now create_supercell_main)
[0m23:51:34.375512 [debug] [ThreadPool]: Creating schema "database: "supercell"
schema: "main"
"
[0m23:51:34.383269 [debug] [ThreadPool]: Using duckdb connection "create_supercell_main"
[0m23:51:34.383710 [debug] [ThreadPool]: On create_supercell_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "connection_name": "create_supercell_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='supercell'
        and type='sqlite'
    
  
[0m23:51:34.384051 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:51:34.385489 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m23:51:34.387040 [debug] [ThreadPool]: Using duckdb connection "create_supercell_main"
[0m23:51:34.387474 [debug] [ThreadPool]: On create_supercell_main: BEGIN
[0m23:51:34.388022 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m23:51:34.388377 [debug] [ThreadPool]: Using duckdb connection "create_supercell_main"
[0m23:51:34.388681 [debug] [ThreadPool]: On create_supercell_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "connection_name": "create_supercell_main"} */

    
    
        create schema if not exists "supercell"."main"
    
[0m23:51:34.389219 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m23:51:34.390203 [debug] [ThreadPool]: On create_supercell_main: COMMIT
[0m23:51:34.390627 [debug] [ThreadPool]: Using duckdb connection "create_supercell_main"
[0m23:51:34.390965 [debug] [ThreadPool]: On create_supercell_main: COMMIT
[0m23:51:34.391568 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m23:51:34.391950 [debug] [ThreadPool]: On create_supercell_main: Close
[0m23:51:34.398742 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_supercell_main, now list_supercell_main)
[0m23:51:34.407155 [debug] [ThreadPool]: Using duckdb connection "list_supercell_main"
[0m23:51:34.407611 [debug] [ThreadPool]: On list_supercell_main: BEGIN
[0m23:51:34.407943 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:51:34.408716 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m23:51:34.409065 [debug] [ThreadPool]: Using duckdb connection "list_supercell_main"
[0m23:51:34.409388 [debug] [ThreadPool]: On list_supercell_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "connection_name": "list_supercell_main"} */
select
      'supercell' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'supercell'
  
[0m23:51:34.425347 [debug] [ThreadPool]: SQL status: OK in 0.016 seconds
[0m23:51:34.426999 [debug] [ThreadPool]: On list_supercell_main: ROLLBACK
[0m23:51:34.428303 [debug] [ThreadPool]: Failed to rollback 'list_supercell_main'
[0m23:51:34.428707 [debug] [ThreadPool]: On list_supercell_main: Close
[0m23:51:34.430392 [debug] [MainThread]: Using duckdb connection "master"
[0m23:51:34.430930 [debug] [MainThread]: On master: BEGIN
[0m23:51:34.431418 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:51:34.432359 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m23:51:34.432904 [debug] [MainThread]: On master: COMMIT
[0m23:51:34.433261 [debug] [MainThread]: Using duckdb connection "master"
[0m23:51:34.433605 [debug] [MainThread]: On master: COMMIT
[0m23:51:34.434175 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m23:51:34.434565 [debug] [MainThread]: On master: Close
[0m23:51:34.438542 [debug] [Thread-1 (]: Began running node model.supercell.total_cost
[0m23:51:34.439593 [info ] [Thread-1 (]: 1 of 1 START sql table model main.total_cost ................................... [RUN]
[0m23:51:34.440499 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_supercell_main, now model.supercell.total_cost)
[0m23:51:34.441226 [debug] [Thread-1 (]: Began compiling node model.supercell.total_cost
[0m23:51:34.454752 [debug] [Thread-1 (]: Writing injected SQL for node "model.supercell.total_cost"
[0m23:51:34.456010 [debug] [Thread-1 (]: Began executing node model.supercell.total_cost
[0m23:51:34.508927 [debug] [Thread-1 (]: Writing runtime sql for node "model.supercell.total_cost"
[0m23:51:34.509883 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.total_cost"
[0m23:51:34.510371 [debug] [Thread-1 (]: On model.supercell.total_cost: BEGIN
[0m23:51:34.510753 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:51:34.511801 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m23:51:34.512261 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.total_cost"
[0m23:51:34.512670 [debug] [Thread-1 (]: On model.supercell.total_cost: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.total_cost"} */

  
    
    

    create  table
      "supercell"."main"."total_cost__dbt_tmp"
  
    as (
      


select 
    region,
    instance_type,
    pricing_model,
    service_code,
    tag_keys as tag_types,
    SUM(pricing_model) as total_cost
from "supercell"."main"."cleaned_usagelogs"
group by region, instance_type, pricing_model, service_code, tag_keys
    );
  
  
[0m23:51:34.513829 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.total_cost"} */

  
    
    

    create  table
      "supercell"."main"."total_cost__dbt_tmp"
  
    as (
      


select 
    region,
    instance_type,
    pricing_model,
    service_code,
    tag_keys as tag_types,
    SUM(pricing_model) as total_cost
from "supercell"."main"."cleaned_usagelogs"
group by region, instance_type, pricing_model, service_code, tag_keys
    );
  
  
[0m23:51:34.514328 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m23:51:34.514931 [debug] [Thread-1 (]: On model.supercell.total_cost: ROLLBACK
[0m23:51:34.518893 [debug] [Thread-1 (]: Failed to rollback 'model.supercell.total_cost'
[0m23:51:34.519368 [debug] [Thread-1 (]: On model.supercell.total_cost: Close
[0m23:51:34.522189 [debug] [Thread-1 (]: Runtime Error in model total_cost (models/supercell_models/metrics/total_cost.sql)
  Binder Error: No function matches the given name and argument types 'sum(VARCHAR)'. You might need to add explicit type casts.
  	Candidate functions:
  	sum(DECIMAL) -> DECIMAL
  	sum(BOOLEAN) -> HUGEINT
  	sum(SMALLINT) -> HUGEINT
  	sum(INTEGER) -> HUGEINT
  	sum(BIGINT) -> HUGEINT
  	sum(HUGEINT) -> HUGEINT
  	sum(DOUBLE) -> DOUBLE
  
  
  LINE 20:     SUM(pricing_model) as total_cost
               ^
[0m23:51:34.524425 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model main.total_cost .......................... [[31mERROR[0m in 0.08s]
[0m23:51:34.525171 [debug] [Thread-1 (]: Finished running node model.supercell.total_cost
[0m23:51:34.526300 [debug] [Thread-7 (]: Marking all children of 'model.supercell.total_cost' to be skipped because of status 'error'.  Reason: Runtime Error in model total_cost (models/supercell_models/metrics/total_cost.sql)
  Binder Error: No function matches the given name and argument types 'sum(VARCHAR)'. You might need to add explicit type casts.
  	Candidate functions:
  	sum(DECIMAL) -> DECIMAL
  	sum(BOOLEAN) -> HUGEINT
  	sum(SMALLINT) -> HUGEINT
  	sum(INTEGER) -> HUGEINT
  	sum(BIGINT) -> HUGEINT
  	sum(HUGEINT) -> HUGEINT
  	sum(DOUBLE) -> DOUBLE
  
  
  LINE 20:     SUM(pricing_model) as total_cost
               ^.
[0m23:51:34.529973 [debug] [MainThread]: Using duckdb connection "master"
[0m23:51:34.530800 [debug] [MainThread]: On master: BEGIN
[0m23:51:34.531482 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:51:34.533481 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m23:51:34.534232 [debug] [MainThread]: On master: COMMIT
[0m23:51:34.534922 [debug] [MainThread]: Using duckdb connection "master"
[0m23:51:34.535638 [debug] [MainThread]: On master: COMMIT
[0m23:51:34.537181 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m23:51:34.537999 [debug] [MainThread]: On master: Close
[0m23:51:34.539320 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:51:34.539887 [debug] [MainThread]: Connection 'model.supercell.total_cost' was properly closed.
[0m23:51:34.540407 [info ] [MainThread]: 
[0m23:51:34.540931 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.22 seconds (0.22s).
[0m23:51:34.542014 [debug] [MainThread]: Command end result
[0m23:51:34.569736 [debug] [MainThread]: Wrote artifact WritableManifest to /home/harsha/data_actions/supercell_dbt/target/manifest.json
[0m23:51:34.572328 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/harsha/data_actions/supercell_dbt/target/semantic_manifest.json
[0m23:51:34.582323 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/harsha/data_actions/supercell_dbt/target/run_results.json
[0m23:51:34.583017 [info ] [MainThread]: 
[0m23:51:34.583707 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m23:51:34.584221 [info ] [MainThread]: 
[0m23:51:34.584878 [error] [MainThread]:   Runtime Error in model total_cost (models/supercell_models/metrics/total_cost.sql)
  Binder Error: No function matches the given name and argument types 'sum(VARCHAR)'. You might need to add explicit type casts.
  	Candidate functions:
  	sum(DECIMAL) -> DECIMAL
  	sum(BOOLEAN) -> HUGEINT
  	sum(SMALLINT) -> HUGEINT
  	sum(INTEGER) -> HUGEINT
  	sum(BIGINT) -> HUGEINT
  	sum(HUGEINT) -> HUGEINT
  	sum(DOUBLE) -> DOUBLE
  
  
  LINE 20:     SUM(pricing_model) as total_cost
               ^
[0m23:51:34.585375 [info ] [MainThread]: 
[0m23:51:34.585851 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m23:51:34.587106 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.258159, "process_in_blocks": "0", "process_kernel_time": 0.16986, "process_mem_max_rss": "147668", "process_out_blocks": "2704", "process_user_time": 2.725755}
[0m23:51:34.587828 [debug] [MainThread]: Command `dbt run` failed at 23:51:34.587683 after 1.26 seconds
[0m23:51:34.588313 [debug] [MainThread]: Flushing usage events


============================== 23:53:53.636111 | 9d9f0b42-db7c-4ef8-a4c3-7715281f86f5 ==============================
[0m23:53:53.636111 [info ] [MainThread]: Running with dbt=1.9.4
[0m23:53:53.641522 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/harsha/data_actions/supercell_dbt/logs', 'debug': 'False', 'profiles_dir': '/home/harsha/data_actions/supercell_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --select models/supercell_models/metrics/total_cost.sql', 'send_anonymous_usage_stats': 'False'}
[0m23:53:53.642222 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality

User config should be moved from the 'config' key in profiles.yml to the 'flags' key in dbt_project.yml.
[0m23:53:53.958538 [info ] [MainThread]: Registered adapter: duckdb=1.9.3
[0m23:53:54.051203 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m23:53:54.166588 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m23:53:54.167618 [debug] [MainThread]: Partial parsing: updated file: supercell://models/supercell_models/metrics/total_cost.sql
[0m23:53:54.550905 [debug] [MainThread]: Wrote artifact WritableManifest to /home/harsha/data_actions/supercell_dbt/target/manifest.json
[0m23:53:54.552910 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/harsha/data_actions/supercell_dbt/target/semantic_manifest.json
[0m23:53:54.566176 [info ] [MainThread]: Found 4 models, 4 data tests, 428 macros
[0m23:53:54.568987 [info ] [MainThread]: 
[0m23:53:54.569617 [info ] [MainThread]: Concurrency: 4 threads (target='default')
[0m23:53:54.570040 [info ] [MainThread]: 
[0m23:53:54.570656 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m23:53:54.572046 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_supercell'
[0m23:53:54.613021 [debug] [ThreadPool]: Using duckdb connection "list_supercell"
[0m23:53:54.613582 [debug] [ThreadPool]: On list_supercell: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "connection_name": "list_supercell"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"supercell"'
    
  
  
[0m23:53:54.613955 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:53:54.628021 [debug] [ThreadPool]: SQL status: OK in 0.014 seconds
[0m23:53:54.629787 [debug] [ThreadPool]: On list_supercell: Close
[0m23:53:54.630735 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_supercell, now create_supercell_main)
[0m23:53:54.631324 [debug] [ThreadPool]: Creating schema "database: "supercell"
schema: "main"
"
[0m23:53:54.639163 [debug] [ThreadPool]: Using duckdb connection "create_supercell_main"
[0m23:53:54.639606 [debug] [ThreadPool]: On create_supercell_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "connection_name": "create_supercell_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='supercell'
        and type='sqlite'
    
  
[0m23:53:54.639948 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:53:54.641107 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m23:53:54.642679 [debug] [ThreadPool]: Using duckdb connection "create_supercell_main"
[0m23:53:54.643081 [debug] [ThreadPool]: On create_supercell_main: BEGIN
[0m23:53:54.643689 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m23:53:54.644022 [debug] [ThreadPool]: Using duckdb connection "create_supercell_main"
[0m23:53:54.644332 [debug] [ThreadPool]: On create_supercell_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "connection_name": "create_supercell_main"} */

    
    
        create schema if not exists "supercell"."main"
    
[0m23:53:54.644925 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m23:53:54.645925 [debug] [ThreadPool]: On create_supercell_main: COMMIT
[0m23:53:54.646339 [debug] [ThreadPool]: Using duckdb connection "create_supercell_main"
[0m23:53:54.646686 [debug] [ThreadPool]: On create_supercell_main: COMMIT
[0m23:53:54.647191 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m23:53:54.647564 [debug] [ThreadPool]: On create_supercell_main: Close
[0m23:53:54.654396 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_supercell_main, now list_supercell_main)
[0m23:53:54.663707 [debug] [ThreadPool]: Using duckdb connection "list_supercell_main"
[0m23:53:54.664344 [debug] [ThreadPool]: On list_supercell_main: BEGIN
[0m23:53:54.664929 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:53:54.666151 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m23:53:54.666785 [debug] [ThreadPool]: Using duckdb connection "list_supercell_main"
[0m23:53:54.667384 [debug] [ThreadPool]: On list_supercell_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "connection_name": "list_supercell_main"} */
select
      'supercell' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'supercell'
  
[0m23:53:54.688177 [debug] [ThreadPool]: SQL status: OK in 0.020 seconds
[0m23:53:54.689919 [debug] [ThreadPool]: On list_supercell_main: ROLLBACK
[0m23:53:54.691232 [debug] [ThreadPool]: Failed to rollback 'list_supercell_main'
[0m23:53:54.691673 [debug] [ThreadPool]: On list_supercell_main: Close
[0m23:53:54.693140 [debug] [MainThread]: Using duckdb connection "master"
[0m23:53:54.693587 [debug] [MainThread]: On master: BEGIN
[0m23:53:54.693953 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:53:54.694715 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m23:53:54.695089 [debug] [MainThread]: On master: COMMIT
[0m23:53:54.695513 [debug] [MainThread]: Using duckdb connection "master"
[0m23:53:54.695826 [debug] [MainThread]: On master: COMMIT
[0m23:53:54.696318 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m23:53:54.696696 [debug] [MainThread]: On master: Close
[0m23:53:54.700931 [debug] [Thread-1 (]: Began running node model.supercell.total_cost
[0m23:53:54.701930 [info ] [Thread-1 (]: 1 of 1 START sql table model main.total_cost ................................... [RUN]
[0m23:53:54.702562 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_supercell_main, now model.supercell.total_cost)
[0m23:53:54.702997 [debug] [Thread-1 (]: Began compiling node model.supercell.total_cost
[0m23:53:54.714065 [debug] [Thread-1 (]: Writing injected SQL for node "model.supercell.total_cost"
[0m23:53:54.715416 [debug] [Thread-1 (]: Began executing node model.supercell.total_cost
[0m23:53:54.760080 [debug] [Thread-1 (]: Writing runtime sql for node "model.supercell.total_cost"
[0m23:53:54.760943 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.total_cost"
[0m23:53:54.761393 [debug] [Thread-1 (]: On model.supercell.total_cost: BEGIN
[0m23:53:54.761755 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:53:54.762791 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m23:53:54.763200 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.total_cost"
[0m23:53:54.763650 [debug] [Thread-1 (]: On model.supercell.total_cost: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.total_cost"} */

  
    
    

    create  table
      "supercell"."main"."total_cost__dbt_tmp"
  
    as (
      


select 
    region,
    instance_type,
    pricing_model,
    service_code,
    tag_keys as tag_types,
    SUM(amortized_cost) as total_cost
from "supercell"."main"."cleaned_usagelogs"
group by region, instance_type, pricing_model, service_code, tag_keys
    );
  
  
[0m23:53:54.778902 [debug] [Thread-1 (]: SQL status: OK in 0.015 seconds
[0m23:53:54.788065 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.total_cost"
[0m23:53:54.788614 [debug] [Thread-1 (]: On model.supercell.total_cost: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.total_cost"} */
alter table "supercell"."main"."total_cost__dbt_tmp" rename to "total_cost"
[0m23:53:54.789616 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m23:53:54.805790 [debug] [Thread-1 (]: On model.supercell.total_cost: COMMIT
[0m23:53:54.806352 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.total_cost"
[0m23:53:54.806766 [debug] [Thread-1 (]: On model.supercell.total_cost: COMMIT
[0m23:53:54.809991 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m23:53:54.815797 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.total_cost"
[0m23:53:54.816335 [debug] [Thread-1 (]: On model.supercell.total_cost: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.total_cost"} */
drop table if exists "supercell"."main"."total_cost__dbt_backup" cascade
[0m23:53:54.817166 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m23:53:54.820087 [debug] [Thread-1 (]: On model.supercell.total_cost: Close
[0m23:53:54.823133 [info ] [Thread-1 (]: 1 of 1 OK created sql table model main.total_cost .............................. [[32mOK[0m in 0.12s]
[0m23:53:54.823856 [debug] [Thread-1 (]: Finished running node model.supercell.total_cost
[0m23:53:54.826309 [debug] [MainThread]: Using duckdb connection "master"
[0m23:53:54.826838 [debug] [MainThread]: On master: BEGIN
[0m23:53:54.827188 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:53:54.828052 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m23:53:54.828469 [debug] [MainThread]: On master: COMMIT
[0m23:53:54.828792 [debug] [MainThread]: Using duckdb connection "master"
[0m23:53:54.829086 [debug] [MainThread]: On master: COMMIT
[0m23:53:54.829845 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m23:53:54.830490 [debug] [MainThread]: On master: Close
[0m23:53:54.831497 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:53:54.831915 [debug] [MainThread]: Connection 'model.supercell.total_cost' was properly closed.
[0m23:53:54.832315 [info ] [MainThread]: 
[0m23:53:54.832790 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.26 seconds (0.26s).
[0m23:53:54.833646 [debug] [MainThread]: Command end result
[0m23:53:54.862601 [debug] [MainThread]: Wrote artifact WritableManifest to /home/harsha/data_actions/supercell_dbt/target/manifest.json
[0m23:53:54.866176 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/harsha/data_actions/supercell_dbt/target/semantic_manifest.json
[0m23:53:54.876938 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/harsha/data_actions/supercell_dbt/target/run_results.json
[0m23:53:54.877578 [info ] [MainThread]: 
[0m23:53:54.878197 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:53:54.878674 [info ] [MainThread]: 
[0m23:53:54.879134 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m23:53:54.880651 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.3071297, "process_in_blocks": "448", "process_kernel_time": 0.196852, "process_mem_max_rss": "151696", "process_out_blocks": "2712", "process_user_time": 2.883488}
[0m23:53:54.881418 [debug] [MainThread]: Command `dbt run` succeeded at 23:53:54.881247 after 1.31 seconds
[0m23:53:54.881956 [debug] [MainThread]: Flushing usage events


============================== 00:03:01.114683 | ac07144f-0cfe-4338-b3fa-8dbb5e720b30 ==============================
[0m00:03:01.114683 [info ] [MainThread]: Running with dbt=1.9.4
[0m00:03:01.119830 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/home/harsha/data_actions/supercell_dbt', 'log_path': '/home/harsha/data_actions/supercell_dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select models/supercell_models/metrics/total_cost.sql', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'False'}
[0m00:03:01.120509 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality

User config should be moved from the 'config' key in profiles.yml to the 'flags' key in dbt_project.yml.
[0m00:03:01.456166 [info ] [MainThread]: Registered adapter: duckdb=1.9.3
[0m00:03:01.532798 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m00:03:01.641250 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m00:03:01.642003 [debug] [MainThread]: Partial parsing: updated file: supercell://models/supercell_models/metrics/total_cost.sql
[0m00:03:02.015761 [debug] [MainThread]: Wrote artifact WritableManifest to /home/harsha/data_actions/supercell_dbt/target/manifest.json
[0m00:03:02.017606 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/harsha/data_actions/supercell_dbt/target/semantic_manifest.json
[0m00:03:02.030989 [info ] [MainThread]: Found 4 models, 4 data tests, 428 macros
[0m00:03:02.033963 [info ] [MainThread]: 
[0m00:03:02.034565 [info ] [MainThread]: Concurrency: 4 threads (target='default')
[0m00:03:02.034923 [info ] [MainThread]: 
[0m00:03:02.035495 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m00:03:02.036920 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_supercell'
[0m00:03:02.085155 [debug] [ThreadPool]: Using duckdb connection "list_supercell"
[0m00:03:02.085731 [debug] [ThreadPool]: On list_supercell: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "connection_name": "list_supercell"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"supercell"'
    
  
  
[0m00:03:02.086099 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:03:02.100480 [debug] [ThreadPool]: SQL status: OK in 0.014 seconds
[0m00:03:02.102178 [debug] [ThreadPool]: On list_supercell: Close
[0m00:03:02.103298 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_supercell, now create_supercell_main)
[0m00:03:02.103917 [debug] [ThreadPool]: Creating schema "database: "supercell"
schema: "main"
"
[0m00:03:02.111685 [debug] [ThreadPool]: Using duckdb connection "create_supercell_main"
[0m00:03:02.112157 [debug] [ThreadPool]: On create_supercell_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "connection_name": "create_supercell_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='supercell'
        and type='sqlite'
    
  
[0m00:03:02.112522 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:03:02.113781 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m00:03:02.115324 [debug] [ThreadPool]: Using duckdb connection "create_supercell_main"
[0m00:03:02.115747 [debug] [ThreadPool]: On create_supercell_main: BEGIN
[0m00:03:02.116314 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m00:03:02.116688 [debug] [ThreadPool]: Using duckdb connection "create_supercell_main"
[0m00:03:02.117003 [debug] [ThreadPool]: On create_supercell_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "connection_name": "create_supercell_main"} */

    
    
        create schema if not exists "supercell"."main"
    
[0m00:03:02.117574 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m00:03:02.118593 [debug] [ThreadPool]: On create_supercell_main: COMMIT
[0m00:03:02.118999 [debug] [ThreadPool]: Using duckdb connection "create_supercell_main"
[0m00:03:02.119339 [debug] [ThreadPool]: On create_supercell_main: COMMIT
[0m00:03:02.119830 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m00:03:02.120178 [debug] [ThreadPool]: On create_supercell_main: Close
[0m00:03:02.128649 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_supercell_main, now list_supercell_main)
[0m00:03:02.137599 [debug] [ThreadPool]: Using duckdb connection "list_supercell_main"
[0m00:03:02.138137 [debug] [ThreadPool]: On list_supercell_main: BEGIN
[0m00:03:02.138542 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:03:02.139658 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m00:03:02.140088 [debug] [ThreadPool]: Using duckdb connection "list_supercell_main"
[0m00:03:02.140484 [debug] [ThreadPool]: On list_supercell_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "connection_name": "list_supercell_main"} */
select
      'supercell' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'supercell'
  
[0m00:03:02.159642 [debug] [ThreadPool]: SQL status: OK in 0.019 seconds
[0m00:03:02.161640 [debug] [ThreadPool]: On list_supercell_main: ROLLBACK
[0m00:03:02.163105 [debug] [ThreadPool]: Failed to rollback 'list_supercell_main'
[0m00:03:02.163588 [debug] [ThreadPool]: On list_supercell_main: Close
[0m00:03:02.165599 [debug] [MainThread]: Using duckdb connection "master"
[0m00:03:02.166081 [debug] [MainThread]: On master: BEGIN
[0m00:03:02.166471 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:03:02.167225 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m00:03:02.167638 [debug] [MainThread]: On master: COMMIT
[0m00:03:02.167991 [debug] [MainThread]: Using duckdb connection "master"
[0m00:03:02.168341 [debug] [MainThread]: On master: COMMIT
[0m00:03:02.168967 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m00:03:02.169456 [debug] [MainThread]: On master: Close
[0m00:03:02.173762 [debug] [Thread-1 (]: Began running node model.supercell.total_cost
[0m00:03:02.174861 [info ] [Thread-1 (]: 1 of 1 START sql table model main.total_cost ................................... [RUN]
[0m00:03:02.175795 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_supercell_main, now model.supercell.total_cost)
[0m00:03:02.176552 [debug] [Thread-1 (]: Began compiling node model.supercell.total_cost
[0m00:03:02.191003 [debug] [Thread-1 (]: Writing injected SQL for node "model.supercell.total_cost"
[0m00:03:02.192260 [debug] [Thread-1 (]: Began executing node model.supercell.total_cost
[0m00:03:02.235507 [debug] [Thread-1 (]: Writing runtime sql for node "model.supercell.total_cost"
[0m00:03:02.236378 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.total_cost"
[0m00:03:02.236833 [debug] [Thread-1 (]: On model.supercell.total_cost: BEGIN
[0m00:03:02.237205 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:03:02.238203 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:03:02.238673 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.total_cost"
[0m00:03:02.239060 [debug] [Thread-1 (]: On model.supercell.total_cost: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.total_cost"} */

  
    
    

    create  table
      "supercell"."main"."total_cost__dbt_tmp"
  
    as (
      


select 
    region,
    instance_type,
    pricing_model,
    service_code,
    tag_keys as tag_values,
    SUM(amortized_cost) as total_cost
from "supercell"."main"."cleaned_usagelogs"
group by region, instance_type, pricing_model, service_code, tag_keys
    );
  
  
[0m00:03:02.255183 [debug] [Thread-1 (]: SQL status: OK in 0.016 seconds
[0m00:03:02.264151 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.total_cost"
[0m00:03:02.264711 [debug] [Thread-1 (]: On model.supercell.total_cost: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.total_cost"} */
alter table "supercell"."main"."total_cost" rename to "total_cost__dbt_backup"
[0m00:03:02.265716 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:03:02.268809 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.total_cost"
[0m00:03:02.269252 [debug] [Thread-1 (]: On model.supercell.total_cost: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.total_cost"} */
alter table "supercell"."main"."total_cost__dbt_tmp" rename to "total_cost"
[0m00:03:02.270049 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:03:02.288500 [debug] [Thread-1 (]: On model.supercell.total_cost: COMMIT
[0m00:03:02.289049 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.total_cost"
[0m00:03:02.289454 [debug] [Thread-1 (]: On model.supercell.total_cost: COMMIT
[0m00:03:02.292066 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m00:03:02.297971 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.total_cost"
[0m00:03:02.298467 [debug] [Thread-1 (]: On model.supercell.total_cost: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.total_cost"} */
drop table if exists "supercell"."main"."total_cost__dbt_backup" cascade
[0m00:03:02.300752 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m00:03:02.303666 [debug] [Thread-1 (]: On model.supercell.total_cost: Close
[0m00:03:02.306474 [info ] [Thread-1 (]: 1 of 1 OK created sql table model main.total_cost .............................. [[32mOK[0m in 0.13s]
[0m00:03:02.307188 [debug] [Thread-1 (]: Finished running node model.supercell.total_cost
[0m00:03:02.309775 [debug] [MainThread]: Using duckdb connection "master"
[0m00:03:02.310626 [debug] [MainThread]: On master: BEGIN
[0m00:03:02.311033 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:03:02.312069 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m00:03:02.312593 [debug] [MainThread]: On master: COMMIT
[0m00:03:02.312965 [debug] [MainThread]: Using duckdb connection "master"
[0m00:03:02.313297 [debug] [MainThread]: On master: COMMIT
[0m00:03:02.313884 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m00:03:02.314256 [debug] [MainThread]: On master: Close
[0m00:03:02.314934 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:03:02.315339 [debug] [MainThread]: Connection 'model.supercell.total_cost' was properly closed.
[0m00:03:02.315769 [info ] [MainThread]: 
[0m00:03:02.316208 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.28 seconds (0.28s).
[0m00:03:02.316984 [debug] [MainThread]: Command end result
[0m00:03:02.336356 [debug] [MainThread]: Wrote artifact WritableManifest to /home/harsha/data_actions/supercell_dbt/target/manifest.json
[0m00:03:02.338263 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/harsha/data_actions/supercell_dbt/target/semantic_manifest.json
[0m00:03:02.345055 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/harsha/data_actions/supercell_dbt/target/run_results.json
[0m00:03:02.345504 [info ] [MainThread]: 
[0m00:03:02.345970 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:03:02.346343 [info ] [MainThread]: 
[0m00:03:02.346717 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m00:03:02.347810 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.2960008, "process_in_blocks": "0", "process_kernel_time": 0.173877, "process_mem_max_rss": "149496", "process_out_blocks": "2720", "process_user_time": 2.811019}
[0m00:03:02.348390 [debug] [MainThread]: Command `dbt run` succeeded at 00:03:02.348259 after 1.30 seconds
[0m00:03:02.348784 [debug] [MainThread]: Flushing usage events


============================== 00:05:25.617906 | 6796d528-a0e6-4aed-84f4-b871e0d566c6 ==============================
[0m00:05:25.617906 [info ] [MainThread]: Running with dbt=1.9.4
[0m00:05:25.624468 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/harsha/data_actions/supercell_dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/harsha/data_actions/supercell_dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run --select models/example/supercell_logsfacts.sql', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'False'}
[0m00:05:25.625224 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality

User config should be moved from the 'config' key in profiles.yml to the 'flags' key in dbt_project.yml.
[0m00:05:25.952725 [info ] [MainThread]: Registered adapter: duckdb=1.9.3
[0m00:05:26.023915 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m00:05:26.134832 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m00:05:26.135572 [debug] [MainThread]: Partial parsing: updated file: supercell://models/supercell_models/metrics/total_cost.sql
[0m00:05:26.510725 [debug] [MainThread]: Wrote artifact WritableManifest to /home/harsha/data_actions/supercell_dbt/target/manifest.json
[0m00:05:26.512612 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/harsha/data_actions/supercell_dbt/target/semantic_manifest.json
[0m00:05:26.525800 [info ] [MainThread]: Found 4 models, 4 data tests, 428 macros
[0m00:05:26.527358 [warn ] [MainThread]: The selection criterion 'models/example/supercell_logsfacts.sql' does not match any enabled nodes
[0m00:05:26.528882 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m00:05:26.529618 [debug] [MainThread]: Command end result
[0m00:05:26.549251 [debug] [MainThread]: Wrote artifact WritableManifest to /home/harsha/data_actions/supercell_dbt/target/manifest.json
[0m00:05:26.551104 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/harsha/data_actions/supercell_dbt/target/semantic_manifest.json
[0m00:05:26.554666 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/harsha/data_actions/supercell_dbt/target/run_results.json
[0m00:05:26.555860 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.0021532, "process_in_blocks": "0", "process_kernel_time": 0.178628, "process_mem_max_rss": "123116", "process_out_blocks": "2672", "process_user_time": 2.474855}
[0m00:05:26.556443 [debug] [MainThread]: Command `dbt run` succeeded at 00:05:26.556317 after 1.00 seconds
[0m00:05:26.556840 [debug] [MainThread]: Flushing usage events


============================== 00:06:32.892428 | 862a689a-4bf6-4ade-bb1b-9304d4124c6b ==============================
[0m00:06:32.892428 [info ] [MainThread]: Running with dbt=1.9.4
[0m00:06:32.896362 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/harsha/data_actions/supercell_dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/home/harsha/data_actions/supercell_dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --select models/supercell_models/metrics/total_cost.sql', 'send_anonymous_usage_stats': 'False'}
[0m00:06:32.896805 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality

User config should be moved from the 'config' key in profiles.yml to the 'flags' key in dbt_project.yml.
[0m00:06:33.215547 [info ] [MainThread]: Registered adapter: duckdb=1.9.3
[0m00:06:33.289957 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m00:06:33.401018 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:06:33.401588 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:06:33.517412 [debug] [MainThread]: Wrote artifact WritableManifest to /home/harsha/data_actions/supercell_dbt/target/manifest.json
[0m00:06:33.519182 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/harsha/data_actions/supercell_dbt/target/semantic_manifest.json
[0m00:06:33.532466 [info ] [MainThread]: Found 4 models, 4 data tests, 428 macros
[0m00:06:33.535236 [info ] [MainThread]: 
[0m00:06:33.535805 [info ] [MainThread]: Concurrency: 4 threads (target='default')
[0m00:06:33.536169 [info ] [MainThread]: 
[0m00:06:33.536762 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m00:06:33.538024 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_supercell'
[0m00:06:33.580357 [debug] [ThreadPool]: Using duckdb connection "list_supercell"
[0m00:06:33.580912 [debug] [ThreadPool]: On list_supercell: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "connection_name": "list_supercell"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"supercell"'
    
  
  
[0m00:06:33.581289 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:06:33.595973 [debug] [ThreadPool]: SQL status: OK in 0.015 seconds
[0m00:06:33.597726 [debug] [ThreadPool]: On list_supercell: Close
[0m00:06:33.598685 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_supercell, now create_supercell_main)
[0m00:06:33.599275 [debug] [ThreadPool]: Creating schema "database: "supercell"
schema: "main"
"
[0m00:06:33.607092 [debug] [ThreadPool]: Using duckdb connection "create_supercell_main"
[0m00:06:33.607540 [debug] [ThreadPool]: On create_supercell_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "connection_name": "create_supercell_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='supercell'
        and type='sqlite'
    
  
[0m00:06:33.607878 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:06:33.609045 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m00:06:33.610548 [debug] [ThreadPool]: Using duckdb connection "create_supercell_main"
[0m00:06:33.610923 [debug] [ThreadPool]: On create_supercell_main: BEGIN
[0m00:06:33.611502 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m00:06:33.611875 [debug] [ThreadPool]: Using duckdb connection "create_supercell_main"
[0m00:06:33.612187 [debug] [ThreadPool]: On create_supercell_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "connection_name": "create_supercell_main"} */

    
    
        create schema if not exists "supercell"."main"
    
[0m00:06:33.612790 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m00:06:33.613791 [debug] [ThreadPool]: On create_supercell_main: COMMIT
[0m00:06:33.614190 [debug] [ThreadPool]: Using duckdb connection "create_supercell_main"
[0m00:06:33.614547 [debug] [ThreadPool]: On create_supercell_main: COMMIT
[0m00:06:33.615048 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m00:06:33.615437 [debug] [ThreadPool]: On create_supercell_main: Close
[0m00:06:33.621915 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_supercell_main, now list_supercell_main)
[0m00:06:33.632345 [debug] [ThreadPool]: Using duckdb connection "list_supercell_main"
[0m00:06:33.632857 [debug] [ThreadPool]: On list_supercell_main: BEGIN
[0m00:06:33.633185 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:06:33.634101 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m00:06:33.634537 [debug] [ThreadPool]: Using duckdb connection "list_supercell_main"
[0m00:06:33.634859 [debug] [ThreadPool]: On list_supercell_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "connection_name": "list_supercell_main"} */
select
      'supercell' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'supercell'
  
[0m00:06:33.656515 [debug] [ThreadPool]: SQL status: OK in 0.021 seconds
[0m00:06:33.659830 [debug] [ThreadPool]: On list_supercell_main: ROLLBACK
[0m00:06:33.661132 [debug] [ThreadPool]: Failed to rollback 'list_supercell_main'
[0m00:06:33.661555 [debug] [ThreadPool]: On list_supercell_main: Close
[0m00:06:33.663120 [debug] [MainThread]: Using duckdb connection "master"
[0m00:06:33.663573 [debug] [MainThread]: On master: BEGIN
[0m00:06:33.663901 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:06:33.664661 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m00:06:33.665034 [debug] [MainThread]: On master: COMMIT
[0m00:06:33.665382 [debug] [MainThread]: Using duckdb connection "master"
[0m00:06:33.665688 [debug] [MainThread]: On master: COMMIT
[0m00:06:33.666175 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m00:06:33.666533 [debug] [MainThread]: On master: Close
[0m00:06:33.670663 [debug] [Thread-1 (]: Began running node model.supercell.total_cost
[0m00:06:33.671406 [info ] [Thread-1 (]: 1 of 1 START sql table model main.total_cost ................................... [RUN]
[0m00:06:33.671984 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_supercell_main, now model.supercell.total_cost)
[0m00:06:33.672399 [debug] [Thread-1 (]: Began compiling node model.supercell.total_cost
[0m00:06:33.685421 [debug] [Thread-1 (]: Writing injected SQL for node "model.supercell.total_cost"
[0m00:06:33.686618 [debug] [Thread-1 (]: Began executing node model.supercell.total_cost
[0m00:06:33.726681 [debug] [Thread-1 (]: Writing runtime sql for node "model.supercell.total_cost"
[0m00:06:33.727694 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.total_cost"
[0m00:06:33.728203 [debug] [Thread-1 (]: On model.supercell.total_cost: BEGIN
[0m00:06:33.728609 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:06:33.729728 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:06:33.730175 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.total_cost"
[0m00:06:33.730582 [debug] [Thread-1 (]: On model.supercell.total_cost: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.total_cost"} */

  
    
    

    create  table
      "supercell"."main"."total_cost__dbt_tmp"
  
    as (
      


select 
    region,
    instance_type,
    pricing_model,
    service_code,
    tag_values as tag_values,
    SUM(amortized_cost) as total_cost
from "supercell"."main"."cleaned_usagelogs"
group by region, instance_type, pricing_model, service_code, tag_keys
    );
  
  
[0m00:06:33.731742 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.total_cost"} */

  
    
    

    create  table
      "supercell"."main"."total_cost__dbt_tmp"
  
    as (
      


select 
    region,
    instance_type,
    pricing_model,
    service_code,
    tag_values as tag_values,
    SUM(amortized_cost) as total_cost
from "supercell"."main"."cleaned_usagelogs"
group by region, instance_type, pricing_model, service_code, tag_keys
    );
  
  
[0m00:06:33.732216 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m00:06:33.732775 [debug] [Thread-1 (]: On model.supercell.total_cost: ROLLBACK
[0m00:06:33.736850 [debug] [Thread-1 (]: Failed to rollback 'model.supercell.total_cost'
[0m00:06:33.737355 [debug] [Thread-1 (]: On model.supercell.total_cost: Close
[0m00:06:33.740183 [debug] [Thread-1 (]: Runtime Error in model total_cost (models/supercell_models/metrics/total_cost.sql)
  Binder Error: column "tag_values" must appear in the GROUP BY clause or must be part of an aggregate function.
  Either add it to the GROUP BY list, or use "ANY_VALUE(tag_values)" if the exact value of "tag_values" is not important.
  
  LINE 19:     tag_values as tag_values,
               ^
[0m00:06:33.742507 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model main.total_cost .......................... [[31mERROR[0m in 0.07s]
[0m00:06:33.743231 [debug] [Thread-1 (]: Finished running node model.supercell.total_cost
[0m00:06:33.744267 [debug] [Thread-7 (]: Marking all children of 'model.supercell.total_cost' to be skipped because of status 'error'.  Reason: Runtime Error in model total_cost (models/supercell_models/metrics/total_cost.sql)
  Binder Error: column "tag_values" must appear in the GROUP BY clause or must be part of an aggregate function.
  Either add it to the GROUP BY list, or use "ANY_VALUE(tag_values)" if the exact value of "tag_values" is not important.
  
  LINE 19:     tag_values as tag_values,
               ^.
[0m00:06:33.748553 [debug] [MainThread]: Using duckdb connection "master"
[0m00:06:33.749580 [debug] [MainThread]: On master: BEGIN
[0m00:06:33.750407 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:06:33.752088 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m00:06:33.753045 [debug] [MainThread]: On master: COMMIT
[0m00:06:33.753806 [debug] [MainThread]: Using duckdb connection "master"
[0m00:06:33.754422 [debug] [MainThread]: On master: COMMIT
[0m00:06:33.755707 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m00:06:33.756754 [debug] [MainThread]: On master: Close
[0m00:06:33.757606 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:06:33.758005 [debug] [MainThread]: Connection 'model.supercell.total_cost' was properly closed.
[0m00:06:33.758419 [info ] [MainThread]: 
[0m00:06:33.758816 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.22 seconds (0.22s).
[0m00:06:33.759586 [debug] [MainThread]: Command end result
[0m00:06:33.779368 [debug] [MainThread]: Wrote artifact WritableManifest to /home/harsha/data_actions/supercell_dbt/target/manifest.json
[0m00:06:33.782147 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/harsha/data_actions/supercell_dbt/target/semantic_manifest.json
[0m00:06:33.789405 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/harsha/data_actions/supercell_dbt/target/run_results.json
[0m00:06:33.789851 [info ] [MainThread]: 
[0m00:06:33.790310 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m00:06:33.790678 [info ] [MainThread]: 
[0m00:06:33.791085 [error] [MainThread]:   Runtime Error in model total_cost (models/supercell_models/metrics/total_cost.sql)
  Binder Error: column "tag_values" must appear in the GROUP BY clause or must be part of an aggregate function.
  Either add it to the GROUP BY list, or use "ANY_VALUE(tag_values)" if the exact value of "tag_values" is not important.
  
  LINE 19:     tag_values as tag_values,
               ^
[0m00:06:33.791451 [info ] [MainThread]: 
[0m00:06:33.791808 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m00:06:33.792788 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.9636515, "process_in_blocks": "0", "process_kernel_time": 0.169569, "process_mem_max_rss": "143696", "process_out_blocks": "1832", "process_user_time": 2.450777}
[0m00:06:33.793362 [debug] [MainThread]: Command `dbt run` failed at 00:06:33.793231 after 0.96 seconds
[0m00:06:33.793761 [debug] [MainThread]: Flushing usage events


============================== 00:07:03.320050 | f9ba73ae-9bdc-42b0-bde0-8e5fbc107fb8 ==============================
[0m00:07:03.320050 [info ] [MainThread]: Running with dbt=1.9.4
[0m00:07:03.325955 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/harsha/data_actions/supercell_dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/harsha/data_actions/supercell_dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run --select models/supercell_models/metrics/total_cost.sql', 'send_anonymous_usage_stats': 'False'}
[0m00:07:03.326758 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality

User config should be moved from the 'config' key in profiles.yml to the 'flags' key in dbt_project.yml.
[0m00:07:03.639673 [info ] [MainThread]: Registered adapter: duckdb=1.9.3
[0m00:07:03.711132 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m00:07:03.820146 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m00:07:03.820947 [debug] [MainThread]: Partial parsing: updated file: supercell://models/supercell_models/metrics/total_cost.sql
[0m00:07:04.204053 [debug] [MainThread]: Wrote artifact WritableManifest to /home/harsha/data_actions/supercell_dbt/target/manifest.json
[0m00:07:04.206047 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/harsha/data_actions/supercell_dbt/target/semantic_manifest.json
[0m00:07:04.219663 [info ] [MainThread]: Found 4 models, 4 data tests, 428 macros
[0m00:07:04.222585 [info ] [MainThread]: 
[0m00:07:04.223124 [info ] [MainThread]: Concurrency: 4 threads (target='default')
[0m00:07:04.223530 [info ] [MainThread]: 
[0m00:07:04.224100 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m00:07:04.225680 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_supercell'
[0m00:07:04.265334 [debug] [ThreadPool]: Using duckdb connection "list_supercell"
[0m00:07:04.265864 [debug] [ThreadPool]: On list_supercell: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "connection_name": "list_supercell"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"supercell"'
    
  
  
[0m00:07:04.266229 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:07:04.281405 [debug] [ThreadPool]: SQL status: OK in 0.015 seconds
[0m00:07:04.283104 [debug] [ThreadPool]: On list_supercell: Close
[0m00:07:04.284060 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_supercell, now create_supercell_main)
[0m00:07:04.284642 [debug] [ThreadPool]: Creating schema "database: "supercell"
schema: "main"
"
[0m00:07:04.292497 [debug] [ThreadPool]: Using duckdb connection "create_supercell_main"
[0m00:07:04.292931 [debug] [ThreadPool]: On create_supercell_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "connection_name": "create_supercell_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='supercell'
        and type='sqlite'
    
  
[0m00:07:04.293310 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:07:04.294547 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m00:07:04.296178 [debug] [ThreadPool]: Using duckdb connection "create_supercell_main"
[0m00:07:04.296584 [debug] [ThreadPool]: On create_supercell_main: BEGIN
[0m00:07:04.297134 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m00:07:04.297488 [debug] [ThreadPool]: Using duckdb connection "create_supercell_main"
[0m00:07:04.297785 [debug] [ThreadPool]: On create_supercell_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "connection_name": "create_supercell_main"} */

    
    
        create schema if not exists "supercell"."main"
    
[0m00:07:04.298335 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m00:07:04.299304 [debug] [ThreadPool]: On create_supercell_main: COMMIT
[0m00:07:04.299728 [debug] [ThreadPool]: Using duckdb connection "create_supercell_main"
[0m00:07:04.300062 [debug] [ThreadPool]: On create_supercell_main: COMMIT
[0m00:07:04.300668 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m00:07:04.301049 [debug] [ThreadPool]: On create_supercell_main: Close
[0m00:07:04.307912 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_supercell_main, now list_supercell_main)
[0m00:07:04.317228 [debug] [ThreadPool]: Using duckdb connection "list_supercell_main"
[0m00:07:04.317903 [debug] [ThreadPool]: On list_supercell_main: BEGIN
[0m00:07:04.318440 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:07:04.319686 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m00:07:04.320260 [debug] [ThreadPool]: Using duckdb connection "list_supercell_main"
[0m00:07:04.320810 [debug] [ThreadPool]: On list_supercell_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "connection_name": "list_supercell_main"} */
select
      'supercell' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'supercell'
  
[0m00:07:04.340924 [debug] [ThreadPool]: SQL status: OK in 0.020 seconds
[0m00:07:04.342642 [debug] [ThreadPool]: On list_supercell_main: ROLLBACK
[0m00:07:04.343963 [debug] [ThreadPool]: Failed to rollback 'list_supercell_main'
[0m00:07:04.344370 [debug] [ThreadPool]: On list_supercell_main: Close
[0m00:07:04.345838 [debug] [MainThread]: Using duckdb connection "master"
[0m00:07:04.346229 [debug] [MainThread]: On master: BEGIN
[0m00:07:04.346596 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:07:04.347328 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m00:07:04.347736 [debug] [MainThread]: On master: COMMIT
[0m00:07:04.348061 [debug] [MainThread]: Using duckdb connection "master"
[0m00:07:04.348381 [debug] [MainThread]: On master: COMMIT
[0m00:07:04.348899 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m00:07:04.349290 [debug] [MainThread]: On master: Close
[0m00:07:04.353230 [debug] [Thread-1 (]: Began running node model.supercell.total_cost
[0m00:07:04.354302 [info ] [Thread-1 (]: 1 of 1 START sql table model main.total_cost ................................... [RUN]
[0m00:07:04.355221 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_supercell_main, now model.supercell.total_cost)
[0m00:07:04.356124 [debug] [Thread-1 (]: Began compiling node model.supercell.total_cost
[0m00:07:04.371148 [debug] [Thread-1 (]: Writing injected SQL for node "model.supercell.total_cost"
[0m00:07:04.372320 [debug] [Thread-1 (]: Began executing node model.supercell.total_cost
[0m00:07:04.417460 [debug] [Thread-1 (]: Writing runtime sql for node "model.supercell.total_cost"
[0m00:07:04.418556 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.total_cost"
[0m00:07:04.419031 [debug] [Thread-1 (]: On model.supercell.total_cost: BEGIN
[0m00:07:04.419412 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:07:04.420408 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:07:04.420808 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.total_cost"
[0m00:07:04.421169 [debug] [Thread-1 (]: On model.supercell.total_cost: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.total_cost"} */

  
    
    

    create  table
      "supercell"."main"."total_cost__dbt_tmp"
  
    as (
      


select 
    region,
    instance_type,
    pricing_model,
    service_code,
    tag_values as tag_values,
    SUM(amortized_cost) as total_cost
from "supercell"."main"."cleaned_usagelogs"
group by region, instance_type, pricing_model, service_code, tag_values
    );
  
  
[0m00:07:04.433782 [debug] [Thread-1 (]: SQL status: OK in 0.012 seconds
[0m00:07:04.443961 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.total_cost"
[0m00:07:04.444639 [debug] [Thread-1 (]: On model.supercell.total_cost: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.total_cost"} */
alter table "supercell"."main"."total_cost" rename to "total_cost__dbt_backup"
[0m00:07:04.446001 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:07:04.450006 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.total_cost"
[0m00:07:04.450601 [debug] [Thread-1 (]: On model.supercell.total_cost: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.total_cost"} */
alter table "supercell"."main"."total_cost__dbt_tmp" rename to "total_cost"
[0m00:07:04.451626 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:07:04.474574 [debug] [Thread-1 (]: On model.supercell.total_cost: COMMIT
[0m00:07:04.475168 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.total_cost"
[0m00:07:04.475571 [debug] [Thread-1 (]: On model.supercell.total_cost: COMMIT
[0m00:07:04.479018 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m00:07:04.484848 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.total_cost"
[0m00:07:04.485334 [debug] [Thread-1 (]: On model.supercell.total_cost: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.total_cost"} */
drop table if exists "supercell"."main"."total_cost__dbt_backup" cascade
[0m00:07:04.488055 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m00:07:04.490946 [debug] [Thread-1 (]: On model.supercell.total_cost: Close
[0m00:07:04.493691 [info ] [Thread-1 (]: 1 of 1 OK created sql table model main.total_cost .............................. [[32mOK[0m in 0.14s]
[0m00:07:04.494401 [debug] [Thread-1 (]: Finished running node model.supercell.total_cost
[0m00:07:04.497222 [debug] [MainThread]: Using duckdb connection "master"
[0m00:07:04.497864 [debug] [MainThread]: On master: BEGIN
[0m00:07:04.498243 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:07:04.499129 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m00:07:04.499618 [debug] [MainThread]: On master: COMMIT
[0m00:07:04.500003 [debug] [MainThread]: Using duckdb connection "master"
[0m00:07:04.500354 [debug] [MainThread]: On master: COMMIT
[0m00:07:04.501033 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m00:07:04.501500 [debug] [MainThread]: On master: Close
[0m00:07:04.502088 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:07:04.502456 [debug] [MainThread]: Connection 'model.supercell.total_cost' was properly closed.
[0m00:07:04.502905 [info ] [MainThread]: 
[0m00:07:04.503387 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.28 seconds (0.28s).
[0m00:07:04.504245 [debug] [MainThread]: Command end result
[0m00:07:04.523166 [debug] [MainThread]: Wrote artifact WritableManifest to /home/harsha/data_actions/supercell_dbt/target/manifest.json
[0m00:07:04.525103 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/harsha/data_actions/supercell_dbt/target/semantic_manifest.json
[0m00:07:04.531814 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/harsha/data_actions/supercell_dbt/target/run_results.json
[0m00:07:04.532258 [info ] [MainThread]: 
[0m00:07:04.532759 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:07:04.533101 [info ] [MainThread]: 
[0m00:07:04.533501 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m00:07:04.534479 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.2780398, "process_in_blocks": "0", "process_kernel_time": 0.205678, "process_mem_max_rss": "149468", "process_out_blocks": "2720", "process_user_time": 2.829338}
[0m00:07:04.535065 [debug] [MainThread]: Command `dbt run` succeeded at 00:07:04.534945 after 1.28 seconds
[0m00:07:04.535463 [debug] [MainThread]: Flushing usage events


============================== 00:21:24.788908 | 8df11f1c-dbdd-463d-807b-76710ec6211c ==============================
[0m00:21:24.788908 [info ] [MainThread]: Running with dbt=1.9.4
[0m00:21:24.794215 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/harsha/data_actions/supercell_dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/home/harsha/data_actions/supercell_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select models/supercell_models/metrics/total_cost.sql', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'False'}
[0m00:21:24.794882 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality

User config should be moved from the 'config' key in profiles.yml to the 'flags' key in dbt_project.yml.
[0m00:21:25.139007 [info ] [MainThread]: Registered adapter: duckdb=1.9.3
[0m00:21:25.210613 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m00:21:25.320199 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:21:25.320722 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:21:25.437639 [debug] [MainThread]: Wrote artifact WritableManifest to /home/harsha/data_actions/supercell_dbt/target/manifest.json
[0m00:21:25.439481 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/harsha/data_actions/supercell_dbt/target/semantic_manifest.json
[0m00:21:25.453519 [info ] [MainThread]: Found 4 models, 4 data tests, 428 macros
[0m00:21:25.456307 [info ] [MainThread]: 
[0m00:21:25.456880 [info ] [MainThread]: Concurrency: 4 threads (target='default')
[0m00:21:25.457242 [info ] [MainThread]: 
[0m00:21:25.457818 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m00:21:25.459256 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_supercell'
[0m00:21:25.505069 [debug] [ThreadPool]: Using duckdb connection "list_supercell"
[0m00:21:25.505621 [debug] [ThreadPool]: On list_supercell: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "connection_name": "list_supercell"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"supercell"'
    
  
  
[0m00:21:25.505989 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:21:25.512023 [debug] [ThreadPool]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "connection_name": "list_supercell"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"supercell"'
    
  
  
[0m00:21:25.512527 [debug] [ThreadPool]: DuckDB adapter: Rolling back transaction.
[0m00:21:25.513497 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:21:25.513933 [debug] [MainThread]: Connection 'list_supercell' was properly closed.
[0m00:21:25.514311 [info ] [MainThread]: 
[0m00:21:25.514701 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.06 seconds (0.06s).
[0m00:21:25.515223 [error] [MainThread]: Encountered an error:
Runtime Error
  IO Error: Could not set lock on file "/home/harsha/data_actions/supercell_dbt/supercell.duckdb": Conflicting lock is held in /usr/bin/python3.12 (PID 2456683) by user harsha. See also https://duckdb.org/docs/connect/concurrency
[0m00:21:25.516336 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.7908463, "process_in_blocks": "0", "process_kernel_time": 0.167553, "process_mem_max_rss": "132884", "process_out_blocks": "920", "process_user_time": 2.295884}
[0m00:21:25.516960 [debug] [MainThread]: Command `dbt run` failed at 00:21:25.516834 after 0.79 seconds
[0m00:21:25.517372 [debug] [MainThread]: Flushing usage events


============================== 00:33:39.211567 | 99570587-983f-4aef-a797-24b3af6499b3 ==============================
[0m00:33:39.211567 [info ] [MainThread]: Running with dbt=1.9.4
[0m00:33:39.215642 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/harsha/data_actions/supercell_dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/home/harsha/data_actions/supercell_dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run --select models/supercell_models/metrics/total_cost.sql', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'False'}
[0m00:33:39.216133 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality

User config should be moved from the 'config' key in profiles.yml to the 'flags' key in dbt_project.yml.
[0m00:33:39.532181 [info ] [MainThread]: Registered adapter: duckdb=1.9.3
[0m00:33:39.603728 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m00:33:39.712915 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m00:33:39.713666 [debug] [MainThread]: Partial parsing: updated file: supercell://models/supercell_models/metrics/total_cost.sql
[0m00:33:40.126109 [debug] [MainThread]: Wrote artifact WritableManifest to /home/harsha/data_actions/supercell_dbt/target/manifest.json
[0m00:33:40.128114 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/harsha/data_actions/supercell_dbt/target/semantic_manifest.json
[0m00:33:40.142947 [info ] [MainThread]: Found 4 models, 4 data tests, 428 macros
[0m00:33:40.146600 [info ] [MainThread]: 
[0m00:33:40.147443 [info ] [MainThread]: Concurrency: 4 threads (target='default')
[0m00:33:40.147862 [info ] [MainThread]: 
[0m00:33:40.148621 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m00:33:40.150391 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_supercell'
[0m00:33:40.207116 [debug] [ThreadPool]: Using duckdb connection "list_supercell"
[0m00:33:40.207731 [debug] [ThreadPool]: On list_supercell: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "connection_name": "list_supercell"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"supercell"'
    
  
  
[0m00:33:40.208112 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:33:40.223737 [debug] [ThreadPool]: SQL status: OK in 0.015 seconds
[0m00:33:40.225556 [debug] [ThreadPool]: On list_supercell: Close
[0m00:33:40.226795 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_supercell, now create_supercell_main)
[0m00:33:40.227809 [debug] [ThreadPool]: Creating schema "database: "supercell"
schema: "main"
"
[0m00:33:40.237658 [debug] [ThreadPool]: Using duckdb connection "create_supercell_main"
[0m00:33:40.238212 [debug] [ThreadPool]: On create_supercell_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "connection_name": "create_supercell_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='supercell'
        and type='sqlite'
    
  
[0m00:33:40.238606 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:33:40.240035 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m00:33:40.241632 [debug] [ThreadPool]: Using duckdb connection "create_supercell_main"
[0m00:33:40.242029 [debug] [ThreadPool]: On create_supercell_main: BEGIN
[0m00:33:40.242601 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m00:33:40.242947 [debug] [ThreadPool]: Using duckdb connection "create_supercell_main"
[0m00:33:40.243256 [debug] [ThreadPool]: On create_supercell_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "connection_name": "create_supercell_main"} */

    
    
        create schema if not exists "supercell"."main"
    
[0m00:33:40.243865 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m00:33:40.244865 [debug] [ThreadPool]: On create_supercell_main: COMMIT
[0m00:33:40.245239 [debug] [ThreadPool]: Using duckdb connection "create_supercell_main"
[0m00:33:40.245563 [debug] [ThreadPool]: On create_supercell_main: COMMIT
[0m00:33:40.246051 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m00:33:40.246449 [debug] [ThreadPool]: On create_supercell_main: Close
[0m00:33:40.253118 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_supercell_main, now list_supercell_main)
[0m00:33:40.263102 [debug] [ThreadPool]: Using duckdb connection "list_supercell_main"
[0m00:33:40.263864 [debug] [ThreadPool]: On list_supercell_main: BEGIN
[0m00:33:40.264468 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:33:40.265824 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m00:33:40.266474 [debug] [ThreadPool]: Using duckdb connection "list_supercell_main"
[0m00:33:40.267078 [debug] [ThreadPool]: On list_supercell_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "connection_name": "list_supercell_main"} */
select
      'supercell' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'supercell'
  
[0m00:33:40.289388 [debug] [ThreadPool]: SQL status: OK in 0.022 seconds
[0m00:33:40.291217 [debug] [ThreadPool]: On list_supercell_main: ROLLBACK
[0m00:33:40.292527 [debug] [ThreadPool]: Failed to rollback 'list_supercell_main'
[0m00:33:40.292926 [debug] [ThreadPool]: On list_supercell_main: Close
[0m00:33:40.294757 [debug] [MainThread]: Using duckdb connection "master"
[0m00:33:40.295219 [debug] [MainThread]: On master: BEGIN
[0m00:33:40.295562 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:33:40.296355 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m00:33:40.296726 [debug] [MainThread]: On master: COMMIT
[0m00:33:40.297054 [debug] [MainThread]: Using duckdb connection "master"
[0m00:33:40.297368 [debug] [MainThread]: On master: COMMIT
[0m00:33:40.297873 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m00:33:40.298263 [debug] [MainThread]: On master: Close
[0m00:33:40.302169 [debug] [Thread-1 (]: Began running node model.supercell.total_cost
[0m00:33:40.303349 [info ] [Thread-1 (]: 1 of 1 START sql table model main.total_cost ................................... [RUN]
[0m00:33:40.304323 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_supercell_main, now model.supercell.total_cost)
[0m00:33:40.305183 [debug] [Thread-1 (]: Began compiling node model.supercell.total_cost
[0m00:33:40.320421 [debug] [Thread-1 (]: Writing injected SQL for node "model.supercell.total_cost"
[0m00:33:40.321536 [debug] [Thread-1 (]: Began executing node model.supercell.total_cost
[0m00:33:40.360612 [debug] [Thread-1 (]: Writing runtime sql for node "model.supercell.total_cost"
[0m00:33:40.361550 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.total_cost"
[0m00:33:40.362018 [debug] [Thread-1 (]: On model.supercell.total_cost: BEGIN
[0m00:33:40.362387 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:33:40.363405 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:33:40.363855 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.total_cost"
[0m00:33:40.364237 [debug] [Thread-1 (]: On model.supercell.total_cost: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.total_cost"} */

  
    
    

    create  table
      "supercell"."main"."total_cost__dbt_tmp"
  
    as (
      


select
    DATE_TRUNC('month', usage_end_date)  as month
    region,
    instance_type,
    pricing_model,
    service_code,
    tag_values as tag_values,
    SUM(amortized_cost) as total_cost
from "supercell"."main"."cleaned_usagelogs"
group by region, instance_type, pricing_model, service_code, tag_values,month
    );
  
  
[0m00:33:40.366985 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.total_cost"} */

  
    
    

    create  table
      "supercell"."main"."total_cost__dbt_tmp"
  
    as (
      


select
    DATE_TRUNC('month', usage_end_date)  as month
    region,
    instance_type,
    pricing_model,
    service_code,
    tag_values as tag_values,
    SUM(amortized_cost) as total_cost
from "supercell"."main"."cleaned_usagelogs"
group by region, instance_type, pricing_model, service_code, tag_values,month
    );
  
  
[0m00:33:40.367446 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m00:33:40.367951 [debug] [Thread-1 (]: On model.supercell.total_cost: ROLLBACK
[0m00:33:40.371945 [debug] [Thread-1 (]: Failed to rollback 'model.supercell.total_cost'
[0m00:33:40.372452 [debug] [Thread-1 (]: On model.supercell.total_cost: Close
[0m00:33:40.375272 [debug] [Thread-1 (]: Runtime Error in model total_cost (models/supercell_models/metrics/total_cost.sql)
  Parser Error: syntax error at or near "region"
[0m00:33:40.377546 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model main.total_cost .......................... [[31mERROR[0m in 0.07s]
[0m00:33:40.378294 [debug] [Thread-1 (]: Finished running node model.supercell.total_cost
[0m00:33:40.379380 [debug] [Thread-7 (]: Marking all children of 'model.supercell.total_cost' to be skipped because of status 'error'.  Reason: Runtime Error in model total_cost (models/supercell_models/metrics/total_cost.sql)
  Parser Error: syntax error at or near "region".
[0m00:33:40.383353 [debug] [MainThread]: Using duckdb connection "master"
[0m00:33:40.384001 [debug] [MainThread]: On master: BEGIN
[0m00:33:40.384435 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:33:40.385578 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m00:33:40.386241 [debug] [MainThread]: On master: COMMIT
[0m00:33:40.386667 [debug] [MainThread]: Using duckdb connection "master"
[0m00:33:40.387037 [debug] [MainThread]: On master: COMMIT
[0m00:33:40.388044 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m00:33:40.388588 [debug] [MainThread]: On master: Close
[0m00:33:40.389248 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:33:40.389639 [debug] [MainThread]: Connection 'model.supercell.total_cost' was properly closed.
[0m00:33:40.390019 [info ] [MainThread]: 
[0m00:33:40.390463 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.24 seconds (0.24s).
[0m00:33:40.391629 [debug] [MainThread]: Command end result
[0m00:33:40.413485 [debug] [MainThread]: Wrote artifact WritableManifest to /home/harsha/data_actions/supercell_dbt/target/manifest.json
[0m00:33:40.415802 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/harsha/data_actions/supercell_dbt/target/semantic_manifest.json
[0m00:33:40.423766 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/harsha/data_actions/supercell_dbt/target/run_results.json
[0m00:33:40.424273 [info ] [MainThread]: 
[0m00:33:40.424949 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m00:33:40.425439 [info ] [MainThread]: 
[0m00:33:40.425923 [error] [MainThread]:   Runtime Error in model total_cost (models/supercell_models/metrics/total_cost.sql)
  Parser Error: syntax error at or near "region"
[0m00:33:40.426314 [info ] [MainThread]: 
[0m00:33:40.426714 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m00:33:40.427831 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.2795529, "process_in_blocks": "1152", "process_kernel_time": 0.161091, "process_mem_max_rss": "147016", "process_out_blocks": "2704", "process_user_time": 2.809597}
[0m00:33:40.428566 [debug] [MainThread]: Command `dbt run` failed at 00:33:40.428387 after 1.28 seconds
[0m00:33:40.429020 [debug] [MainThread]: Flushing usage events


============================== 00:34:07.852130 | 1cc1b535-91a3-4b88-8c93-ba22e540c7c8 ==============================
[0m00:34:07.852130 [info ] [MainThread]: Running with dbt=1.9.4
[0m00:34:07.857363 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/harsha/data_actions/supercell_dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/home/harsha/data_actions/supercell_dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --select models/supercell_models/metrics/total_cost.sql', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'False'}
[0m00:34:07.858160 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality

User config should be moved from the 'config' key in profiles.yml to the 'flags' key in dbt_project.yml.
[0m00:34:08.181303 [info ] [MainThread]: Registered adapter: duckdb=1.9.3
[0m00:34:08.253850 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m00:34:08.363582 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m00:34:08.364352 [debug] [MainThread]: Partial parsing: updated file: supercell://models/supercell_models/metrics/total_cost.sql
[0m00:34:08.739917 [debug] [MainThread]: Wrote artifact WritableManifest to /home/harsha/data_actions/supercell_dbt/target/manifest.json
[0m00:34:08.741747 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/harsha/data_actions/supercell_dbt/target/semantic_manifest.json
[0m00:34:08.754992 [info ] [MainThread]: Found 4 models, 4 data tests, 428 macros
[0m00:34:08.757937 [info ] [MainThread]: 
[0m00:34:08.758519 [info ] [MainThread]: Concurrency: 4 threads (target='default')
[0m00:34:08.758899 [info ] [MainThread]: 
[0m00:34:08.759470 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m00:34:08.760631 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_supercell'
[0m00:34:08.800383 [debug] [ThreadPool]: Using duckdb connection "list_supercell"
[0m00:34:08.800929 [debug] [ThreadPool]: On list_supercell: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "connection_name": "list_supercell"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"supercell"'
    
  
  
[0m00:34:08.801321 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:34:08.815861 [debug] [ThreadPool]: SQL status: OK in 0.014 seconds
[0m00:34:08.817696 [debug] [ThreadPool]: On list_supercell: Close
[0m00:34:08.818861 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_supercell, now create_supercell_main)
[0m00:34:08.819547 [debug] [ThreadPool]: Creating schema "database: "supercell"
schema: "main"
"
[0m00:34:08.827321 [debug] [ThreadPool]: Using duckdb connection "create_supercell_main"
[0m00:34:08.827771 [debug] [ThreadPool]: On create_supercell_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "connection_name": "create_supercell_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='supercell'
        and type='sqlite'
    
  
[0m00:34:08.828101 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:34:08.829338 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m00:34:08.830850 [debug] [ThreadPool]: Using duckdb connection "create_supercell_main"
[0m00:34:08.831247 [debug] [ThreadPool]: On create_supercell_main: BEGIN
[0m00:34:08.831820 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m00:34:08.832176 [debug] [ThreadPool]: Using duckdb connection "create_supercell_main"
[0m00:34:08.832517 [debug] [ThreadPool]: On create_supercell_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "connection_name": "create_supercell_main"} */

    
    
        create schema if not exists "supercell"."main"
    
[0m00:34:08.833093 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m00:34:08.834083 [debug] [ThreadPool]: On create_supercell_main: COMMIT
[0m00:34:08.834554 [debug] [ThreadPool]: Using duckdb connection "create_supercell_main"
[0m00:34:08.834884 [debug] [ThreadPool]: On create_supercell_main: COMMIT
[0m00:34:08.835401 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m00:34:08.835797 [debug] [ThreadPool]: On create_supercell_main: Close
[0m00:34:08.842518 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_supercell_main, now list_supercell_main)
[0m00:34:08.851585 [debug] [ThreadPool]: Using duckdb connection "list_supercell_main"
[0m00:34:08.852061 [debug] [ThreadPool]: On list_supercell_main: BEGIN
[0m00:34:08.852415 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:34:08.853244 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m00:34:08.853675 [debug] [ThreadPool]: Using duckdb connection "list_supercell_main"
[0m00:34:08.853997 [debug] [ThreadPool]: On list_supercell_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "connection_name": "list_supercell_main"} */
select
      'supercell' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'supercell'
  
[0m00:34:08.870205 [debug] [ThreadPool]: SQL status: OK in 0.016 seconds
[0m00:34:08.871921 [debug] [ThreadPool]: On list_supercell_main: ROLLBACK
[0m00:34:08.873172 [debug] [ThreadPool]: Failed to rollback 'list_supercell_main'
[0m00:34:08.873568 [debug] [ThreadPool]: On list_supercell_main: Close
[0m00:34:08.875185 [debug] [MainThread]: Using duckdb connection "master"
[0m00:34:08.875584 [debug] [MainThread]: On master: BEGIN
[0m00:34:08.875899 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:34:08.876589 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m00:34:08.876988 [debug] [MainThread]: On master: COMMIT
[0m00:34:08.877337 [debug] [MainThread]: Using duckdb connection "master"
[0m00:34:08.877668 [debug] [MainThread]: On master: COMMIT
[0m00:34:08.878158 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m00:34:08.878519 [debug] [MainThread]: On master: Close
[0m00:34:08.881923 [debug] [Thread-1 (]: Began running node model.supercell.total_cost
[0m00:34:08.882977 [info ] [Thread-1 (]: 1 of 1 START sql table model main.total_cost ................................... [RUN]
[0m00:34:08.883912 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_supercell_main, now model.supercell.total_cost)
[0m00:34:08.884746 [debug] [Thread-1 (]: Began compiling node model.supercell.total_cost
[0m00:34:08.900966 [debug] [Thread-1 (]: Writing injected SQL for node "model.supercell.total_cost"
[0m00:34:08.902560 [debug] [Thread-1 (]: Began executing node model.supercell.total_cost
[0m00:34:08.948018 [debug] [Thread-1 (]: Writing runtime sql for node "model.supercell.total_cost"
[0m00:34:08.948906 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.total_cost"
[0m00:34:08.949393 [debug] [Thread-1 (]: On model.supercell.total_cost: BEGIN
[0m00:34:08.949786 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:34:08.951058 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:34:08.951555 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.total_cost"
[0m00:34:08.951963 [debug] [Thread-1 (]: On model.supercell.total_cost: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.total_cost"} */

  
    
    

    create  table
      "supercell"."main"."total_cost__dbt_tmp"
  
    as (
      


select
    DATE_TRUNC('month', usage_end_date)  as month,
    region,
    instance_type,
    pricing_model,
    service_code,
    tag_values as tag_values,
    SUM(amortized_cost) as total_cost
from "supercell"."main"."cleaned_usagelogs"
group by month,region, instance_type, pricing_model, service_code, tag_values
    );
  
  
[0m00:34:08.973986 [debug] [Thread-1 (]: SQL status: OK in 0.021 seconds
[0m00:34:08.982984 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.total_cost"
[0m00:34:08.983533 [debug] [Thread-1 (]: On model.supercell.total_cost: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.total_cost"} */
alter table "supercell"."main"."total_cost" rename to "total_cost__dbt_backup"
[0m00:34:08.984523 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:34:08.987686 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.total_cost"
[0m00:34:08.988121 [debug] [Thread-1 (]: On model.supercell.total_cost: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.total_cost"} */
alter table "supercell"."main"."total_cost__dbt_tmp" rename to "total_cost"
[0m00:34:08.988889 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:34:09.007617 [debug] [Thread-1 (]: On model.supercell.total_cost: COMMIT
[0m00:34:09.008188 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.total_cost"
[0m00:34:09.008592 [debug] [Thread-1 (]: On model.supercell.total_cost: COMMIT
[0m00:34:09.013183 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m00:34:09.018857 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.total_cost"
[0m00:34:09.019356 [debug] [Thread-1 (]: On model.supercell.total_cost: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.total_cost"} */
drop table if exists "supercell"."main"."total_cost__dbt_backup" cascade
[0m00:34:09.022014 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m00:34:09.025160 [debug] [Thread-1 (]: On model.supercell.total_cost: Close
[0m00:34:09.029110 [info ] [Thread-1 (]: 1 of 1 OK created sql table model main.total_cost .............................. [[32mOK[0m in 0.14s]
[0m00:34:09.030031 [debug] [Thread-1 (]: Finished running node model.supercell.total_cost
[0m00:34:09.033052 [debug] [MainThread]: Using duckdb connection "master"
[0m00:34:09.033920 [debug] [MainThread]: On master: BEGIN
[0m00:34:09.034666 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:34:09.036570 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m00:34:09.037540 [debug] [MainThread]: On master: COMMIT
[0m00:34:09.038234 [debug] [MainThread]: Using duckdb connection "master"
[0m00:34:09.038892 [debug] [MainThread]: On master: COMMIT
[0m00:34:09.040222 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m00:34:09.041016 [debug] [MainThread]: On master: Close
[0m00:34:09.042244 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:34:09.043271 [debug] [MainThread]: Connection 'model.supercell.total_cost' was properly closed.
[0m00:34:09.044521 [info ] [MainThread]: 
[0m00:34:09.045116 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.29 seconds (0.29s).
[0m00:34:09.046239 [debug] [MainThread]: Command end result
[0m00:34:09.066539 [debug] [MainThread]: Wrote artifact WritableManifest to /home/harsha/data_actions/supercell_dbt/target/manifest.json
[0m00:34:09.069642 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/harsha/data_actions/supercell_dbt/target/semantic_manifest.json
[0m00:34:09.077804 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/harsha/data_actions/supercell_dbt/target/run_results.json
[0m00:34:09.078307 [info ] [MainThread]: 
[0m00:34:09.078816 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:34:09.079190 [info ] [MainThread]: 
[0m00:34:09.079601 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m00:34:09.080642 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.2913575, "process_in_blocks": "296", "process_kernel_time": 0.173904, "process_mem_max_rss": "153512", "process_out_blocks": "2744", "process_user_time": 2.787476}
[0m00:34:09.081231 [debug] [MainThread]: Command `dbt run` succeeded at 00:34:09.081110 after 1.29 seconds
[0m00:34:09.081648 [debug] [MainThread]: Flushing usage events


============================== 00:34:14.738157 | ce994868-46c4-4088-8820-89b9acfb0e42 ==============================
[0m00:34:14.738157 [info ] [MainThread]: Running with dbt=1.9.4
[0m00:34:14.743186 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/harsha/data_actions/supercell_dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/home/harsha/data_actions/supercell_dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --select models/supercell_models/metrics/total_cost.sql', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'False'}
[0m00:34:14.743718 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality

User config should be moved from the 'config' key in profiles.yml to the 'flags' key in dbt_project.yml.
[0m00:34:15.071307 [info ] [MainThread]: Registered adapter: duckdb=1.9.3
[0m00:34:15.143401 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m00:34:15.253753 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:34:15.254266 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:34:15.371271 [debug] [MainThread]: Wrote artifact WritableManifest to /home/harsha/data_actions/supercell_dbt/target/manifest.json
[0m00:34:15.373088 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/harsha/data_actions/supercell_dbt/target/semantic_manifest.json
[0m00:34:15.386586 [info ] [MainThread]: Found 4 models, 4 data tests, 428 macros
[0m00:34:15.389449 [info ] [MainThread]: 
[0m00:34:15.390000 [info ] [MainThread]: Concurrency: 4 threads (target='default')
[0m00:34:15.390372 [info ] [MainThread]: 
[0m00:34:15.390937 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m00:34:15.392499 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_supercell'
[0m00:34:15.441350 [debug] [ThreadPool]: Using duckdb connection "list_supercell"
[0m00:34:15.441890 [debug] [ThreadPool]: On list_supercell: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "connection_name": "list_supercell"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"supercell"'
    
  
  
[0m00:34:15.442263 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:34:15.457170 [debug] [ThreadPool]: SQL status: OK in 0.015 seconds
[0m00:34:15.458978 [debug] [ThreadPool]: On list_supercell: Close
[0m00:34:15.459930 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_supercell, now create_supercell_main)
[0m00:34:15.460528 [debug] [ThreadPool]: Creating schema "database: "supercell"
schema: "main"
"
[0m00:34:15.468396 [debug] [ThreadPool]: Using duckdb connection "create_supercell_main"
[0m00:34:15.468866 [debug] [ThreadPool]: On create_supercell_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "connection_name": "create_supercell_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='supercell'
        and type='sqlite'
    
  
[0m00:34:15.469225 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:34:15.470453 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m00:34:15.472018 [debug] [ThreadPool]: Using duckdb connection "create_supercell_main"
[0m00:34:15.472426 [debug] [ThreadPool]: On create_supercell_main: BEGIN
[0m00:34:15.472977 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m00:34:15.473324 [debug] [ThreadPool]: Using duckdb connection "create_supercell_main"
[0m00:34:15.473636 [debug] [ThreadPool]: On create_supercell_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "connection_name": "create_supercell_main"} */

    
    
        create schema if not exists "supercell"."main"
    
[0m00:34:15.474268 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m00:34:15.475291 [debug] [ThreadPool]: On create_supercell_main: COMMIT
[0m00:34:15.475684 [debug] [ThreadPool]: Using duckdb connection "create_supercell_main"
[0m00:34:15.476014 [debug] [ThreadPool]: On create_supercell_main: COMMIT
[0m00:34:15.476554 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m00:34:15.476915 [debug] [ThreadPool]: On create_supercell_main: Close
[0m00:34:15.483396 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_supercell_main, now list_supercell_main)
[0m00:34:15.495504 [debug] [ThreadPool]: Using duckdb connection "list_supercell_main"
[0m00:34:15.496012 [debug] [ThreadPool]: On list_supercell_main: BEGIN
[0m00:34:15.496387 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:34:15.497275 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m00:34:15.497774 [debug] [ThreadPool]: Using duckdb connection "list_supercell_main"
[0m00:34:15.498166 [debug] [ThreadPool]: On list_supercell_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "connection_name": "list_supercell_main"} */
select
      'supercell' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'supercell'
  
[0m00:34:15.517596 [debug] [ThreadPool]: SQL status: OK in 0.019 seconds
[0m00:34:15.519821 [debug] [ThreadPool]: On list_supercell_main: ROLLBACK
[0m00:34:15.521262 [debug] [ThreadPool]: Failed to rollback 'list_supercell_main'
[0m00:34:15.521726 [debug] [ThreadPool]: On list_supercell_main: Close
[0m00:34:15.523633 [debug] [MainThread]: Using duckdb connection "master"
[0m00:34:15.524107 [debug] [MainThread]: On master: BEGIN
[0m00:34:15.524487 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:34:15.525293 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m00:34:15.525696 [debug] [MainThread]: On master: COMMIT
[0m00:34:15.526044 [debug] [MainThread]: Using duckdb connection "master"
[0m00:34:15.526375 [debug] [MainThread]: On master: COMMIT
[0m00:34:15.527153 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m00:34:15.527612 [debug] [MainThread]: On master: Close
[0m00:34:15.532546 [debug] [Thread-1 (]: Began running node model.supercell.total_cost
[0m00:34:15.533716 [info ] [Thread-1 (]: 1 of 1 START sql table model main.total_cost ................................... [RUN]
[0m00:34:15.534725 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_supercell_main, now model.supercell.total_cost)
[0m00:34:15.535660 [debug] [Thread-1 (]: Began compiling node model.supercell.total_cost
[0m00:34:15.550215 [debug] [Thread-1 (]: Writing injected SQL for node "model.supercell.total_cost"
[0m00:34:15.551714 [debug] [Thread-1 (]: Began executing node model.supercell.total_cost
[0m00:34:15.595100 [debug] [Thread-1 (]: Writing runtime sql for node "model.supercell.total_cost"
[0m00:34:15.595958 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.total_cost"
[0m00:34:15.596412 [debug] [Thread-1 (]: On model.supercell.total_cost: BEGIN
[0m00:34:15.596773 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:34:15.597775 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:34:15.598174 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.total_cost"
[0m00:34:15.598576 [debug] [Thread-1 (]: On model.supercell.total_cost: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.total_cost"} */

  
    
    

    create  table
      "supercell"."main"."total_cost__dbt_tmp"
  
    as (
      


select
    DATE_TRUNC('month', usage_end_date)  as month,
    region,
    instance_type,
    pricing_model,
    service_code,
    tag_values as tag_values,
    SUM(amortized_cost) as total_cost
from "supercell"."main"."cleaned_usagelogs"
group by month,region, instance_type, pricing_model, service_code, tag_values
    );
  
  
[0m00:34:15.619740 [debug] [Thread-1 (]: SQL status: OK in 0.021 seconds
[0m00:34:15.627059 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.total_cost"
[0m00:34:15.627570 [debug] [Thread-1 (]: On model.supercell.total_cost: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.total_cost"} */
alter table "supercell"."main"."total_cost" rename to "total_cost__dbt_backup"
[0m00:34:15.628440 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:34:15.631537 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.total_cost"
[0m00:34:15.631972 [debug] [Thread-1 (]: On model.supercell.total_cost: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.total_cost"} */
alter table "supercell"."main"."total_cost__dbt_tmp" rename to "total_cost"
[0m00:34:15.632770 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:34:15.651361 [debug] [Thread-1 (]: On model.supercell.total_cost: COMMIT
[0m00:34:15.651904 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.total_cost"
[0m00:34:15.652305 [debug] [Thread-1 (]: On model.supercell.total_cost: COMMIT
[0m00:34:15.656747 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m00:34:15.662702 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.total_cost"
[0m00:34:15.663177 [debug] [Thread-1 (]: On model.supercell.total_cost: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.total_cost"} */
drop table if exists "supercell"."main"."total_cost__dbt_backup" cascade
[0m00:34:15.665653 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m00:34:15.668622 [debug] [Thread-1 (]: On model.supercell.total_cost: Close
[0m00:34:15.672213 [info ] [Thread-1 (]: 1 of 1 OK created sql table model main.total_cost .............................. [[32mOK[0m in 0.14s]
[0m00:34:15.673143 [debug] [Thread-1 (]: Finished running node model.supercell.total_cost
[0m00:34:15.675914 [debug] [MainThread]: Using duckdb connection "master"
[0m00:34:15.676599 [debug] [MainThread]: On master: BEGIN
[0m00:34:15.677064 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:34:15.678210 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m00:34:15.678804 [debug] [MainThread]: On master: COMMIT
[0m00:34:15.679301 [debug] [MainThread]: Using duckdb connection "master"
[0m00:34:15.679755 [debug] [MainThread]: On master: COMMIT
[0m00:34:15.680907 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m00:34:15.681992 [debug] [MainThread]: On master: Close
[0m00:34:15.683533 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:34:15.684097 [debug] [MainThread]: Connection 'model.supercell.total_cost' was properly closed.
[0m00:34:15.684658 [info ] [MainThread]: 
[0m00:34:15.685607 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.29 seconds (0.29s).
[0m00:34:15.686909 [debug] [MainThread]: Command end result
[0m00:34:15.711061 [debug] [MainThread]: Wrote artifact WritableManifest to /home/harsha/data_actions/supercell_dbt/target/manifest.json
[0m00:34:15.713000 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/harsha/data_actions/supercell_dbt/target/semantic_manifest.json
[0m00:34:15.719768 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/harsha/data_actions/supercell_dbt/target/run_results.json
[0m00:34:15.720198 [info ] [MainThread]: 
[0m00:34:15.720673 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:34:15.721022 [info ] [MainThread]: 
[0m00:34:15.721414 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m00:34:15.722425 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.0469933, "process_in_blocks": "0", "process_kernel_time": 0.19471, "process_mem_max_rss": "149352", "process_out_blocks": "1864", "process_user_time": 2.525239}
[0m00:34:15.722961 [debug] [MainThread]: Command `dbt run` succeeded at 00:34:15.722848 after 1.05 seconds
[0m00:34:15.723353 [debug] [MainThread]: Flushing usage events
