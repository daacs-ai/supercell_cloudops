

============================== 21:59:35.449547 | 98501f52-b893-47fd-9e65-acef3777a96e ==============================
[0m21:59:35.449547 [info ] [MainThread]: Running with dbt=1.9.4
[0m21:59:35.454789 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/harsha/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': 'logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt init', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'False'}
[0m21:59:35.455251 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality

User config should be moved from the 'config' key in profiles.yml to the 'flags' key in dbt_project.yml.
[0m22:00:14.810292 [debug] [MainThread]: Starter project path: /home/harsha/data_actions/supercell_dbt/supercell_env/lib/python3.12/site-packages/dbt/include/starter_project
[0m22:00:14.813840 [info ] [MainThread]: 
Your new dbt project "supercell" was created!

For more information on how to configure the profiles.yml file,
please consult the dbt documentation here:

  https://docs.getdbt.com/docs/configure-your-profile

One more thing:

Need help? Don't hesitate to reach out to us via GitHub issues or on Slack:

  https://community.getdbt.com/

Happy modeling!

[0m22:00:14.814632 [info ] [MainThread]: Setting up your profile.
[0m22:00:14.816848 [error] [MainThread]: Encountered an error:
Runtime Error
  No adapters available. Learn how to install an adapter by going to https://docs.getdbt.com/docs/connect-adapters#install-using-the-cli
[0m22:00:14.818383 [debug] [MainThread]: Resource report: {"command_name": "init", "command_success": false, "command_wall_clock_time": 39.432167, "process_in_blocks": "1096", "process_kernel_time": 0.123689, "process_mem_max_rss": "96932", "process_out_blocks": "72", "process_user_time": 1.57869}
[0m22:00:14.818987 [debug] [MainThread]: Command `dbt init` failed at 22:00:14.818864 after 39.43 seconds
[0m22:00:14.819917 [debug] [MainThread]: Flushing usage events


============================== 22:17:42.601641 | 7d812d2a-d411-4ba0-bcc1-c3325494815d ==============================
[0m22:17:42.601641 [info ] [MainThread]: Running with dbt=1.9.4
[0m22:17:42.606883 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/harsha/.dbt', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/harsha/data_actions/supercell_dbt/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run --select models/example/my_first_dbt_model.sql', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'False'}
[0m22:17:42.607568 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality

User config should be moved from the 'config' key in profiles.yml to the 'flags' key in dbt_project.yml.
[0m22:17:42.612719 [error] [MainThread]: Encountered an error:
Runtime Error
  Could not find profile named 'supercell'
[0m22:17:42.614883 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.075832024, "process_in_blocks": "0", "process_kernel_time": 0.153664, "process_mem_max_rss": "94912", "process_out_blocks": "8", "process_user_time": 1.527663}
[0m22:17:42.615965 [debug] [MainThread]: Command `dbt run` failed at 22:17:42.615754 after 0.08 seconds
[0m22:17:42.616697 [debug] [MainThread]: Flushing usage events


============================== 22:18:05.649881 | fe1223b5-9469-46e7-9954-414800dc3465 ==============================
[0m22:18:05.649881 [info ] [MainThread]: Running with dbt=1.9.4
[0m22:18:05.654733 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/harsha/data_actions/supercell_dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/harsha/data_actions/supercell_dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run --select models/example/my_first_dbt_model.sql', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'False'}
[0m22:18:05.655407 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality

User config should be moved from the 'config' key in profiles.yml to the 'flags' key in dbt_project.yml.
[0m22:18:05.663165 [info ] [MainThread]: Error importing adapter: No module named 'dbt.adapters.clickhouse'
[0m22:18:05.664245 [error] [MainThread]: Encountered an error:
Runtime Error
  Credentials in profile "supercell", target "default" invalid: Runtime Error
    Could not find adapter type clickhouse!
[0m22:18:05.666794 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.079584524, "process_in_blocks": "0", "process_kernel_time": 0.109692, "process_mem_max_rss": "94880", "process_out_blocks": "8", "process_user_time": 1.564609}
[0m22:18:05.667866 [debug] [MainThread]: Command `dbt run` failed at 22:18:05.667652 after 0.08 seconds
[0m22:18:05.668589 [debug] [MainThread]: Flushing usage events


============================== 23:30:52.803197 | eee3d708-9fb1-4aa1-b8be-54e64e0b23d5 ==============================
[0m23:30:52.803197 [info ] [MainThread]: Running with dbt=1.9.4
[0m23:30:52.807374 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/home/harsha/data_actions/supercell_dbt', 'log_path': '/home/harsha/data_actions/supercell_dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select models/example/supercell_logsfacts.sql', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'False'}
[0m23:30:52.807835 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality

User config should be moved from the 'config' key in profiles.yml to the 'flags' key in dbt_project.yml.
[0m23:30:52.965532 [info ] [MainThread]: Registered adapter: duckdb=1.9.3
[0m23:30:53.005122 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m23:30:53.005545 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m23:30:53.690346 [debug] [MainThread]: Wrote artifact WritableManifest to /home/harsha/data_actions/supercell_dbt/target/manifest.json
[0m23:30:53.691240 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/harsha/data_actions/supercell_dbt/target/semantic_manifest.json
[0m23:30:53.702771 [info ] [MainThread]: Found 3 models, 4 data tests, 428 macros
[0m23:30:53.704129 [info ] [MainThread]: 
[0m23:30:53.704437 [info ] [MainThread]: Concurrency: 4 threads (target='default')
[0m23:30:53.704646 [info ] [MainThread]: 
[0m23:30:53.704967 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m23:30:53.705767 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_supercell'
[0m23:30:53.728357 [debug] [ThreadPool]: Using duckdb connection "list_supercell"
[0m23:30:53.728686 [debug] [ThreadPool]: On list_supercell: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "connection_name": "list_supercell"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"supercell"'
    
  
  
[0m23:30:53.728862 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:30:53.735835 [debug] [ThreadPool]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "connection_name": "list_supercell"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"supercell"'
    
  
  
[0m23:30:53.736118 [debug] [ThreadPool]: DuckDB adapter: Rolling back transaction.
[0m23:30:53.736772 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:30:53.737018 [debug] [MainThread]: Connection 'list_supercell' was properly closed.
[0m23:30:53.737210 [info ] [MainThread]: 
[0m23:30:53.737432 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.03 seconds (0.03s).
[0m23:30:53.737724 [error] [MainThread]: Encountered an error:
Runtime Error
  IO Error: Could not set lock on file "/home/harsha/data_actions/supercell_dbt/supercell.duckdb": Conflicting lock is held in /usr/bin/python3.12 (PID 2406907) by user harsha. See also https://duckdb.org/docs/connect/concurrency
[0m23:30:53.738425 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.9662292, "process_in_blocks": "42456", "process_kernel_time": 0.102277, "process_mem_max_rss": "135576", "process_out_blocks": "1776", "process_user_time": 1.686057}
[0m23:30:53.738793 [debug] [MainThread]: Command `dbt run` failed at 23:30:53.738721 after 0.97 seconds
[0m23:30:53.739028 [debug] [MainThread]: Flushing usage events


============================== 23:31:33.160724 | 74f35780-8d3b-46c9-b7e7-3681ac5b4b52 ==============================
[0m23:31:33.160724 [info ] [MainThread]: Running with dbt=1.9.4
[0m23:31:33.162791 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/harsha/data_actions/supercell_dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/harsha/data_actions/supercell_dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run --select models/example/supercell_logsfacts.sql', 'send_anonymous_usage_stats': 'False'}
[0m23:31:33.163044 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality

User config should be moved from the 'config' key in profiles.yml to the 'flags' key in dbt_project.yml.
[0m23:31:33.316787 [info ] [MainThread]: Registered adapter: duckdb=1.9.3
[0m23:31:33.353786 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m23:31:33.406201 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:31:33.406496 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:31:33.461725 [debug] [MainThread]: Wrote artifact WritableManifest to /home/harsha/data_actions/supercell_dbt/target/manifest.json
[0m23:31:33.462729 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/harsha/data_actions/supercell_dbt/target/semantic_manifest.json
[0m23:31:33.469289 [info ] [MainThread]: Found 3 models, 4 data tests, 428 macros
[0m23:31:33.470666 [info ] [MainThread]: 
[0m23:31:33.470970 [info ] [MainThread]: Concurrency: 4 threads (target='default')
[0m23:31:33.471145 [info ] [MainThread]: 
[0m23:31:33.471437 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m23:31:33.472134 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_supercell'
[0m23:31:33.498043 [debug] [ThreadPool]: Using duckdb connection "list_supercell"
[0m23:31:33.498376 [debug] [ThreadPool]: On list_supercell: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "connection_name": "list_supercell"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"supercell"'
    
  
  
[0m23:31:33.498579 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:31:33.507041 [debug] [ThreadPool]: SQL status: OK in 0.008 seconds
[0m23:31:33.507913 [debug] [ThreadPool]: On list_supercell: Close
[0m23:31:33.508517 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_supercell, now create_supercell_main)
[0m23:31:33.508811 [debug] [ThreadPool]: Creating schema "database: "supercell"
schema: "main"
"
[0m23:31:33.512782 [debug] [ThreadPool]: Using duckdb connection "create_supercell_main"
[0m23:31:33.513024 [debug] [ThreadPool]: On create_supercell_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "connection_name": "create_supercell_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='supercell'
        and type='sqlite'
    
  
[0m23:31:33.513191 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:31:33.514067 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m23:31:33.514843 [debug] [ThreadPool]: Using duckdb connection "create_supercell_main"
[0m23:31:33.515033 [debug] [ThreadPool]: On create_supercell_main: BEGIN
[0m23:31:33.515322 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m23:31:33.515505 [debug] [ThreadPool]: Using duckdb connection "create_supercell_main"
[0m23:31:33.515657 [debug] [ThreadPool]: On create_supercell_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "connection_name": "create_supercell_main"} */

    
    
        create schema if not exists "supercell"."main"
    
[0m23:31:33.515932 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m23:31:33.516420 [debug] [ThreadPool]: On create_supercell_main: COMMIT
[0m23:31:33.516612 [debug] [ThreadPool]: Using duckdb connection "create_supercell_main"
[0m23:31:33.516760 [debug] [ThreadPool]: On create_supercell_main: COMMIT
[0m23:31:33.516991 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m23:31:33.517154 [debug] [ThreadPool]: On create_supercell_main: Close
[0m23:31:33.520565 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_supercell_main, now list_supercell_main)
[0m23:31:33.527308 [debug] [ThreadPool]: Using duckdb connection "list_supercell_main"
[0m23:31:33.527749 [debug] [ThreadPool]: On list_supercell_main: BEGIN
[0m23:31:33.528040 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:31:33.528748 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m23:31:33.529063 [debug] [ThreadPool]: Using duckdb connection "list_supercell_main"
[0m23:31:33.529364 [debug] [ThreadPool]: On list_supercell_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "connection_name": "list_supercell_main"} */
select
      'supercell' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'supercell'
  
[0m23:31:33.543733 [debug] [ThreadPool]: SQL status: OK in 0.014 seconds
[0m23:31:33.544645 [debug] [ThreadPool]: On list_supercell_main: ROLLBACK
[0m23:31:33.545567 [debug] [ThreadPool]: Failed to rollback 'list_supercell_main'
[0m23:31:33.545769 [debug] [ThreadPool]: On list_supercell_main: Close
[0m23:31:33.546624 [debug] [MainThread]: Using duckdb connection "master"
[0m23:31:33.546845 [debug] [MainThread]: On master: BEGIN
[0m23:31:33.547003 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:31:33.547372 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m23:31:33.547557 [debug] [MainThread]: On master: COMMIT
[0m23:31:33.547719 [debug] [MainThread]: Using duckdb connection "master"
[0m23:31:33.547863 [debug] [MainThread]: On master: COMMIT
[0m23:31:33.548113 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m23:31:33.548301 [debug] [MainThread]: On master: Close
[0m23:31:33.550622 [debug] [Thread-1 (]: Began running node model.supercell.supercell_logsfacts
[0m23:31:33.551146 [info ] [Thread-1 (]: 1 of 1 START sql table model main.supercell_logsfacts .......................... [RUN]
[0m23:31:33.551589 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_supercell_main, now model.supercell.supercell_logsfacts)
[0m23:31:33.551859 [debug] [Thread-1 (]: Began compiling node model.supercell.supercell_logsfacts
[0m23:31:33.557072 [debug] [Thread-1 (]: Writing injected SQL for node "model.supercell.supercell_logsfacts"
[0m23:31:33.557803 [debug] [Thread-1 (]: Began executing node model.supercell.supercell_logsfacts
[0m23:31:33.577160 [debug] [Thread-1 (]: Writing runtime sql for node "model.supercell.supercell_logsfacts"
[0m23:31:33.577714 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.supercell_logsfacts"
[0m23:31:33.577960 [debug] [Thread-1 (]: On model.supercell.supercell_logsfacts: BEGIN
[0m23:31:33.578133 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:31:33.578765 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m23:31:33.578980 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.supercell_logsfacts"
[0m23:31:33.579167 [debug] [Thread-1 (]: On model.supercell.supercell_logsfacts: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.supercell_logsfacts"} */

  
    
    

    create  table
      "supercell"."main"."supercell_logsfacts__dbt_tmp"
  
    as (
      


SELECT
    CAST("LinkedAccountId" AS VARCHAR) AS linked_account_id,
    CAST("bill/PayerAccountId" AS VARCHAR) AS payer_account_id,
    CAST("lineItem/UsageStartDate" AS TIMESTAMP) AS usage_start_date,
    CAST("lineItem/UsageEndDate" AS TIMESTAMP) AS usage_end_date,
    CAST("lineItem/UsageAmount" AS DECIMAL(18, 6)) AS usage_amount,
    CAST("lineItem/Operation" AS VARCHAR) AS operation,
    CAST("pricing/PricingModel" AS VARCHAR) AS pricing_model,
    CAST("resourceTags/TagKeys" AS VARCHAR) AS tag_keys,
    CAST("resourceTags/TagValues" AS VARCHAR) AS tag_values,
    CAST("product/Region" AS VARCHAR) AS region,
    CAST("product/ServiceCode" AS VARCHAR) AS service_code,
    CAST("product/InstanceType" AS VARCHAR) AS instance_type,
    CAST("amortized_cost" AS DECIMAL(18, 6)) AS amortized_cost,
    CAST("product/Description" AS VARCHAR) AS description
FROM supercell_usagelogs
    );
  
  
[0m23:31:33.657814 [debug] [Thread-1 (]: SQL status: OK in 0.078 seconds
[0m23:31:33.661868 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.supercell_logsfacts"
[0m23:31:33.662159 [debug] [Thread-1 (]: On model.supercell.supercell_logsfacts: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.supercell_logsfacts"} */
alter table "supercell"."main"."supercell_logsfacts__dbt_tmp" rename to "supercell_logsfacts"
[0m23:31:33.662892 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m23:31:33.670723 [debug] [Thread-1 (]: On model.supercell.supercell_logsfacts: COMMIT
[0m23:31:33.670986 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.supercell_logsfacts"
[0m23:31:33.671165 [debug] [Thread-1 (]: On model.supercell.supercell_logsfacts: COMMIT
[0m23:31:33.763925 [debug] [Thread-1 (]: SQL status: OK in 0.092 seconds
[0m23:31:33.767036 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.supercell_logsfacts"
[0m23:31:33.767304 [debug] [Thread-1 (]: On model.supercell.supercell_logsfacts: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.supercell_logsfacts"} */
drop table if exists "supercell"."main"."supercell_logsfacts__dbt_backup" cascade
[0m23:31:33.767793 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m23:31:33.769181 [debug] [Thread-1 (]: On model.supercell.supercell_logsfacts: Close
[0m23:31:33.772886 [info ] [Thread-1 (]: 1 of 1 OK created sql table model main.supercell_logsfacts ..................... [[32mOK[0m in 0.22s]
[0m23:31:33.773243 [debug] [Thread-1 (]: Finished running node model.supercell.supercell_logsfacts
[0m23:31:33.775062 [debug] [MainThread]: Using duckdb connection "master"
[0m23:31:33.775583 [debug] [MainThread]: On master: BEGIN
[0m23:31:33.775886 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:31:33.776596 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m23:31:33.776873 [debug] [MainThread]: On master: COMMIT
[0m23:31:33.777083 [debug] [MainThread]: Using duckdb connection "master"
[0m23:31:33.777256 [debug] [MainThread]: On master: COMMIT
[0m23:31:33.777792 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m23:31:33.778042 [debug] [MainThread]: On master: Close
[0m23:31:33.778428 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:31:33.778626 [debug] [MainThread]: Connection 'model.supercell.supercell_logsfacts' was properly closed.
[0m23:31:33.778845 [info ] [MainThread]: 
[0m23:31:33.779089 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.31 seconds (0.31s).
[0m23:31:33.779566 [debug] [MainThread]: Command end result
[0m23:31:33.792992 [debug] [MainThread]: Wrote artifact WritableManifest to /home/harsha/data_actions/supercell_dbt/target/manifest.json
[0m23:31:33.794028 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/harsha/data_actions/supercell_dbt/target/semantic_manifest.json
[0m23:31:33.797317 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/harsha/data_actions/supercell_dbt/target/run_results.json
[0m23:31:33.797532 [info ] [MainThread]: 
[0m23:31:33.797765 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:31:33.797943 [info ] [MainThread]: 
[0m23:31:33.798123 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m23:31:33.798656 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.6683834, "process_in_blocks": "2072", "process_kernel_time": 0.100941, "process_mem_max_rss": "189624", "process_out_blocks": "4896", "process_user_time": 1.365209}
[0m23:31:33.798929 [debug] [MainThread]: Command `dbt run` succeeded at 23:31:33.798872 after 0.67 seconds
[0m23:31:33.799117 [debug] [MainThread]: Flushing usage events


============================== 23:36:21.027122 | 49a71eb3-61be-45bc-9179-11ed4f914b77 ==============================
[0m23:36:21.027122 [info ] [MainThread]: Running with dbt=1.9.4
[0m23:36:21.030274 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/harsha/data_actions/supercell_dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/home/harsha/data_actions/supercell_dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select models/supercell_models/cleaned_usagelogs.sql', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'False'}
[0m23:36:21.030844 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality

User config should be moved from the 'config' key in profiles.yml to the 'flags' key in dbt_project.yml.
[0m23:36:21.211242 [info ] [MainThread]: Registered adapter: duckdb=1.9.3
[0m23:36:21.252503 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m23:36:21.311216 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 1 files added, 0 files changed.
[0m23:36:21.311598 [debug] [MainThread]: Partial parsing: added file: supercell://models/supercell_models/cleaned_usagelogs.sql
[0m23:36:21.311778 [debug] [MainThread]: Partial parsing: deleted file: supercell://models/example/supercell_logsfacts.sql
[0m23:36:21.490159 [debug] [MainThread]: Wrote artifact WritableManifest to /home/harsha/data_actions/supercell_dbt/target/manifest.json
[0m23:36:21.491176 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/harsha/data_actions/supercell_dbt/target/semantic_manifest.json
[0m23:36:21.498423 [info ] [MainThread]: Found 3 models, 4 data tests, 428 macros
[0m23:36:21.499845 [info ] [MainThread]: 
[0m23:36:21.500134 [info ] [MainThread]: Concurrency: 4 threads (target='default')
[0m23:36:21.500322 [info ] [MainThread]: 
[0m23:36:21.500604 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m23:36:21.501395 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_supercell'
[0m23:36:21.524620 [debug] [ThreadPool]: Using duckdb connection "list_supercell"
[0m23:36:21.524929 [debug] [ThreadPool]: On list_supercell: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "connection_name": "list_supercell"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"supercell"'
    
  
  
[0m23:36:21.525108 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:36:21.528323 [debug] [ThreadPool]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "connection_name": "list_supercell"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"supercell"'
    
  
  
[0m23:36:21.528582 [debug] [ThreadPool]: DuckDB adapter: Rolling back transaction.
[0m23:36:21.529178 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:36:21.529426 [debug] [MainThread]: Connection 'list_supercell' was properly closed.
[0m23:36:21.529612 [info ] [MainThread]: 
[0m23:36:21.529795 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.03 seconds (0.03s).
[0m23:36:21.530042 [error] [MainThread]: Encountered an error:
Runtime Error
  IO Error: Could not set lock on file "/home/harsha/data_actions/supercell_dbt/supercell.duckdb": Conflicting lock is held in /usr/local/bin/duckdb (PID 2434532) by user harsha. See also https://duckdb.org/docs/connect/concurrency
[0m23:36:21.530685 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.5377297, "process_in_blocks": "0", "process_kernel_time": 0.092, "process_mem_max_rss": "136380", "process_out_blocks": "1776", "process_user_time": 1.294013}
[0m23:36:21.531018 [debug] [MainThread]: Command `dbt run` failed at 23:36:21.530954 after 0.54 seconds
[0m23:36:21.531286 [debug] [MainThread]: Flushing usage events


============================== 23:36:35.278878 | a955ac6f-f864-4c2b-8a52-dced9534ec9d ==============================
[0m23:36:35.278878 [info ] [MainThread]: Running with dbt=1.9.4
[0m23:36:35.281886 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/home/harsha/data_actions/supercell_dbt', 'log_path': '/home/harsha/data_actions/supercell_dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run --select models/supercell_models/cleaned_usagelogs.sql', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'False'}
[0m23:36:35.282328 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality

User config should be moved from the 'config' key in profiles.yml to the 'flags' key in dbt_project.yml.
[0m23:36:35.437073 [info ] [MainThread]: Registered adapter: duckdb=1.9.3
[0m23:36:35.473319 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m23:36:35.524765 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m23:36:35.525023 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m23:36:35.579544 [debug] [MainThread]: Wrote artifact WritableManifest to /home/harsha/data_actions/supercell_dbt/target/manifest.json
[0m23:36:35.580454 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/harsha/data_actions/supercell_dbt/target/semantic_manifest.json
[0m23:36:35.587074 [info ] [MainThread]: Found 3 models, 4 data tests, 428 macros
[0m23:36:35.588556 [info ] [MainThread]: 
[0m23:36:35.588872 [info ] [MainThread]: Concurrency: 4 threads (target='default')
[0m23:36:35.589050 [info ] [MainThread]: 
[0m23:36:35.589341 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m23:36:35.590082 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_supercell'
[0m23:36:35.615283 [debug] [ThreadPool]: Using duckdb connection "list_supercell"
[0m23:36:35.615620 [debug] [ThreadPool]: On list_supercell: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "connection_name": "list_supercell"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"supercell"'
    
  
  
[0m23:36:35.615828 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:36:35.623339 [debug] [ThreadPool]: SQL status: OK in 0.007 seconds
[0m23:36:35.624232 [debug] [ThreadPool]: On list_supercell: Close
[0m23:36:35.624854 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_supercell, now create_supercell_main)
[0m23:36:35.625138 [debug] [ThreadPool]: Creating schema "database: "supercell"
schema: "main"
"
[0m23:36:35.629000 [debug] [ThreadPool]: Using duckdb connection "create_supercell_main"
[0m23:36:35.629223 [debug] [ThreadPool]: On create_supercell_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "connection_name": "create_supercell_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='supercell'
        and type='sqlite'
    
  
[0m23:36:35.629412 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:36:35.629972 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m23:36:35.630718 [debug] [ThreadPool]: Using duckdb connection "create_supercell_main"
[0m23:36:35.630915 [debug] [ThreadPool]: On create_supercell_main: BEGIN
[0m23:36:35.631189 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m23:36:35.631389 [debug] [ThreadPool]: Using duckdb connection "create_supercell_main"
[0m23:36:35.631554 [debug] [ThreadPool]: On create_supercell_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "connection_name": "create_supercell_main"} */

    
    
        create schema if not exists "supercell"."main"
    
[0m23:36:35.631992 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m23:36:35.632512 [debug] [ThreadPool]: On create_supercell_main: COMMIT
[0m23:36:35.632745 [debug] [ThreadPool]: Using duckdb connection "create_supercell_main"
[0m23:36:35.632931 [debug] [ThreadPool]: On create_supercell_main: COMMIT
[0m23:36:35.633240 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m23:36:35.633459 [debug] [ThreadPool]: On create_supercell_main: Close
[0m23:36:35.637549 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_supercell_main, now list_supercell_main)
[0m23:36:35.642257 [debug] [ThreadPool]: Using duckdb connection "list_supercell_main"
[0m23:36:35.642712 [debug] [ThreadPool]: On list_supercell_main: BEGIN
[0m23:36:35.642910 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:36:35.643382 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m23:36:35.643560 [debug] [ThreadPool]: Using duckdb connection "list_supercell_main"
[0m23:36:35.643708 [debug] [ThreadPool]: On list_supercell_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "connection_name": "list_supercell_main"} */
select
      'supercell' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'supercell'
  
[0m23:36:35.651751 [debug] [ThreadPool]: SQL status: OK in 0.008 seconds
[0m23:36:35.652623 [debug] [ThreadPool]: On list_supercell_main: ROLLBACK
[0m23:36:35.653324 [debug] [ThreadPool]: Failed to rollback 'list_supercell_main'
[0m23:36:35.653546 [debug] [ThreadPool]: On list_supercell_main: Close
[0m23:36:35.654450 [debug] [MainThread]: Using duckdb connection "master"
[0m23:36:35.654654 [debug] [MainThread]: On master: BEGIN
[0m23:36:35.654814 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:36:35.655171 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m23:36:35.655399 [debug] [MainThread]: On master: COMMIT
[0m23:36:35.655558 [debug] [MainThread]: Using duckdb connection "master"
[0m23:36:35.655701 [debug] [MainThread]: On master: COMMIT
[0m23:36:35.655955 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m23:36:35.656149 [debug] [MainThread]: On master: Close
[0m23:36:35.658088 [debug] [Thread-1 (]: Began running node model.supercell.cleaned_usagelogs
[0m23:36:35.658624 [info ] [Thread-1 (]: 1 of 1 START sql table model main.cleaned_usagelogs ............................ [RUN]
[0m23:36:35.658945 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_supercell_main, now model.supercell.cleaned_usagelogs)
[0m23:36:35.659169 [debug] [Thread-1 (]: Began compiling node model.supercell.cleaned_usagelogs
[0m23:36:35.664251 [debug] [Thread-1 (]: Writing injected SQL for node "model.supercell.cleaned_usagelogs"
[0m23:36:35.665135 [debug] [Thread-1 (]: Began executing node model.supercell.cleaned_usagelogs
[0m23:36:35.684124 [debug] [Thread-1 (]: Writing runtime sql for node "model.supercell.cleaned_usagelogs"
[0m23:36:35.684679 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.cleaned_usagelogs"
[0m23:36:35.684920 [debug] [Thread-1 (]: On model.supercell.cleaned_usagelogs: BEGIN
[0m23:36:35.685114 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:36:35.685715 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m23:36:35.685927 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.cleaned_usagelogs"
[0m23:36:35.686120 [debug] [Thread-1 (]: On model.supercell.cleaned_usagelogs: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.cleaned_usagelogs"} */

  
    
    

    create  table
      "supercell"."main"."cleaned_usagelogs__dbt_tmp"
  
    as (
      


SELECT
    CAST("LinkedAccountId" AS VARCHAR) AS linked_account_id,
    CAST("bill/PayerAccountId" AS VARCHAR) AS payer_account_id,
    CAST("lineItem/UsageStartDate" AS TIMESTAMP) AS usage_start_date,
    CAST("lineItem/UsageEndDate" AS TIMESTAMP) AS usage_end_date,
    CAST("lineItem/UsageAmount" AS DECIMAL(18, 6)) AS usage_amount,
    CAST("lineItem/Operation" AS VARCHAR) AS operation,
    CAST("pricing/PricingModel" AS VARCHAR) AS pricing_model,
    CAST("resourceTags/TagKeys" AS VARCHAR) AS tag_keys,
    CAST("resourceTags/TagValues" AS VARCHAR) AS tag_values,
    CAST("product/Region" AS VARCHAR) AS region,
    CAST("product/ServiceCode" AS VARCHAR) AS service_code,
    CAST("product/InstanceType" AS VARCHAR) AS instance_type,
    CAST("amortized_cost" AS DECIMAL(18, 6)) AS amortized_cost,
    CAST("product/Description" AS VARCHAR) AS description
FROM supercell_usagelogs
    );
  
  
[0m23:36:35.764272 [debug] [Thread-1 (]: SQL status: OK in 0.078 seconds
[0m23:36:35.768166 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.cleaned_usagelogs"
[0m23:36:35.768481 [debug] [Thread-1 (]: On model.supercell.cleaned_usagelogs: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.cleaned_usagelogs"} */
alter table "supercell"."main"."cleaned_usagelogs__dbt_tmp" rename to "cleaned_usagelogs"
[0m23:36:35.769056 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m23:36:35.776571 [debug] [Thread-1 (]: On model.supercell.cleaned_usagelogs: COMMIT
[0m23:36:35.776824 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.cleaned_usagelogs"
[0m23:36:35.777011 [debug] [Thread-1 (]: On model.supercell.cleaned_usagelogs: COMMIT
[0m23:36:35.864781 [debug] [Thread-1 (]: SQL status: OK in 0.087 seconds
[0m23:36:35.867989 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.cleaned_usagelogs"
[0m23:36:35.868266 [debug] [Thread-1 (]: On model.supercell.cleaned_usagelogs: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.cleaned_usagelogs"} */
drop table if exists "supercell"."main"."cleaned_usagelogs__dbt_backup" cascade
[0m23:36:35.869040 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m23:36:35.870552 [debug] [Thread-1 (]: On model.supercell.cleaned_usagelogs: Close
[0m23:36:35.873589 [info ] [Thread-1 (]: 1 of 1 OK created sql table model main.cleaned_usagelogs ....................... [[32mOK[0m in 0.21s]
[0m23:36:35.873934 [debug] [Thread-1 (]: Finished running node model.supercell.cleaned_usagelogs
[0m23:36:35.875539 [debug] [MainThread]: Using duckdb connection "master"
[0m23:36:35.875814 [debug] [MainThread]: On master: BEGIN
[0m23:36:35.875980 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:36:35.876488 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m23:36:35.876685 [debug] [MainThread]: On master: COMMIT
[0m23:36:35.876841 [debug] [MainThread]: Using duckdb connection "master"
[0m23:36:35.876980 [debug] [MainThread]: On master: COMMIT
[0m23:36:35.877269 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m23:36:35.877482 [debug] [MainThread]: On master: Close
[0m23:36:35.877784 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:36:35.877937 [debug] [MainThread]: Connection 'model.supercell.cleaned_usagelogs' was properly closed.
[0m23:36:35.878117 [info ] [MainThread]: 
[0m23:36:35.878345 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.29 seconds (0.29s).
[0m23:36:35.878766 [debug] [MainThread]: Command end result
[0m23:36:35.890716 [debug] [MainThread]: Wrote artifact WritableManifest to /home/harsha/data_actions/supercell_dbt/target/manifest.json
[0m23:36:35.891774 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/harsha/data_actions/supercell_dbt/target/semantic_manifest.json
[0m23:36:35.894992 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/harsha/data_actions/supercell_dbt/target/run_results.json
[0m23:36:35.895200 [info ] [MainThread]: 
[0m23:36:35.895439 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:36:35.895602 [info ] [MainThread]: 
[0m23:36:35.895771 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m23:36:35.896274 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.64822966, "process_in_blocks": "0", "process_kernel_time": 0.119714, "process_mem_max_rss": "190092", "process_out_blocks": "4904", "process_user_time": 1.340801}
[0m23:36:35.896556 [debug] [MainThread]: Command `dbt run` succeeded at 23:36:35.896499 after 0.65 seconds
[0m23:36:35.896746 [debug] [MainThread]: Flushing usage events


============================== 23:50:36.695507 | e197b047-d96b-4371-b964-21dd37007c41 ==============================
[0m23:50:36.695507 [info ] [MainThread]: Running with dbt=1.9.4
[0m23:50:36.697473 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/harsha/data_actions/supercell_dbt/logs', 'debug': 'False', 'profiles_dir': '/home/harsha/data_actions/supercell_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run --select models/supercell_models/metrics/total_cost.sql', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'False'}
[0m23:50:36.697693 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality

User config should be moved from the 'config' key in profiles.yml to the 'flags' key in dbt_project.yml.
[0m23:50:36.850390 [info ] [MainThread]: Registered adapter: duckdb=1.9.3
[0m23:50:36.887316 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m23:50:36.940193 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m23:50:36.940602 [debug] [MainThread]: Partial parsing: added file: supercell://models/supercell_models/metrics/total_cost.sql
[0m23:50:37.121355 [debug] [MainThread]: Wrote artifact WritableManifest to /home/harsha/data_actions/supercell_dbt/target/manifest.json
[0m23:50:37.122401 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/harsha/data_actions/supercell_dbt/target/semantic_manifest.json
[0m23:50:37.129067 [info ] [MainThread]: Found 4 models, 4 data tests, 428 macros
[0m23:50:37.130599 [info ] [MainThread]: 
[0m23:50:37.130905 [info ] [MainThread]: Concurrency: 4 threads (target='default')
[0m23:50:37.131099 [info ] [MainThread]: 
[0m23:50:37.131461 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m23:50:37.132236 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_supercell'
[0m23:50:37.154227 [debug] [ThreadPool]: Using duckdb connection "list_supercell"
[0m23:50:37.154577 [debug] [ThreadPool]: On list_supercell: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "connection_name": "list_supercell"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"supercell"'
    
  
  
[0m23:50:37.154780 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:50:37.162245 [debug] [ThreadPool]: SQL status: OK in 0.007 seconds
[0m23:50:37.163100 [debug] [ThreadPool]: On list_supercell: Close
[0m23:50:37.163769 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_supercell, now create_supercell_main)
[0m23:50:37.164078 [debug] [ThreadPool]: Creating schema "database: "supercell"
schema: "main"
"
[0m23:50:37.167918 [debug] [ThreadPool]: Using duckdb connection "create_supercell_main"
[0m23:50:37.168127 [debug] [ThreadPool]: On create_supercell_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "connection_name": "create_supercell_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='supercell'
        and type='sqlite'
    
  
[0m23:50:37.168290 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:50:37.168908 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m23:50:37.169621 [debug] [ThreadPool]: Using duckdb connection "create_supercell_main"
[0m23:50:37.169798 [debug] [ThreadPool]: On create_supercell_main: BEGIN
[0m23:50:37.170055 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m23:50:37.170240 [debug] [ThreadPool]: Using duckdb connection "create_supercell_main"
[0m23:50:37.170392 [debug] [ThreadPool]: On create_supercell_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "connection_name": "create_supercell_main"} */

    
    
        create schema if not exists "supercell"."main"
    
[0m23:50:37.170663 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m23:50:37.171118 [debug] [ThreadPool]: On create_supercell_main: COMMIT
[0m23:50:37.171321 [debug] [ThreadPool]: Using duckdb connection "create_supercell_main"
[0m23:50:37.171494 [debug] [ThreadPool]: On create_supercell_main: COMMIT
[0m23:50:37.171733 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m23:50:37.171898 [debug] [ThreadPool]: On create_supercell_main: Close
[0m23:50:37.175392 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_supercell_main, now list_supercell_main)
[0m23:50:37.179796 [debug] [ThreadPool]: Using duckdb connection "list_supercell_main"
[0m23:50:37.180058 [debug] [ThreadPool]: On list_supercell_main: BEGIN
[0m23:50:37.180220 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:50:37.180621 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m23:50:37.180815 [debug] [ThreadPool]: Using duckdb connection "list_supercell_main"
[0m23:50:37.180986 [debug] [ThreadPool]: On list_supercell_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "connection_name": "list_supercell_main"} */
select
      'supercell' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'supercell'
  
[0m23:50:37.188778 [debug] [ThreadPool]: SQL status: OK in 0.008 seconds
[0m23:50:37.189560 [debug] [ThreadPool]: On list_supercell_main: ROLLBACK
[0m23:50:37.190189 [debug] [ThreadPool]: Failed to rollback 'list_supercell_main'
[0m23:50:37.190402 [debug] [ThreadPool]: On list_supercell_main: Close
[0m23:50:37.191022 [debug] [MainThread]: Using duckdb connection "master"
[0m23:50:37.191221 [debug] [MainThread]: On master: BEGIN
[0m23:50:37.191400 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:50:37.191753 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m23:50:37.191932 [debug] [MainThread]: On master: COMMIT
[0m23:50:37.192088 [debug] [MainThread]: Using duckdb connection "master"
[0m23:50:37.192233 [debug] [MainThread]: On master: COMMIT
[0m23:50:37.192514 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m23:50:37.192683 [debug] [MainThread]: On master: Close
[0m23:50:37.194714 [debug] [Thread-1 (]: Began running node model.supercell.total_cost
[0m23:50:37.195255 [info ] [Thread-1 (]: 1 of 1 START sql table model main.total_cost ................................... [RUN]
[0m23:50:37.195696 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_supercell_main, now model.supercell.total_cost)
[0m23:50:37.196047 [debug] [Thread-1 (]: Began compiling node model.supercell.total_cost
[0m23:50:37.203672 [debug] [Thread-1 (]: Writing injected SQL for node "model.supercell.total_cost"
[0m23:50:37.204361 [debug] [Thread-1 (]: Began executing node model.supercell.total_cost
[0m23:50:37.225981 [debug] [Thread-1 (]: Writing runtime sql for node "model.supercell.total_cost"
[0m23:50:37.226461 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.total_cost"
[0m23:50:37.226703 [debug] [Thread-1 (]: On model.supercell.total_cost: BEGIN
[0m23:50:37.226890 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:50:37.227453 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m23:50:37.227645 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.total_cost"
[0m23:50:37.227811 [debug] [Thread-1 (]: On model.supercell.total_cost: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.total_cost"} */

  
    
    

    create  table
      "supercell"."main"."total_cost__dbt_tmp"
  
    as (
      


select 
    SUM(pricing_model) as total_cost,
    region,
    instance_type,
    pricing_model,
    service_code,
    tag_keys as tag_types
from "supercell"."main"."cleaned_usagelogs"
    );
  
  
[0m23:50:37.231242 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.total_cost"} */

  
    
    

    create  table
      "supercell"."main"."total_cost__dbt_tmp"
  
    as (
      


select 
    SUM(pricing_model) as total_cost,
    region,
    instance_type,
    pricing_model,
    service_code,
    tag_keys as tag_types
from "supercell"."main"."cleaned_usagelogs"
    );
  
  
[0m23:50:37.231478 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m23:50:37.231729 [debug] [Thread-1 (]: On model.supercell.total_cost: ROLLBACK
[0m23:50:37.235775 [debug] [Thread-1 (]: Failed to rollback 'model.supercell.total_cost'
[0m23:50:37.236000 [debug] [Thread-1 (]: On model.supercell.total_cost: Close
[0m23:50:37.237243 [debug] [Thread-1 (]: Runtime Error in model total_cost (models/supercell_models/metrics/total_cost.sql)
  Binder Error: No function matches the given name and argument types 'sum(VARCHAR)'. You might need to add explicit type casts.
  	Candidate functions:
  	sum(DECIMAL) -> DECIMAL
  	sum(BOOLEAN) -> HUGEINT
  	sum(SMALLINT) -> HUGEINT
  	sum(INTEGER) -> HUGEINT
  	sum(BIGINT) -> HUGEINT
  	sum(HUGEINT) -> HUGEINT
  	sum(DOUBLE) -> DOUBLE
  
  
  LINE 15:     SUM(pricing_model) as total_cost,
               ^
[0m23:50:37.238338 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model main.total_cost .......................... [[31mERROR[0m in 0.04s]
[0m23:50:37.238685 [debug] [Thread-1 (]: Finished running node model.supercell.total_cost
[0m23:50:37.239222 [debug] [Thread-7 (]: Marking all children of 'model.supercell.total_cost' to be skipped because of status 'error'.  Reason: Runtime Error in model total_cost (models/supercell_models/metrics/total_cost.sql)
  Binder Error: No function matches the given name and argument types 'sum(VARCHAR)'. You might need to add explicit type casts.
  	Candidate functions:
  	sum(DECIMAL) -> DECIMAL
  	sum(BOOLEAN) -> HUGEINT
  	sum(SMALLINT) -> HUGEINT
  	sum(INTEGER) -> HUGEINT
  	sum(BIGINT) -> HUGEINT
  	sum(HUGEINT) -> HUGEINT
  	sum(DOUBLE) -> DOUBLE
  
  
  LINE 15:     SUM(pricing_model) as total_cost,
               ^.
[0m23:50:37.241566 [debug] [MainThread]: Using duckdb connection "master"
[0m23:50:37.241833 [debug] [MainThread]: On master: BEGIN
[0m23:50:37.241997 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:50:37.242592 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m23:50:37.243150 [debug] [MainThread]: On master: COMMIT
[0m23:50:37.243848 [debug] [MainThread]: Using duckdb connection "master"
[0m23:50:37.244096 [debug] [MainThread]: On master: COMMIT
[0m23:50:37.244626 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m23:50:37.244908 [debug] [MainThread]: On master: Close
[0m23:50:37.245475 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:50:37.245704 [debug] [MainThread]: Connection 'model.supercell.total_cost' was properly closed.
[0m23:50:37.245955 [info ] [MainThread]: 
[0m23:50:37.246173 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.11 seconds (0.11s).
[0m23:50:37.246595 [debug] [MainThread]: Command end result
[0m23:50:37.255541 [debug] [MainThread]: Wrote artifact WritableManifest to /home/harsha/data_actions/supercell_dbt/target/manifest.json
[0m23:50:37.256444 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/harsha/data_actions/supercell_dbt/target/semantic_manifest.json
[0m23:50:37.259706 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/harsha/data_actions/supercell_dbt/target/run_results.json
[0m23:50:37.259917 [info ] [MainThread]: 
[0m23:50:37.260141 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m23:50:37.260334 [info ] [MainThread]: 
[0m23:50:37.260547 [error] [MainThread]:   Runtime Error in model total_cost (models/supercell_models/metrics/total_cost.sql)
  Binder Error: No function matches the given name and argument types 'sum(VARCHAR)'. You might need to add explicit type casts.
  	Candidate functions:
  	sum(DECIMAL) -> DECIMAL
  	sum(BOOLEAN) -> HUGEINT
  	sum(SMALLINT) -> HUGEINT
  	sum(INTEGER) -> HUGEINT
  	sum(BIGINT) -> HUGEINT
  	sum(HUGEINT) -> HUGEINT
  	sum(DOUBLE) -> DOUBLE
  
  
  LINE 15:     SUM(pricing_model) as total_cost,
               ^
[0m23:50:37.260716 [info ] [MainThread]: 
[0m23:50:37.260905 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m23:50:37.261449 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.59624594, "process_in_blocks": "2128", "process_kernel_time": 0.081771, "process_mem_max_rss": "148224", "process_out_blocks": "2704", "process_user_time": 1.307352}
[0m23:50:37.261744 [debug] [MainThread]: Command `dbt run` failed at 23:50:37.261678 after 0.60 seconds
[0m23:50:37.261974 [debug] [MainThread]: Flushing usage events


============================== 23:50:53.045568 | 471dba94-f3b8-4899-a63b-838aac5926c0 ==============================
[0m23:50:53.045568 [info ] [MainThread]: Running with dbt=1.9.4
[0m23:50:53.047604 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/home/harsha/data_actions/supercell_dbt', 'log_path': '/home/harsha/data_actions/supercell_dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --select models/supercell_models/metrics/total_cost.sql', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'False'}
[0m23:50:53.047844 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality

User config should be moved from the 'config' key in profiles.yml to the 'flags' key in dbt_project.yml.
[0m23:50:53.203389 [info ] [MainThread]: Registered adapter: duckdb=1.9.3
[0m23:50:53.240663 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m23:50:53.293239 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m23:50:53.293646 [debug] [MainThread]: Partial parsing: updated file: supercell://models/supercell_models/metrics/total_cost.sql
[0m23:50:53.471582 [debug] [MainThread]: Wrote artifact WritableManifest to /home/harsha/data_actions/supercell_dbt/target/manifest.json
[0m23:50:53.472522 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/harsha/data_actions/supercell_dbt/target/semantic_manifest.json
[0m23:50:53.478981 [info ] [MainThread]: Found 4 models, 4 data tests, 428 macros
[0m23:50:53.480399 [info ] [MainThread]: 
[0m23:50:53.480700 [info ] [MainThread]: Concurrency: 4 threads (target='default')
[0m23:50:53.480877 [info ] [MainThread]: 
[0m23:50:53.481161 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m23:50:53.481871 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_supercell'
[0m23:50:53.502107 [debug] [ThreadPool]: Using duckdb connection "list_supercell"
[0m23:50:53.502411 [debug] [ThreadPool]: On list_supercell: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "connection_name": "list_supercell"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"supercell"'
    
  
  
[0m23:50:53.502588 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:50:53.510593 [debug] [ThreadPool]: SQL status: OK in 0.008 seconds
[0m23:50:53.511474 [debug] [ThreadPool]: On list_supercell: Close
[0m23:50:53.511952 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_supercell, now create_supercell_main)
[0m23:50:53.512237 [debug] [ThreadPool]: Creating schema "database: "supercell"
schema: "main"
"
[0m23:50:53.516065 [debug] [ThreadPool]: Using duckdb connection "create_supercell_main"
[0m23:50:53.516299 [debug] [ThreadPool]: On create_supercell_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "connection_name": "create_supercell_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='supercell'
        and type='sqlite'
    
  
[0m23:50:53.516463 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:50:53.517065 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m23:50:53.517821 [debug] [ThreadPool]: Using duckdb connection "create_supercell_main"
[0m23:50:53.518003 [debug] [ThreadPool]: On create_supercell_main: BEGIN
[0m23:50:53.518275 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m23:50:53.518453 [debug] [ThreadPool]: Using duckdb connection "create_supercell_main"
[0m23:50:53.518589 [debug] [ThreadPool]: On create_supercell_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "connection_name": "create_supercell_main"} */

    
    
        create schema if not exists "supercell"."main"
    
[0m23:50:53.518843 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m23:50:53.519300 [debug] [ThreadPool]: On create_supercell_main: COMMIT
[0m23:50:53.519507 [debug] [ThreadPool]: Using duckdb connection "create_supercell_main"
[0m23:50:53.519658 [debug] [ThreadPool]: On create_supercell_main: COMMIT
[0m23:50:53.520078 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m23:50:53.520275 [debug] [ThreadPool]: On create_supercell_main: Close
[0m23:50:53.523653 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_supercell_main, now list_supercell_main)
[0m23:50:53.528650 [debug] [ThreadPool]: Using duckdb connection "list_supercell_main"
[0m23:50:53.528863 [debug] [ThreadPool]: On list_supercell_main: BEGIN
[0m23:50:53.529019 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:50:53.529424 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m23:50:53.529596 [debug] [ThreadPool]: Using duckdb connection "list_supercell_main"
[0m23:50:53.529748 [debug] [ThreadPool]: On list_supercell_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "connection_name": "list_supercell_main"} */
select
      'supercell' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'supercell'
  
[0m23:50:53.537775 [debug] [ThreadPool]: SQL status: OK in 0.008 seconds
[0m23:50:53.538584 [debug] [ThreadPool]: On list_supercell_main: ROLLBACK
[0m23:50:53.539216 [debug] [ThreadPool]: Failed to rollback 'list_supercell_main'
[0m23:50:53.539420 [debug] [ThreadPool]: On list_supercell_main: Close
[0m23:50:53.540200 [debug] [MainThread]: Using duckdb connection "master"
[0m23:50:53.540427 [debug] [MainThread]: On master: BEGIN
[0m23:50:53.540576 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:50:53.540903 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m23:50:53.541072 [debug] [MainThread]: On master: COMMIT
[0m23:50:53.541231 [debug] [MainThread]: Using duckdb connection "master"
[0m23:50:53.541390 [debug] [MainThread]: On master: COMMIT
[0m23:50:53.541626 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m23:50:53.541790 [debug] [MainThread]: On master: Close
[0m23:50:53.543631 [debug] [Thread-1 (]: Began running node model.supercell.total_cost
[0m23:50:53.544159 [info ] [Thread-1 (]: 1 of 1 START sql table model main.total_cost ................................... [RUN]
[0m23:50:53.544603 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_supercell_main, now model.supercell.total_cost)
[0m23:50:53.544960 [debug] [Thread-1 (]: Began compiling node model.supercell.total_cost
[0m23:50:53.551875 [debug] [Thread-1 (]: Writing injected SQL for node "model.supercell.total_cost"
[0m23:50:53.552362 [debug] [Thread-1 (]: Began executing node model.supercell.total_cost
[0m23:50:53.570454 [debug] [Thread-1 (]: Writing runtime sql for node "model.supercell.total_cost"
[0m23:50:53.570858 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.total_cost"
[0m23:50:53.571082 [debug] [Thread-1 (]: On model.supercell.total_cost: BEGIN
[0m23:50:53.571254 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:50:53.571876 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m23:50:53.572075 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.total_cost"
[0m23:50:53.572242 [debug] [Thread-1 (]: On model.supercell.total_cost: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.total_cost"} */

  
    
    

    create  table
      "supercell"."main"."total_cost__dbt_tmp"
  
    as (
      


select 
    SUM(pricing_model) as total_cost,
    region,
    instance_type,
    pricing_model,
    service_code,
    tag_keys as tag_types
from "supercell"."main"."cleaned_usagelogs"
group by region, instance_type, pricing_model, service_code, tag_keys
    );
  
  
[0m23:50:53.572887 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.total_cost"} */

  
    
    

    create  table
      "supercell"."main"."total_cost__dbt_tmp"
  
    as (
      


select 
    SUM(pricing_model) as total_cost,
    region,
    instance_type,
    pricing_model,
    service_code,
    tag_keys as tag_types
from "supercell"."main"."cleaned_usagelogs"
group by region, instance_type, pricing_model, service_code, tag_keys
    );
  
  
[0m23:50:53.573114 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m23:50:53.573362 [debug] [Thread-1 (]: On model.supercell.total_cost: ROLLBACK
[0m23:50:53.575301 [debug] [Thread-1 (]: Failed to rollback 'model.supercell.total_cost'
[0m23:50:53.575523 [debug] [Thread-1 (]: On model.supercell.total_cost: Close
[0m23:50:53.576771 [debug] [Thread-1 (]: Runtime Error in model total_cost (models/supercell_models/metrics/total_cost.sql)
  Binder Error: No function matches the given name and argument types 'sum(VARCHAR)'. You might need to add explicit type casts.
  	Candidate functions:
  	sum(DECIMAL) -> DECIMAL
  	sum(BOOLEAN) -> HUGEINT
  	sum(SMALLINT) -> HUGEINT
  	sum(INTEGER) -> HUGEINT
  	sum(BIGINT) -> HUGEINT
  	sum(HUGEINT) -> HUGEINT
  	sum(DOUBLE) -> DOUBLE
  
  
  LINE 15:     SUM(pricing_model) as total_cost,
               ^
[0m23:50:53.577847 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model main.total_cost .......................... [[31mERROR[0m in 0.03s]
[0m23:50:53.578206 [debug] [Thread-1 (]: Finished running node model.supercell.total_cost
[0m23:50:53.578743 [debug] [Thread-7 (]: Marking all children of 'model.supercell.total_cost' to be skipped because of status 'error'.  Reason: Runtime Error in model total_cost (models/supercell_models/metrics/total_cost.sql)
  Binder Error: No function matches the given name and argument types 'sum(VARCHAR)'. You might need to add explicit type casts.
  	Candidate functions:
  	sum(DECIMAL) -> DECIMAL
  	sum(BOOLEAN) -> HUGEINT
  	sum(SMALLINT) -> HUGEINT
  	sum(INTEGER) -> HUGEINT
  	sum(BIGINT) -> HUGEINT
  	sum(HUGEINT) -> HUGEINT
  	sum(DOUBLE) -> DOUBLE
  
  
  LINE 15:     SUM(pricing_model) as total_cost,
               ^.
[0m23:50:53.580876 [debug] [MainThread]: Using duckdb connection "master"
[0m23:50:53.581269 [debug] [MainThread]: On master: BEGIN
[0m23:50:53.581501 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:50:53.582318 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m23:50:53.582630 [debug] [MainThread]: On master: COMMIT
[0m23:50:53.582833 [debug] [MainThread]: Using duckdb connection "master"
[0m23:50:53.583011 [debug] [MainThread]: On master: COMMIT
[0m23:50:53.583343 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m23:50:53.583674 [debug] [MainThread]: On master: Close
[0m23:50:53.584172 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:50:53.584408 [debug] [MainThread]: Connection 'model.supercell.total_cost' was properly closed.
[0m23:50:53.584652 [info ] [MainThread]: 
[0m23:50:53.584857 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.10 seconds (0.10s).
[0m23:50:53.585258 [debug] [MainThread]: Command end result
[0m23:50:53.594793 [debug] [MainThread]: Wrote artifact WritableManifest to /home/harsha/data_actions/supercell_dbt/target/manifest.json
[0m23:50:53.595709 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/harsha/data_actions/supercell_dbt/target/semantic_manifest.json
[0m23:50:53.598941 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/harsha/data_actions/supercell_dbt/target/run_results.json
[0m23:50:53.599143 [info ] [MainThread]: 
[0m23:50:53.599414 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m23:50:53.599602 [info ] [MainThread]: 
[0m23:50:53.599818 [error] [MainThread]:   Runtime Error in model total_cost (models/supercell_models/metrics/total_cost.sql)
  Binder Error: No function matches the given name and argument types 'sum(VARCHAR)'. You might need to add explicit type casts.
  	Candidate functions:
  	sum(DECIMAL) -> DECIMAL
  	sum(BOOLEAN) -> HUGEINT
  	sum(SMALLINT) -> HUGEINT
  	sum(INTEGER) -> HUGEINT
  	sum(BIGINT) -> HUGEINT
  	sum(HUGEINT) -> HUGEINT
  	sum(DOUBLE) -> DOUBLE
  
  
  LINE 15:     SUM(pricing_model) as total_cost,
               ^
[0m23:50:53.599980 [info ] [MainThread]: 
[0m23:50:53.600219 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m23:50:53.601732 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.58571744, "process_in_blocks": "0", "process_kernel_time": 0.089553, "process_mem_max_rss": "147780", "process_out_blocks": "2704", "process_user_time": 1.301516}
[0m23:50:53.602297 [debug] [MainThread]: Command `dbt run` failed at 23:50:53.602171 after 0.59 seconds
[0m23:50:53.602604 [debug] [MainThread]: Flushing usage events


============================== 23:51:33.391309 | 1a40d8d7-41bb-49cf-b2d7-83efff86b036 ==============================
[0m23:51:33.391309 [info ] [MainThread]: Running with dbt=1.9.4
[0m23:51:33.396476 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/harsha/data_actions/supercell_dbt', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/harsha/data_actions/supercell_dbt/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt run --select models/supercell_models/metrics/total_cost.sql', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'False'}
[0m23:51:33.397192 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality

User config should be moved from the 'config' key in profiles.yml to the 'flags' key in dbt_project.yml.
[0m23:51:33.736996 [info ] [MainThread]: Registered adapter: duckdb=1.9.3
[0m23:51:33.807619 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m23:51:33.915567 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m23:51:33.916309 [debug] [MainThread]: Partial parsing: updated file: supercell://models/supercell_models/metrics/total_cost.sql
[0m23:51:34.297519 [debug] [MainThread]: Wrote artifact WritableManifest to /home/harsha/data_actions/supercell_dbt/target/manifest.json
[0m23:51:34.299401 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/harsha/data_actions/supercell_dbt/target/semantic_manifest.json
[0m23:51:34.312106 [info ] [MainThread]: Found 4 models, 4 data tests, 428 macros
[0m23:51:34.314901 [info ] [MainThread]: 
[0m23:51:34.315524 [info ] [MainThread]: Concurrency: 4 threads (target='default')
[0m23:51:34.315900 [info ] [MainThread]: 
[0m23:51:34.316494 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m23:51:34.318062 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_supercell'
[0m23:51:34.357288 [debug] [ThreadPool]: Using duckdb connection "list_supercell"
[0m23:51:34.357871 [debug] [ThreadPool]: On list_supercell: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "connection_name": "list_supercell"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"supercell"'
    
  
  
[0m23:51:34.358234 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:51:34.372313 [debug] [ThreadPool]: SQL status: OK in 0.014 seconds
[0m23:51:34.373958 [debug] [ThreadPool]: On list_supercell: Close
[0m23:51:34.374919 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_supercell, now create_supercell_main)
[0m23:51:34.375512 [debug] [ThreadPool]: Creating schema "database: "supercell"
schema: "main"
"
[0m23:51:34.383269 [debug] [ThreadPool]: Using duckdb connection "create_supercell_main"
[0m23:51:34.383710 [debug] [ThreadPool]: On create_supercell_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "connection_name": "create_supercell_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='supercell'
        and type='sqlite'
    
  
[0m23:51:34.384051 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:51:34.385489 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m23:51:34.387040 [debug] [ThreadPool]: Using duckdb connection "create_supercell_main"
[0m23:51:34.387474 [debug] [ThreadPool]: On create_supercell_main: BEGIN
[0m23:51:34.388022 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m23:51:34.388377 [debug] [ThreadPool]: Using duckdb connection "create_supercell_main"
[0m23:51:34.388681 [debug] [ThreadPool]: On create_supercell_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "connection_name": "create_supercell_main"} */

    
    
        create schema if not exists "supercell"."main"
    
[0m23:51:34.389219 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m23:51:34.390203 [debug] [ThreadPool]: On create_supercell_main: COMMIT
[0m23:51:34.390627 [debug] [ThreadPool]: Using duckdb connection "create_supercell_main"
[0m23:51:34.390965 [debug] [ThreadPool]: On create_supercell_main: COMMIT
[0m23:51:34.391568 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m23:51:34.391950 [debug] [ThreadPool]: On create_supercell_main: Close
[0m23:51:34.398742 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_supercell_main, now list_supercell_main)
[0m23:51:34.407155 [debug] [ThreadPool]: Using duckdb connection "list_supercell_main"
[0m23:51:34.407611 [debug] [ThreadPool]: On list_supercell_main: BEGIN
[0m23:51:34.407943 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:51:34.408716 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m23:51:34.409065 [debug] [ThreadPool]: Using duckdb connection "list_supercell_main"
[0m23:51:34.409388 [debug] [ThreadPool]: On list_supercell_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "connection_name": "list_supercell_main"} */
select
      'supercell' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'supercell'
  
[0m23:51:34.425347 [debug] [ThreadPool]: SQL status: OK in 0.016 seconds
[0m23:51:34.426999 [debug] [ThreadPool]: On list_supercell_main: ROLLBACK
[0m23:51:34.428303 [debug] [ThreadPool]: Failed to rollback 'list_supercell_main'
[0m23:51:34.428707 [debug] [ThreadPool]: On list_supercell_main: Close
[0m23:51:34.430392 [debug] [MainThread]: Using duckdb connection "master"
[0m23:51:34.430930 [debug] [MainThread]: On master: BEGIN
[0m23:51:34.431418 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:51:34.432359 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m23:51:34.432904 [debug] [MainThread]: On master: COMMIT
[0m23:51:34.433261 [debug] [MainThread]: Using duckdb connection "master"
[0m23:51:34.433605 [debug] [MainThread]: On master: COMMIT
[0m23:51:34.434175 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m23:51:34.434565 [debug] [MainThread]: On master: Close
[0m23:51:34.438542 [debug] [Thread-1 (]: Began running node model.supercell.total_cost
[0m23:51:34.439593 [info ] [Thread-1 (]: 1 of 1 START sql table model main.total_cost ................................... [RUN]
[0m23:51:34.440499 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_supercell_main, now model.supercell.total_cost)
[0m23:51:34.441226 [debug] [Thread-1 (]: Began compiling node model.supercell.total_cost
[0m23:51:34.454752 [debug] [Thread-1 (]: Writing injected SQL for node "model.supercell.total_cost"
[0m23:51:34.456010 [debug] [Thread-1 (]: Began executing node model.supercell.total_cost
[0m23:51:34.508927 [debug] [Thread-1 (]: Writing runtime sql for node "model.supercell.total_cost"
[0m23:51:34.509883 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.total_cost"
[0m23:51:34.510371 [debug] [Thread-1 (]: On model.supercell.total_cost: BEGIN
[0m23:51:34.510753 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:51:34.511801 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m23:51:34.512261 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.total_cost"
[0m23:51:34.512670 [debug] [Thread-1 (]: On model.supercell.total_cost: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.total_cost"} */

  
    
    

    create  table
      "supercell"."main"."total_cost__dbt_tmp"
  
    as (
      


select 
    region,
    instance_type,
    pricing_model,
    service_code,
    tag_keys as tag_types,
    SUM(pricing_model) as total_cost
from "supercell"."main"."cleaned_usagelogs"
group by region, instance_type, pricing_model, service_code, tag_keys
    );
  
  
[0m23:51:34.513829 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.total_cost"} */

  
    
    

    create  table
      "supercell"."main"."total_cost__dbt_tmp"
  
    as (
      


select 
    region,
    instance_type,
    pricing_model,
    service_code,
    tag_keys as tag_types,
    SUM(pricing_model) as total_cost
from "supercell"."main"."cleaned_usagelogs"
group by region, instance_type, pricing_model, service_code, tag_keys
    );
  
  
[0m23:51:34.514328 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m23:51:34.514931 [debug] [Thread-1 (]: On model.supercell.total_cost: ROLLBACK
[0m23:51:34.518893 [debug] [Thread-1 (]: Failed to rollback 'model.supercell.total_cost'
[0m23:51:34.519368 [debug] [Thread-1 (]: On model.supercell.total_cost: Close
[0m23:51:34.522189 [debug] [Thread-1 (]: Runtime Error in model total_cost (models/supercell_models/metrics/total_cost.sql)
  Binder Error: No function matches the given name and argument types 'sum(VARCHAR)'. You might need to add explicit type casts.
  	Candidate functions:
  	sum(DECIMAL) -> DECIMAL
  	sum(BOOLEAN) -> HUGEINT
  	sum(SMALLINT) -> HUGEINT
  	sum(INTEGER) -> HUGEINT
  	sum(BIGINT) -> HUGEINT
  	sum(HUGEINT) -> HUGEINT
  	sum(DOUBLE) -> DOUBLE
  
  
  LINE 20:     SUM(pricing_model) as total_cost
               ^
[0m23:51:34.524425 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model main.total_cost .......................... [[31mERROR[0m in 0.08s]
[0m23:51:34.525171 [debug] [Thread-1 (]: Finished running node model.supercell.total_cost
[0m23:51:34.526300 [debug] [Thread-7 (]: Marking all children of 'model.supercell.total_cost' to be skipped because of status 'error'.  Reason: Runtime Error in model total_cost (models/supercell_models/metrics/total_cost.sql)
  Binder Error: No function matches the given name and argument types 'sum(VARCHAR)'. You might need to add explicit type casts.
  	Candidate functions:
  	sum(DECIMAL) -> DECIMAL
  	sum(BOOLEAN) -> HUGEINT
  	sum(SMALLINT) -> HUGEINT
  	sum(INTEGER) -> HUGEINT
  	sum(BIGINT) -> HUGEINT
  	sum(HUGEINT) -> HUGEINT
  	sum(DOUBLE) -> DOUBLE
  
  
  LINE 20:     SUM(pricing_model) as total_cost
               ^.
[0m23:51:34.529973 [debug] [MainThread]: Using duckdb connection "master"
[0m23:51:34.530800 [debug] [MainThread]: On master: BEGIN
[0m23:51:34.531482 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:51:34.533481 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m23:51:34.534232 [debug] [MainThread]: On master: COMMIT
[0m23:51:34.534922 [debug] [MainThread]: Using duckdb connection "master"
[0m23:51:34.535638 [debug] [MainThread]: On master: COMMIT
[0m23:51:34.537181 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m23:51:34.537999 [debug] [MainThread]: On master: Close
[0m23:51:34.539320 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:51:34.539887 [debug] [MainThread]: Connection 'model.supercell.total_cost' was properly closed.
[0m23:51:34.540407 [info ] [MainThread]: 
[0m23:51:34.540931 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.22 seconds (0.22s).
[0m23:51:34.542014 [debug] [MainThread]: Command end result
[0m23:51:34.569736 [debug] [MainThread]: Wrote artifact WritableManifest to /home/harsha/data_actions/supercell_dbt/target/manifest.json
[0m23:51:34.572328 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/harsha/data_actions/supercell_dbt/target/semantic_manifest.json
[0m23:51:34.582323 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/harsha/data_actions/supercell_dbt/target/run_results.json
[0m23:51:34.583017 [info ] [MainThread]: 
[0m23:51:34.583707 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m23:51:34.584221 [info ] [MainThread]: 
[0m23:51:34.584878 [error] [MainThread]:   Runtime Error in model total_cost (models/supercell_models/metrics/total_cost.sql)
  Binder Error: No function matches the given name and argument types 'sum(VARCHAR)'. You might need to add explicit type casts.
  	Candidate functions:
  	sum(DECIMAL) -> DECIMAL
  	sum(BOOLEAN) -> HUGEINT
  	sum(SMALLINT) -> HUGEINT
  	sum(INTEGER) -> HUGEINT
  	sum(BIGINT) -> HUGEINT
  	sum(HUGEINT) -> HUGEINT
  	sum(DOUBLE) -> DOUBLE
  
  
  LINE 20:     SUM(pricing_model) as total_cost
               ^
[0m23:51:34.585375 [info ] [MainThread]: 
[0m23:51:34.585851 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m23:51:34.587106 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.258159, "process_in_blocks": "0", "process_kernel_time": 0.16986, "process_mem_max_rss": "147668", "process_out_blocks": "2704", "process_user_time": 2.725755}
[0m23:51:34.587828 [debug] [MainThread]: Command `dbt run` failed at 23:51:34.587683 after 1.26 seconds
[0m23:51:34.588313 [debug] [MainThread]: Flushing usage events


============================== 23:53:53.636111 | 9d9f0b42-db7c-4ef8-a4c3-7715281f86f5 ==============================
[0m23:53:53.636111 [info ] [MainThread]: Running with dbt=1.9.4
[0m23:53:53.641522 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/harsha/data_actions/supercell_dbt/logs', 'debug': 'False', 'profiles_dir': '/home/harsha/data_actions/supercell_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --select models/supercell_models/metrics/total_cost.sql', 'send_anonymous_usage_stats': 'False'}
[0m23:53:53.642222 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality

User config should be moved from the 'config' key in profiles.yml to the 'flags' key in dbt_project.yml.
[0m23:53:53.958538 [info ] [MainThread]: Registered adapter: duckdb=1.9.3
[0m23:53:54.051203 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m23:53:54.166588 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m23:53:54.167618 [debug] [MainThread]: Partial parsing: updated file: supercell://models/supercell_models/metrics/total_cost.sql
[0m23:53:54.550905 [debug] [MainThread]: Wrote artifact WritableManifest to /home/harsha/data_actions/supercell_dbt/target/manifest.json
[0m23:53:54.552910 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/harsha/data_actions/supercell_dbt/target/semantic_manifest.json
[0m23:53:54.566176 [info ] [MainThread]: Found 4 models, 4 data tests, 428 macros
[0m23:53:54.568987 [info ] [MainThread]: 
[0m23:53:54.569617 [info ] [MainThread]: Concurrency: 4 threads (target='default')
[0m23:53:54.570040 [info ] [MainThread]: 
[0m23:53:54.570656 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m23:53:54.572046 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_supercell'
[0m23:53:54.613021 [debug] [ThreadPool]: Using duckdb connection "list_supercell"
[0m23:53:54.613582 [debug] [ThreadPool]: On list_supercell: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "connection_name": "list_supercell"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"supercell"'
    
  
  
[0m23:53:54.613955 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m23:53:54.628021 [debug] [ThreadPool]: SQL status: OK in 0.014 seconds
[0m23:53:54.629787 [debug] [ThreadPool]: On list_supercell: Close
[0m23:53:54.630735 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_supercell, now create_supercell_main)
[0m23:53:54.631324 [debug] [ThreadPool]: Creating schema "database: "supercell"
schema: "main"
"
[0m23:53:54.639163 [debug] [ThreadPool]: Using duckdb connection "create_supercell_main"
[0m23:53:54.639606 [debug] [ThreadPool]: On create_supercell_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "connection_name": "create_supercell_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='supercell'
        and type='sqlite'
    
  
[0m23:53:54.639948 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:53:54.641107 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m23:53:54.642679 [debug] [ThreadPool]: Using duckdb connection "create_supercell_main"
[0m23:53:54.643081 [debug] [ThreadPool]: On create_supercell_main: BEGIN
[0m23:53:54.643689 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m23:53:54.644022 [debug] [ThreadPool]: Using duckdb connection "create_supercell_main"
[0m23:53:54.644332 [debug] [ThreadPool]: On create_supercell_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "connection_name": "create_supercell_main"} */

    
    
        create schema if not exists "supercell"."main"
    
[0m23:53:54.644925 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m23:53:54.645925 [debug] [ThreadPool]: On create_supercell_main: COMMIT
[0m23:53:54.646339 [debug] [ThreadPool]: Using duckdb connection "create_supercell_main"
[0m23:53:54.646686 [debug] [ThreadPool]: On create_supercell_main: COMMIT
[0m23:53:54.647191 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m23:53:54.647564 [debug] [ThreadPool]: On create_supercell_main: Close
[0m23:53:54.654396 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_supercell_main, now list_supercell_main)
[0m23:53:54.663707 [debug] [ThreadPool]: Using duckdb connection "list_supercell_main"
[0m23:53:54.664344 [debug] [ThreadPool]: On list_supercell_main: BEGIN
[0m23:53:54.664929 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m23:53:54.666151 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m23:53:54.666785 [debug] [ThreadPool]: Using duckdb connection "list_supercell_main"
[0m23:53:54.667384 [debug] [ThreadPool]: On list_supercell_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "connection_name": "list_supercell_main"} */
select
      'supercell' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'supercell'
  
[0m23:53:54.688177 [debug] [ThreadPool]: SQL status: OK in 0.020 seconds
[0m23:53:54.689919 [debug] [ThreadPool]: On list_supercell_main: ROLLBACK
[0m23:53:54.691232 [debug] [ThreadPool]: Failed to rollback 'list_supercell_main'
[0m23:53:54.691673 [debug] [ThreadPool]: On list_supercell_main: Close
[0m23:53:54.693140 [debug] [MainThread]: Using duckdb connection "master"
[0m23:53:54.693587 [debug] [MainThread]: On master: BEGIN
[0m23:53:54.693953 [debug] [MainThread]: Opening a new connection, currently in state init
[0m23:53:54.694715 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m23:53:54.695089 [debug] [MainThread]: On master: COMMIT
[0m23:53:54.695513 [debug] [MainThread]: Using duckdb connection "master"
[0m23:53:54.695826 [debug] [MainThread]: On master: COMMIT
[0m23:53:54.696318 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m23:53:54.696696 [debug] [MainThread]: On master: Close
[0m23:53:54.700931 [debug] [Thread-1 (]: Began running node model.supercell.total_cost
[0m23:53:54.701930 [info ] [Thread-1 (]: 1 of 1 START sql table model main.total_cost ................................... [RUN]
[0m23:53:54.702562 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_supercell_main, now model.supercell.total_cost)
[0m23:53:54.702997 [debug] [Thread-1 (]: Began compiling node model.supercell.total_cost
[0m23:53:54.714065 [debug] [Thread-1 (]: Writing injected SQL for node "model.supercell.total_cost"
[0m23:53:54.715416 [debug] [Thread-1 (]: Began executing node model.supercell.total_cost
[0m23:53:54.760080 [debug] [Thread-1 (]: Writing runtime sql for node "model.supercell.total_cost"
[0m23:53:54.760943 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.total_cost"
[0m23:53:54.761393 [debug] [Thread-1 (]: On model.supercell.total_cost: BEGIN
[0m23:53:54.761755 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m23:53:54.762791 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m23:53:54.763200 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.total_cost"
[0m23:53:54.763650 [debug] [Thread-1 (]: On model.supercell.total_cost: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.total_cost"} */

  
    
    

    create  table
      "supercell"."main"."total_cost__dbt_tmp"
  
    as (
      


select 
    region,
    instance_type,
    pricing_model,
    service_code,
    tag_keys as tag_types,
    SUM(amortized_cost) as total_cost
from "supercell"."main"."cleaned_usagelogs"
group by region, instance_type, pricing_model, service_code, tag_keys
    );
  
  
[0m23:53:54.778902 [debug] [Thread-1 (]: SQL status: OK in 0.015 seconds
[0m23:53:54.788065 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.total_cost"
[0m23:53:54.788614 [debug] [Thread-1 (]: On model.supercell.total_cost: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.total_cost"} */
alter table "supercell"."main"."total_cost__dbt_tmp" rename to "total_cost"
[0m23:53:54.789616 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m23:53:54.805790 [debug] [Thread-1 (]: On model.supercell.total_cost: COMMIT
[0m23:53:54.806352 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.total_cost"
[0m23:53:54.806766 [debug] [Thread-1 (]: On model.supercell.total_cost: COMMIT
[0m23:53:54.809991 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m23:53:54.815797 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.total_cost"
[0m23:53:54.816335 [debug] [Thread-1 (]: On model.supercell.total_cost: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.total_cost"} */
drop table if exists "supercell"."main"."total_cost__dbt_backup" cascade
[0m23:53:54.817166 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m23:53:54.820087 [debug] [Thread-1 (]: On model.supercell.total_cost: Close
[0m23:53:54.823133 [info ] [Thread-1 (]: 1 of 1 OK created sql table model main.total_cost .............................. [[32mOK[0m in 0.12s]
[0m23:53:54.823856 [debug] [Thread-1 (]: Finished running node model.supercell.total_cost
[0m23:53:54.826309 [debug] [MainThread]: Using duckdb connection "master"
[0m23:53:54.826838 [debug] [MainThread]: On master: BEGIN
[0m23:53:54.827188 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m23:53:54.828052 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m23:53:54.828469 [debug] [MainThread]: On master: COMMIT
[0m23:53:54.828792 [debug] [MainThread]: Using duckdb connection "master"
[0m23:53:54.829086 [debug] [MainThread]: On master: COMMIT
[0m23:53:54.829845 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m23:53:54.830490 [debug] [MainThread]: On master: Close
[0m23:53:54.831497 [debug] [MainThread]: Connection 'master' was properly closed.
[0m23:53:54.831915 [debug] [MainThread]: Connection 'model.supercell.total_cost' was properly closed.
[0m23:53:54.832315 [info ] [MainThread]: 
[0m23:53:54.832790 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.26 seconds (0.26s).
[0m23:53:54.833646 [debug] [MainThread]: Command end result
[0m23:53:54.862601 [debug] [MainThread]: Wrote artifact WritableManifest to /home/harsha/data_actions/supercell_dbt/target/manifest.json
[0m23:53:54.866176 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/harsha/data_actions/supercell_dbt/target/semantic_manifest.json
[0m23:53:54.876938 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/harsha/data_actions/supercell_dbt/target/run_results.json
[0m23:53:54.877578 [info ] [MainThread]: 
[0m23:53:54.878197 [info ] [MainThread]: [32mCompleted successfully[0m
[0m23:53:54.878674 [info ] [MainThread]: 
[0m23:53:54.879134 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m23:53:54.880651 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.3071297, "process_in_blocks": "448", "process_kernel_time": 0.196852, "process_mem_max_rss": "151696", "process_out_blocks": "2712", "process_user_time": 2.883488}
[0m23:53:54.881418 [debug] [MainThread]: Command `dbt run` succeeded at 23:53:54.881247 after 1.31 seconds
[0m23:53:54.881956 [debug] [MainThread]: Flushing usage events


============================== 00:03:01.114683 | ac07144f-0cfe-4338-b3fa-8dbb5e720b30 ==============================
[0m00:03:01.114683 [info ] [MainThread]: Running with dbt=1.9.4
[0m00:03:01.119830 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/home/harsha/data_actions/supercell_dbt', 'log_path': '/home/harsha/data_actions/supercell_dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select models/supercell_models/metrics/total_cost.sql', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'False'}
[0m00:03:01.120509 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality

User config should be moved from the 'config' key in profiles.yml to the 'flags' key in dbt_project.yml.
[0m00:03:01.456166 [info ] [MainThread]: Registered adapter: duckdb=1.9.3
[0m00:03:01.532798 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m00:03:01.641250 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m00:03:01.642003 [debug] [MainThread]: Partial parsing: updated file: supercell://models/supercell_models/metrics/total_cost.sql
[0m00:03:02.015761 [debug] [MainThread]: Wrote artifact WritableManifest to /home/harsha/data_actions/supercell_dbt/target/manifest.json
[0m00:03:02.017606 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/harsha/data_actions/supercell_dbt/target/semantic_manifest.json
[0m00:03:02.030989 [info ] [MainThread]: Found 4 models, 4 data tests, 428 macros
[0m00:03:02.033963 [info ] [MainThread]: 
[0m00:03:02.034565 [info ] [MainThread]: Concurrency: 4 threads (target='default')
[0m00:03:02.034923 [info ] [MainThread]: 
[0m00:03:02.035495 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m00:03:02.036920 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_supercell'
[0m00:03:02.085155 [debug] [ThreadPool]: Using duckdb connection "list_supercell"
[0m00:03:02.085731 [debug] [ThreadPool]: On list_supercell: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "connection_name": "list_supercell"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"supercell"'
    
  
  
[0m00:03:02.086099 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:03:02.100480 [debug] [ThreadPool]: SQL status: OK in 0.014 seconds
[0m00:03:02.102178 [debug] [ThreadPool]: On list_supercell: Close
[0m00:03:02.103298 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_supercell, now create_supercell_main)
[0m00:03:02.103917 [debug] [ThreadPool]: Creating schema "database: "supercell"
schema: "main"
"
[0m00:03:02.111685 [debug] [ThreadPool]: Using duckdb connection "create_supercell_main"
[0m00:03:02.112157 [debug] [ThreadPool]: On create_supercell_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "connection_name": "create_supercell_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='supercell'
        and type='sqlite'
    
  
[0m00:03:02.112522 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:03:02.113781 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m00:03:02.115324 [debug] [ThreadPool]: Using duckdb connection "create_supercell_main"
[0m00:03:02.115747 [debug] [ThreadPool]: On create_supercell_main: BEGIN
[0m00:03:02.116314 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m00:03:02.116688 [debug] [ThreadPool]: Using duckdb connection "create_supercell_main"
[0m00:03:02.117003 [debug] [ThreadPool]: On create_supercell_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "connection_name": "create_supercell_main"} */

    
    
        create schema if not exists "supercell"."main"
    
[0m00:03:02.117574 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m00:03:02.118593 [debug] [ThreadPool]: On create_supercell_main: COMMIT
[0m00:03:02.118999 [debug] [ThreadPool]: Using duckdb connection "create_supercell_main"
[0m00:03:02.119339 [debug] [ThreadPool]: On create_supercell_main: COMMIT
[0m00:03:02.119830 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m00:03:02.120178 [debug] [ThreadPool]: On create_supercell_main: Close
[0m00:03:02.128649 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_supercell_main, now list_supercell_main)
[0m00:03:02.137599 [debug] [ThreadPool]: Using duckdb connection "list_supercell_main"
[0m00:03:02.138137 [debug] [ThreadPool]: On list_supercell_main: BEGIN
[0m00:03:02.138542 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:03:02.139658 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m00:03:02.140088 [debug] [ThreadPool]: Using duckdb connection "list_supercell_main"
[0m00:03:02.140484 [debug] [ThreadPool]: On list_supercell_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "connection_name": "list_supercell_main"} */
select
      'supercell' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'supercell'
  
[0m00:03:02.159642 [debug] [ThreadPool]: SQL status: OK in 0.019 seconds
[0m00:03:02.161640 [debug] [ThreadPool]: On list_supercell_main: ROLLBACK
[0m00:03:02.163105 [debug] [ThreadPool]: Failed to rollback 'list_supercell_main'
[0m00:03:02.163588 [debug] [ThreadPool]: On list_supercell_main: Close
[0m00:03:02.165599 [debug] [MainThread]: Using duckdb connection "master"
[0m00:03:02.166081 [debug] [MainThread]: On master: BEGIN
[0m00:03:02.166471 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:03:02.167225 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m00:03:02.167638 [debug] [MainThread]: On master: COMMIT
[0m00:03:02.167991 [debug] [MainThread]: Using duckdb connection "master"
[0m00:03:02.168341 [debug] [MainThread]: On master: COMMIT
[0m00:03:02.168967 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m00:03:02.169456 [debug] [MainThread]: On master: Close
[0m00:03:02.173762 [debug] [Thread-1 (]: Began running node model.supercell.total_cost
[0m00:03:02.174861 [info ] [Thread-1 (]: 1 of 1 START sql table model main.total_cost ................................... [RUN]
[0m00:03:02.175795 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_supercell_main, now model.supercell.total_cost)
[0m00:03:02.176552 [debug] [Thread-1 (]: Began compiling node model.supercell.total_cost
[0m00:03:02.191003 [debug] [Thread-1 (]: Writing injected SQL for node "model.supercell.total_cost"
[0m00:03:02.192260 [debug] [Thread-1 (]: Began executing node model.supercell.total_cost
[0m00:03:02.235507 [debug] [Thread-1 (]: Writing runtime sql for node "model.supercell.total_cost"
[0m00:03:02.236378 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.total_cost"
[0m00:03:02.236833 [debug] [Thread-1 (]: On model.supercell.total_cost: BEGIN
[0m00:03:02.237205 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:03:02.238203 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:03:02.238673 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.total_cost"
[0m00:03:02.239060 [debug] [Thread-1 (]: On model.supercell.total_cost: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.total_cost"} */

  
    
    

    create  table
      "supercell"."main"."total_cost__dbt_tmp"
  
    as (
      


select 
    region,
    instance_type,
    pricing_model,
    service_code,
    tag_keys as tag_values,
    SUM(amortized_cost) as total_cost
from "supercell"."main"."cleaned_usagelogs"
group by region, instance_type, pricing_model, service_code, tag_keys
    );
  
  
[0m00:03:02.255183 [debug] [Thread-1 (]: SQL status: OK in 0.016 seconds
[0m00:03:02.264151 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.total_cost"
[0m00:03:02.264711 [debug] [Thread-1 (]: On model.supercell.total_cost: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.total_cost"} */
alter table "supercell"."main"."total_cost" rename to "total_cost__dbt_backup"
[0m00:03:02.265716 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:03:02.268809 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.total_cost"
[0m00:03:02.269252 [debug] [Thread-1 (]: On model.supercell.total_cost: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.total_cost"} */
alter table "supercell"."main"."total_cost__dbt_tmp" rename to "total_cost"
[0m00:03:02.270049 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:03:02.288500 [debug] [Thread-1 (]: On model.supercell.total_cost: COMMIT
[0m00:03:02.289049 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.total_cost"
[0m00:03:02.289454 [debug] [Thread-1 (]: On model.supercell.total_cost: COMMIT
[0m00:03:02.292066 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m00:03:02.297971 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.total_cost"
[0m00:03:02.298467 [debug] [Thread-1 (]: On model.supercell.total_cost: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.total_cost"} */
drop table if exists "supercell"."main"."total_cost__dbt_backup" cascade
[0m00:03:02.300752 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m00:03:02.303666 [debug] [Thread-1 (]: On model.supercell.total_cost: Close
[0m00:03:02.306474 [info ] [Thread-1 (]: 1 of 1 OK created sql table model main.total_cost .............................. [[32mOK[0m in 0.13s]
[0m00:03:02.307188 [debug] [Thread-1 (]: Finished running node model.supercell.total_cost
[0m00:03:02.309775 [debug] [MainThread]: Using duckdb connection "master"
[0m00:03:02.310626 [debug] [MainThread]: On master: BEGIN
[0m00:03:02.311033 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:03:02.312069 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m00:03:02.312593 [debug] [MainThread]: On master: COMMIT
[0m00:03:02.312965 [debug] [MainThread]: Using duckdb connection "master"
[0m00:03:02.313297 [debug] [MainThread]: On master: COMMIT
[0m00:03:02.313884 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m00:03:02.314256 [debug] [MainThread]: On master: Close
[0m00:03:02.314934 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:03:02.315339 [debug] [MainThread]: Connection 'model.supercell.total_cost' was properly closed.
[0m00:03:02.315769 [info ] [MainThread]: 
[0m00:03:02.316208 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.28 seconds (0.28s).
[0m00:03:02.316984 [debug] [MainThread]: Command end result
[0m00:03:02.336356 [debug] [MainThread]: Wrote artifact WritableManifest to /home/harsha/data_actions/supercell_dbt/target/manifest.json
[0m00:03:02.338263 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/harsha/data_actions/supercell_dbt/target/semantic_manifest.json
[0m00:03:02.345055 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/harsha/data_actions/supercell_dbt/target/run_results.json
[0m00:03:02.345504 [info ] [MainThread]: 
[0m00:03:02.345970 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:03:02.346343 [info ] [MainThread]: 
[0m00:03:02.346717 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m00:03:02.347810 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.2960008, "process_in_blocks": "0", "process_kernel_time": 0.173877, "process_mem_max_rss": "149496", "process_out_blocks": "2720", "process_user_time": 2.811019}
[0m00:03:02.348390 [debug] [MainThread]: Command `dbt run` succeeded at 00:03:02.348259 after 1.30 seconds
[0m00:03:02.348784 [debug] [MainThread]: Flushing usage events


============================== 00:05:25.617906 | 6796d528-a0e6-4aed-84f4-b871e0d566c6 ==============================
[0m00:05:25.617906 [info ] [MainThread]: Running with dbt=1.9.4
[0m00:05:25.624468 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/harsha/data_actions/supercell_dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/harsha/data_actions/supercell_dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run --select models/example/supercell_logsfacts.sql', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'False'}
[0m00:05:25.625224 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality

User config should be moved from the 'config' key in profiles.yml to the 'flags' key in dbt_project.yml.
[0m00:05:25.952725 [info ] [MainThread]: Registered adapter: duckdb=1.9.3
[0m00:05:26.023915 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m00:05:26.134832 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m00:05:26.135572 [debug] [MainThread]: Partial parsing: updated file: supercell://models/supercell_models/metrics/total_cost.sql
[0m00:05:26.510725 [debug] [MainThread]: Wrote artifact WritableManifest to /home/harsha/data_actions/supercell_dbt/target/manifest.json
[0m00:05:26.512612 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/harsha/data_actions/supercell_dbt/target/semantic_manifest.json
[0m00:05:26.525800 [info ] [MainThread]: Found 4 models, 4 data tests, 428 macros
[0m00:05:26.527358 [warn ] [MainThread]: The selection criterion 'models/example/supercell_logsfacts.sql' does not match any enabled nodes
[0m00:05:26.528882 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m00:05:26.529618 [debug] [MainThread]: Command end result
[0m00:05:26.549251 [debug] [MainThread]: Wrote artifact WritableManifest to /home/harsha/data_actions/supercell_dbt/target/manifest.json
[0m00:05:26.551104 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/harsha/data_actions/supercell_dbt/target/semantic_manifest.json
[0m00:05:26.554666 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/harsha/data_actions/supercell_dbt/target/run_results.json
[0m00:05:26.555860 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.0021532, "process_in_blocks": "0", "process_kernel_time": 0.178628, "process_mem_max_rss": "123116", "process_out_blocks": "2672", "process_user_time": 2.474855}
[0m00:05:26.556443 [debug] [MainThread]: Command `dbt run` succeeded at 00:05:26.556317 after 1.00 seconds
[0m00:05:26.556840 [debug] [MainThread]: Flushing usage events


============================== 00:06:32.892428 | 862a689a-4bf6-4ade-bb1b-9304d4124c6b ==============================
[0m00:06:32.892428 [info ] [MainThread]: Running with dbt=1.9.4
[0m00:06:32.896362 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/harsha/data_actions/supercell_dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/home/harsha/data_actions/supercell_dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run --select models/supercell_models/metrics/total_cost.sql', 'send_anonymous_usage_stats': 'False'}
[0m00:06:32.896805 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality

User config should be moved from the 'config' key in profiles.yml to the 'flags' key in dbt_project.yml.
[0m00:06:33.215547 [info ] [MainThread]: Registered adapter: duckdb=1.9.3
[0m00:06:33.289957 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m00:06:33.401018 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:06:33.401588 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:06:33.517412 [debug] [MainThread]: Wrote artifact WritableManifest to /home/harsha/data_actions/supercell_dbt/target/manifest.json
[0m00:06:33.519182 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/harsha/data_actions/supercell_dbt/target/semantic_manifest.json
[0m00:06:33.532466 [info ] [MainThread]: Found 4 models, 4 data tests, 428 macros
[0m00:06:33.535236 [info ] [MainThread]: 
[0m00:06:33.535805 [info ] [MainThread]: Concurrency: 4 threads (target='default')
[0m00:06:33.536169 [info ] [MainThread]: 
[0m00:06:33.536762 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m00:06:33.538024 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_supercell'
[0m00:06:33.580357 [debug] [ThreadPool]: Using duckdb connection "list_supercell"
[0m00:06:33.580912 [debug] [ThreadPool]: On list_supercell: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "connection_name": "list_supercell"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"supercell"'
    
  
  
[0m00:06:33.581289 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:06:33.595973 [debug] [ThreadPool]: SQL status: OK in 0.015 seconds
[0m00:06:33.597726 [debug] [ThreadPool]: On list_supercell: Close
[0m00:06:33.598685 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_supercell, now create_supercell_main)
[0m00:06:33.599275 [debug] [ThreadPool]: Creating schema "database: "supercell"
schema: "main"
"
[0m00:06:33.607092 [debug] [ThreadPool]: Using duckdb connection "create_supercell_main"
[0m00:06:33.607540 [debug] [ThreadPool]: On create_supercell_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "connection_name": "create_supercell_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='supercell'
        and type='sqlite'
    
  
[0m00:06:33.607878 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:06:33.609045 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m00:06:33.610548 [debug] [ThreadPool]: Using duckdb connection "create_supercell_main"
[0m00:06:33.610923 [debug] [ThreadPool]: On create_supercell_main: BEGIN
[0m00:06:33.611502 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m00:06:33.611875 [debug] [ThreadPool]: Using duckdb connection "create_supercell_main"
[0m00:06:33.612187 [debug] [ThreadPool]: On create_supercell_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "connection_name": "create_supercell_main"} */

    
    
        create schema if not exists "supercell"."main"
    
[0m00:06:33.612790 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m00:06:33.613791 [debug] [ThreadPool]: On create_supercell_main: COMMIT
[0m00:06:33.614190 [debug] [ThreadPool]: Using duckdb connection "create_supercell_main"
[0m00:06:33.614547 [debug] [ThreadPool]: On create_supercell_main: COMMIT
[0m00:06:33.615048 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m00:06:33.615437 [debug] [ThreadPool]: On create_supercell_main: Close
[0m00:06:33.621915 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_supercell_main, now list_supercell_main)
[0m00:06:33.632345 [debug] [ThreadPool]: Using duckdb connection "list_supercell_main"
[0m00:06:33.632857 [debug] [ThreadPool]: On list_supercell_main: BEGIN
[0m00:06:33.633185 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:06:33.634101 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m00:06:33.634537 [debug] [ThreadPool]: Using duckdb connection "list_supercell_main"
[0m00:06:33.634859 [debug] [ThreadPool]: On list_supercell_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "connection_name": "list_supercell_main"} */
select
      'supercell' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'supercell'
  
[0m00:06:33.656515 [debug] [ThreadPool]: SQL status: OK in 0.021 seconds
[0m00:06:33.659830 [debug] [ThreadPool]: On list_supercell_main: ROLLBACK
[0m00:06:33.661132 [debug] [ThreadPool]: Failed to rollback 'list_supercell_main'
[0m00:06:33.661555 [debug] [ThreadPool]: On list_supercell_main: Close
[0m00:06:33.663120 [debug] [MainThread]: Using duckdb connection "master"
[0m00:06:33.663573 [debug] [MainThread]: On master: BEGIN
[0m00:06:33.663901 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:06:33.664661 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m00:06:33.665034 [debug] [MainThread]: On master: COMMIT
[0m00:06:33.665382 [debug] [MainThread]: Using duckdb connection "master"
[0m00:06:33.665688 [debug] [MainThread]: On master: COMMIT
[0m00:06:33.666175 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m00:06:33.666533 [debug] [MainThread]: On master: Close
[0m00:06:33.670663 [debug] [Thread-1 (]: Began running node model.supercell.total_cost
[0m00:06:33.671406 [info ] [Thread-1 (]: 1 of 1 START sql table model main.total_cost ................................... [RUN]
[0m00:06:33.671984 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_supercell_main, now model.supercell.total_cost)
[0m00:06:33.672399 [debug] [Thread-1 (]: Began compiling node model.supercell.total_cost
[0m00:06:33.685421 [debug] [Thread-1 (]: Writing injected SQL for node "model.supercell.total_cost"
[0m00:06:33.686618 [debug] [Thread-1 (]: Began executing node model.supercell.total_cost
[0m00:06:33.726681 [debug] [Thread-1 (]: Writing runtime sql for node "model.supercell.total_cost"
[0m00:06:33.727694 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.total_cost"
[0m00:06:33.728203 [debug] [Thread-1 (]: On model.supercell.total_cost: BEGIN
[0m00:06:33.728609 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:06:33.729728 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:06:33.730175 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.total_cost"
[0m00:06:33.730582 [debug] [Thread-1 (]: On model.supercell.total_cost: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.total_cost"} */

  
    
    

    create  table
      "supercell"."main"."total_cost__dbt_tmp"
  
    as (
      


select 
    region,
    instance_type,
    pricing_model,
    service_code,
    tag_values as tag_values,
    SUM(amortized_cost) as total_cost
from "supercell"."main"."cleaned_usagelogs"
group by region, instance_type, pricing_model, service_code, tag_keys
    );
  
  
[0m00:06:33.731742 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.total_cost"} */

  
    
    

    create  table
      "supercell"."main"."total_cost__dbt_tmp"
  
    as (
      


select 
    region,
    instance_type,
    pricing_model,
    service_code,
    tag_values as tag_values,
    SUM(amortized_cost) as total_cost
from "supercell"."main"."cleaned_usagelogs"
group by region, instance_type, pricing_model, service_code, tag_keys
    );
  
  
[0m00:06:33.732216 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m00:06:33.732775 [debug] [Thread-1 (]: On model.supercell.total_cost: ROLLBACK
[0m00:06:33.736850 [debug] [Thread-1 (]: Failed to rollback 'model.supercell.total_cost'
[0m00:06:33.737355 [debug] [Thread-1 (]: On model.supercell.total_cost: Close
[0m00:06:33.740183 [debug] [Thread-1 (]: Runtime Error in model total_cost (models/supercell_models/metrics/total_cost.sql)
  Binder Error: column "tag_values" must appear in the GROUP BY clause or must be part of an aggregate function.
  Either add it to the GROUP BY list, or use "ANY_VALUE(tag_values)" if the exact value of "tag_values" is not important.
  
  LINE 19:     tag_values as tag_values,
               ^
[0m00:06:33.742507 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model main.total_cost .......................... [[31mERROR[0m in 0.07s]
[0m00:06:33.743231 [debug] [Thread-1 (]: Finished running node model.supercell.total_cost
[0m00:06:33.744267 [debug] [Thread-7 (]: Marking all children of 'model.supercell.total_cost' to be skipped because of status 'error'.  Reason: Runtime Error in model total_cost (models/supercell_models/metrics/total_cost.sql)
  Binder Error: column "tag_values" must appear in the GROUP BY clause or must be part of an aggregate function.
  Either add it to the GROUP BY list, or use "ANY_VALUE(tag_values)" if the exact value of "tag_values" is not important.
  
  LINE 19:     tag_values as tag_values,
               ^.
[0m00:06:33.748553 [debug] [MainThread]: Using duckdb connection "master"
[0m00:06:33.749580 [debug] [MainThread]: On master: BEGIN
[0m00:06:33.750407 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:06:33.752088 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m00:06:33.753045 [debug] [MainThread]: On master: COMMIT
[0m00:06:33.753806 [debug] [MainThread]: Using duckdb connection "master"
[0m00:06:33.754422 [debug] [MainThread]: On master: COMMIT
[0m00:06:33.755707 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m00:06:33.756754 [debug] [MainThread]: On master: Close
[0m00:06:33.757606 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:06:33.758005 [debug] [MainThread]: Connection 'model.supercell.total_cost' was properly closed.
[0m00:06:33.758419 [info ] [MainThread]: 
[0m00:06:33.758816 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.22 seconds (0.22s).
[0m00:06:33.759586 [debug] [MainThread]: Command end result
[0m00:06:33.779368 [debug] [MainThread]: Wrote artifact WritableManifest to /home/harsha/data_actions/supercell_dbt/target/manifest.json
[0m00:06:33.782147 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/harsha/data_actions/supercell_dbt/target/semantic_manifest.json
[0m00:06:33.789405 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/harsha/data_actions/supercell_dbt/target/run_results.json
[0m00:06:33.789851 [info ] [MainThread]: 
[0m00:06:33.790310 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m00:06:33.790678 [info ] [MainThread]: 
[0m00:06:33.791085 [error] [MainThread]:   Runtime Error in model total_cost (models/supercell_models/metrics/total_cost.sql)
  Binder Error: column "tag_values" must appear in the GROUP BY clause or must be part of an aggregate function.
  Either add it to the GROUP BY list, or use "ANY_VALUE(tag_values)" if the exact value of "tag_values" is not important.
  
  LINE 19:     tag_values as tag_values,
               ^
[0m00:06:33.791451 [info ] [MainThread]: 
[0m00:06:33.791808 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m00:06:33.792788 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.9636515, "process_in_blocks": "0", "process_kernel_time": 0.169569, "process_mem_max_rss": "143696", "process_out_blocks": "1832", "process_user_time": 2.450777}
[0m00:06:33.793362 [debug] [MainThread]: Command `dbt run` failed at 00:06:33.793231 after 0.96 seconds
[0m00:06:33.793761 [debug] [MainThread]: Flushing usage events


============================== 00:07:03.320050 | f9ba73ae-9bdc-42b0-bde0-8e5fbc107fb8 ==============================
[0m00:07:03.320050 [info ] [MainThread]: Running with dbt=1.9.4
[0m00:07:03.325955 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/harsha/data_actions/supercell_dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/harsha/data_actions/supercell_dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run --select models/supercell_models/metrics/total_cost.sql', 'send_anonymous_usage_stats': 'False'}
[0m00:07:03.326758 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality

User config should be moved from the 'config' key in profiles.yml to the 'flags' key in dbt_project.yml.
[0m00:07:03.639673 [info ] [MainThread]: Registered adapter: duckdb=1.9.3
[0m00:07:03.711132 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m00:07:03.820146 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m00:07:03.820947 [debug] [MainThread]: Partial parsing: updated file: supercell://models/supercell_models/metrics/total_cost.sql
[0m00:07:04.204053 [debug] [MainThread]: Wrote artifact WritableManifest to /home/harsha/data_actions/supercell_dbt/target/manifest.json
[0m00:07:04.206047 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/harsha/data_actions/supercell_dbt/target/semantic_manifest.json
[0m00:07:04.219663 [info ] [MainThread]: Found 4 models, 4 data tests, 428 macros
[0m00:07:04.222585 [info ] [MainThread]: 
[0m00:07:04.223124 [info ] [MainThread]: Concurrency: 4 threads (target='default')
[0m00:07:04.223530 [info ] [MainThread]: 
[0m00:07:04.224100 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m00:07:04.225680 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_supercell'
[0m00:07:04.265334 [debug] [ThreadPool]: Using duckdb connection "list_supercell"
[0m00:07:04.265864 [debug] [ThreadPool]: On list_supercell: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "connection_name": "list_supercell"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"supercell"'
    
  
  
[0m00:07:04.266229 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:07:04.281405 [debug] [ThreadPool]: SQL status: OK in 0.015 seconds
[0m00:07:04.283104 [debug] [ThreadPool]: On list_supercell: Close
[0m00:07:04.284060 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_supercell, now create_supercell_main)
[0m00:07:04.284642 [debug] [ThreadPool]: Creating schema "database: "supercell"
schema: "main"
"
[0m00:07:04.292497 [debug] [ThreadPool]: Using duckdb connection "create_supercell_main"
[0m00:07:04.292931 [debug] [ThreadPool]: On create_supercell_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "connection_name": "create_supercell_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='supercell'
        and type='sqlite'
    
  
[0m00:07:04.293310 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:07:04.294547 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m00:07:04.296178 [debug] [ThreadPool]: Using duckdb connection "create_supercell_main"
[0m00:07:04.296584 [debug] [ThreadPool]: On create_supercell_main: BEGIN
[0m00:07:04.297134 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m00:07:04.297488 [debug] [ThreadPool]: Using duckdb connection "create_supercell_main"
[0m00:07:04.297785 [debug] [ThreadPool]: On create_supercell_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "connection_name": "create_supercell_main"} */

    
    
        create schema if not exists "supercell"."main"
    
[0m00:07:04.298335 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m00:07:04.299304 [debug] [ThreadPool]: On create_supercell_main: COMMIT
[0m00:07:04.299728 [debug] [ThreadPool]: Using duckdb connection "create_supercell_main"
[0m00:07:04.300062 [debug] [ThreadPool]: On create_supercell_main: COMMIT
[0m00:07:04.300668 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m00:07:04.301049 [debug] [ThreadPool]: On create_supercell_main: Close
[0m00:07:04.307912 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_supercell_main, now list_supercell_main)
[0m00:07:04.317228 [debug] [ThreadPool]: Using duckdb connection "list_supercell_main"
[0m00:07:04.317903 [debug] [ThreadPool]: On list_supercell_main: BEGIN
[0m00:07:04.318440 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:07:04.319686 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m00:07:04.320260 [debug] [ThreadPool]: Using duckdb connection "list_supercell_main"
[0m00:07:04.320810 [debug] [ThreadPool]: On list_supercell_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "connection_name": "list_supercell_main"} */
select
      'supercell' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'supercell'
  
[0m00:07:04.340924 [debug] [ThreadPool]: SQL status: OK in 0.020 seconds
[0m00:07:04.342642 [debug] [ThreadPool]: On list_supercell_main: ROLLBACK
[0m00:07:04.343963 [debug] [ThreadPool]: Failed to rollback 'list_supercell_main'
[0m00:07:04.344370 [debug] [ThreadPool]: On list_supercell_main: Close
[0m00:07:04.345838 [debug] [MainThread]: Using duckdb connection "master"
[0m00:07:04.346229 [debug] [MainThread]: On master: BEGIN
[0m00:07:04.346596 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:07:04.347328 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m00:07:04.347736 [debug] [MainThread]: On master: COMMIT
[0m00:07:04.348061 [debug] [MainThread]: Using duckdb connection "master"
[0m00:07:04.348381 [debug] [MainThread]: On master: COMMIT
[0m00:07:04.348899 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m00:07:04.349290 [debug] [MainThread]: On master: Close
[0m00:07:04.353230 [debug] [Thread-1 (]: Began running node model.supercell.total_cost
[0m00:07:04.354302 [info ] [Thread-1 (]: 1 of 1 START sql table model main.total_cost ................................... [RUN]
[0m00:07:04.355221 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_supercell_main, now model.supercell.total_cost)
[0m00:07:04.356124 [debug] [Thread-1 (]: Began compiling node model.supercell.total_cost
[0m00:07:04.371148 [debug] [Thread-1 (]: Writing injected SQL for node "model.supercell.total_cost"
[0m00:07:04.372320 [debug] [Thread-1 (]: Began executing node model.supercell.total_cost
[0m00:07:04.417460 [debug] [Thread-1 (]: Writing runtime sql for node "model.supercell.total_cost"
[0m00:07:04.418556 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.total_cost"
[0m00:07:04.419031 [debug] [Thread-1 (]: On model.supercell.total_cost: BEGIN
[0m00:07:04.419412 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:07:04.420408 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:07:04.420808 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.total_cost"
[0m00:07:04.421169 [debug] [Thread-1 (]: On model.supercell.total_cost: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.total_cost"} */

  
    
    

    create  table
      "supercell"."main"."total_cost__dbt_tmp"
  
    as (
      


select 
    region,
    instance_type,
    pricing_model,
    service_code,
    tag_values as tag_values,
    SUM(amortized_cost) as total_cost
from "supercell"."main"."cleaned_usagelogs"
group by region, instance_type, pricing_model, service_code, tag_values
    );
  
  
[0m00:07:04.433782 [debug] [Thread-1 (]: SQL status: OK in 0.012 seconds
[0m00:07:04.443961 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.total_cost"
[0m00:07:04.444639 [debug] [Thread-1 (]: On model.supercell.total_cost: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.total_cost"} */
alter table "supercell"."main"."total_cost" rename to "total_cost__dbt_backup"
[0m00:07:04.446001 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:07:04.450006 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.total_cost"
[0m00:07:04.450601 [debug] [Thread-1 (]: On model.supercell.total_cost: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.total_cost"} */
alter table "supercell"."main"."total_cost__dbt_tmp" rename to "total_cost"
[0m00:07:04.451626 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:07:04.474574 [debug] [Thread-1 (]: On model.supercell.total_cost: COMMIT
[0m00:07:04.475168 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.total_cost"
[0m00:07:04.475571 [debug] [Thread-1 (]: On model.supercell.total_cost: COMMIT
[0m00:07:04.479018 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m00:07:04.484848 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.total_cost"
[0m00:07:04.485334 [debug] [Thread-1 (]: On model.supercell.total_cost: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.total_cost"} */
drop table if exists "supercell"."main"."total_cost__dbt_backup" cascade
[0m00:07:04.488055 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m00:07:04.490946 [debug] [Thread-1 (]: On model.supercell.total_cost: Close
[0m00:07:04.493691 [info ] [Thread-1 (]: 1 of 1 OK created sql table model main.total_cost .............................. [[32mOK[0m in 0.14s]
[0m00:07:04.494401 [debug] [Thread-1 (]: Finished running node model.supercell.total_cost
[0m00:07:04.497222 [debug] [MainThread]: Using duckdb connection "master"
[0m00:07:04.497864 [debug] [MainThread]: On master: BEGIN
[0m00:07:04.498243 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:07:04.499129 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m00:07:04.499618 [debug] [MainThread]: On master: COMMIT
[0m00:07:04.500003 [debug] [MainThread]: Using duckdb connection "master"
[0m00:07:04.500354 [debug] [MainThread]: On master: COMMIT
[0m00:07:04.501033 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m00:07:04.501500 [debug] [MainThread]: On master: Close
[0m00:07:04.502088 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:07:04.502456 [debug] [MainThread]: Connection 'model.supercell.total_cost' was properly closed.
[0m00:07:04.502905 [info ] [MainThread]: 
[0m00:07:04.503387 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.28 seconds (0.28s).
[0m00:07:04.504245 [debug] [MainThread]: Command end result
[0m00:07:04.523166 [debug] [MainThread]: Wrote artifact WritableManifest to /home/harsha/data_actions/supercell_dbt/target/manifest.json
[0m00:07:04.525103 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/harsha/data_actions/supercell_dbt/target/semantic_manifest.json
[0m00:07:04.531814 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/harsha/data_actions/supercell_dbt/target/run_results.json
[0m00:07:04.532258 [info ] [MainThread]: 
[0m00:07:04.532759 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:07:04.533101 [info ] [MainThread]: 
[0m00:07:04.533501 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m00:07:04.534479 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.2780398, "process_in_blocks": "0", "process_kernel_time": 0.205678, "process_mem_max_rss": "149468", "process_out_blocks": "2720", "process_user_time": 2.829338}
[0m00:07:04.535065 [debug] [MainThread]: Command `dbt run` succeeded at 00:07:04.534945 after 1.28 seconds
[0m00:07:04.535463 [debug] [MainThread]: Flushing usage events


============================== 00:21:24.788908 | 8df11f1c-dbdd-463d-807b-76710ec6211c ==============================
[0m00:21:24.788908 [info ] [MainThread]: Running with dbt=1.9.4
[0m00:21:24.794215 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/harsha/data_actions/supercell_dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/home/harsha/data_actions/supercell_dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select models/supercell_models/metrics/total_cost.sql', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'False'}
[0m00:21:24.794882 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality

User config should be moved from the 'config' key in profiles.yml to the 'flags' key in dbt_project.yml.
[0m00:21:25.139007 [info ] [MainThread]: Registered adapter: duckdb=1.9.3
[0m00:21:25.210613 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m00:21:25.320199 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:21:25.320722 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:21:25.437639 [debug] [MainThread]: Wrote artifact WritableManifest to /home/harsha/data_actions/supercell_dbt/target/manifest.json
[0m00:21:25.439481 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/harsha/data_actions/supercell_dbt/target/semantic_manifest.json
[0m00:21:25.453519 [info ] [MainThread]: Found 4 models, 4 data tests, 428 macros
[0m00:21:25.456307 [info ] [MainThread]: 
[0m00:21:25.456880 [info ] [MainThread]: Concurrency: 4 threads (target='default')
[0m00:21:25.457242 [info ] [MainThread]: 
[0m00:21:25.457818 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m00:21:25.459256 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_supercell'
[0m00:21:25.505069 [debug] [ThreadPool]: Using duckdb connection "list_supercell"
[0m00:21:25.505621 [debug] [ThreadPool]: On list_supercell: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "connection_name": "list_supercell"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"supercell"'
    
  
  
[0m00:21:25.505989 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:21:25.512023 [debug] [ThreadPool]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "connection_name": "list_supercell"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"supercell"'
    
  
  
[0m00:21:25.512527 [debug] [ThreadPool]: DuckDB adapter: Rolling back transaction.
[0m00:21:25.513497 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:21:25.513933 [debug] [MainThread]: Connection 'list_supercell' was properly closed.
[0m00:21:25.514311 [info ] [MainThread]: 
[0m00:21:25.514701 [info ] [MainThread]: Finished running  in 0 hours 0 minutes and 0.06 seconds (0.06s).
[0m00:21:25.515223 [error] [MainThread]: Encountered an error:
Runtime Error
  IO Error: Could not set lock on file "/home/harsha/data_actions/supercell_dbt/supercell.duckdb": Conflicting lock is held in /usr/bin/python3.12 (PID 2456683) by user harsha. See also https://duckdb.org/docs/connect/concurrency
[0m00:21:25.516336 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.7908463, "process_in_blocks": "0", "process_kernel_time": 0.167553, "process_mem_max_rss": "132884", "process_out_blocks": "920", "process_user_time": 2.295884}
[0m00:21:25.516960 [debug] [MainThread]: Command `dbt run` failed at 00:21:25.516834 after 0.79 seconds
[0m00:21:25.517372 [debug] [MainThread]: Flushing usage events


============================== 00:33:39.211567 | 99570587-983f-4aef-a797-24b3af6499b3 ==============================
[0m00:33:39.211567 [info ] [MainThread]: Running with dbt=1.9.4
[0m00:33:39.215642 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/harsha/data_actions/supercell_dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/home/harsha/data_actions/supercell_dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run --select models/supercell_models/metrics/total_cost.sql', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'False'}
[0m00:33:39.216133 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality

User config should be moved from the 'config' key in profiles.yml to the 'flags' key in dbt_project.yml.
[0m00:33:39.532181 [info ] [MainThread]: Registered adapter: duckdb=1.9.3
[0m00:33:39.603728 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m00:33:39.712915 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m00:33:39.713666 [debug] [MainThread]: Partial parsing: updated file: supercell://models/supercell_models/metrics/total_cost.sql
[0m00:33:40.126109 [debug] [MainThread]: Wrote artifact WritableManifest to /home/harsha/data_actions/supercell_dbt/target/manifest.json
[0m00:33:40.128114 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/harsha/data_actions/supercell_dbt/target/semantic_manifest.json
[0m00:33:40.142947 [info ] [MainThread]: Found 4 models, 4 data tests, 428 macros
[0m00:33:40.146600 [info ] [MainThread]: 
[0m00:33:40.147443 [info ] [MainThread]: Concurrency: 4 threads (target='default')
[0m00:33:40.147862 [info ] [MainThread]: 
[0m00:33:40.148621 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m00:33:40.150391 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_supercell'
[0m00:33:40.207116 [debug] [ThreadPool]: Using duckdb connection "list_supercell"
[0m00:33:40.207731 [debug] [ThreadPool]: On list_supercell: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "connection_name": "list_supercell"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"supercell"'
    
  
  
[0m00:33:40.208112 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:33:40.223737 [debug] [ThreadPool]: SQL status: OK in 0.015 seconds
[0m00:33:40.225556 [debug] [ThreadPool]: On list_supercell: Close
[0m00:33:40.226795 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_supercell, now create_supercell_main)
[0m00:33:40.227809 [debug] [ThreadPool]: Creating schema "database: "supercell"
schema: "main"
"
[0m00:33:40.237658 [debug] [ThreadPool]: Using duckdb connection "create_supercell_main"
[0m00:33:40.238212 [debug] [ThreadPool]: On create_supercell_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "connection_name": "create_supercell_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='supercell'
        and type='sqlite'
    
  
[0m00:33:40.238606 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:33:40.240035 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m00:33:40.241632 [debug] [ThreadPool]: Using duckdb connection "create_supercell_main"
[0m00:33:40.242029 [debug] [ThreadPool]: On create_supercell_main: BEGIN
[0m00:33:40.242601 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m00:33:40.242947 [debug] [ThreadPool]: Using duckdb connection "create_supercell_main"
[0m00:33:40.243256 [debug] [ThreadPool]: On create_supercell_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "connection_name": "create_supercell_main"} */

    
    
        create schema if not exists "supercell"."main"
    
[0m00:33:40.243865 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m00:33:40.244865 [debug] [ThreadPool]: On create_supercell_main: COMMIT
[0m00:33:40.245239 [debug] [ThreadPool]: Using duckdb connection "create_supercell_main"
[0m00:33:40.245563 [debug] [ThreadPool]: On create_supercell_main: COMMIT
[0m00:33:40.246051 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m00:33:40.246449 [debug] [ThreadPool]: On create_supercell_main: Close
[0m00:33:40.253118 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_supercell_main, now list_supercell_main)
[0m00:33:40.263102 [debug] [ThreadPool]: Using duckdb connection "list_supercell_main"
[0m00:33:40.263864 [debug] [ThreadPool]: On list_supercell_main: BEGIN
[0m00:33:40.264468 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:33:40.265824 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m00:33:40.266474 [debug] [ThreadPool]: Using duckdb connection "list_supercell_main"
[0m00:33:40.267078 [debug] [ThreadPool]: On list_supercell_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "connection_name": "list_supercell_main"} */
select
      'supercell' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'supercell'
  
[0m00:33:40.289388 [debug] [ThreadPool]: SQL status: OK in 0.022 seconds
[0m00:33:40.291217 [debug] [ThreadPool]: On list_supercell_main: ROLLBACK
[0m00:33:40.292527 [debug] [ThreadPool]: Failed to rollback 'list_supercell_main'
[0m00:33:40.292926 [debug] [ThreadPool]: On list_supercell_main: Close
[0m00:33:40.294757 [debug] [MainThread]: Using duckdb connection "master"
[0m00:33:40.295219 [debug] [MainThread]: On master: BEGIN
[0m00:33:40.295562 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:33:40.296355 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m00:33:40.296726 [debug] [MainThread]: On master: COMMIT
[0m00:33:40.297054 [debug] [MainThread]: Using duckdb connection "master"
[0m00:33:40.297368 [debug] [MainThread]: On master: COMMIT
[0m00:33:40.297873 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m00:33:40.298263 [debug] [MainThread]: On master: Close
[0m00:33:40.302169 [debug] [Thread-1 (]: Began running node model.supercell.total_cost
[0m00:33:40.303349 [info ] [Thread-1 (]: 1 of 1 START sql table model main.total_cost ................................... [RUN]
[0m00:33:40.304323 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_supercell_main, now model.supercell.total_cost)
[0m00:33:40.305183 [debug] [Thread-1 (]: Began compiling node model.supercell.total_cost
[0m00:33:40.320421 [debug] [Thread-1 (]: Writing injected SQL for node "model.supercell.total_cost"
[0m00:33:40.321536 [debug] [Thread-1 (]: Began executing node model.supercell.total_cost
[0m00:33:40.360612 [debug] [Thread-1 (]: Writing runtime sql for node "model.supercell.total_cost"
[0m00:33:40.361550 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.total_cost"
[0m00:33:40.362018 [debug] [Thread-1 (]: On model.supercell.total_cost: BEGIN
[0m00:33:40.362387 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:33:40.363405 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:33:40.363855 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.total_cost"
[0m00:33:40.364237 [debug] [Thread-1 (]: On model.supercell.total_cost: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.total_cost"} */

  
    
    

    create  table
      "supercell"."main"."total_cost__dbt_tmp"
  
    as (
      


select
    DATE_TRUNC('month', usage_end_date)  as month
    region,
    instance_type,
    pricing_model,
    service_code,
    tag_values as tag_values,
    SUM(amortized_cost) as total_cost
from "supercell"."main"."cleaned_usagelogs"
group by region, instance_type, pricing_model, service_code, tag_values,month
    );
  
  
[0m00:33:40.366985 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.total_cost"} */

  
    
    

    create  table
      "supercell"."main"."total_cost__dbt_tmp"
  
    as (
      


select
    DATE_TRUNC('month', usage_end_date)  as month
    region,
    instance_type,
    pricing_model,
    service_code,
    tag_values as tag_values,
    SUM(amortized_cost) as total_cost
from "supercell"."main"."cleaned_usagelogs"
group by region, instance_type, pricing_model, service_code, tag_values,month
    );
  
  
[0m00:33:40.367446 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m00:33:40.367951 [debug] [Thread-1 (]: On model.supercell.total_cost: ROLLBACK
[0m00:33:40.371945 [debug] [Thread-1 (]: Failed to rollback 'model.supercell.total_cost'
[0m00:33:40.372452 [debug] [Thread-1 (]: On model.supercell.total_cost: Close
[0m00:33:40.375272 [debug] [Thread-1 (]: Runtime Error in model total_cost (models/supercell_models/metrics/total_cost.sql)
  Parser Error: syntax error at or near "region"
[0m00:33:40.377546 [error] [Thread-1 (]: 1 of 1 ERROR creating sql table model main.total_cost .......................... [[31mERROR[0m in 0.07s]
[0m00:33:40.378294 [debug] [Thread-1 (]: Finished running node model.supercell.total_cost
[0m00:33:40.379380 [debug] [Thread-7 (]: Marking all children of 'model.supercell.total_cost' to be skipped because of status 'error'.  Reason: Runtime Error in model total_cost (models/supercell_models/metrics/total_cost.sql)
  Parser Error: syntax error at or near "region".
[0m00:33:40.383353 [debug] [MainThread]: Using duckdb connection "master"
[0m00:33:40.384001 [debug] [MainThread]: On master: BEGIN
[0m00:33:40.384435 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:33:40.385578 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m00:33:40.386241 [debug] [MainThread]: On master: COMMIT
[0m00:33:40.386667 [debug] [MainThread]: Using duckdb connection "master"
[0m00:33:40.387037 [debug] [MainThread]: On master: COMMIT
[0m00:33:40.388044 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m00:33:40.388588 [debug] [MainThread]: On master: Close
[0m00:33:40.389248 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:33:40.389639 [debug] [MainThread]: Connection 'model.supercell.total_cost' was properly closed.
[0m00:33:40.390019 [info ] [MainThread]: 
[0m00:33:40.390463 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.24 seconds (0.24s).
[0m00:33:40.391629 [debug] [MainThread]: Command end result
[0m00:33:40.413485 [debug] [MainThread]: Wrote artifact WritableManifest to /home/harsha/data_actions/supercell_dbt/target/manifest.json
[0m00:33:40.415802 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/harsha/data_actions/supercell_dbt/target/semantic_manifest.json
[0m00:33:40.423766 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/harsha/data_actions/supercell_dbt/target/run_results.json
[0m00:33:40.424273 [info ] [MainThread]: 
[0m00:33:40.424949 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m00:33:40.425439 [info ] [MainThread]: 
[0m00:33:40.425923 [error] [MainThread]:   Runtime Error in model total_cost (models/supercell_models/metrics/total_cost.sql)
  Parser Error: syntax error at or near "region"
[0m00:33:40.426314 [info ] [MainThread]: 
[0m00:33:40.426714 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m00:33:40.427831 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.2795529, "process_in_blocks": "1152", "process_kernel_time": 0.161091, "process_mem_max_rss": "147016", "process_out_blocks": "2704", "process_user_time": 2.809597}
[0m00:33:40.428566 [debug] [MainThread]: Command `dbt run` failed at 00:33:40.428387 after 1.28 seconds
[0m00:33:40.429020 [debug] [MainThread]: Flushing usage events


============================== 00:34:07.852130 | 1cc1b535-91a3-4b88-8c93-ba22e540c7c8 ==============================
[0m00:34:07.852130 [info ] [MainThread]: Running with dbt=1.9.4
[0m00:34:07.857363 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/harsha/data_actions/supercell_dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/home/harsha/data_actions/supercell_dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --select models/supercell_models/metrics/total_cost.sql', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'False'}
[0m00:34:07.858160 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality

User config should be moved from the 'config' key in profiles.yml to the 'flags' key in dbt_project.yml.
[0m00:34:08.181303 [info ] [MainThread]: Registered adapter: duckdb=1.9.3
[0m00:34:08.253850 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m00:34:08.363582 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m00:34:08.364352 [debug] [MainThread]: Partial parsing: updated file: supercell://models/supercell_models/metrics/total_cost.sql
[0m00:34:08.739917 [debug] [MainThread]: Wrote artifact WritableManifest to /home/harsha/data_actions/supercell_dbt/target/manifest.json
[0m00:34:08.741747 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/harsha/data_actions/supercell_dbt/target/semantic_manifest.json
[0m00:34:08.754992 [info ] [MainThread]: Found 4 models, 4 data tests, 428 macros
[0m00:34:08.757937 [info ] [MainThread]: 
[0m00:34:08.758519 [info ] [MainThread]: Concurrency: 4 threads (target='default')
[0m00:34:08.758899 [info ] [MainThread]: 
[0m00:34:08.759470 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m00:34:08.760631 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_supercell'
[0m00:34:08.800383 [debug] [ThreadPool]: Using duckdb connection "list_supercell"
[0m00:34:08.800929 [debug] [ThreadPool]: On list_supercell: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "connection_name": "list_supercell"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"supercell"'
    
  
  
[0m00:34:08.801321 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:34:08.815861 [debug] [ThreadPool]: SQL status: OK in 0.014 seconds
[0m00:34:08.817696 [debug] [ThreadPool]: On list_supercell: Close
[0m00:34:08.818861 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_supercell, now create_supercell_main)
[0m00:34:08.819547 [debug] [ThreadPool]: Creating schema "database: "supercell"
schema: "main"
"
[0m00:34:08.827321 [debug] [ThreadPool]: Using duckdb connection "create_supercell_main"
[0m00:34:08.827771 [debug] [ThreadPool]: On create_supercell_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "connection_name": "create_supercell_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='supercell'
        and type='sqlite'
    
  
[0m00:34:08.828101 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:34:08.829338 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m00:34:08.830850 [debug] [ThreadPool]: Using duckdb connection "create_supercell_main"
[0m00:34:08.831247 [debug] [ThreadPool]: On create_supercell_main: BEGIN
[0m00:34:08.831820 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m00:34:08.832176 [debug] [ThreadPool]: Using duckdb connection "create_supercell_main"
[0m00:34:08.832517 [debug] [ThreadPool]: On create_supercell_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "connection_name": "create_supercell_main"} */

    
    
        create schema if not exists "supercell"."main"
    
[0m00:34:08.833093 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m00:34:08.834083 [debug] [ThreadPool]: On create_supercell_main: COMMIT
[0m00:34:08.834554 [debug] [ThreadPool]: Using duckdb connection "create_supercell_main"
[0m00:34:08.834884 [debug] [ThreadPool]: On create_supercell_main: COMMIT
[0m00:34:08.835401 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m00:34:08.835797 [debug] [ThreadPool]: On create_supercell_main: Close
[0m00:34:08.842518 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_supercell_main, now list_supercell_main)
[0m00:34:08.851585 [debug] [ThreadPool]: Using duckdb connection "list_supercell_main"
[0m00:34:08.852061 [debug] [ThreadPool]: On list_supercell_main: BEGIN
[0m00:34:08.852415 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:34:08.853244 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m00:34:08.853675 [debug] [ThreadPool]: Using duckdb connection "list_supercell_main"
[0m00:34:08.853997 [debug] [ThreadPool]: On list_supercell_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "connection_name": "list_supercell_main"} */
select
      'supercell' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'supercell'
  
[0m00:34:08.870205 [debug] [ThreadPool]: SQL status: OK in 0.016 seconds
[0m00:34:08.871921 [debug] [ThreadPool]: On list_supercell_main: ROLLBACK
[0m00:34:08.873172 [debug] [ThreadPool]: Failed to rollback 'list_supercell_main'
[0m00:34:08.873568 [debug] [ThreadPool]: On list_supercell_main: Close
[0m00:34:08.875185 [debug] [MainThread]: Using duckdb connection "master"
[0m00:34:08.875584 [debug] [MainThread]: On master: BEGIN
[0m00:34:08.875899 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:34:08.876589 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m00:34:08.876988 [debug] [MainThread]: On master: COMMIT
[0m00:34:08.877337 [debug] [MainThread]: Using duckdb connection "master"
[0m00:34:08.877668 [debug] [MainThread]: On master: COMMIT
[0m00:34:08.878158 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m00:34:08.878519 [debug] [MainThread]: On master: Close
[0m00:34:08.881923 [debug] [Thread-1 (]: Began running node model.supercell.total_cost
[0m00:34:08.882977 [info ] [Thread-1 (]: 1 of 1 START sql table model main.total_cost ................................... [RUN]
[0m00:34:08.883912 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_supercell_main, now model.supercell.total_cost)
[0m00:34:08.884746 [debug] [Thread-1 (]: Began compiling node model.supercell.total_cost
[0m00:34:08.900966 [debug] [Thread-1 (]: Writing injected SQL for node "model.supercell.total_cost"
[0m00:34:08.902560 [debug] [Thread-1 (]: Began executing node model.supercell.total_cost
[0m00:34:08.948018 [debug] [Thread-1 (]: Writing runtime sql for node "model.supercell.total_cost"
[0m00:34:08.948906 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.total_cost"
[0m00:34:08.949393 [debug] [Thread-1 (]: On model.supercell.total_cost: BEGIN
[0m00:34:08.949786 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:34:08.951058 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:34:08.951555 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.total_cost"
[0m00:34:08.951963 [debug] [Thread-1 (]: On model.supercell.total_cost: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.total_cost"} */

  
    
    

    create  table
      "supercell"."main"."total_cost__dbt_tmp"
  
    as (
      


select
    DATE_TRUNC('month', usage_end_date)  as month,
    region,
    instance_type,
    pricing_model,
    service_code,
    tag_values as tag_values,
    SUM(amortized_cost) as total_cost
from "supercell"."main"."cleaned_usagelogs"
group by month,region, instance_type, pricing_model, service_code, tag_values
    );
  
  
[0m00:34:08.973986 [debug] [Thread-1 (]: SQL status: OK in 0.021 seconds
[0m00:34:08.982984 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.total_cost"
[0m00:34:08.983533 [debug] [Thread-1 (]: On model.supercell.total_cost: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.total_cost"} */
alter table "supercell"."main"."total_cost" rename to "total_cost__dbt_backup"
[0m00:34:08.984523 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:34:08.987686 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.total_cost"
[0m00:34:08.988121 [debug] [Thread-1 (]: On model.supercell.total_cost: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.total_cost"} */
alter table "supercell"."main"."total_cost__dbt_tmp" rename to "total_cost"
[0m00:34:08.988889 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:34:09.007617 [debug] [Thread-1 (]: On model.supercell.total_cost: COMMIT
[0m00:34:09.008188 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.total_cost"
[0m00:34:09.008592 [debug] [Thread-1 (]: On model.supercell.total_cost: COMMIT
[0m00:34:09.013183 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m00:34:09.018857 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.total_cost"
[0m00:34:09.019356 [debug] [Thread-1 (]: On model.supercell.total_cost: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.total_cost"} */
drop table if exists "supercell"."main"."total_cost__dbt_backup" cascade
[0m00:34:09.022014 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m00:34:09.025160 [debug] [Thread-1 (]: On model.supercell.total_cost: Close
[0m00:34:09.029110 [info ] [Thread-1 (]: 1 of 1 OK created sql table model main.total_cost .............................. [[32mOK[0m in 0.14s]
[0m00:34:09.030031 [debug] [Thread-1 (]: Finished running node model.supercell.total_cost
[0m00:34:09.033052 [debug] [MainThread]: Using duckdb connection "master"
[0m00:34:09.033920 [debug] [MainThread]: On master: BEGIN
[0m00:34:09.034666 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:34:09.036570 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m00:34:09.037540 [debug] [MainThread]: On master: COMMIT
[0m00:34:09.038234 [debug] [MainThread]: Using duckdb connection "master"
[0m00:34:09.038892 [debug] [MainThread]: On master: COMMIT
[0m00:34:09.040222 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m00:34:09.041016 [debug] [MainThread]: On master: Close
[0m00:34:09.042244 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:34:09.043271 [debug] [MainThread]: Connection 'model.supercell.total_cost' was properly closed.
[0m00:34:09.044521 [info ] [MainThread]: 
[0m00:34:09.045116 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.29 seconds (0.29s).
[0m00:34:09.046239 [debug] [MainThread]: Command end result
[0m00:34:09.066539 [debug] [MainThread]: Wrote artifact WritableManifest to /home/harsha/data_actions/supercell_dbt/target/manifest.json
[0m00:34:09.069642 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/harsha/data_actions/supercell_dbt/target/semantic_manifest.json
[0m00:34:09.077804 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/harsha/data_actions/supercell_dbt/target/run_results.json
[0m00:34:09.078307 [info ] [MainThread]: 
[0m00:34:09.078816 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:34:09.079190 [info ] [MainThread]: 
[0m00:34:09.079601 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m00:34:09.080642 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.2913575, "process_in_blocks": "296", "process_kernel_time": 0.173904, "process_mem_max_rss": "153512", "process_out_blocks": "2744", "process_user_time": 2.787476}
[0m00:34:09.081231 [debug] [MainThread]: Command `dbt run` succeeded at 00:34:09.081110 after 1.29 seconds
[0m00:34:09.081648 [debug] [MainThread]: Flushing usage events


============================== 00:34:14.738157 | ce994868-46c4-4088-8820-89b9acfb0e42 ==============================
[0m00:34:14.738157 [info ] [MainThread]: Running with dbt=1.9.4
[0m00:34:14.743186 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/harsha/data_actions/supercell_dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/home/harsha/data_actions/supercell_dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run --select models/supercell_models/metrics/total_cost.sql', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'False'}
[0m00:34:14.743718 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality

User config should be moved from the 'config' key in profiles.yml to the 'flags' key in dbt_project.yml.
[0m00:34:15.071307 [info ] [MainThread]: Registered adapter: duckdb=1.9.3
[0m00:34:15.143401 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m00:34:15.253753 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m00:34:15.254266 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m00:34:15.371271 [debug] [MainThread]: Wrote artifact WritableManifest to /home/harsha/data_actions/supercell_dbt/target/manifest.json
[0m00:34:15.373088 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/harsha/data_actions/supercell_dbt/target/semantic_manifest.json
[0m00:34:15.386586 [info ] [MainThread]: Found 4 models, 4 data tests, 428 macros
[0m00:34:15.389449 [info ] [MainThread]: 
[0m00:34:15.390000 [info ] [MainThread]: Concurrency: 4 threads (target='default')
[0m00:34:15.390372 [info ] [MainThread]: 
[0m00:34:15.390937 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m00:34:15.392499 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_supercell'
[0m00:34:15.441350 [debug] [ThreadPool]: Using duckdb connection "list_supercell"
[0m00:34:15.441890 [debug] [ThreadPool]: On list_supercell: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "connection_name": "list_supercell"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"supercell"'
    
  
  
[0m00:34:15.442263 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m00:34:15.457170 [debug] [ThreadPool]: SQL status: OK in 0.015 seconds
[0m00:34:15.458978 [debug] [ThreadPool]: On list_supercell: Close
[0m00:34:15.459930 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_supercell, now create_supercell_main)
[0m00:34:15.460528 [debug] [ThreadPool]: Creating schema "database: "supercell"
schema: "main"
"
[0m00:34:15.468396 [debug] [ThreadPool]: Using duckdb connection "create_supercell_main"
[0m00:34:15.468866 [debug] [ThreadPool]: On create_supercell_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "connection_name": "create_supercell_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='supercell'
        and type='sqlite'
    
  
[0m00:34:15.469225 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:34:15.470453 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m00:34:15.472018 [debug] [ThreadPool]: Using duckdb connection "create_supercell_main"
[0m00:34:15.472426 [debug] [ThreadPool]: On create_supercell_main: BEGIN
[0m00:34:15.472977 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m00:34:15.473324 [debug] [ThreadPool]: Using duckdb connection "create_supercell_main"
[0m00:34:15.473636 [debug] [ThreadPool]: On create_supercell_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "connection_name": "create_supercell_main"} */

    
    
        create schema if not exists "supercell"."main"
    
[0m00:34:15.474268 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m00:34:15.475291 [debug] [ThreadPool]: On create_supercell_main: COMMIT
[0m00:34:15.475684 [debug] [ThreadPool]: Using duckdb connection "create_supercell_main"
[0m00:34:15.476014 [debug] [ThreadPool]: On create_supercell_main: COMMIT
[0m00:34:15.476554 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m00:34:15.476915 [debug] [ThreadPool]: On create_supercell_main: Close
[0m00:34:15.483396 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_supercell_main, now list_supercell_main)
[0m00:34:15.495504 [debug] [ThreadPool]: Using duckdb connection "list_supercell_main"
[0m00:34:15.496012 [debug] [ThreadPool]: On list_supercell_main: BEGIN
[0m00:34:15.496387 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m00:34:15.497275 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m00:34:15.497774 [debug] [ThreadPool]: Using duckdb connection "list_supercell_main"
[0m00:34:15.498166 [debug] [ThreadPool]: On list_supercell_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "connection_name": "list_supercell_main"} */
select
      'supercell' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'supercell'
  
[0m00:34:15.517596 [debug] [ThreadPool]: SQL status: OK in 0.019 seconds
[0m00:34:15.519821 [debug] [ThreadPool]: On list_supercell_main: ROLLBACK
[0m00:34:15.521262 [debug] [ThreadPool]: Failed to rollback 'list_supercell_main'
[0m00:34:15.521726 [debug] [ThreadPool]: On list_supercell_main: Close
[0m00:34:15.523633 [debug] [MainThread]: Using duckdb connection "master"
[0m00:34:15.524107 [debug] [MainThread]: On master: BEGIN
[0m00:34:15.524487 [debug] [MainThread]: Opening a new connection, currently in state init
[0m00:34:15.525293 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m00:34:15.525696 [debug] [MainThread]: On master: COMMIT
[0m00:34:15.526044 [debug] [MainThread]: Using duckdb connection "master"
[0m00:34:15.526375 [debug] [MainThread]: On master: COMMIT
[0m00:34:15.527153 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m00:34:15.527612 [debug] [MainThread]: On master: Close
[0m00:34:15.532546 [debug] [Thread-1 (]: Began running node model.supercell.total_cost
[0m00:34:15.533716 [info ] [Thread-1 (]: 1 of 1 START sql table model main.total_cost ................................... [RUN]
[0m00:34:15.534725 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_supercell_main, now model.supercell.total_cost)
[0m00:34:15.535660 [debug] [Thread-1 (]: Began compiling node model.supercell.total_cost
[0m00:34:15.550215 [debug] [Thread-1 (]: Writing injected SQL for node "model.supercell.total_cost"
[0m00:34:15.551714 [debug] [Thread-1 (]: Began executing node model.supercell.total_cost
[0m00:34:15.595100 [debug] [Thread-1 (]: Writing runtime sql for node "model.supercell.total_cost"
[0m00:34:15.595958 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.total_cost"
[0m00:34:15.596412 [debug] [Thread-1 (]: On model.supercell.total_cost: BEGIN
[0m00:34:15.596773 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m00:34:15.597775 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m00:34:15.598174 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.total_cost"
[0m00:34:15.598576 [debug] [Thread-1 (]: On model.supercell.total_cost: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.total_cost"} */

  
    
    

    create  table
      "supercell"."main"."total_cost__dbt_tmp"
  
    as (
      


select
    DATE_TRUNC('month', usage_end_date)  as month,
    region,
    instance_type,
    pricing_model,
    service_code,
    tag_values as tag_values,
    SUM(amortized_cost) as total_cost
from "supercell"."main"."cleaned_usagelogs"
group by month,region, instance_type, pricing_model, service_code, tag_values
    );
  
  
[0m00:34:15.619740 [debug] [Thread-1 (]: SQL status: OK in 0.021 seconds
[0m00:34:15.627059 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.total_cost"
[0m00:34:15.627570 [debug] [Thread-1 (]: On model.supercell.total_cost: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.total_cost"} */
alter table "supercell"."main"."total_cost" rename to "total_cost__dbt_backup"
[0m00:34:15.628440 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:34:15.631537 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.total_cost"
[0m00:34:15.631972 [debug] [Thread-1 (]: On model.supercell.total_cost: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.total_cost"} */
alter table "supercell"."main"."total_cost__dbt_tmp" rename to "total_cost"
[0m00:34:15.632770 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m00:34:15.651361 [debug] [Thread-1 (]: On model.supercell.total_cost: COMMIT
[0m00:34:15.651904 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.total_cost"
[0m00:34:15.652305 [debug] [Thread-1 (]: On model.supercell.total_cost: COMMIT
[0m00:34:15.656747 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m00:34:15.662702 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.total_cost"
[0m00:34:15.663177 [debug] [Thread-1 (]: On model.supercell.total_cost: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.total_cost"} */
drop table if exists "supercell"."main"."total_cost__dbt_backup" cascade
[0m00:34:15.665653 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m00:34:15.668622 [debug] [Thread-1 (]: On model.supercell.total_cost: Close
[0m00:34:15.672213 [info ] [Thread-1 (]: 1 of 1 OK created sql table model main.total_cost .............................. [[32mOK[0m in 0.14s]
[0m00:34:15.673143 [debug] [Thread-1 (]: Finished running node model.supercell.total_cost
[0m00:34:15.675914 [debug] [MainThread]: Using duckdb connection "master"
[0m00:34:15.676599 [debug] [MainThread]: On master: BEGIN
[0m00:34:15.677064 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m00:34:15.678210 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m00:34:15.678804 [debug] [MainThread]: On master: COMMIT
[0m00:34:15.679301 [debug] [MainThread]: Using duckdb connection "master"
[0m00:34:15.679755 [debug] [MainThread]: On master: COMMIT
[0m00:34:15.680907 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m00:34:15.681992 [debug] [MainThread]: On master: Close
[0m00:34:15.683533 [debug] [MainThread]: Connection 'master' was properly closed.
[0m00:34:15.684097 [debug] [MainThread]: Connection 'model.supercell.total_cost' was properly closed.
[0m00:34:15.684658 [info ] [MainThread]: 
[0m00:34:15.685607 [info ] [MainThread]: Finished running 1 table model in 0 hours 0 minutes and 0.29 seconds (0.29s).
[0m00:34:15.686909 [debug] [MainThread]: Command end result
[0m00:34:15.711061 [debug] [MainThread]: Wrote artifact WritableManifest to /home/harsha/data_actions/supercell_dbt/target/manifest.json
[0m00:34:15.713000 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/harsha/data_actions/supercell_dbt/target/semantic_manifest.json
[0m00:34:15.719768 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/harsha/data_actions/supercell_dbt/target/run_results.json
[0m00:34:15.720198 [info ] [MainThread]: 
[0m00:34:15.720673 [info ] [MainThread]: [32mCompleted successfully[0m
[0m00:34:15.721022 [info ] [MainThread]: 
[0m00:34:15.721414 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m00:34:15.722425 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.0469933, "process_in_blocks": "0", "process_kernel_time": 0.19471, "process_mem_max_rss": "149352", "process_out_blocks": "1864", "process_user_time": 2.525239}
[0m00:34:15.722961 [debug] [MainThread]: Command `dbt run` succeeded at 00:34:15.722848 after 1.05 seconds
[0m00:34:15.723353 [debug] [MainThread]: Flushing usage events


============================== 13:18:50.078630 | bc1e6509-94f5-4330-b473-652ac99fc71d ==============================
[0m13:18:50.078630 [info ] [MainThread]: Running with dbt=1.9.4
[0m13:18:50.082763 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/harsha/data_actions/supercell_cloudops', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/harsha/data_actions/supercell_cloudops/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --select models/supercell_models/fact_bill_generation', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'False'}
[0m13:18:50.083160 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality

User config should be moved from the 'config' key in profiles.yml to the 'flags' key in dbt_project.yml.
[0m13:18:50.278262 [info ] [MainThread]: Registered adapter: duckdb=1.9.3
[0m13:18:50.324227 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m13:18:50.374799 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m13:18:51.125237 [debug] [MainThread]: Wrote artifact WritableManifest to /home/harsha/data_actions/supercell_cloudops/target/manifest.json
[0m13:18:51.126382 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/harsha/data_actions/supercell_cloudops/target/semantic_manifest.json
[0m13:18:51.137180 [info ] [MainThread]: Found 5 models, 4 data tests, 428 macros
[0m13:18:51.138082 [warn ] [MainThread]: The selection criterion 'models/supercell_models/fact_bill_generation' does not match any enabled nodes
[0m13:18:51.139364 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m13:18:51.140301 [debug] [MainThread]: Command end result
[0m13:18:51.154104 [debug] [MainThread]: Wrote artifact WritableManifest to /home/harsha/data_actions/supercell_cloudops/target/manifest.json
[0m13:18:51.156031 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/harsha/data_actions/supercell_cloudops/target/semantic_manifest.json
[0m13:18:51.158900 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/harsha/data_actions/supercell_cloudops/target/run_results.json
[0m13:18:51.160043 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.1141145, "process_in_blocks": "84952", "process_kernel_time": 0.13326, "process_mem_max_rss": "122856", "process_out_blocks": "2680", "process_user_time": 1.897708}
[0m13:18:51.160447 [debug] [MainThread]: Command `dbt run` succeeded at 13:18:51.160364 after 1.11 seconds
[0m13:18:51.160693 [debug] [MainThread]: Flushing usage events


============================== 13:19:04.817771 | a9f5fe99-7460-414e-a059-e8e33afe4d43 ==============================
[0m13:19:04.817771 [info ] [MainThread]: Running with dbt=1.9.4
[0m13:19:04.820529 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/harsha/data_actions/supercell_cloudops', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/harsha/data_actions/supercell_cloudops/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select models/supercell_models/fact_bill_generation.sql', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'False'}
[0m13:19:04.820795 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality

User config should be moved from the 'config' key in profiles.yml to the 'flags' key in dbt_project.yml.
[0m13:19:05.014053 [info ] [MainThread]: Registered adapter: duckdb=1.9.3
[0m13:19:05.054358 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m13:19:05.116539 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m13:19:05.116836 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m13:19:05.185353 [debug] [MainThread]: Wrote artifact WritableManifest to /home/harsha/data_actions/supercell_cloudops/target/manifest.json
[0m13:19:05.186495 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/harsha/data_actions/supercell_cloudops/target/semantic_manifest.json
[0m13:19:05.193380 [info ] [MainThread]: Found 5 models, 4 data tests, 428 macros
[0m13:19:05.194905 [info ] [MainThread]: 
[0m13:19:05.195211 [info ] [MainThread]: Concurrency: 4 threads (target='default')
[0m13:19:05.195414 [info ] [MainThread]: 
[0m13:19:05.196267 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m13:19:05.197799 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_supercell'
[0m13:19:05.231613 [debug] [ThreadPool]: Using duckdb connection "list_supercell"
[0m13:19:05.231910 [debug] [ThreadPool]: On list_supercell: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "connection_name": "list_supercell"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"supercell"'
    
  
  
[0m13:19:05.232093 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:19:05.278126 [debug] [ThreadPool]: SQL status: OK in 0.046 seconds
[0m13:19:05.279070 [debug] [ThreadPool]: On list_supercell: Close
[0m13:19:05.279592 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_supercell, now create_supercell_main)
[0m13:19:05.279909 [debug] [ThreadPool]: Creating schema "database: "supercell"
schema: "main"
"
[0m13:19:05.284189 [debug] [ThreadPool]: Using duckdb connection "create_supercell_main"
[0m13:19:05.284466 [debug] [ThreadPool]: On create_supercell_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "connection_name": "create_supercell_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='supercell'
        and type='sqlite'
    
  
[0m13:19:05.284652 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:19:05.285724 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m13:19:05.286529 [debug] [ThreadPool]: Using duckdb connection "create_supercell_main"
[0m13:19:05.286714 [debug] [ThreadPool]: On create_supercell_main: BEGIN
[0m13:19:05.287010 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:19:05.287192 [debug] [ThreadPool]: Using duckdb connection "create_supercell_main"
[0m13:19:05.287339 [debug] [ThreadPool]: On create_supercell_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "connection_name": "create_supercell_main"} */

    
    
        create schema if not exists "supercell"."main"
    
[0m13:19:05.288175 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m13:19:05.288829 [debug] [ThreadPool]: On create_supercell_main: COMMIT
[0m13:19:05.289041 [debug] [ThreadPool]: Using duckdb connection "create_supercell_main"
[0m13:19:05.289203 [debug] [ThreadPool]: On create_supercell_main: COMMIT
[0m13:19:05.289555 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:19:05.289748 [debug] [ThreadPool]: On create_supercell_main: Close
[0m13:19:05.293185 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_supercell_main, now list_supercell_main)
[0m13:19:05.299753 [debug] [ThreadPool]: Using duckdb connection "list_supercell_main"
[0m13:19:05.300034 [debug] [ThreadPool]: On list_supercell_main: BEGIN
[0m13:19:05.300198 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:19:05.300739 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m13:19:05.300940 [debug] [ThreadPool]: Using duckdb connection "list_supercell_main"
[0m13:19:05.301091 [debug] [ThreadPool]: On list_supercell_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "connection_name": "list_supercell_main"} */
select
      'supercell' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'supercell'
  
[0m13:19:05.312417 [debug] [ThreadPool]: SQL status: OK in 0.011 seconds
[0m13:19:05.313468 [debug] [ThreadPool]: On list_supercell_main: ROLLBACK
[0m13:19:05.314468 [debug] [ThreadPool]: Failed to rollback 'list_supercell_main'
[0m13:19:05.314686 [debug] [ThreadPool]: On list_supercell_main: Close
[0m13:19:05.315751 [debug] [MainThread]: Using duckdb connection "master"
[0m13:19:05.315987 [debug] [MainThread]: On master: BEGIN
[0m13:19:05.316162 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:19:05.316610 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m13:19:05.316791 [debug] [MainThread]: On master: COMMIT
[0m13:19:05.316953 [debug] [MainThread]: Using duckdb connection "master"
[0m13:19:05.317090 [debug] [MainThread]: On master: COMMIT
[0m13:19:05.317339 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m13:19:05.317542 [debug] [MainThread]: On master: Close
[0m13:19:05.319830 [debug] [Thread-1 (]: Began running node model.supercell.fact_bill_generation
[0m13:19:05.320379 [info ] [Thread-1 (]: 1 of 1 START sql view model main.fact_bill_generation .......................... [RUN]
[0m13:19:05.320850 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_supercell_main, now model.supercell.fact_bill_generation)
[0m13:19:05.321269 [debug] [Thread-1 (]: Began compiling node model.supercell.fact_bill_generation
[0m13:19:05.330520 [debug] [Thread-1 (]: Writing injected SQL for node "model.supercell.fact_bill_generation"
[0m13:19:05.331848 [debug] [Thread-1 (]: Began executing node model.supercell.fact_bill_generation
[0m13:19:05.351512 [debug] [Thread-1 (]: Writing runtime sql for node "model.supercell.fact_bill_generation"
[0m13:19:05.352009 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.fact_bill_generation"
[0m13:19:05.352244 [debug] [Thread-1 (]: On model.supercell.fact_bill_generation: BEGIN
[0m13:19:05.352444 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:19:05.353189 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:19:05.353458 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.fact_bill_generation"
[0m13:19:05.353666 [debug] [Thread-1 (]: On model.supercell.fact_bill_generation: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.fact_bill_generation"} */

  
  create view "supercell"."main"."fact_bill_generation__dbt_tmp" as (
    select 
    md5(concat(linked_account_id, '_', service_code, '_', instance_type, '_', region, '_', CAST(usage_start_date AS VARCHAR))) AS hash_key
    resources_id,
    start_time,
    bill_time
    bill_amount
    line_item
from "supercell"."main"."cleaned_usagelogs"
  );

[0m13:19:05.358100 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.fact_bill_generation"} */

  
  create view "supercell"."main"."fact_bill_generation__dbt_tmp" as (
    select 
    md5(concat(linked_account_id, '_', service_code, '_', instance_type, '_', region, '_', CAST(usage_start_date AS VARCHAR))) AS hash_key
    resources_id,
    start_time,
    bill_time
    bill_amount
    line_item
from "supercell"."main"."cleaned_usagelogs"
  );

[0m13:19:05.358402 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m13:19:05.358720 [debug] [Thread-1 (]: On model.supercell.fact_bill_generation: ROLLBACK
[0m13:19:05.362707 [debug] [Thread-1 (]: Failed to rollback 'model.supercell.fact_bill_generation'
[0m13:19:05.362972 [debug] [Thread-1 (]: On model.supercell.fact_bill_generation: Close
[0m13:19:05.364404 [debug] [Thread-1 (]: Runtime Error in model fact_bill_generation (models/supercell_models/fact_bill_generation.sql)
  Parser Error: syntax error at or near "resources_id"
[0m13:19:05.365685 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model main.fact_bill_generation ................. [[31mERROR[0m in 0.04s]
[0m13:19:05.366053 [debug] [Thread-1 (]: Finished running node model.supercell.fact_bill_generation
[0m13:19:05.366624 [debug] [Thread-7 (]: Marking all children of 'model.supercell.fact_bill_generation' to be skipped because of status 'error'.  Reason: Runtime Error in model fact_bill_generation (models/supercell_models/fact_bill_generation.sql)
  Parser Error: syntax error at or near "resources_id".
[0m13:19:05.368767 [debug] [MainThread]: Using duckdb connection "master"
[0m13:19:05.369132 [debug] [MainThread]: On master: BEGIN
[0m13:19:05.369331 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:19:05.370039 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m13:19:05.370433 [debug] [MainThread]: On master: COMMIT
[0m13:19:05.370679 [debug] [MainThread]: Using duckdb connection "master"
[0m13:19:05.370862 [debug] [MainThread]: On master: COMMIT
[0m13:19:05.371318 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m13:19:05.371588 [debug] [MainThread]: On master: Close
[0m13:19:05.371987 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:19:05.372176 [debug] [MainThread]: Connection 'model.supercell.fact_bill_generation' was properly closed.
[0m13:19:05.372390 [info ] [MainThread]: 
[0m13:19:05.372633 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.18 seconds (0.18s).
[0m13:19:05.373149 [debug] [MainThread]: Command end result
[0m13:19:05.388400 [debug] [MainThread]: Wrote artifact WritableManifest to /home/harsha/data_actions/supercell_cloudops/target/manifest.json
[0m13:19:05.389877 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/harsha/data_actions/supercell_cloudops/target/semantic_manifest.json
[0m13:19:05.393720 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/harsha/data_actions/supercell_cloudops/target/run_results.json
[0m13:19:05.394199 [info ] [MainThread]: 
[0m13:19:05.394611 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m13:19:05.394834 [info ] [MainThread]: 
[0m13:19:05.395051 [error] [MainThread]:   Runtime Error in model fact_bill_generation (models/supercell_models/fact_bill_generation.sql)
  Parser Error: syntax error at or near "resources_id"
[0m13:19:05.395224 [info ] [MainThread]: 
[0m13:19:05.395399 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m13:19:05.396029 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.61805046, "process_in_blocks": "42312", "process_kernel_time": 0.128274, "process_mem_max_rss": "143564", "process_out_blocks": "1832", "process_user_time": 1.352892}
[0m13:19:05.396357 [debug] [MainThread]: Command `dbt run` failed at 13:19:05.396292 after 0.62 seconds
[0m13:19:05.396655 [debug] [MainThread]: Flushing usage events


============================== 13:19:34.803515 | a1e4a075-6e15-4568-b9e5-e2189c90ffa8 ==============================
[0m13:19:34.803515 [info ] [MainThread]: Running with dbt=1.9.4
[0m13:19:34.805684 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/harsha/data_actions/supercell_cloudops/logs', 'profiles_dir': '/home/harsha/data_actions/supercell_cloudops', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run --select models/supercell_models/fact_bill_generation.sql', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'False'}
[0m13:19:34.805914 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality

User config should be moved from the 'config' key in profiles.yml to the 'flags' key in dbt_project.yml.
[0m13:19:34.983527 [info ] [MainThread]: Registered adapter: duckdb=1.9.3
[0m13:19:35.060103 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m13:19:35.135236 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:19:35.135915 [debug] [MainThread]: Partial parsing: updated file: supercell://models/supercell_models/fact_bill_generation.sql
[0m13:19:35.379141 [debug] [MainThread]: Wrote artifact WritableManifest to /home/harsha/data_actions/supercell_cloudops/target/manifest.json
[0m13:19:35.380733 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/harsha/data_actions/supercell_cloudops/target/semantic_manifest.json
[0m13:19:35.391211 [info ] [MainThread]: Found 5 models, 4 data tests, 428 macros
[0m13:19:35.393452 [info ] [MainThread]: 
[0m13:19:35.393934 [info ] [MainThread]: Concurrency: 4 threads (target='default')
[0m13:19:35.394280 [info ] [MainThread]: 
[0m13:19:35.394928 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m13:19:35.396048 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_supercell'
[0m13:19:35.433654 [debug] [ThreadPool]: Using duckdb connection "list_supercell"
[0m13:19:35.434135 [debug] [ThreadPool]: On list_supercell: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "connection_name": "list_supercell"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"supercell"'
    
  
  
[0m13:19:35.434482 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:19:35.449547 [debug] [ThreadPool]: SQL status: OK in 0.015 seconds
[0m13:19:35.450984 [debug] [ThreadPool]: On list_supercell: Close
[0m13:19:35.451865 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_supercell, now create_supercell_main)
[0m13:19:35.452333 [debug] [ThreadPool]: Creating schema "database: "supercell"
schema: "main"
"
[0m13:19:35.458615 [debug] [ThreadPool]: Using duckdb connection "create_supercell_main"
[0m13:19:35.459032 [debug] [ThreadPool]: On create_supercell_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "connection_name": "create_supercell_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='supercell'
        and type='sqlite'
    
  
[0m13:19:35.459345 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:19:35.460836 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m13:19:35.462208 [debug] [ThreadPool]: Using duckdb connection "create_supercell_main"
[0m13:19:35.462542 [debug] [ThreadPool]: On create_supercell_main: BEGIN
[0m13:19:35.463325 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:19:35.463659 [debug] [ThreadPool]: Using duckdb connection "create_supercell_main"
[0m13:19:35.463969 [debug] [ThreadPool]: On create_supercell_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "connection_name": "create_supercell_main"} */

    
    
        create schema if not exists "supercell"."main"
    
[0m13:19:35.464759 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:19:35.465603 [debug] [ThreadPool]: On create_supercell_main: COMMIT
[0m13:19:35.465947 [debug] [ThreadPool]: Using duckdb connection "create_supercell_main"
[0m13:19:35.466232 [debug] [ThreadPool]: On create_supercell_main: COMMIT
[0m13:19:35.466763 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:19:35.467087 [debug] [ThreadPool]: On create_supercell_main: Close
[0m13:19:35.471858 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_supercell_main, now list_supercell_main)
[0m13:19:35.477052 [debug] [ThreadPool]: Using duckdb connection "list_supercell_main"
[0m13:19:35.477507 [debug] [ThreadPool]: On list_supercell_main: BEGIN
[0m13:19:35.477812 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:19:35.478518 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m13:19:35.478844 [debug] [ThreadPool]: Using duckdb connection "list_supercell_main"
[0m13:19:35.479141 [debug] [ThreadPool]: On list_supercell_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "connection_name": "list_supercell_main"} */
select
      'supercell' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'supercell'
  
[0m13:19:35.499649 [debug] [ThreadPool]: SQL status: OK in 0.020 seconds
[0m13:19:35.501137 [debug] [ThreadPool]: On list_supercell_main: ROLLBACK
[0m13:19:35.502156 [debug] [ThreadPool]: Failed to rollback 'list_supercell_main'
[0m13:19:35.502491 [debug] [ThreadPool]: On list_supercell_main: Close
[0m13:19:35.503355 [debug] [MainThread]: Using duckdb connection "master"
[0m13:19:35.503598 [debug] [MainThread]: On master: BEGIN
[0m13:19:35.503781 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:19:35.504239 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m13:19:35.504446 [debug] [MainThread]: On master: COMMIT
[0m13:19:35.504630 [debug] [MainThread]: Using duckdb connection "master"
[0m13:19:35.504799 [debug] [MainThread]: On master: COMMIT
[0m13:19:35.505108 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m13:19:35.505302 [debug] [MainThread]: On master: Close
[0m13:19:35.507123 [debug] [Thread-1 (]: Began running node model.supercell.fact_bill_generation
[0m13:19:35.507658 [info ] [Thread-1 (]: 1 of 1 START sql view model main.fact_bill_generation .......................... [RUN]
[0m13:19:35.508104 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_supercell_main, now model.supercell.fact_bill_generation)
[0m13:19:35.508543 [debug] [Thread-1 (]: Began compiling node model.supercell.fact_bill_generation
[0m13:19:35.517949 [debug] [Thread-1 (]: Writing injected SQL for node "model.supercell.fact_bill_generation"
[0m13:19:35.518777 [debug] [Thread-1 (]: Began executing node model.supercell.fact_bill_generation
[0m13:19:35.550291 [debug] [Thread-1 (]: Writing runtime sql for node "model.supercell.fact_bill_generation"
[0m13:19:35.551073 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.fact_bill_generation"
[0m13:19:35.551493 [debug] [Thread-1 (]: On model.supercell.fact_bill_generation: BEGIN
[0m13:19:35.551876 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:19:35.552727 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:19:35.553114 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.fact_bill_generation"
[0m13:19:35.553493 [debug] [Thread-1 (]: On model.supercell.fact_bill_generation: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.fact_bill_generation"} */

  
  create view "supercell"."main"."fact_bill_generation__dbt_tmp" as (
    select 
    md5(concat(linked_account_id, '_', service_code, '_', instance_type, '_', region, '_', CAST(usage_start_date AS VARCHAR))) AS resource_id,
    start_time,
    bill_time
    bill_amount
    line_item
from "supercell"."main"."cleaned_usagelogs"
  );

[0m13:19:35.554142 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.fact_bill_generation"} */

  
  create view "supercell"."main"."fact_bill_generation__dbt_tmp" as (
    select 
    md5(concat(linked_account_id, '_', service_code, '_', instance_type, '_', region, '_', CAST(usage_start_date AS VARCHAR))) AS resource_id,
    start_time,
    bill_time
    bill_amount
    line_item
from "supercell"."main"."cleaned_usagelogs"
  );

[0m13:19:35.554542 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m13:19:35.554986 [debug] [Thread-1 (]: On model.supercell.fact_bill_generation: ROLLBACK
[0m13:19:35.557523 [debug] [Thread-1 (]: Failed to rollback 'model.supercell.fact_bill_generation'
[0m13:19:35.557889 [debug] [Thread-1 (]: On model.supercell.fact_bill_generation: Close
[0m13:19:35.559636 [debug] [Thread-1 (]: Runtime Error in model fact_bill_generation (models/supercell_models/fact_bill_generation.sql)
  Parser Error: syntax error at or near "line_item"
[0m13:19:35.561181 [error] [Thread-1 (]: 1 of 1 ERROR creating sql view model main.fact_bill_generation ................. [[31mERROR[0m in 0.05s]
[0m13:19:35.561670 [debug] [Thread-1 (]: Finished running node model.supercell.fact_bill_generation
[0m13:19:35.562219 [debug] [Thread-7 (]: Marking all children of 'model.supercell.fact_bill_generation' to be skipped because of status 'error'.  Reason: Runtime Error in model fact_bill_generation (models/supercell_models/fact_bill_generation.sql)
  Parser Error: syntax error at or near "line_item".
[0m13:19:35.565862 [debug] [MainThread]: Using duckdb connection "master"
[0m13:19:35.566489 [debug] [MainThread]: On master: BEGIN
[0m13:19:35.566860 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:19:35.567847 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m13:19:35.568289 [debug] [MainThread]: On master: COMMIT
[0m13:19:35.568694 [debug] [MainThread]: Using duckdb connection "master"
[0m13:19:35.569026 [debug] [MainThread]: On master: COMMIT
[0m13:19:35.569885 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m13:19:35.570318 [debug] [MainThread]: On master: Close
[0m13:19:35.570892 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:19:35.571202 [debug] [MainThread]: Connection 'model.supercell.fact_bill_generation' was properly closed.
[0m13:19:35.571576 [info ] [MainThread]: 
[0m13:19:35.572010 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.18 seconds (0.18s).
[0m13:19:35.572929 [debug] [MainThread]: Command end result
[0m13:19:35.589197 [debug] [MainThread]: Wrote artifact WritableManifest to /home/harsha/data_actions/supercell_cloudops/target/manifest.json
[0m13:19:35.590909 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/harsha/data_actions/supercell_cloudops/target/semantic_manifest.json
[0m13:19:35.597258 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/harsha/data_actions/supercell_cloudops/target/run_results.json
[0m13:19:35.597735 [info ] [MainThread]: 
[0m13:19:35.598142 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m13:19:35.598500 [info ] [MainThread]: 
[0m13:19:35.598881 [error] [MainThread]:   Runtime Error in model fact_bill_generation (models/supercell_models/fact_bill_generation.sql)
  Parser Error: syntax error at or near "line_item"
[0m13:19:35.599193 [info ] [MainThread]: 
[0m13:19:35.599562 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 TOTAL=1
[0m13:19:35.600575 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.8305282, "process_in_blocks": "0", "process_kernel_time": 0.111908, "process_mem_max_rss": "147800", "process_out_blocks": "2720", "process_user_time": 1.612678}
[0m13:19:35.601056 [debug] [MainThread]: Command `dbt run` failed at 13:19:35.600958 after 0.83 seconds
[0m13:19:35.601399 [debug] [MainThread]: Flushing usage events


============================== 13:20:02.706961 | a5419741-a2b7-4683-bd36-ca1831dc70e9 ==============================
[0m13:20:02.706961 [info ] [MainThread]: Running with dbt=1.9.4
[0m13:20:02.710098 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/harsha/data_actions/supercell_cloudops/logs', 'profiles_dir': '/home/harsha/data_actions/supercell_cloudops', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select models/supercell_models/fact_bill_generation.sql', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'False'}
[0m13:20:02.710587 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality

User config should be moved from the 'config' key in profiles.yml to the 'flags' key in dbt_project.yml.
[0m13:20:02.890204 [info ] [MainThread]: Registered adapter: duckdb=1.9.3
[0m13:20:02.931811 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m13:20:02.994154 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:20:02.994683 [debug] [MainThread]: Partial parsing: updated file: supercell://models/supercell_models/fact_bill_generation.sql
[0m13:20:03.187390 [debug] [MainThread]: Wrote artifact WritableManifest to /home/harsha/data_actions/supercell_cloudops/target/manifest.json
[0m13:20:03.188558 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/harsha/data_actions/supercell_cloudops/target/semantic_manifest.json
[0m13:20:03.196315 [info ] [MainThread]: Found 5 models, 4 data tests, 428 macros
[0m13:20:03.198122 [info ] [MainThread]: 
[0m13:20:03.198525 [info ] [MainThread]: Concurrency: 4 threads (target='default')
[0m13:20:03.198732 [info ] [MainThread]: 
[0m13:20:03.199054 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m13:20:03.199966 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_supercell'
[0m13:20:03.231456 [debug] [ThreadPool]: Using duckdb connection "list_supercell"
[0m13:20:03.231783 [debug] [ThreadPool]: On list_supercell: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "connection_name": "list_supercell"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"supercell"'
    
  
  
[0m13:20:03.231984 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:20:03.239852 [debug] [ThreadPool]: SQL status: OK in 0.008 seconds
[0m13:20:03.240804 [debug] [ThreadPool]: On list_supercell: Close
[0m13:20:03.241321 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_supercell, now create_supercell_main)
[0m13:20:03.241652 [debug] [ThreadPool]: Creating schema "database: "supercell"
schema: "main"
"
[0m13:20:03.246680 [debug] [ThreadPool]: Using duckdb connection "create_supercell_main"
[0m13:20:03.247024 [debug] [ThreadPool]: On create_supercell_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "connection_name": "create_supercell_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='supercell'
        and type='sqlite'
    
  
[0m13:20:03.247213 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:20:03.248067 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m13:20:03.249054 [debug] [ThreadPool]: Using duckdb connection "create_supercell_main"
[0m13:20:03.249315 [debug] [ThreadPool]: On create_supercell_main: BEGIN
[0m13:20:03.250250 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m13:20:03.250656 [debug] [ThreadPool]: Using duckdb connection "create_supercell_main"
[0m13:20:03.250835 [debug] [ThreadPool]: On create_supercell_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "connection_name": "create_supercell_main"} */

    
    
        create schema if not exists "supercell"."main"
    
[0m13:20:03.251663 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m13:20:03.252233 [debug] [ThreadPool]: On create_supercell_main: COMMIT
[0m13:20:03.252466 [debug] [ThreadPool]: Using duckdb connection "create_supercell_main"
[0m13:20:03.252676 [debug] [ThreadPool]: On create_supercell_main: COMMIT
[0m13:20:03.252962 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:20:03.253140 [debug] [ThreadPool]: On create_supercell_main: Close
[0m13:20:03.257008 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_supercell_main, now list_supercell_main)
[0m13:20:03.262229 [debug] [ThreadPool]: Using duckdb connection "list_supercell_main"
[0m13:20:03.262706 [debug] [ThreadPool]: On list_supercell_main: BEGIN
[0m13:20:03.263071 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:20:03.263821 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m13:20:03.264139 [debug] [ThreadPool]: Using duckdb connection "list_supercell_main"
[0m13:20:03.264430 [debug] [ThreadPool]: On list_supercell_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "connection_name": "list_supercell_main"} */
select
      'supercell' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'supercell'
  
[0m13:20:03.274190 [debug] [ThreadPool]: SQL status: OK in 0.009 seconds
[0m13:20:03.275165 [debug] [ThreadPool]: On list_supercell_main: ROLLBACK
[0m13:20:03.275859 [debug] [ThreadPool]: Failed to rollback 'list_supercell_main'
[0m13:20:03.276058 [debug] [ThreadPool]: On list_supercell_main: Close
[0m13:20:03.277161 [debug] [MainThread]: Using duckdb connection "master"
[0m13:20:03.277521 [debug] [MainThread]: On master: BEGIN
[0m13:20:03.277806 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:20:03.278390 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m13:20:03.278781 [debug] [MainThread]: On master: COMMIT
[0m13:20:03.278971 [debug] [MainThread]: Using duckdb connection "master"
[0m13:20:03.279129 [debug] [MainThread]: On master: COMMIT
[0m13:20:03.279577 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m13:20:03.279753 [debug] [MainThread]: On master: Close
[0m13:20:03.281641 [debug] [Thread-1 (]: Began running node model.supercell.fact_bill_generation
[0m13:20:03.282195 [info ] [Thread-1 (]: 1 of 1 START sql view model main.fact_bill_generation .......................... [RUN]
[0m13:20:03.282657 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_supercell_main, now model.supercell.fact_bill_generation)
[0m13:20:03.283026 [debug] [Thread-1 (]: Began compiling node model.supercell.fact_bill_generation
[0m13:20:03.290745 [debug] [Thread-1 (]: Writing injected SQL for node "model.supercell.fact_bill_generation"
[0m13:20:03.292423 [debug] [Thread-1 (]: Began executing node model.supercell.fact_bill_generation
[0m13:20:03.316593 [debug] [Thread-1 (]: Writing runtime sql for node "model.supercell.fact_bill_generation"
[0m13:20:03.317177 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.fact_bill_generation"
[0m13:20:03.317404 [debug] [Thread-1 (]: On model.supercell.fact_bill_generation: BEGIN
[0m13:20:03.317633 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:20:03.318162 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:20:03.318363 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.fact_bill_generation"
[0m13:20:03.318559 [debug] [Thread-1 (]: On model.supercell.fact_bill_generation: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.fact_bill_generation"} */

  
  create view "supercell"."main"."fact_bill_generation__dbt_tmp" as (
    select 
    md5(concat(linked_account_id, '_', service_code, '_', instance_type, '_', region, '_', CAST(usage_start_date AS VARCHAR))) AS resource_id,
    usage_start_date
from "supercell"."main"."cleaned_usagelogs"
  );

[0m13:20:03.319130 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:20:03.322669 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.fact_bill_generation"
[0m13:20:03.322901 [debug] [Thread-1 (]: On model.supercell.fact_bill_generation: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.fact_bill_generation"} */
alter view "supercell"."main"."fact_bill_generation__dbt_tmp" rename to "fact_bill_generation"
[0m13:20:03.323316 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:20:03.330150 [debug] [Thread-1 (]: On model.supercell.fact_bill_generation: COMMIT
[0m13:20:03.330618 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.fact_bill_generation"
[0m13:20:03.330921 [debug] [Thread-1 (]: On model.supercell.fact_bill_generation: COMMIT
[0m13:20:03.334849 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m13:20:03.338115 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.fact_bill_generation"
[0m13:20:03.338384 [debug] [Thread-1 (]: On model.supercell.fact_bill_generation: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.fact_bill_generation"} */
drop view if exists "supercell"."main"."fact_bill_generation__dbt_backup" cascade
[0m13:20:03.338926 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:20:03.340342 [debug] [Thread-1 (]: On model.supercell.fact_bill_generation: Close
[0m13:20:03.341679 [info ] [Thread-1 (]: 1 of 1 OK created sql view model main.fact_bill_generation ..................... [[32mOK[0m in 0.06s]
[0m13:20:03.342055 [debug] [Thread-1 (]: Finished running node model.supercell.fact_bill_generation
[0m13:20:03.343496 [debug] [MainThread]: Using duckdb connection "master"
[0m13:20:03.343998 [debug] [MainThread]: On master: BEGIN
[0m13:20:03.344361 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:20:03.345150 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m13:20:03.345589 [debug] [MainThread]: On master: COMMIT
[0m13:20:03.346015 [debug] [MainThread]: Using duckdb connection "master"
[0m13:20:03.346502 [debug] [MainThread]: On master: COMMIT
[0m13:20:03.347201 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m13:20:03.347668 [debug] [MainThread]: On master: Close
[0m13:20:03.348327 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:20:03.348709 [debug] [MainThread]: Connection 'model.supercell.fact_bill_generation' was properly closed.
[0m13:20:03.349060 [info ] [MainThread]: 
[0m13:20:03.349433 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.15 seconds (0.15s).
[0m13:20:03.350420 [debug] [MainThread]: Command end result
[0m13:20:03.365965 [debug] [MainThread]: Wrote artifact WritableManifest to /home/harsha/data_actions/supercell_cloudops/target/manifest.json
[0m13:20:03.367489 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/harsha/data_actions/supercell_cloudops/target/semantic_manifest.json
[0m13:20:03.371764 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/harsha/data_actions/supercell_cloudops/target/run_results.json
[0m13:20:03.372055 [info ] [MainThread]: 
[0m13:20:03.372308 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:20:03.372503 [info ] [MainThread]: 
[0m13:20:03.372702 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m13:20:03.373311 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.69943273, "process_in_blocks": "0", "process_kernel_time": 0.152817, "process_mem_max_rss": "145424", "process_out_blocks": "2728", "process_user_time": 1.451263}
[0m13:20:03.373653 [debug] [MainThread]: Command `dbt run` succeeded at 13:20:03.373583 after 0.70 seconds
[0m13:20:03.373877 [debug] [MainThread]: Flushing usage events


============================== 13:24:44.609146 | 239e609b-85a0-44d0-80ac-4dc4fbcaabac ==============================
[0m13:24:44.609146 [info ] [MainThread]: Running with dbt=1.9.4
[0m13:24:44.611498 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/harsha/data_actions/supercell_cloudops/logs', 'profiles_dir': '/home/harsha/data_actions/supercell_cloudops', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select models/supercell_models/fact_bill_generation.sql', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'False'}
[0m13:24:44.611752 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality

User config should be moved from the 'config' key in profiles.yml to the 'flags' key in dbt_project.yml.
[0m13:24:44.787196 [info ] [MainThread]: Registered adapter: duckdb=1.9.3
[0m13:24:44.828156 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m13:24:44.887052 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m13:24:44.887609 [debug] [MainThread]: Partial parsing: updated file: supercell://models/supercell_models/fact_bill_generation.sql
[0m13:24:45.096232 [debug] [MainThread]: Wrote artifact WritableManifest to /home/harsha/data_actions/supercell_cloudops/target/manifest.json
[0m13:24:45.097316 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/harsha/data_actions/supercell_cloudops/target/semantic_manifest.json
[0m13:24:45.104994 [info ] [MainThread]: Found 5 models, 4 data tests, 428 macros
[0m13:24:45.106881 [info ] [MainThread]: 
[0m13:24:45.107249 [info ] [MainThread]: Concurrency: 4 threads (target='default')
[0m13:24:45.107501 [info ] [MainThread]: 
[0m13:24:45.107841 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m13:24:45.108792 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_supercell'
[0m13:24:45.140636 [debug] [ThreadPool]: Using duckdb connection "list_supercell"
[0m13:24:45.140973 [debug] [ThreadPool]: On list_supercell: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "connection_name": "list_supercell"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"supercell"'
    
  
  
[0m13:24:45.141175 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m13:24:45.149209 [debug] [ThreadPool]: SQL status: OK in 0.008 seconds
[0m13:24:45.150198 [debug] [ThreadPool]: On list_supercell: Close
[0m13:24:45.150742 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_supercell, now create_supercell_main)
[0m13:24:45.151031 [debug] [ThreadPool]: Creating schema "database: "supercell"
schema: "main"
"
[0m13:24:45.155747 [debug] [ThreadPool]: Using duckdb connection "create_supercell_main"
[0m13:24:45.156040 [debug] [ThreadPool]: On create_supercell_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "connection_name": "create_supercell_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='supercell'
        and type='sqlite'
    
  
[0m13:24:45.156212 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:24:45.157030 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m13:24:45.157896 [debug] [ThreadPool]: Using duckdb connection "create_supercell_main"
[0m13:24:45.158092 [debug] [ThreadPool]: On create_supercell_main: BEGIN
[0m13:24:45.158511 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:24:45.158682 [debug] [ThreadPool]: Using duckdb connection "create_supercell_main"
[0m13:24:45.158823 [debug] [ThreadPool]: On create_supercell_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "connection_name": "create_supercell_main"} */

    
    
        create schema if not exists "supercell"."main"
    
[0m13:24:45.159090 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:24:45.159608 [debug] [ThreadPool]: On create_supercell_main: COMMIT
[0m13:24:45.159813 [debug] [ThreadPool]: Using duckdb connection "create_supercell_main"
[0m13:24:45.159985 [debug] [ThreadPool]: On create_supercell_main: COMMIT
[0m13:24:45.160253 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m13:24:45.160485 [debug] [ThreadPool]: On create_supercell_main: Close
[0m13:24:45.164244 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_supercell_main, now list_supercell_main)
[0m13:24:45.169659 [debug] [ThreadPool]: Using duckdb connection "list_supercell_main"
[0m13:24:45.170103 [debug] [ThreadPool]: On list_supercell_main: BEGIN
[0m13:24:45.170411 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m13:24:45.171102 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m13:24:45.171444 [debug] [ThreadPool]: Using duckdb connection "list_supercell_main"
[0m13:24:45.171746 [debug] [ThreadPool]: On list_supercell_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "connection_name": "list_supercell_main"} */
select
      'supercell' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'supercell'
  
[0m13:24:45.191665 [debug] [ThreadPool]: SQL status: OK in 0.020 seconds
[0m13:24:45.193181 [debug] [ThreadPool]: On list_supercell_main: ROLLBACK
[0m13:24:45.194067 [debug] [ThreadPool]: Failed to rollback 'list_supercell_main'
[0m13:24:45.194319 [debug] [ThreadPool]: On list_supercell_main: Close
[0m13:24:45.195168 [debug] [MainThread]: Using duckdb connection "master"
[0m13:24:45.195378 [debug] [MainThread]: On master: BEGIN
[0m13:24:45.195556 [debug] [MainThread]: Opening a new connection, currently in state init
[0m13:24:45.195936 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m13:24:45.196103 [debug] [MainThread]: On master: COMMIT
[0m13:24:45.196264 [debug] [MainThread]: Using duckdb connection "master"
[0m13:24:45.196420 [debug] [MainThread]: On master: COMMIT
[0m13:24:45.196671 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m13:24:45.196834 [debug] [MainThread]: On master: Close
[0m13:24:45.198785 [debug] [Thread-1 (]: Began running node model.supercell.fact_bill_generation
[0m13:24:45.199329 [info ] [Thread-1 (]: 1 of 1 START sql view model main.fact_bill_generation .......................... [RUN]
[0m13:24:45.199774 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_supercell_main, now model.supercell.fact_bill_generation)
[0m13:24:45.200144 [debug] [Thread-1 (]: Began compiling node model.supercell.fact_bill_generation
[0m13:24:45.208973 [debug] [Thread-1 (]: Writing injected SQL for node "model.supercell.fact_bill_generation"
[0m13:24:45.209709 [debug] [Thread-1 (]: Began executing node model.supercell.fact_bill_generation
[0m13:24:45.233880 [debug] [Thread-1 (]: Writing runtime sql for node "model.supercell.fact_bill_generation"
[0m13:24:45.234593 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.fact_bill_generation"
[0m13:24:45.234888 [debug] [Thread-1 (]: On model.supercell.fact_bill_generation: BEGIN
[0m13:24:45.235094 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m13:24:45.235676 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m13:24:45.235903 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.fact_bill_generation"
[0m13:24:45.236100 [debug] [Thread-1 (]: On model.supercell.fact_bill_generation: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.fact_bill_generation"} */

  
  create view "supercell"."main"."fact_bill_generation__dbt_tmp" as (
    select 
    md5(concat(linked_account_id, '_', service_code, '_', instance_type, '_', region, '_', CAST(usage_start_date AS VARCHAR), '_', CAST(usage_end_date AS VARCHAR))) AS resource_id,
    usage_start_date as start_date,
    usage_end_date as bill_date,
    region,
    usage_amount as bill_amount,
    operation
from "supercell"."main"."cleaned_usagelogs"
  );

[0m13:24:45.236761 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:24:45.240885 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.fact_bill_generation"
[0m13:24:45.241163 [debug] [Thread-1 (]: On model.supercell.fact_bill_generation: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.fact_bill_generation"} */
alter view "supercell"."main"."fact_bill_generation" rename to "fact_bill_generation__dbt_backup"
[0m13:24:45.241872 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:24:45.243600 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.fact_bill_generation"
[0m13:24:45.243839 [debug] [Thread-1 (]: On model.supercell.fact_bill_generation: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.fact_bill_generation"} */
alter view "supercell"."main"."fact_bill_generation__dbt_tmp" rename to "fact_bill_generation"
[0m13:24:45.244245 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m13:24:45.252366 [debug] [Thread-1 (]: On model.supercell.fact_bill_generation: COMMIT
[0m13:24:45.252756 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.fact_bill_generation"
[0m13:24:45.252987 [debug] [Thread-1 (]: On model.supercell.fact_bill_generation: COMMIT
[0m13:24:45.256922 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m13:24:45.260478 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.fact_bill_generation"
[0m13:24:45.260766 [debug] [Thread-1 (]: On model.supercell.fact_bill_generation: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.fact_bill_generation"} */
drop view if exists "supercell"."main"."fact_bill_generation__dbt_backup" cascade
[0m13:24:45.262665 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m13:24:45.264262 [debug] [Thread-1 (]: On model.supercell.fact_bill_generation: Close
[0m13:24:45.265689 [info ] [Thread-1 (]: 1 of 1 OK created sql view model main.fact_bill_generation ..................... [[32mOK[0m in 0.07s]
[0m13:24:45.266078 [debug] [Thread-1 (]: Finished running node model.supercell.fact_bill_generation
[0m13:24:45.267450 [debug] [MainThread]: Using duckdb connection "master"
[0m13:24:45.267752 [debug] [MainThread]: On master: BEGIN
[0m13:24:45.267946 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m13:24:45.268467 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m13:24:45.268694 [debug] [MainThread]: On master: COMMIT
[0m13:24:45.268877 [debug] [MainThread]: Using duckdb connection "master"
[0m13:24:45.269054 [debug] [MainThread]: On master: COMMIT
[0m13:24:45.269546 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m13:24:45.269876 [debug] [MainThread]: On master: Close
[0m13:24:45.270342 [debug] [MainThread]: Connection 'master' was properly closed.
[0m13:24:45.270596 [debug] [MainThread]: Connection 'model.supercell.fact_bill_generation' was properly closed.
[0m13:24:45.270846 [info ] [MainThread]: 
[0m13:24:45.271058 [info ] [MainThread]: Finished running 1 view model in 0 hours 0 minutes and 0.16 seconds (0.16s).
[0m13:24:45.271586 [debug] [MainThread]: Command end result
[0m13:24:45.285772 [debug] [MainThread]: Wrote artifact WritableManifest to /home/harsha/data_actions/supercell_cloudops/target/manifest.json
[0m13:24:45.287106 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/harsha/data_actions/supercell_cloudops/target/semantic_manifest.json
[0m13:24:45.290899 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/harsha/data_actions/supercell_cloudops/target/run_results.json
[0m13:24:45.291152 [info ] [MainThread]: 
[0m13:24:45.291415 [info ] [MainThread]: [32mCompleted successfully[0m
[0m13:24:45.291609 [info ] [MainThread]: 
[0m13:24:45.291794 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
[0m13:24:45.292302 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 0.7175706, "process_in_blocks": "0", "process_kernel_time": 0.09487, "process_mem_max_rss": "146008", "process_out_blocks": "2736", "process_user_time": 1.619791}
[0m13:24:45.292613 [debug] [MainThread]: Command `dbt run` succeeded at 13:24:45.292552 after 0.72 seconds
[0m13:24:45.292829 [debug] [MainThread]: Flushing usage events


============================== 15:30:47.952903 | 6a8b9263-6a5c-4909-a7a9-cefa0ad8a355 ==============================
[0m15:30:47.952903 [info ] [MainThread]: Running with dbt=1.9.4
[0m15:30:47.959043 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/harsha/data_actions/supercell_cloudops/logs', 'profiles_dir': '/home/harsha/data_actions/supercell_cloudops', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run --select analyses dbt_project.yml dim_accounts.sql finops.db logs macros models profiles.yml README.md requirements.txt seeds snapshots supercell.duckdb supercell_env supercell.ipynb target tests', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'False'}
[0m15:30:47.959626 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality

User config should be moved from the 'config' key in profiles.yml to the 'flags' key in dbt_project.yml.
[0m15:30:48.294715 [info ] [MainThread]: Registered adapter: duckdb=1.9.3
[0m15:30:48.369052 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m15:30:48.485675 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m15:30:48.486370 [debug] [MainThread]: Partial parsing: added file: supercell://models/supercell_models/dim_resource.sql
[0m15:30:48.486888 [debug] [MainThread]: Partial parsing: updated file: supercell://models/supercell_models/fact_bill_generation.sql
[0m15:30:48.865936 [debug] [MainThread]: Wrote artifact WritableManifest to /home/harsha/data_actions/supercell_cloudops/target/manifest.json
[0m15:30:48.868836 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/harsha/data_actions/supercell_cloudops/target/semantic_manifest.json
[0m15:30:48.886999 [info ] [MainThread]: Found 6 models, 4 data tests, 428 macros
[0m15:30:48.888009 [warn ] [MainThread]: The selection criterion 'analyses' does not match any enabled nodes
[0m15:30:48.888581 [warn ] [MainThread]: The selection criterion 'dbt_project.yml' does not match any enabled nodes
[0m15:30:48.889350 [warn ] [MainThread]: The selection criterion 'dim_accounts.sql' does not match any enabled nodes
[0m15:30:48.889811 [warn ] [MainThread]: The selection criterion 'finops.db' does not match any enabled nodes
[0m15:30:48.890216 [warn ] [MainThread]: The selection criterion 'logs' does not match any enabled nodes
[0m15:30:48.890630 [warn ] [MainThread]: The selection criterion 'macros' does not match any enabled nodes
[0m15:30:48.891107 [warn ] [MainThread]: The selection criterion 'models' does not match any enabled nodes
[0m15:30:48.891506 [warn ] [MainThread]: The selection criterion 'profiles.yml' does not match any enabled nodes
[0m15:30:48.891939 [warn ] [MainThread]: The selection criterion 'README.md' does not match any enabled nodes
[0m15:30:48.892377 [warn ] [MainThread]: The selection criterion 'requirements.txt' does not match any enabled nodes
[0m15:30:48.892794 [warn ] [MainThread]: The selection criterion 'seeds' does not match any enabled nodes
[0m15:30:48.893190 [warn ] [MainThread]: The selection criterion 'snapshots' does not match any enabled nodes
[0m15:30:48.893604 [warn ] [MainThread]: The selection criterion 'supercell.duckdb' does not match any enabled nodes
[0m15:30:48.893987 [warn ] [MainThread]: The selection criterion 'supercell_env' does not match any enabled nodes
[0m15:30:48.894351 [warn ] [MainThread]: The selection criterion 'supercell.ipynb' does not match any enabled nodes
[0m15:30:48.894738 [warn ] [MainThread]: The selection criterion 'target' does not match any enabled nodes
[0m15:30:48.895133 [warn ] [MainThread]: The selection criterion 'tests' does not match any enabled nodes
[0m15:30:48.897059 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m15:30:48.897964 [debug] [MainThread]: Command end result
[0m15:30:48.917281 [debug] [MainThread]: Wrote artifact WritableManifest to /home/harsha/data_actions/supercell_cloudops/target/manifest.json
[0m15:30:48.919811 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/harsha/data_actions/supercell_cloudops/target/semantic_manifest.json
[0m15:30:48.924086 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/harsha/data_actions/supercell_cloudops/target/run_results.json
[0m15:30:48.925357 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.0373322, "process_in_blocks": "38792", "process_kernel_time": 0.207649, "process_mem_max_rss": "122920", "process_out_blocks": "2696", "process_user_time": 2.616184}
[0m15:30:48.926024 [debug] [MainThread]: Command `dbt run` succeeded at 15:30:48.925896 after 1.04 seconds
[0m15:30:48.926467 [debug] [MainThread]: Flushing usage events


============================== 15:30:56.191892 | 411f408c-77b7-4d89-838a-1db8857dcd86 ==============================
[0m15:30:56.191892 [info ] [MainThread]: Running with dbt=1.9.4
[0m15:30:56.197326 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/harsha/data_actions/supercell_cloudops', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/harsha/data_actions/supercell_cloudops/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'False'}
[0m15:30:56.198211 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality

User config should be moved from the 'config' key in profiles.yml to the 'flags' key in dbt_project.yml.
[0m15:30:56.515942 [info ] [MainThread]: Registered adapter: duckdb=1.9.3
[0m15:30:56.589092 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m15:30:56.698744 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:30:56.699309 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:30:56.816392 [debug] [MainThread]: Wrote artifact WritableManifest to /home/harsha/data_actions/supercell_cloudops/target/manifest.json
[0m15:30:56.818200 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/harsha/data_actions/supercell_cloudops/target/semantic_manifest.json
[0m15:30:56.831621 [info ] [MainThread]: Found 6 models, 4 data tests, 428 macros
[0m15:30:56.834414 [info ] [MainThread]: 
[0m15:30:56.835049 [info ] [MainThread]: Concurrency: 4 threads (target='default')
[0m15:30:56.835421 [info ] [MainThread]: 
[0m15:30:56.836019 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m15:30:56.843576 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_supercell'
[0m15:30:56.896116 [debug] [ThreadPool]: Using duckdb connection "list_supercell"
[0m15:30:56.896818 [debug] [ThreadPool]: On list_supercell: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "connection_name": "list_supercell"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"supercell"'
    
  
  
[0m15:30:56.897304 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:30:56.918426 [debug] [ThreadPool]: SQL status: OK in 0.021 seconds
[0m15:30:56.920125 [debug] [ThreadPool]: On list_supercell: Close
[0m15:30:56.921287 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_supercell, now create_supercell_main)
[0m15:30:56.921905 [debug] [ThreadPool]: Creating schema "database: "supercell"
schema: "main"
"
[0m15:30:56.929781 [debug] [ThreadPool]: Using duckdb connection "create_supercell_main"
[0m15:30:56.930243 [debug] [ThreadPool]: On create_supercell_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "connection_name": "create_supercell_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='supercell'
        and type='sqlite'
    
  
[0m15:30:56.930583 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:30:56.931790 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m15:30:56.933300 [debug] [ThreadPool]: Using duckdb connection "create_supercell_main"
[0m15:30:56.933709 [debug] [ThreadPool]: On create_supercell_main: BEGIN
[0m15:30:56.934258 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m15:30:56.934609 [debug] [ThreadPool]: Using duckdb connection "create_supercell_main"
[0m15:30:56.934967 [debug] [ThreadPool]: On create_supercell_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "connection_name": "create_supercell_main"} */

    
    
        create schema if not exists "supercell"."main"
    
[0m15:30:56.935629 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m15:30:56.936609 [debug] [ThreadPool]: On create_supercell_main: COMMIT
[0m15:30:56.937038 [debug] [ThreadPool]: Using duckdb connection "create_supercell_main"
[0m15:30:56.937342 [debug] [ThreadPool]: On create_supercell_main: COMMIT
[0m15:30:56.937850 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m15:30:56.938210 [debug] [ThreadPool]: On create_supercell_main: Close
[0m15:30:56.940605 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_supercell_main, now list_supercell_main)
[0m15:30:56.949466 [debug] [ThreadPool]: Using duckdb connection "list_supercell_main"
[0m15:30:56.950065 [debug] [ThreadPool]: On list_supercell_main: BEGIN
[0m15:30:56.950469 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:30:56.951393 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m15:30:56.951849 [debug] [ThreadPool]: Using duckdb connection "list_supercell_main"
[0m15:30:56.952242 [debug] [ThreadPool]: On list_supercell_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "connection_name": "list_supercell_main"} */
select
      'supercell' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'supercell'
  
[0m15:30:56.975515 [debug] [ThreadPool]: SQL status: OK in 0.023 seconds
[0m15:30:56.978591 [debug] [ThreadPool]: On list_supercell_main: ROLLBACK
[0m15:30:56.981687 [debug] [ThreadPool]: Failed to rollback 'list_supercell_main'
[0m15:30:56.982689 [debug] [ThreadPool]: On list_supercell_main: Close
[0m15:30:56.986630 [debug] [MainThread]: Using duckdb connection "master"
[0m15:30:56.987436 [debug] [MainThread]: On master: BEGIN
[0m15:30:56.988008 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:30:56.989162 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m15:30:56.989758 [debug] [MainThread]: On master: COMMIT
[0m15:30:56.990265 [debug] [MainThread]: Using duckdb connection "master"
[0m15:30:56.990763 [debug] [MainThread]: On master: COMMIT
[0m15:30:56.991518 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m15:30:56.992149 [debug] [MainThread]: On master: Close
[0m15:30:56.997390 [debug] [Thread-1 (]: Began running node model.supercell.cleaned_usagelogs
[0m15:30:56.998604 [info ] [Thread-1 (]: 1 of 6 START sql table model main.cleaned_usagelogs ............................ [RUN]
[0m15:30:56.999478 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_supercell_main, now model.supercell.cleaned_usagelogs)
[0m15:30:57.000355 [debug] [Thread-2 (]: Began running node model.supercell.my_first_dbt_model
[0m15:30:57.001298 [debug] [Thread-1 (]: Began compiling node model.supercell.cleaned_usagelogs
[0m15:30:57.002593 [info ] [Thread-2 (]: 2 of 6 START sql table model main.my_first_dbt_model ........................... [RUN]
[0m15:30:57.016894 [debug] [Thread-1 (]: Writing injected SQL for node "model.supercell.cleaned_usagelogs"
[0m15:30:57.018455 [debug] [Thread-2 (]: Acquiring new duckdb connection 'model.supercell.my_first_dbt_model'
[0m15:30:57.020785 [debug] [Thread-2 (]: Began compiling node model.supercell.my_first_dbt_model
[0m15:30:57.027098 [debug] [Thread-1 (]: Began executing node model.supercell.cleaned_usagelogs
[0m15:30:57.026463 [debug] [Thread-2 (]: Writing injected SQL for node "model.supercell.my_first_dbt_model"
[0m15:30:57.057803 [debug] [Thread-2 (]: Began executing node model.supercell.my_first_dbt_model
[0m15:30:57.090862 [debug] [Thread-1 (]: Writing runtime sql for node "model.supercell.cleaned_usagelogs"
[0m15:30:57.091568 [debug] [Thread-2 (]: Writing runtime sql for node "model.supercell.my_first_dbt_model"
[0m15:30:57.092470 [debug] [Thread-2 (]: Using duckdb connection "model.supercell.my_first_dbt_model"
[0m15:30:57.092974 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.cleaned_usagelogs"
[0m15:30:57.093437 [debug] [Thread-2 (]: On model.supercell.my_first_dbt_model: BEGIN
[0m15:30:57.093874 [debug] [Thread-1 (]: On model.supercell.cleaned_usagelogs: BEGIN
[0m15:30:57.094313 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m15:30:57.094755 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:30:57.096032 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m15:30:57.096481 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m15:30:57.096941 [debug] [Thread-2 (]: Using duckdb connection "model.supercell.my_first_dbt_model"
[0m15:30:57.097354 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.cleaned_usagelogs"
[0m15:30:57.097780 [debug] [Thread-2 (]: On model.supercell.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.my_first_dbt_model"} */

  
    
    

    create  table
      "supercell"."main"."my_first_dbt_model__dbt_tmp"
  
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    );
  
  
[0m15:30:57.098231 [debug] [Thread-1 (]: On model.supercell.cleaned_usagelogs: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.cleaned_usagelogs"} */

  
    
    

    create  table
      "supercell"."main"."cleaned_usagelogs__dbt_tmp"
  
    as (
      


SELECT
    CAST("LinkedAccountId" AS VARCHAR) AS linked_account_id,
    CAST("bill/PayerAccountId" AS VARCHAR) AS payer_account_id,
    CAST("lineItem/UsageStartDate" AS TIMESTAMP) AS usage_start_date,
    CAST("lineItem/UsageEndDate" AS TIMESTAMP) AS usage_end_date,
    CAST("lineItem/UsageAmount" AS DECIMAL(18, 6)) AS usage_amount,
    CAST("lineItem/Operation" AS VARCHAR) AS operation,
    CAST("pricing/PricingModel" AS VARCHAR) AS pricing_model,
    CAST("resourceTags/TagKeys" AS VARCHAR) AS tag_keys,
    CAST("resourceTags/TagValues" AS VARCHAR) AS tag_values,
    CAST("product/Region" AS VARCHAR) AS region,
    CAST("product/ServiceCode" AS VARCHAR) AS service_code,
    CAST("product/InstanceType" AS VARCHAR) AS instance_type,
    CAST("amortized_cost" AS DECIMAL(18, 6)) AS amortized_cost,
    CAST("product/Description" AS VARCHAR) AS description
FROM supercell_usagelogs
    );
  
  
[0m15:30:57.100109 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m15:30:57.108147 [debug] [Thread-2 (]: Using duckdb connection "model.supercell.my_first_dbt_model"
[0m15:30:57.108808 [debug] [Thread-2 (]: On model.supercell.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.my_first_dbt_model"} */
alter table "supercell"."main"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m15:30:57.109931 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m15:30:57.126860 [debug] [Thread-2 (]: On model.supercell.my_first_dbt_model: COMMIT
[0m15:30:57.127586 [debug] [Thread-2 (]: Using duckdb connection "model.supercell.my_first_dbt_model"
[0m15:30:57.128169 [debug] [Thread-2 (]: On model.supercell.my_first_dbt_model: COMMIT
[0m15:30:57.134239 [debug] [Thread-2 (]: SQL status: OK in 0.005 seconds
[0m15:30:57.141030 [debug] [Thread-2 (]: Using duckdb connection "model.supercell.my_first_dbt_model"
[0m15:30:57.141681 [debug] [Thread-2 (]: On model.supercell.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.my_first_dbt_model"} */
drop table if exists "supercell"."main"."my_first_dbt_model__dbt_backup" cascade
[0m15:30:57.143004 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m15:30:57.146467 [debug] [Thread-2 (]: On model.supercell.my_first_dbt_model: Close
[0m15:30:57.149895 [info ] [Thread-2 (]: 2 of 6 OK created sql table model main.my_first_dbt_model ...................... [[32mOK[0m in 0.13s]
[0m15:30:57.150747 [debug] [Thread-2 (]: Finished running node model.supercell.my_first_dbt_model
[0m15:30:57.151941 [debug] [Thread-4 (]: Began running node model.supercell.my_second_dbt_model
[0m15:30:57.153474 [info ] [Thread-4 (]: 3 of 6 START sql view model main.my_second_dbt_model ........................... [RUN]
[0m15:30:57.155073 [debug] [Thread-4 (]: Acquiring new duckdb connection 'model.supercell.my_second_dbt_model'
[0m15:30:57.155951 [debug] [Thread-4 (]: Began compiling node model.supercell.my_second_dbt_model
[0m15:30:57.163441 [debug] [Thread-4 (]: Writing injected SQL for node "model.supercell.my_second_dbt_model"
[0m15:30:57.165950 [debug] [Thread-4 (]: Began executing node model.supercell.my_second_dbt_model
[0m15:30:57.193740 [debug] [Thread-4 (]: Writing runtime sql for node "model.supercell.my_second_dbt_model"
[0m15:30:57.194831 [debug] [Thread-4 (]: Using duckdb connection "model.supercell.my_second_dbt_model"
[0m15:30:57.195406 [debug] [Thread-4 (]: On model.supercell.my_second_dbt_model: BEGIN
[0m15:30:57.195828 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m15:30:57.196729 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m15:30:57.197157 [debug] [Thread-4 (]: Using duckdb connection "model.supercell.my_second_dbt_model"
[0m15:30:57.197521 [debug] [Thread-4 (]: On model.supercell.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.my_second_dbt_model"} */

  
  create view "supercell"."main"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "supercell"."main"."my_first_dbt_model"
where id = 1
  );

[0m15:30:57.198435 [debug] [Thread-4 (]: SQL status: OK in 0.000 seconds
[0m15:30:57.201929 [debug] [Thread-4 (]: Using duckdb connection "model.supercell.my_second_dbt_model"
[0m15:30:57.202445 [debug] [Thread-4 (]: On model.supercell.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.my_second_dbt_model"} */
alter view "supercell"."main"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m15:30:57.203446 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m15:30:57.205195 [debug] [Thread-4 (]: On model.supercell.my_second_dbt_model: COMMIT
[0m15:30:57.205678 [debug] [Thread-4 (]: Using duckdb connection "model.supercell.my_second_dbt_model"
[0m15:30:57.206075 [debug] [Thread-4 (]: On model.supercell.my_second_dbt_model: COMMIT
[0m15:30:57.208933 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m15:30:57.213358 [debug] [Thread-4 (]: Using duckdb connection "model.supercell.my_second_dbt_model"
[0m15:30:57.214231 [debug] [Thread-4 (]: On model.supercell.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.my_second_dbt_model"} */
drop view if exists "supercell"."main"."my_second_dbt_model__dbt_backup" cascade
[0m15:30:57.215692 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m15:30:57.218221 [debug] [Thread-4 (]: On model.supercell.my_second_dbt_model: Close
[0m15:30:57.219895 [info ] [Thread-4 (]: 3 of 6 OK created sql view model main.my_second_dbt_model ...................... [[32mOK[0m in 0.06s]
[0m15:30:57.220669 [debug] [Thread-4 (]: Finished running node model.supercell.my_second_dbt_model
[0m15:30:57.665695 [debug] [Thread-1 (]: SQL status: OK in 0.567 seconds
[0m15:30:57.669216 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.cleaned_usagelogs"
[0m15:30:57.669702 [debug] [Thread-1 (]: On model.supercell.cleaned_usagelogs: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.cleaned_usagelogs"} */
alter table "supercell"."main"."cleaned_usagelogs" rename to "cleaned_usagelogs__dbt_backup"
[0m15:30:57.670625 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:30:57.673681 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.cleaned_usagelogs"
[0m15:30:57.674123 [debug] [Thread-1 (]: On model.supercell.cleaned_usagelogs: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.cleaned_usagelogs"} */
alter table "supercell"."main"."cleaned_usagelogs__dbt_tmp" rename to "cleaned_usagelogs"
[0m15:30:57.674872 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:30:57.679576 [debug] [Thread-1 (]: On model.supercell.cleaned_usagelogs: COMMIT
[0m15:30:57.680091 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.cleaned_usagelogs"
[0m15:30:57.680484 [debug] [Thread-1 (]: On model.supercell.cleaned_usagelogs: COMMIT
[0m15:30:57.698960 [debug] [Thread-1 (]: SQL status: OK in 0.018 seconds
[0m15:30:57.701733 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.cleaned_usagelogs"
[0m15:30:57.702183 [debug] [Thread-1 (]: On model.supercell.cleaned_usagelogs: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.cleaned_usagelogs"} */
drop table if exists "supercell"."main"."cleaned_usagelogs__dbt_backup" cascade
[0m15:30:57.704721 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m15:30:57.706490 [debug] [Thread-1 (]: On model.supercell.cleaned_usagelogs: Close
[0m15:30:57.716880 [info ] [Thread-1 (]: 1 of 6 OK created sql table model main.cleaned_usagelogs ....................... [[32mOK[0m in 0.72s]
[0m15:30:57.717801 [debug] [Thread-1 (]: Finished running node model.supercell.cleaned_usagelogs
[0m15:30:57.719343 [debug] [Thread-2 (]: Began running node model.supercell.dim_resource
[0m15:30:57.720553 [debug] [Thread-3 (]: Began running node model.supercell.fact_bill_generation
[0m15:30:57.721369 [info ] [Thread-2 (]: 4 of 6 START sql table model main.dim_resource ................................. [RUN]
[0m15:30:57.722211 [debug] [Thread-4 (]: Began running node model.supercell.total_cost
[0m15:30:57.723156 [info ] [Thread-3 (]: 5 of 6 START sql table model main.fact_bill_generation ......................... [RUN]
[0m15:30:57.723933 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.supercell.my_first_dbt_model, now model.supercell.dim_resource)
[0m15:30:57.724624 [info ] [Thread-4 (]: 6 of 6 START sql table model main.total_cost ................................... [RUN]
[0m15:30:57.726096 [debug] [Thread-3 (]: Acquiring new duckdb connection 'model.supercell.fact_bill_generation'
[0m15:30:57.727138 [debug] [Thread-2 (]: Began compiling node model.supercell.dim_resource
[0m15:30:57.727907 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.supercell.my_second_dbt_model, now model.supercell.total_cost)
[0m15:30:57.728899 [debug] [Thread-3 (]: Began compiling node model.supercell.fact_bill_generation
[0m15:30:57.733781 [debug] [Thread-2 (]: Writing injected SQL for node "model.supercell.dim_resource"
[0m15:30:57.734448 [debug] [Thread-4 (]: Began compiling node model.supercell.total_cost
[0m15:30:57.738579 [debug] [Thread-3 (]: Writing injected SQL for node "model.supercell.fact_bill_generation"
[0m15:30:57.742268 [debug] [Thread-4 (]: Writing injected SQL for node "model.supercell.total_cost"
[0m15:30:57.742872 [debug] [Thread-2 (]: Began executing node model.supercell.dim_resource
[0m15:30:57.749791 [debug] [Thread-2 (]: Writing runtime sql for node "model.supercell.dim_resource"
[0m15:30:57.751399 [debug] [Thread-4 (]: Began executing node model.supercell.total_cost
[0m15:30:57.752075 [debug] [Thread-3 (]: Began executing node model.supercell.fact_bill_generation
[0m15:30:57.755906 [debug] [Thread-4 (]: Writing runtime sql for node "model.supercell.total_cost"
[0m15:30:57.756810 [debug] [Thread-2 (]: Using duckdb connection "model.supercell.dim_resource"
[0m15:30:57.762809 [debug] [Thread-3 (]: Writing runtime sql for node "model.supercell.fact_bill_generation"
[0m15:30:57.764192 [debug] [Thread-2 (]: On model.supercell.dim_resource: BEGIN
[0m15:30:57.765008 [debug] [Thread-4 (]: Using duckdb connection "model.supercell.total_cost"
[0m15:30:57.766238 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:30:57.767143 [debug] [Thread-4 (]: On model.supercell.total_cost: BEGIN
[0m15:30:57.768837 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m15:30:57.770204 [debug] [Thread-2 (]: SQL status: OK in 0.004 seconds
[0m15:30:57.771029 [debug] [Thread-2 (]: Using duckdb connection "model.supercell.dim_resource"
[0m15:30:57.772024 [debug] [Thread-2 (]: On model.supercell.dim_resource: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.dim_resource"} */

  
    
    

    create  table
      "supercell"."main"."dim_resource__dbt_tmp"
  
    as (
      


select
    md5(concat(linked_account_id, '_', service_code, '_', instance_type, '_', region, '_', CAST(usage_start_date AS VARCHAR), '_', CAST(usage_end_date AS VARCHAR))) AS resource_id,
    linked_account_id as linked_account_id,
    region,
    service_code as product,
    instance_type as instance_type,
    pricing_model as pricing_model
from "supercell"."main"."cleaned_usagelogs"
    );
  
  
[0m15:30:57.773050 [debug] [Thread-3 (]: Using duckdb connection "model.supercell.fact_bill_generation"
[0m15:30:57.774215 [debug] [Thread-4 (]: SQL status: OK in 0.006 seconds
[0m15:30:57.774999 [debug] [Thread-3 (]: On model.supercell.fact_bill_generation: BEGIN
[0m15:30:57.776100 [debug] [Thread-4 (]: Using duckdb connection "model.supercell.total_cost"
[0m15:30:57.777302 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m15:30:57.778371 [debug] [Thread-4 (]: On model.supercell.total_cost: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.total_cost"} */

  
    
    

    create  table
      "supercell"."main"."total_cost__dbt_tmp"
  
    as (
      


select
    DATE_TRUNC('month', usage_end_date)  as month,
    region,
    instance_type,
    pricing_model,
    service_code,
    tag_values as tag_values,
    SUM(usage_amount) as total_cost
from "supercell"."main"."cleaned_usagelogs"
group by month,region, instance_type, pricing_model, service_code, tag_values
    );
  
  
[0m15:30:57.780711 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m15:30:57.782084 [debug] [Thread-3 (]: Using duckdb connection "model.supercell.fact_bill_generation"
[0m15:30:57.783614 [debug] [Thread-3 (]: On model.supercell.fact_bill_generation: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.fact_bill_generation"} */

  
    
    

    create  table
      "supercell"."main"."fact_bill_generation__dbt_tmp"
  
    as (
      


select
    md5(concat(linked_account_id, '_', service_code, '_', instance_type, '_', region, '_', CAST(usage_start_date AS VARCHAR), '_', CAST(usage_end_date AS VARCHAR))) AS resource_id,
    usage_start_date as start_date,
    usage_end_date as bill_date,
    usage_amount as bill_amount,
    operation
from "supercell"."main"."cleaned_usagelogs"
    );
  
  
[0m15:30:57.868249 [debug] [Thread-4 (]: SQL status: OK in 0.088 seconds
[0m15:30:57.874445 [debug] [Thread-4 (]: Using duckdb connection "model.supercell.total_cost"
[0m15:30:57.875414 [debug] [Thread-4 (]: On model.supercell.total_cost: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.total_cost"} */
alter table "supercell"."main"."total_cost" rename to "total_cost__dbt_backup"
[0m15:30:57.877088 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m15:30:57.882593 [debug] [Thread-4 (]: Using duckdb connection "model.supercell.total_cost"
[0m15:30:57.883568 [debug] [Thread-4 (]: On model.supercell.total_cost: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.total_cost"} */
alter table "supercell"."main"."total_cost__dbt_tmp" rename to "total_cost"
[0m15:30:57.885282 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m15:30:57.888627 [debug] [Thread-4 (]: On model.supercell.total_cost: COMMIT
[0m15:30:57.889499 [debug] [Thread-4 (]: Using duckdb connection "model.supercell.total_cost"
[0m15:30:57.890272 [debug] [Thread-4 (]: On model.supercell.total_cost: COMMIT
[0m15:30:57.896309 [debug] [Thread-4 (]: SQL status: OK in 0.005 seconds
[0m15:30:57.900772 [debug] [Thread-4 (]: Using duckdb connection "model.supercell.total_cost"
[0m15:30:57.901678 [debug] [Thread-4 (]: On model.supercell.total_cost: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.total_cost"} */
drop table if exists "supercell"."main"."total_cost__dbt_backup" cascade
[0m15:30:57.904726 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m15:30:57.907520 [debug] [Thread-4 (]: On model.supercell.total_cost: Close
[0m15:30:57.911443 [info ] [Thread-4 (]: 6 of 6 OK created sql table model main.total_cost .............................. [[32mOK[0m in 0.18s]
[0m15:30:57.913092 [debug] [Thread-4 (]: Finished running node model.supercell.total_cost
[0m15:30:58.115973 [debug] [Thread-3 (]: SQL status: OK in 0.331 seconds
[0m15:30:58.119431 [debug] [Thread-3 (]: Using duckdb connection "model.supercell.fact_bill_generation"
[0m15:30:58.120258 [debug] [Thread-3 (]: On model.supercell.fact_bill_generation: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.fact_bill_generation"} */
alter view "supercell"."main"."fact_bill_generation" rename to "fact_bill_generation__dbt_backup"
[0m15:30:58.121334 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m15:30:58.124484 [debug] [Thread-3 (]: Using duckdb connection "model.supercell.fact_bill_generation"
[0m15:30:58.124958 [debug] [Thread-3 (]: On model.supercell.fact_bill_generation: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.fact_bill_generation"} */
alter table "supercell"."main"."fact_bill_generation__dbt_tmp" rename to "fact_bill_generation"
[0m15:30:58.125807 [debug] [Thread-3 (]: SQL status: OK in 0.000 seconds
[0m15:30:58.128017 [debug] [Thread-3 (]: On model.supercell.fact_bill_generation: COMMIT
[0m15:30:58.128557 [debug] [Thread-3 (]: Using duckdb connection "model.supercell.fact_bill_generation"
[0m15:30:58.129056 [debug] [Thread-3 (]: On model.supercell.fact_bill_generation: COMMIT
[0m15:30:58.175714 [debug] [Thread-3 (]: SQL status: OK in 0.046 seconds
[0m15:30:58.179914 [debug] [Thread-3 (]: Using duckdb connection "model.supercell.fact_bill_generation"
[0m15:30:58.180775 [debug] [Thread-3 (]: On model.supercell.fact_bill_generation: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.fact_bill_generation"} */
drop view if exists "supercell"."main"."fact_bill_generation__dbt_backup" cascade
[0m15:30:58.183934 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m15:30:58.186365 [debug] [Thread-3 (]: On model.supercell.fact_bill_generation: Close
[0m15:30:58.203707 [info ] [Thread-3 (]: 5 of 6 OK created sql table model main.fact_bill_generation .................... [[32mOK[0m in 0.48s]
[0m15:30:58.204577 [debug] [Thread-3 (]: Finished running node model.supercell.fact_bill_generation
[0m15:30:58.263960 [debug] [Thread-2 (]: SQL status: OK in 0.491 seconds
[0m15:30:58.267422 [debug] [Thread-2 (]: Using duckdb connection "model.supercell.dim_resource"
[0m15:30:58.267893 [debug] [Thread-2 (]: On model.supercell.dim_resource: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.dim_resource"} */
alter table "supercell"."main"."dim_resource__dbt_tmp" rename to "dim_resource"
[0m15:30:58.268946 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m15:30:58.271082 [debug] [Thread-2 (]: On model.supercell.dim_resource: COMMIT
[0m15:30:58.271539 [debug] [Thread-2 (]: Using duckdb connection "model.supercell.dim_resource"
[0m15:30:58.271931 [debug] [Thread-2 (]: On model.supercell.dim_resource: COMMIT
[0m15:30:58.283855 [debug] [Thread-2 (]: SQL status: OK in 0.011 seconds
[0m15:30:58.286453 [debug] [Thread-2 (]: Using duckdb connection "model.supercell.dim_resource"
[0m15:30:58.286937 [debug] [Thread-2 (]: On model.supercell.dim_resource: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.dim_resource"} */
drop table if exists "supercell"."main"."dim_resource__dbt_backup" cascade
[0m15:30:58.287891 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m15:30:58.289462 [debug] [Thread-2 (]: On model.supercell.dim_resource: Close
[0m15:30:58.292190 [info ] [Thread-2 (]: 4 of 6 OK created sql table model main.dim_resource ............................ [[32mOK[0m in 0.57s]
[0m15:30:58.292959 [debug] [Thread-2 (]: Finished running node model.supercell.dim_resource
[0m15:30:58.295578 [debug] [MainThread]: Using duckdb connection "master"
[0m15:30:58.296491 [debug] [MainThread]: On master: BEGIN
[0m15:30:58.297037 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:30:58.298075 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m15:30:58.298536 [debug] [MainThread]: On master: COMMIT
[0m15:30:58.298978 [debug] [MainThread]: Using duckdb connection "master"
[0m15:30:58.299358 [debug] [MainThread]: On master: COMMIT
[0m15:30:58.300249 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m15:30:58.300786 [debug] [MainThread]: On master: Close
[0m15:30:58.302355 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:30:58.302838 [debug] [MainThread]: Connection 'model.supercell.cleaned_usagelogs' was properly closed.
[0m15:30:58.303179 [debug] [MainThread]: Connection 'model.supercell.dim_resource' was properly closed.
[0m15:30:58.303502 [debug] [MainThread]: Connection 'model.supercell.total_cost' was properly closed.
[0m15:30:58.303865 [debug] [MainThread]: Connection 'model.supercell.fact_bill_generation' was properly closed.
[0m15:30:58.304660 [info ] [MainThread]: 
[0m15:30:58.305220 [info ] [MainThread]: Finished running 5 table models, 1 view model in 0 hours 0 minutes and 1.47 seconds (1.47s).
[0m15:30:58.306751 [debug] [MainThread]: Command end result
[0m15:30:58.333472 [debug] [MainThread]: Wrote artifact WritableManifest to /home/harsha/data_actions/supercell_cloudops/target/manifest.json
[0m15:30:58.336349 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/harsha/data_actions/supercell_cloudops/target/semantic_manifest.json
[0m15:30:58.345409 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/harsha/data_actions/supercell_cloudops/target/run_results.json
[0m15:30:58.346367 [info ] [MainThread]: 
[0m15:30:58.347034 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:30:58.347461 [info ] [MainThread]: 
[0m15:30:58.347869 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m15:30:58.348990 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 2.2211242, "process_in_blocks": "5336", "process_kernel_time": 0.717025, "process_mem_max_rss": "342236", "process_out_blocks": "56392", "process_user_time": 8.109982}
[0m15:30:58.349581 [debug] [MainThread]: Command `dbt run` succeeded at 15:30:58.349462 after 2.22 seconds
[0m15:30:58.350059 [debug] [MainThread]: Flushing usage events


============================== 15:38:07.070404 | 48be00cb-c850-4c6d-96c4-d049e6d7d0d7 ==============================
[0m15:38:07.070404 [info ] [MainThread]: Running with dbt=1.9.4
[0m15:38:07.074590 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/harsha/data_actions/supercell_cloudops/logs', 'debug': 'False', 'profiles_dir': '/home/harsha/data_actions/supercell_cloudops', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'False'}
[0m15:38:07.075225 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality

User config should be moved from the 'config' key in profiles.yml to the 'flags' key in dbt_project.yml.
[0m15:38:07.398383 [info ] [MainThread]: Registered adapter: duckdb=1.9.3
[0m15:38:07.470917 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m15:38:07.581335 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:38:07.582100 [debug] [MainThread]: Partial parsing: updated file: supercell://models/supercell_models/metrics/total_cost.sql
[0m15:38:07.969096 [debug] [MainThread]: Wrote artifact WritableManifest to /home/harsha/data_actions/supercell_cloudops/target/manifest.json
[0m15:38:07.971114 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/harsha/data_actions/supercell_cloudops/target/semantic_manifest.json
[0m15:38:07.984764 [info ] [MainThread]: Found 6 models, 4 data tests, 428 macros
[0m15:38:07.987739 [info ] [MainThread]: 
[0m15:38:07.988346 [info ] [MainThread]: Concurrency: 4 threads (target='default')
[0m15:38:07.988746 [info ] [MainThread]: 
[0m15:38:07.989433 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m15:38:07.997400 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_supercell'
[0m15:38:08.037448 [debug] [ThreadPool]: Using duckdb connection "list_supercell"
[0m15:38:08.038022 [debug] [ThreadPool]: On list_supercell: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "connection_name": "list_supercell"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"supercell"'
    
  
  
[0m15:38:08.038399 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:38:08.053758 [debug] [ThreadPool]: SQL status: OK in 0.015 seconds
[0m15:38:08.055481 [debug] [ThreadPool]: On list_supercell: Close
[0m15:38:08.056430 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_supercell, now create_supercell_main)
[0m15:38:08.057009 [debug] [ThreadPool]: Creating schema "database: "supercell"
schema: "main"
"
[0m15:38:08.065118 [debug] [ThreadPool]: Using duckdb connection "create_supercell_main"
[0m15:38:08.065604 [debug] [ThreadPool]: On create_supercell_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "connection_name": "create_supercell_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='supercell'
        and type='sqlite'
    
  
[0m15:38:08.066002 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:38:08.067364 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m15:38:08.068941 [debug] [ThreadPool]: Using duckdb connection "create_supercell_main"
[0m15:38:08.069327 [debug] [ThreadPool]: On create_supercell_main: BEGIN
[0m15:38:08.069922 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m15:38:08.070298 [debug] [ThreadPool]: Using duckdb connection "create_supercell_main"
[0m15:38:08.070614 [debug] [ThreadPool]: On create_supercell_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "connection_name": "create_supercell_main"} */

    
    
        create schema if not exists "supercell"."main"
    
[0m15:38:08.071222 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m15:38:08.072253 [debug] [ThreadPool]: On create_supercell_main: COMMIT
[0m15:38:08.072681 [debug] [ThreadPool]: Using duckdb connection "create_supercell_main"
[0m15:38:08.073020 [debug] [ThreadPool]: On create_supercell_main: COMMIT
[0m15:38:08.073543 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m15:38:08.073932 [debug] [ThreadPool]: On create_supercell_main: Close
[0m15:38:08.075909 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_supercell_main, now list_supercell_main)
[0m15:38:08.082430 [debug] [ThreadPool]: Using duckdb connection "list_supercell_main"
[0m15:38:08.082893 [debug] [ThreadPool]: On list_supercell_main: BEGIN
[0m15:38:08.083232 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:38:08.083956 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m15:38:08.084332 [debug] [ThreadPool]: Using duckdb connection "list_supercell_main"
[0m15:38:08.084662 [debug] [ThreadPool]: On list_supercell_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "connection_name": "list_supercell_main"} */
select
      'supercell' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'supercell'
  
[0m15:38:08.101127 [debug] [ThreadPool]: SQL status: OK in 0.016 seconds
[0m15:38:08.103061 [debug] [ThreadPool]: On list_supercell_main: ROLLBACK
[0m15:38:08.104470 [debug] [ThreadPool]: Failed to rollback 'list_supercell_main'
[0m15:38:08.104890 [debug] [ThreadPool]: On list_supercell_main: Close
[0m15:38:08.106915 [debug] [MainThread]: Using duckdb connection "master"
[0m15:38:08.107322 [debug] [MainThread]: On master: BEGIN
[0m15:38:08.107698 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:38:08.108488 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m15:38:08.108889 [debug] [MainThread]: On master: COMMIT
[0m15:38:08.109228 [debug] [MainThread]: Using duckdb connection "master"
[0m15:38:08.109533 [debug] [MainThread]: On master: COMMIT
[0m15:38:08.110079 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m15:38:08.110488 [debug] [MainThread]: On master: Close
[0m15:38:08.113940 [debug] [Thread-1 (]: Began running node model.supercell.cleaned_usagelogs
[0m15:38:08.114976 [info ] [Thread-1 (]: 1 of 6 START sql table model main.cleaned_usagelogs ............................ [RUN]
[0m15:38:08.115833 [debug] [Thread-2 (]: Began running node model.supercell.my_first_dbt_model
[0m15:38:08.116773 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_supercell_main, now model.supercell.cleaned_usagelogs)
[0m15:38:08.117960 [info ] [Thread-2 (]: 2 of 6 START sql table model main.my_first_dbt_model ........................... [RUN]
[0m15:38:08.118936 [debug] [Thread-1 (]: Began compiling node model.supercell.cleaned_usagelogs
[0m15:38:08.120335 [debug] [Thread-2 (]: Acquiring new duckdb connection 'model.supercell.my_first_dbt_model'
[0m15:38:08.135234 [debug] [Thread-1 (]: Writing injected SQL for node "model.supercell.cleaned_usagelogs"
[0m15:38:08.136305 [debug] [Thread-2 (]: Began compiling node model.supercell.my_first_dbt_model
[0m15:38:08.141220 [debug] [Thread-2 (]: Writing injected SQL for node "model.supercell.my_first_dbt_model"
[0m15:38:08.142127 [debug] [Thread-2 (]: Began executing node model.supercell.my_first_dbt_model
[0m15:38:08.148074 [debug] [Thread-1 (]: Began executing node model.supercell.cleaned_usagelogs
[0m15:38:08.236919 [debug] [Thread-2 (]: Writing runtime sql for node "model.supercell.my_first_dbt_model"
[0m15:38:08.238120 [debug] [Thread-1 (]: Writing runtime sql for node "model.supercell.cleaned_usagelogs"
[0m15:38:08.239497 [debug] [Thread-2 (]: Using duckdb connection "model.supercell.my_first_dbt_model"
[0m15:38:08.240315 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.cleaned_usagelogs"
[0m15:38:08.241024 [debug] [Thread-2 (]: On model.supercell.my_first_dbt_model: BEGIN
[0m15:38:08.241842 [debug] [Thread-1 (]: On model.supercell.cleaned_usagelogs: BEGIN
[0m15:38:08.242549 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m15:38:08.243325 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:38:08.245257 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m15:38:08.245910 [debug] [Thread-2 (]: Using duckdb connection "model.supercell.my_first_dbt_model"
[0m15:38:08.246475 [debug] [Thread-2 (]: On model.supercell.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.my_first_dbt_model"} */

  
    
    

    create  table
      "supercell"."main"."my_first_dbt_model__dbt_tmp"
  
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    );
  
  
[0m15:38:08.247409 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m15:38:08.248313 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.cleaned_usagelogs"
[0m15:38:08.249231 [debug] [Thread-1 (]: On model.supercell.cleaned_usagelogs: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.cleaned_usagelogs"} */

  
    
    

    create  table
      "supercell"."main"."cleaned_usagelogs__dbt_tmp"
  
    as (
      


SELECT
    CAST("LinkedAccountId" AS VARCHAR) AS linked_account_id,
    CAST("bill/PayerAccountId" AS VARCHAR) AS payer_account_id,
    CAST("lineItem/UsageStartDate" AS TIMESTAMP) AS usage_start_date,
    CAST("lineItem/UsageEndDate" AS TIMESTAMP) AS usage_end_date,
    CAST("lineItem/UsageAmount" AS DECIMAL(18, 6)) AS usage_amount,
    CAST("lineItem/Operation" AS VARCHAR) AS operation,
    CAST("pricing/PricingModel" AS VARCHAR) AS pricing_model,
    CAST("resourceTags/TagKeys" AS VARCHAR) AS tag_keys,
    CAST("resourceTags/TagValues" AS VARCHAR) AS tag_values,
    CAST("product/Region" AS VARCHAR) AS region,
    CAST("product/ServiceCode" AS VARCHAR) AS service_code,
    CAST("product/InstanceType" AS VARCHAR) AS instance_type,
    CAST("amortized_cost" AS DECIMAL(18, 6)) AS amortized_cost,
    CAST("product/Description" AS VARCHAR) AS description
FROM supercell_usagelogs
    );
  
  
[0m15:38:08.249943 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m15:38:08.263060 [debug] [Thread-2 (]: Using duckdb connection "model.supercell.my_first_dbt_model"
[0m15:38:08.264085 [debug] [Thread-2 (]: On model.supercell.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.my_first_dbt_model"} */
alter table "supercell"."main"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m15:38:08.265834 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m15:38:08.271776 [debug] [Thread-2 (]: Using duckdb connection "model.supercell.my_first_dbt_model"
[0m15:38:08.272900 [debug] [Thread-2 (]: On model.supercell.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.my_first_dbt_model"} */
alter table "supercell"."main"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m15:38:08.274687 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m15:38:08.323083 [debug] [Thread-2 (]: On model.supercell.my_first_dbt_model: COMMIT
[0m15:38:08.324436 [debug] [Thread-2 (]: Using duckdb connection "model.supercell.my_first_dbt_model"
[0m15:38:08.325483 [debug] [Thread-2 (]: On model.supercell.my_first_dbt_model: COMMIT
[0m15:38:08.332063 [debug] [Thread-2 (]: SQL status: OK in 0.005 seconds
[0m15:38:08.344342 [debug] [Thread-2 (]: Using duckdb connection "model.supercell.my_first_dbt_model"
[0m15:38:08.345775 [debug] [Thread-2 (]: On model.supercell.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.my_first_dbt_model"} */
drop table if exists "supercell"."main"."my_first_dbt_model__dbt_backup" cascade
[0m15:38:08.349698 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m15:38:08.355698 [debug] [Thread-2 (]: On model.supercell.my_first_dbt_model: Close
[0m15:38:08.361681 [info ] [Thread-2 (]: 2 of 6 OK created sql table model main.my_first_dbt_model ...................... [[32mOK[0m in 0.24s]
[0m15:38:08.363894 [debug] [Thread-2 (]: Finished running node model.supercell.my_first_dbt_model
[0m15:38:08.366180 [debug] [Thread-4 (]: Began running node model.supercell.my_second_dbt_model
[0m15:38:08.368222 [info ] [Thread-4 (]: 3 of 6 START sql view model main.my_second_dbt_model ........................... [RUN]
[0m15:38:08.370413 [debug] [Thread-4 (]: Acquiring new duckdb connection 'model.supercell.my_second_dbt_model'
[0m15:38:08.372016 [debug] [Thread-4 (]: Began compiling node model.supercell.my_second_dbt_model
[0m15:38:08.379383 [debug] [Thread-4 (]: Writing injected SQL for node "model.supercell.my_second_dbt_model"
[0m15:38:08.381561 [debug] [Thread-4 (]: Began executing node model.supercell.my_second_dbt_model
[0m15:38:08.407127 [debug] [Thread-4 (]: Writing runtime sql for node "model.supercell.my_second_dbt_model"
[0m15:38:08.408129 [debug] [Thread-4 (]: Using duckdb connection "model.supercell.my_second_dbt_model"
[0m15:38:08.408601 [debug] [Thread-4 (]: On model.supercell.my_second_dbt_model: BEGIN
[0m15:38:08.409009 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m15:38:08.409912 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m15:38:08.410326 [debug] [Thread-4 (]: Using duckdb connection "model.supercell.my_second_dbt_model"
[0m15:38:08.410729 [debug] [Thread-4 (]: On model.supercell.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.my_second_dbt_model"} */

  
  create view "supercell"."main"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "supercell"."main"."my_first_dbt_model"
where id = 1
  );

[0m15:38:08.411898 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m15:38:08.415369 [debug] [Thread-4 (]: Using duckdb connection "model.supercell.my_second_dbt_model"
[0m15:38:08.415909 [debug] [Thread-4 (]: On model.supercell.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.my_second_dbt_model"} */
alter view "supercell"."main"."my_second_dbt_model" rename to "my_second_dbt_model__dbt_backup"
[0m15:38:08.416884 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m15:38:08.420221 [debug] [Thread-4 (]: Using duckdb connection "model.supercell.my_second_dbt_model"
[0m15:38:08.420748 [debug] [Thread-4 (]: On model.supercell.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.my_second_dbt_model"} */
alter view "supercell"."main"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m15:38:08.421703 [debug] [Thread-4 (]: SQL status: OK in 0.000 seconds
[0m15:38:08.423547 [debug] [Thread-4 (]: On model.supercell.my_second_dbt_model: COMMIT
[0m15:38:08.424058 [debug] [Thread-4 (]: Using duckdb connection "model.supercell.my_second_dbt_model"
[0m15:38:08.424455 [debug] [Thread-4 (]: On model.supercell.my_second_dbt_model: COMMIT
[0m15:38:08.426788 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m15:38:08.431148 [debug] [Thread-4 (]: Using duckdb connection "model.supercell.my_second_dbt_model"
[0m15:38:08.431718 [debug] [Thread-4 (]: On model.supercell.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.my_second_dbt_model"} */
drop view if exists "supercell"."main"."my_second_dbt_model__dbt_backup" cascade
[0m15:38:08.433995 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m15:38:08.435822 [debug] [Thread-4 (]: On model.supercell.my_second_dbt_model: Close
[0m15:38:08.436971 [info ] [Thread-4 (]: 3 of 6 OK created sql view model main.my_second_dbt_model ...................... [[32mOK[0m in 0.07s]
[0m15:38:08.437708 [debug] [Thread-4 (]: Finished running node model.supercell.my_second_dbt_model
[0m15:38:08.848317 [debug] [Thread-1 (]: SQL status: OK in 0.598 seconds
[0m15:38:08.851775 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.cleaned_usagelogs"
[0m15:38:08.852315 [debug] [Thread-1 (]: On model.supercell.cleaned_usagelogs: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.cleaned_usagelogs"} */
alter table "supercell"."main"."cleaned_usagelogs" rename to "cleaned_usagelogs__dbt_backup"
[0m15:38:08.853330 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:38:08.856543 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.cleaned_usagelogs"
[0m15:38:08.857008 [debug] [Thread-1 (]: On model.supercell.cleaned_usagelogs: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.cleaned_usagelogs"} */
alter table "supercell"."main"."cleaned_usagelogs__dbt_tmp" rename to "cleaned_usagelogs"
[0m15:38:08.857832 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:38:08.859781 [debug] [Thread-1 (]: On model.supercell.cleaned_usagelogs: COMMIT
[0m15:38:08.860239 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.cleaned_usagelogs"
[0m15:38:08.860611 [debug] [Thread-1 (]: On model.supercell.cleaned_usagelogs: COMMIT
[0m15:38:08.881274 [debug] [Thread-1 (]: SQL status: OK in 0.020 seconds
[0m15:38:08.884421 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.cleaned_usagelogs"
[0m15:38:08.884998 [debug] [Thread-1 (]: On model.supercell.cleaned_usagelogs: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.cleaned_usagelogs"} */
drop table if exists "supercell"."main"."cleaned_usagelogs__dbt_backup" cascade
[0m15:38:08.889696 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m15:38:08.892391 [debug] [Thread-1 (]: On model.supercell.cleaned_usagelogs: Close
[0m15:38:08.906057 [info ] [Thread-1 (]: 1 of 6 OK created sql table model main.cleaned_usagelogs ....................... [[32mOK[0m in 0.79s]
[0m15:38:08.907364 [debug] [Thread-1 (]: Finished running node model.supercell.cleaned_usagelogs
[0m15:38:08.909325 [debug] [Thread-2 (]: Began running node model.supercell.dim_resource
[0m15:38:08.910371 [debug] [Thread-3 (]: Began running node model.supercell.fact_bill_generation
[0m15:38:08.911797 [info ] [Thread-2 (]: 4 of 6 START sql table model main.dim_resource ................................. [RUN]
[0m15:38:08.913541 [info ] [Thread-3 (]: 5 of 6 START sql table model main.fact_bill_generation ......................... [RUN]
[0m15:38:08.914821 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.supercell.my_first_dbt_model, now model.supercell.dim_resource)
[0m15:38:08.915870 [debug] [Thread-3 (]: Acquiring new duckdb connection 'model.supercell.fact_bill_generation'
[0m15:38:08.916831 [debug] [Thread-2 (]: Began compiling node model.supercell.dim_resource
[0m15:38:08.917738 [debug] [Thread-3 (]: Began compiling node model.supercell.fact_bill_generation
[0m15:38:08.924238 [debug] [Thread-2 (]: Writing injected SQL for node "model.supercell.dim_resource"
[0m15:38:08.931153 [debug] [Thread-3 (]: Writing injected SQL for node "model.supercell.fact_bill_generation"
[0m15:38:08.932698 [debug] [Thread-3 (]: Began executing node model.supercell.fact_bill_generation
[0m15:38:08.933497 [debug] [Thread-2 (]: Began executing node model.supercell.dim_resource
[0m15:38:08.938898 [debug] [Thread-3 (]: Writing runtime sql for node "model.supercell.fact_bill_generation"
[0m15:38:08.943343 [debug] [Thread-2 (]: Writing runtime sql for node "model.supercell.dim_resource"
[0m15:38:08.944425 [debug] [Thread-3 (]: Using duckdb connection "model.supercell.fact_bill_generation"
[0m15:38:08.945112 [debug] [Thread-2 (]: Using duckdb connection "model.supercell.dim_resource"
[0m15:38:08.945585 [debug] [Thread-3 (]: On model.supercell.fact_bill_generation: BEGIN
[0m15:38:08.946161 [debug] [Thread-2 (]: On model.supercell.dim_resource: BEGIN
[0m15:38:08.946596 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m15:38:08.947031 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:38:08.948263 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m15:38:08.948732 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m15:38:08.949139 [debug] [Thread-3 (]: Using duckdb connection "model.supercell.fact_bill_generation"
[0m15:38:08.949538 [debug] [Thread-2 (]: Using duckdb connection "model.supercell.dim_resource"
[0m15:38:08.949989 [debug] [Thread-3 (]: On model.supercell.fact_bill_generation: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.fact_bill_generation"} */

  
    
    

    create  table
      "supercell"."main"."fact_bill_generation__dbt_tmp"
  
    as (
      


select
    md5(concat(linked_account_id, '_', service_code, '_', instance_type, '_', region, '_', CAST(usage_start_date AS VARCHAR), '_', CAST(usage_end_date AS VARCHAR))) AS resource_id,
    usage_start_date as start_date,
    usage_end_date as bill_date,
    usage_amount as bill_amount,
    operation
from "supercell"."main"."cleaned_usagelogs"
    );
  
  
[0m15:38:08.950431 [debug] [Thread-2 (]: On model.supercell.dim_resource: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.dim_resource"} */

  
    
    

    create  table
      "supercell"."main"."dim_resource__dbt_tmp"
  
    as (
      


select
    md5(concat(linked_account_id, '_', service_code, '_', instance_type, '_', region, '_', CAST(usage_start_date AS VARCHAR), '_', CAST(usage_end_date AS VARCHAR))) AS resource_id,
    linked_account_id as linked_account_id,
    region,
    service_code as product,
    instance_type as instance_type,
    pricing_model as pricing_model
from "supercell"."main"."cleaned_usagelogs"
    );
  
  
[0m15:38:09.265503 [debug] [Thread-3 (]: SQL status: OK in 0.314 seconds
[0m15:38:09.269129 [debug] [Thread-3 (]: Using duckdb connection "model.supercell.fact_bill_generation"
[0m15:38:09.269709 [debug] [Thread-3 (]: On model.supercell.fact_bill_generation: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.fact_bill_generation"} */
alter table "supercell"."main"."fact_bill_generation" rename to "fact_bill_generation__dbt_backup"
[0m15:38:09.271083 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m15:38:09.274471 [debug] [Thread-3 (]: Using duckdb connection "model.supercell.fact_bill_generation"
[0m15:38:09.274993 [debug] [Thread-3 (]: On model.supercell.fact_bill_generation: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.fact_bill_generation"} */
alter table "supercell"."main"."fact_bill_generation__dbt_tmp" rename to "fact_bill_generation"
[0m15:38:09.275970 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m15:38:09.278126 [debug] [Thread-3 (]: On model.supercell.fact_bill_generation: COMMIT
[0m15:38:09.278626 [debug] [Thread-3 (]: Using duckdb connection "model.supercell.fact_bill_generation"
[0m15:38:09.279118 [debug] [Thread-3 (]: On model.supercell.fact_bill_generation: COMMIT
[0m15:38:09.333591 [debug] [Thread-3 (]: SQL status: OK in 0.054 seconds
[0m15:38:09.338710 [debug] [Thread-3 (]: Using duckdb connection "model.supercell.fact_bill_generation"
[0m15:38:09.339724 [debug] [Thread-3 (]: On model.supercell.fact_bill_generation: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.fact_bill_generation"} */
drop table if exists "supercell"."main"."fact_bill_generation__dbt_backup" cascade
[0m15:38:09.343932 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m15:38:09.346564 [debug] [Thread-3 (]: On model.supercell.fact_bill_generation: Close
[0m15:38:09.360035 [info ] [Thread-3 (]: 5 of 6 OK created sql table model main.fact_bill_generation .................... [[32mOK[0m in 0.44s]
[0m15:38:09.360963 [debug] [Thread-3 (]: Finished running node model.supercell.fact_bill_generation
[0m15:38:09.362286 [debug] [Thread-1 (]: Began running node model.supercell.total_cost
[0m15:38:09.363783 [info ] [Thread-1 (]: 6 of 6 START sql table model main.total_cost ................................... [RUN]
[0m15:38:09.365092 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.supercell.cleaned_usagelogs, now model.supercell.total_cost)
[0m15:38:09.365942 [debug] [Thread-1 (]: Began compiling node model.supercell.total_cost
[0m15:38:09.372408 [debug] [Thread-1 (]: Writing injected SQL for node "model.supercell.total_cost"
[0m15:38:09.374372 [debug] [Thread-1 (]: Began executing node model.supercell.total_cost
[0m15:38:09.381549 [debug] [Thread-1 (]: Writing runtime sql for node "model.supercell.total_cost"
[0m15:38:09.383087 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.total_cost"
[0m15:38:09.383804 [debug] [Thread-1 (]: On model.supercell.total_cost: BEGIN
[0m15:38:09.384261 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:38:09.385305 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:38:09.385768 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.total_cost"
[0m15:38:09.386146 [debug] [Thread-1 (]: On model.supercell.total_cost: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.total_cost"} */

  
    
    

    create  table
      "supercell"."main"."total_cost__dbt_tmp"
  
    as (
      


select
    resource_id,
    date_trunc('month', bill_date) as month,
    sum(bill_amount) as total_cost
from "supercell"."main"."fact_bill_generation"
    );
  
  
[0m15:38:09.392003 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.total_cost"} */

  
    
    

    create  table
      "supercell"."main"."total_cost__dbt_tmp"
  
    as (
      


select
    resource_id,
    date_trunc('month', bill_date) as month,
    sum(bill_amount) as total_cost
from "supercell"."main"."fact_bill_generation"
    );
  
  
[0m15:38:09.392929 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m15:38:09.393896 [debug] [Thread-1 (]: On model.supercell.total_cost: ROLLBACK
[0m15:38:09.474393 [debug] [Thread-2 (]: SQL status: OK in 0.523 seconds
[0m15:38:09.484343 [debug] [Thread-2 (]: Using duckdb connection "model.supercell.dim_resource"
[0m15:38:09.486523 [debug] [Thread-2 (]: On model.supercell.dim_resource: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.dim_resource"} */
alter table "supercell"."main"."dim_resource" rename to "dim_resource__dbt_backup"
[0m15:38:09.489883 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m15:38:09.496491 [debug] [Thread-2 (]: Using duckdb connection "model.supercell.dim_resource"
[0m15:38:09.497691 [debug] [Thread-2 (]: On model.supercell.dim_resource: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.dim_resource"} */
alter table "supercell"."main"."dim_resource__dbt_tmp" rename to "dim_resource"
[0m15:38:09.499241 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m15:38:09.501523 [debug] [Thread-2 (]: On model.supercell.dim_resource: COMMIT
[0m15:38:09.502023 [debug] [Thread-2 (]: Using duckdb connection "model.supercell.dim_resource"
[0m15:38:09.502497 [debug] [Thread-2 (]: On model.supercell.dim_resource: COMMIT
[0m15:38:09.512127 [debug] [Thread-1 (]: Failed to rollback 'model.supercell.total_cost'
[0m15:38:09.513732 [debug] [Thread-1 (]: On model.supercell.total_cost: Close
[0m15:38:09.515350 [debug] [Thread-2 (]: SQL status: OK in 0.012 seconds
[0m15:38:09.522556 [debug] [Thread-2 (]: Using duckdb connection "model.supercell.dim_resource"
[0m15:38:09.525328 [debug] [Thread-2 (]: On model.supercell.dim_resource: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.dim_resource"} */
drop table if exists "supercell"."main"."dim_resource__dbt_backup" cascade
[0m15:38:09.529291 [debug] [Thread-1 (]: Runtime Error in model total_cost (models/supercell_models/metrics/total_cost.sql)
  Binder Error: column "resource_id" must appear in the GROUP BY clause or must be part of an aggregate function.
  Either add it to the GROUP BY list, or use "ANY_VALUE(resource_id)" if the exact value of "resource_id" is not important.
  
  LINE 15:     resource_id,
               ^
[0m15:38:09.531211 [error] [Thread-1 (]: 6 of 6 ERROR creating sql table model main.total_cost .......................... [[31mERROR[0m in 0.17s]
[0m15:38:09.532993 [debug] [Thread-1 (]: Finished running node model.supercell.total_cost
[0m15:38:09.535018 [debug] [Thread-7 (]: Marking all children of 'model.supercell.total_cost' to be skipped because of status 'error'.  Reason: Runtime Error in model total_cost (models/supercell_models/metrics/total_cost.sql)
  Binder Error: column "resource_id" must appear in the GROUP BY clause or must be part of an aggregate function.
  Either add it to the GROUP BY list, or use "ANY_VALUE(resource_id)" if the exact value of "resource_id" is not important.
  
  LINE 15:     resource_id,
               ^.
[0m15:38:09.536464 [debug] [Thread-2 (]: SQL status: OK in 0.010 seconds
[0m15:38:09.542864 [debug] [Thread-2 (]: On model.supercell.dim_resource: Close
[0m15:38:09.546077 [info ] [Thread-2 (]: 4 of 6 OK created sql table model main.dim_resource ............................ [[32mOK[0m in 0.63s]
[0m15:38:09.547051 [debug] [Thread-2 (]: Finished running node model.supercell.dim_resource
[0m15:38:09.549835 [debug] [MainThread]: Using duckdb connection "master"
[0m15:38:09.550756 [debug] [MainThread]: On master: BEGIN
[0m15:38:09.551722 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:38:09.552891 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m15:38:09.553377 [debug] [MainThread]: On master: COMMIT
[0m15:38:09.553823 [debug] [MainThread]: Using duckdb connection "master"
[0m15:38:09.554212 [debug] [MainThread]: On master: COMMIT
[0m15:38:09.554899 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m15:38:09.555377 [debug] [MainThread]: On master: Close
[0m15:38:09.556065 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:38:09.556431 [debug] [MainThread]: Connection 'model.supercell.total_cost' was properly closed.
[0m15:38:09.556884 [debug] [MainThread]: Connection 'model.supercell.dim_resource' was properly closed.
[0m15:38:09.557632 [debug] [MainThread]: Connection 'model.supercell.my_second_dbt_model' was properly closed.
[0m15:38:09.558303 [debug] [MainThread]: Connection 'model.supercell.fact_bill_generation' was properly closed.
[0m15:38:09.559168 [info ] [MainThread]: 
[0m15:38:09.560115 [info ] [MainThread]: Finished running 5 table models, 1 view model in 0 hours 0 minutes and 1.57 seconds (1.57s).
[0m15:38:09.564302 [debug] [MainThread]: Command end result
[0m15:38:09.594731 [debug] [MainThread]: Wrote artifact WritableManifest to /home/harsha/data_actions/supercell_cloudops/target/manifest.json
[0m15:38:09.596989 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/harsha/data_actions/supercell_cloudops/target/semantic_manifest.json
[0m15:38:09.605031 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/harsha/data_actions/supercell_cloudops/target/run_results.json
[0m15:38:09.605548 [info ] [MainThread]: 
[0m15:38:09.606021 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m15:38:09.606396 [info ] [MainThread]: 
[0m15:38:09.606837 [error] [MainThread]:   Runtime Error in model total_cost (models/supercell_models/metrics/total_cost.sql)
  Binder Error: column "resource_id" must appear in the GROUP BY clause or must be part of an aggregate function.
  Either add it to the GROUP BY list, or use "ANY_VALUE(resource_id)" if the exact value of "resource_id" is not important.
  
  LINE 15:     resource_id,
               ^
[0m15:38:09.607188 [info ] [MainThread]: 
[0m15:38:09.607548 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=1 SKIP=0 TOTAL=6
[0m15:38:09.608576 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 2.602769, "process_in_blocks": "3264", "process_kernel_time": 0.602056, "process_mem_max_rss": "348952", "process_out_blocks": "57784", "process_user_time": 8.280772}
[0m15:38:09.609151 [debug] [MainThread]: Command `dbt run` failed at 15:38:09.609028 after 2.60 seconds
[0m15:38:09.609578 [debug] [MainThread]: Flushing usage events


============================== 15:42:11.171402 | c92ad456-25c8-4c0f-a288-43528fd3f5d5 ==============================
[0m15:42:11.171402 [info ] [MainThread]: Running with dbt=1.9.4
[0m15:42:11.176681 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/harsha/data_actions/supercell_cloudops', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/harsha/data_actions/supercell_cloudops/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'False'}
[0m15:42:11.177246 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality

User config should be moved from the 'config' key in profiles.yml to the 'flags' key in dbt_project.yml.
[0m15:42:11.492958 [info ] [MainThread]: Registered adapter: duckdb=1.9.3
[0m15:42:11.574420 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m15:42:11.691435 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:42:11.692260 [debug] [MainThread]: Partial parsing: updated file: supercell://models/supercell_models/metrics/total_cost.sql
[0m15:42:11.941388 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.supercell.total_cost' (models/supercell_models/metrics/total_cost.sql) depends on a node named 'dim_accounts' which was not found
[0m15:42:11.943640 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.8356778, "process_in_blocks": "0", "process_kernel_time": 0.172986, "process_mem_max_rss": "120172", "process_out_blocks": "8", "process_user_time": 2.39881}
[0m15:42:11.944909 [debug] [MainThread]: Command `dbt run` failed at 15:42:11.944701 after 0.84 seconds
[0m15:42:11.945386 [debug] [MainThread]: Flushing usage events


============================== 15:42:26.336522 | bd5e903e-61a2-4ed3-a914-68799925bbee ==============================
[0m15:42:26.336522 [info ] [MainThread]: Running with dbt=1.9.4
[0m15:42:26.341945 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/harsha/data_actions/supercell_cloudops', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/harsha/data_actions/supercell_cloudops/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'False'}
[0m15:42:26.342750 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality

User config should be moved from the 'config' key in profiles.yml to the 'flags' key in dbt_project.yml.
[0m15:42:26.676873 [info ] [MainThread]: Registered adapter: duckdb=1.9.3
[0m15:42:26.750842 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m15:42:26.862130 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:42:26.862912 [debug] [MainThread]: Partial parsing: updated file: supercell://models/supercell_models/metrics/total_cost.sql
[0m15:42:27.107917 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.supercell.total_cost' (models/supercell_models/metrics/total_cost.sql) depends on a node named 'dim_accounts' which was not found
[0m15:42:27.109681 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.83709556, "process_in_blocks": "0", "process_kernel_time": 0.142802, "process_mem_max_rss": "120568", "process_out_blocks": "16", "process_user_time": 2.388695}
[0m15:42:27.110585 [debug] [MainThread]: Command `dbt run` failed at 15:42:27.110414 after 0.84 seconds
[0m15:42:27.111207 [debug] [MainThread]: Flushing usage events


============================== 15:43:01.575691 | 005451a2-cef3-4662-8577-2c7d53290d14 ==============================
[0m15:43:01.575691 [info ] [MainThread]: Running with dbt=1.9.4
[0m15:43:01.581102 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/harsha/data_actions/supercell_cloudops/logs', 'debug': 'False', 'profiles_dir': '/home/harsha/data_actions/supercell_cloudops', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'False'}
[0m15:43:01.581948 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality

User config should be moved from the 'config' key in profiles.yml to the 'flags' key in dbt_project.yml.
[0m15:43:01.903261 [info ] [MainThread]: Registered adapter: duckdb=1.9.3
[0m15:43:01.975599 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m15:43:02.086332 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m15:43:02.087149 [debug] [MainThread]: Partial parsing: added file: supercell://models/supercell_models/dim_accounts.sql
[0m15:43:02.087662 [debug] [MainThread]: Partial parsing: updated file: supercell://models/supercell_models/metrics/total_cost.sql
[0m15:43:02.510542 [debug] [MainThread]: Wrote artifact WritableManifest to /home/harsha/data_actions/supercell_cloudops/target/manifest.json
[0m15:43:02.512503 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/harsha/data_actions/supercell_cloudops/target/semantic_manifest.json
[0m15:43:02.526143 [info ] [MainThread]: Found 7 models, 4 data tests, 428 macros
[0m15:43:02.528882 [info ] [MainThread]: 
[0m15:43:02.529466 [info ] [MainThread]: Concurrency: 4 threads (target='default')
[0m15:43:02.529880 [info ] [MainThread]: 
[0m15:43:02.530475 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m15:43:02.538503 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_supercell'
[0m15:43:02.589581 [debug] [ThreadPool]: Using duckdb connection "list_supercell"
[0m15:43:02.590280 [debug] [ThreadPool]: On list_supercell: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "connection_name": "list_supercell"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"supercell"'
    
  
  
[0m15:43:02.590786 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:43:02.608969 [debug] [ThreadPool]: SQL status: OK in 0.018 seconds
[0m15:43:02.610816 [debug] [ThreadPool]: On list_supercell: Close
[0m15:43:02.612178 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_supercell, now create_supercell_main)
[0m15:43:02.613125 [debug] [ThreadPool]: Creating schema "database: "supercell"
schema: "main"
"
[0m15:43:02.625448 [debug] [ThreadPool]: Using duckdb connection "create_supercell_main"
[0m15:43:02.626086 [debug] [ThreadPool]: On create_supercell_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "connection_name": "create_supercell_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='supercell'
        and type='sqlite'
    
  
[0m15:43:02.626524 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:43:02.628100 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m15:43:02.630093 [debug] [ThreadPool]: Using duckdb connection "create_supercell_main"
[0m15:43:02.630609 [debug] [ThreadPool]: On create_supercell_main: BEGIN
[0m15:43:02.631324 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m15:43:02.631790 [debug] [ThreadPool]: Using duckdb connection "create_supercell_main"
[0m15:43:02.632191 [debug] [ThreadPool]: On create_supercell_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "connection_name": "create_supercell_main"} */

    
    
        create schema if not exists "supercell"."main"
    
[0m15:43:02.632902 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m15:43:02.634164 [debug] [ThreadPool]: On create_supercell_main: COMMIT
[0m15:43:02.634684 [debug] [ThreadPool]: Using duckdb connection "create_supercell_main"
[0m15:43:02.635175 [debug] [ThreadPool]: On create_supercell_main: COMMIT
[0m15:43:02.635891 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m15:43:02.636376 [debug] [ThreadPool]: On create_supercell_main: Close
[0m15:43:02.639023 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_supercell_main, now list_supercell_main)
[0m15:43:02.649167 [debug] [ThreadPool]: Using duckdb connection "list_supercell_main"
[0m15:43:02.649774 [debug] [ThreadPool]: On list_supercell_main: BEGIN
[0m15:43:02.650218 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:43:02.651252 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m15:43:02.651822 [debug] [ThreadPool]: Using duckdb connection "list_supercell_main"
[0m15:43:02.652246 [debug] [ThreadPool]: On list_supercell_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "connection_name": "list_supercell_main"} */
select
      'supercell' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'supercell'
  
[0m15:43:02.677000 [debug] [ThreadPool]: SQL status: OK in 0.024 seconds
[0m15:43:02.680010 [debug] [ThreadPool]: On list_supercell_main: ROLLBACK
[0m15:43:02.682269 [debug] [ThreadPool]: Failed to rollback 'list_supercell_main'
[0m15:43:02.682981 [debug] [ThreadPool]: On list_supercell_main: Close
[0m15:43:02.688349 [debug] [MainThread]: Using duckdb connection "master"
[0m15:43:02.689182 [debug] [MainThread]: On master: BEGIN
[0m15:43:02.689795 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:43:02.691177 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m15:43:02.691860 [debug] [MainThread]: On master: COMMIT
[0m15:43:02.692439 [debug] [MainThread]: Using duckdb connection "master"
[0m15:43:02.692959 [debug] [MainThread]: On master: COMMIT
[0m15:43:02.693888 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m15:43:02.694577 [debug] [MainThread]: On master: Close
[0m15:43:02.700834 [debug] [Thread-1 (]: Began running node model.supercell.cleaned_usagelogs
[0m15:43:02.701963 [debug] [Thread-2 (]: Began running node model.supercell.my_first_dbt_model
[0m15:43:02.703589 [info ] [Thread-1 (]: 1 of 7 START sql table model main.cleaned_usagelogs ............................ [RUN]
[0m15:43:02.705106 [info ] [Thread-2 (]: 2 of 7 START sql table model main.my_first_dbt_model ........................... [RUN]
[0m15:43:02.706690 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_supercell_main, now model.supercell.cleaned_usagelogs)
[0m15:43:02.708613 [debug] [Thread-2 (]: Acquiring new duckdb connection 'model.supercell.my_first_dbt_model'
[0m15:43:02.710128 [debug] [Thread-1 (]: Began compiling node model.supercell.cleaned_usagelogs
[0m15:43:02.711433 [debug] [Thread-2 (]: Began compiling node model.supercell.my_first_dbt_model
[0m15:43:02.739622 [debug] [Thread-1 (]: Writing injected SQL for node "model.supercell.cleaned_usagelogs"
[0m15:43:02.741188 [debug] [Thread-2 (]: Writing injected SQL for node "model.supercell.my_first_dbt_model"
[0m15:43:02.743049 [debug] [Thread-1 (]: Began executing node model.supercell.cleaned_usagelogs
[0m15:43:02.765129 [debug] [Thread-2 (]: Began executing node model.supercell.my_first_dbt_model
[0m15:43:02.831004 [debug] [Thread-1 (]: Writing runtime sql for node "model.supercell.cleaned_usagelogs"
[0m15:43:02.832350 [debug] [Thread-2 (]: Writing runtime sql for node "model.supercell.my_first_dbt_model"
[0m15:43:02.834202 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.cleaned_usagelogs"
[0m15:43:02.835289 [debug] [Thread-1 (]: On model.supercell.cleaned_usagelogs: BEGIN
[0m15:43:02.836223 [debug] [Thread-2 (]: Using duckdb connection "model.supercell.my_first_dbt_model"
[0m15:43:02.837063 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:43:02.838087 [debug] [Thread-2 (]: On model.supercell.my_first_dbt_model: BEGIN
[0m15:43:02.839483 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m15:43:02.841084 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m15:43:02.841977 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m15:43:02.842757 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.cleaned_usagelogs"
[0m15:43:02.843807 [debug] [Thread-2 (]: Using duckdb connection "model.supercell.my_first_dbt_model"
[0m15:43:02.844987 [debug] [Thread-1 (]: On model.supercell.cleaned_usagelogs: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.cleaned_usagelogs"} */

  
    
    

    create  table
      "supercell"."main"."cleaned_usagelogs__dbt_tmp"
  
    as (
      


SELECT
    CAST("LinkedAccountId" AS VARCHAR) AS linked_account_id,
    CAST("bill/PayerAccountId" AS VARCHAR) AS payer_account_id,
    CAST("lineItem/UsageStartDate" AS TIMESTAMP) AS usage_start_date,
    CAST("lineItem/UsageEndDate" AS TIMESTAMP) AS usage_end_date,
    CAST("lineItem/UsageAmount" AS DECIMAL(18, 6)) AS usage_amount,
    CAST("lineItem/Operation" AS VARCHAR) AS operation,
    CAST("pricing/PricingModel" AS VARCHAR) AS pricing_model,
    CAST("resourceTags/TagKeys" AS VARCHAR) AS tag_keys,
    CAST("resourceTags/TagValues" AS VARCHAR) AS tag_values,
    CAST("product/Region" AS VARCHAR) AS region,
    CAST("product/ServiceCode" AS VARCHAR) AS service_code,
    CAST("product/InstanceType" AS VARCHAR) AS instance_type,
    CAST("amortized_cost" AS DECIMAL(18, 6)) AS amortized_cost,
    CAST("product/Description" AS VARCHAR) AS description
FROM supercell_usagelogs
    );
  
  
[0m15:43:02.846208 [debug] [Thread-2 (]: On model.supercell.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.my_first_dbt_model"} */

  
    
    

    create  table
      "supercell"."main"."my_first_dbt_model__dbt_tmp"
  
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
    );
  
  
[0m15:43:02.849521 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m15:43:02.863042 [debug] [Thread-2 (]: Using duckdb connection "model.supercell.my_first_dbt_model"
[0m15:43:02.864134 [debug] [Thread-2 (]: On model.supercell.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.my_first_dbt_model"} */
alter table "supercell"."main"."my_first_dbt_model" rename to "my_first_dbt_model__dbt_backup"
[0m15:43:02.865883 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m15:43:02.873750 [debug] [Thread-2 (]: Using duckdb connection "model.supercell.my_first_dbt_model"
[0m15:43:02.875100 [debug] [Thread-2 (]: On model.supercell.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.my_first_dbt_model"} */
alter table "supercell"."main"."my_first_dbt_model__dbt_tmp" rename to "my_first_dbt_model"
[0m15:43:02.877764 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m15:43:02.924619 [debug] [Thread-2 (]: On model.supercell.my_first_dbt_model: COMMIT
[0m15:43:02.926079 [debug] [Thread-2 (]: Using duckdb connection "model.supercell.my_first_dbt_model"
[0m15:43:02.927272 [debug] [Thread-2 (]: On model.supercell.my_first_dbt_model: COMMIT
[0m15:43:02.933935 [debug] [Thread-2 (]: SQL status: OK in 0.005 seconds
[0m15:43:02.945949 [debug] [Thread-2 (]: Using duckdb connection "model.supercell.my_first_dbt_model"
[0m15:43:02.946860 [debug] [Thread-2 (]: On model.supercell.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.my_first_dbt_model"} */
drop table if exists "supercell"."main"."my_first_dbt_model__dbt_backup" cascade
[0m15:43:02.949996 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m15:43:02.955615 [debug] [Thread-2 (]: On model.supercell.my_first_dbt_model: Close
[0m15:43:02.960450 [info ] [Thread-2 (]: 2 of 7 OK created sql table model main.my_first_dbt_model ...................... [[32mOK[0m in 0.25s]
[0m15:43:02.962382 [debug] [Thread-2 (]: Finished running node model.supercell.my_first_dbt_model
[0m15:43:02.964503 [debug] [Thread-4 (]: Began running node model.supercell.my_second_dbt_model
[0m15:43:02.966261 [info ] [Thread-4 (]: 3 of 7 START sql view model main.my_second_dbt_model ........................... [RUN]
[0m15:43:02.968093 [debug] [Thread-4 (]: Acquiring new duckdb connection 'model.supercell.my_second_dbt_model'
[0m15:43:02.969980 [debug] [Thread-4 (]: Began compiling node model.supercell.my_second_dbt_model
[0m15:43:02.977570 [debug] [Thread-4 (]: Writing injected SQL for node "model.supercell.my_second_dbt_model"
[0m15:43:02.979591 [debug] [Thread-4 (]: Began executing node model.supercell.my_second_dbt_model
[0m15:43:03.002788 [debug] [Thread-4 (]: Writing runtime sql for node "model.supercell.my_second_dbt_model"
[0m15:43:03.003756 [debug] [Thread-4 (]: Using duckdb connection "model.supercell.my_second_dbt_model"
[0m15:43:03.004245 [debug] [Thread-4 (]: On model.supercell.my_second_dbt_model: BEGIN
[0m15:43:03.004673 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m15:43:03.005556 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m15:43:03.005997 [debug] [Thread-4 (]: Using duckdb connection "model.supercell.my_second_dbt_model"
[0m15:43:03.006386 [debug] [Thread-4 (]: On model.supercell.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.my_second_dbt_model"} */

  
  create view "supercell"."main"."my_second_dbt_model__dbt_tmp" as (
    -- Use the `ref` function to select from other models

select *
from "supercell"."main"."my_first_dbt_model"
where id = 1
  );

[0m15:43:03.007318 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m15:43:03.010761 [debug] [Thread-4 (]: Using duckdb connection "model.supercell.my_second_dbt_model"
[0m15:43:03.011272 [debug] [Thread-4 (]: On model.supercell.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.my_second_dbt_model"} */
alter view "supercell"."main"."my_second_dbt_model" rename to "my_second_dbt_model__dbt_backup"
[0m15:43:03.012211 [debug] [Thread-4 (]: SQL status: OK in 0.000 seconds
[0m15:43:03.015403 [debug] [Thread-4 (]: Using duckdb connection "model.supercell.my_second_dbt_model"
[0m15:43:03.015872 [debug] [Thread-4 (]: On model.supercell.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.my_second_dbt_model"} */
alter view "supercell"."main"."my_second_dbt_model__dbt_tmp" rename to "my_second_dbt_model"
[0m15:43:03.016725 [debug] [Thread-4 (]: SQL status: OK in 0.000 seconds
[0m15:43:03.018669 [debug] [Thread-4 (]: On model.supercell.my_second_dbt_model: COMMIT
[0m15:43:03.019176 [debug] [Thread-4 (]: Using duckdb connection "model.supercell.my_second_dbt_model"
[0m15:43:03.019583 [debug] [Thread-4 (]: On model.supercell.my_second_dbt_model: COMMIT
[0m15:43:03.021926 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m15:43:03.028168 [debug] [Thread-4 (]: Using duckdb connection "model.supercell.my_second_dbt_model"
[0m15:43:03.029074 [debug] [Thread-4 (]: On model.supercell.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.my_second_dbt_model"} */
drop view if exists "supercell"."main"."my_second_dbt_model__dbt_backup" cascade
[0m15:43:03.031733 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m15:43:03.034328 [debug] [Thread-4 (]: On model.supercell.my_second_dbt_model: Close
[0m15:43:03.036122 [info ] [Thread-4 (]: 3 of 7 OK created sql view model main.my_second_dbt_model ...................... [[32mOK[0m in 0.07s]
[0m15:43:03.037336 [debug] [Thread-4 (]: Finished running node model.supercell.my_second_dbt_model
[0m15:43:03.424569 [debug] [Thread-1 (]: SQL status: OK in 0.577 seconds
[0m15:43:03.428860 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.cleaned_usagelogs"
[0m15:43:03.429376 [debug] [Thread-1 (]: On model.supercell.cleaned_usagelogs: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.cleaned_usagelogs"} */
alter table "supercell"."main"."cleaned_usagelogs" rename to "cleaned_usagelogs__dbt_backup"
[0m15:43:03.430360 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:43:03.433383 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.cleaned_usagelogs"
[0m15:43:03.433844 [debug] [Thread-1 (]: On model.supercell.cleaned_usagelogs: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.cleaned_usagelogs"} */
alter table "supercell"."main"."cleaned_usagelogs__dbt_tmp" rename to "cleaned_usagelogs"
[0m15:43:03.434707 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:43:03.436670 [debug] [Thread-1 (]: On model.supercell.cleaned_usagelogs: COMMIT
[0m15:43:03.437114 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.cleaned_usagelogs"
[0m15:43:03.437477 [debug] [Thread-1 (]: On model.supercell.cleaned_usagelogs: COMMIT
[0m15:43:03.455329 [debug] [Thread-1 (]: SQL status: OK in 0.017 seconds
[0m15:43:03.458285 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.cleaned_usagelogs"
[0m15:43:03.458814 [debug] [Thread-1 (]: On model.supercell.cleaned_usagelogs: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.cleaned_usagelogs"} */
drop table if exists "supercell"."main"."cleaned_usagelogs__dbt_backup" cascade
[0m15:43:03.461867 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m15:43:03.463501 [debug] [Thread-1 (]: On model.supercell.cleaned_usagelogs: Close
[0m15:43:03.474094 [info ] [Thread-1 (]: 1 of 7 OK created sql table model main.cleaned_usagelogs ....................... [[32mOK[0m in 0.77s]
[0m15:43:03.474896 [debug] [Thread-1 (]: Finished running node model.supercell.cleaned_usagelogs
[0m15:43:03.477020 [debug] [Thread-2 (]: Began running node model.supercell.dim_accounts
[0m15:43:03.478271 [info ] [Thread-2 (]: 4 of 7 START sql table model main.dim_accounts ................................. [RUN]
[0m15:43:03.479300 [debug] [Thread-3 (]: Began running node model.supercell.dim_resource
[0m15:43:03.480758 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly model.supercell.my_first_dbt_model, now model.supercell.dim_accounts)
[0m15:43:03.481970 [debug] [Thread-4 (]: Began running node model.supercell.fact_bill_generation
[0m15:43:03.483456 [info ] [Thread-3 (]: 5 of 7 START sql table model main.dim_resource ................................. [RUN]
[0m15:43:03.484985 [debug] [Thread-2 (]: Began compiling node model.supercell.dim_accounts
[0m15:43:03.486541 [info ] [Thread-4 (]: 6 of 7 START sql table model main.fact_bill_generation ......................... [RUN]
[0m15:43:03.488004 [debug] [Thread-3 (]: Acquiring new duckdb connection 'model.supercell.dim_resource'
[0m15:43:03.494436 [debug] [Thread-2 (]: Writing injected SQL for node "model.supercell.dim_accounts"
[0m15:43:03.495980 [debug] [Thread-4 (]: Re-using an available connection from the pool (formerly model.supercell.my_second_dbt_model, now model.supercell.fact_bill_generation)
[0m15:43:03.497030 [debug] [Thread-3 (]: Began compiling node model.supercell.dim_resource
[0m15:43:03.498330 [debug] [Thread-4 (]: Began compiling node model.supercell.fact_bill_generation
[0m15:43:03.499331 [debug] [Thread-2 (]: Began executing node model.supercell.dim_accounts
[0m15:43:03.504758 [debug] [Thread-3 (]: Writing injected SQL for node "model.supercell.dim_resource"
[0m15:43:03.509485 [debug] [Thread-4 (]: Writing injected SQL for node "model.supercell.fact_bill_generation"
[0m15:43:03.514572 [debug] [Thread-2 (]: Writing runtime sql for node "model.supercell.dim_accounts"
[0m15:43:03.516434 [debug] [Thread-3 (]: Began executing node model.supercell.dim_resource
[0m15:43:03.522930 [debug] [Thread-3 (]: Writing runtime sql for node "model.supercell.dim_resource"
[0m15:43:03.524048 [debug] [Thread-2 (]: Using duckdb connection "model.supercell.dim_accounts"
[0m15:43:03.525056 [debug] [Thread-4 (]: Began executing node model.supercell.fact_bill_generation
[0m15:43:03.526239 [debug] [Thread-2 (]: On model.supercell.dim_accounts: BEGIN
[0m15:43:03.532710 [debug] [Thread-3 (]: Using duckdb connection "model.supercell.dim_resource"
[0m15:43:03.533689 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m15:43:03.534687 [debug] [Thread-3 (]: On model.supercell.dim_resource: BEGIN
[0m15:43:03.535973 [debug] [Thread-4 (]: Writing runtime sql for node "model.supercell.fact_bill_generation"
[0m15:43:03.537327 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m15:43:03.538341 [debug] [Thread-2 (]: SQL status: OK in 0.005 seconds
[0m15:43:03.539931 [debug] [Thread-2 (]: Using duckdb connection "model.supercell.dim_accounts"
[0m15:43:03.540639 [debug] [Thread-2 (]: On model.supercell.dim_accounts: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.dim_accounts"} */

  
    
    

    create  table
      "supercell"."main"."dim_accounts__dbt_tmp"
  
    as (
      


select
    linked_account_id as linked_account_id,
    tag_keys as tag_keys,
    tag_values as tag_values
from "supercell"."main"."cleaned_usagelogs"
    );
  
  
[0m15:43:03.541677 [debug] [Thread-4 (]: Using duckdb connection "model.supercell.fact_bill_generation"
[0m15:43:03.542746 [debug] [Thread-3 (]: SQL status: OK in 0.005 seconds
[0m15:43:03.543599 [debug] [Thread-4 (]: On model.supercell.fact_bill_generation: BEGIN
[0m15:43:03.544828 [debug] [Thread-3 (]: Using duckdb connection "model.supercell.dim_resource"
[0m15:43:03.545956 [debug] [Thread-4 (]: Opening a new connection, currently in state closed
[0m15:43:03.547258 [debug] [Thread-3 (]: On model.supercell.dim_resource: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.dim_resource"} */

  
    
    

    create  table
      "supercell"."main"."dim_resource__dbt_tmp"
  
    as (
      


select
    md5(concat(linked_account_id, '_', service_code, '_', instance_type, '_', region, '_', CAST(usage_start_date AS VARCHAR), '_', CAST(usage_end_date AS VARCHAR))) AS resource_id,
    linked_account_id as linked_account_id,
    region,
    service_code as product,
    instance_type as instance_type,
    pricing_model as pricing_model
from "supercell"."main"."cleaned_usagelogs"
    );
  
  
[0m15:43:03.549826 [debug] [Thread-4 (]: SQL status: OK in 0.004 seconds
[0m15:43:03.554459 [debug] [Thread-4 (]: Using duckdb connection "model.supercell.fact_bill_generation"
[0m15:43:03.556268 [debug] [Thread-4 (]: On model.supercell.fact_bill_generation: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.fact_bill_generation"} */

  
    
    

    create  table
      "supercell"."main"."fact_bill_generation__dbt_tmp"
  
    as (
      


select
    md5(concat(linked_account_id, '_', service_code, '_', instance_type, '_', region, '_', CAST(usage_start_date AS VARCHAR), '_', CAST(usage_end_date AS VARCHAR))) AS resource_id,
    usage_start_date as start_date,
    usage_end_date as bill_date,
    usage_amount as bill_amount,
    operation
from "supercell"."main"."cleaned_usagelogs"
    );
  
  
[0m15:43:03.733237 [debug] [Thread-2 (]: SQL status: OK in 0.192 seconds
[0m15:43:03.739655 [debug] [Thread-2 (]: Using duckdb connection "model.supercell.dim_accounts"
[0m15:43:03.740780 [debug] [Thread-2 (]: On model.supercell.dim_accounts: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.dim_accounts"} */
alter table "supercell"."main"."dim_accounts__dbt_tmp" rename to "dim_accounts"
[0m15:43:03.743006 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m15:43:03.746637 [debug] [Thread-2 (]: On model.supercell.dim_accounts: COMMIT
[0m15:43:03.747846 [debug] [Thread-2 (]: Using duckdb connection "model.supercell.dim_accounts"
[0m15:43:03.748813 [debug] [Thread-2 (]: On model.supercell.dim_accounts: COMMIT
[0m15:43:03.756965 [debug] [Thread-2 (]: SQL status: OK in 0.007 seconds
[0m15:43:03.765224 [debug] [Thread-2 (]: Using duckdb connection "model.supercell.dim_accounts"
[0m15:43:03.766409 [debug] [Thread-2 (]: On model.supercell.dim_accounts: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.dim_accounts"} */
drop table if exists "supercell"."main"."dim_accounts__dbt_backup" cascade
[0m15:43:03.769228 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m15:43:03.772549 [debug] [Thread-2 (]: On model.supercell.dim_accounts: Close
[0m15:43:03.778832 [info ] [Thread-2 (]: 4 of 7 OK created sql table model main.dim_accounts ............................ [[32mOK[0m in 0.30s]
[0m15:43:03.780554 [debug] [Thread-2 (]: Finished running node model.supercell.dim_accounts
[0m15:43:03.881874 [debug] [Thread-4 (]: SQL status: OK in 0.323 seconds
[0m15:43:03.886808 [debug] [Thread-4 (]: Using duckdb connection "model.supercell.fact_bill_generation"
[0m15:43:03.887681 [debug] [Thread-4 (]: On model.supercell.fact_bill_generation: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.fact_bill_generation"} */
alter table "supercell"."main"."fact_bill_generation" rename to "fact_bill_generation__dbt_backup"
[0m15:43:03.889319 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m15:43:03.983997 [debug] [Thread-4 (]: Using duckdb connection "model.supercell.fact_bill_generation"
[0m15:43:03.984621 [debug] [Thread-4 (]: On model.supercell.fact_bill_generation: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.fact_bill_generation"} */
alter table "supercell"."main"."fact_bill_generation__dbt_tmp" rename to "fact_bill_generation"
[0m15:43:03.985801 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m15:43:03.988432 [debug] [Thread-4 (]: On model.supercell.fact_bill_generation: COMMIT
[0m15:43:03.988999 [debug] [Thread-4 (]: Using duckdb connection "model.supercell.fact_bill_generation"
[0m15:43:03.989423 [debug] [Thread-4 (]: On model.supercell.fact_bill_generation: COMMIT
[0m15:43:04.030762 [debug] [Thread-3 (]: SQL status: OK in 0.482 seconds
[0m15:43:04.034288 [debug] [Thread-3 (]: Using duckdb connection "model.supercell.dim_resource"
[0m15:43:04.034907 [debug] [Thread-3 (]: On model.supercell.dim_resource: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.dim_resource"} */
alter table "supercell"."main"."dim_resource" rename to "dim_resource__dbt_backup"
[0m15:43:04.035616 [debug] [Thread-4 (]: SQL status: OK in 0.046 seconds
[0m15:43:04.038312 [debug] [Thread-4 (]: Using duckdb connection "model.supercell.fact_bill_generation"
[0m15:43:04.038836 [debug] [Thread-4 (]: On model.supercell.fact_bill_generation: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.fact_bill_generation"} */
drop table if exists "supercell"."main"."fact_bill_generation__dbt_backup" cascade
[0m15:43:04.040063 [debug] [Thread-3 (]: SQL status: OK in 0.005 seconds
[0m15:43:04.043465 [debug] [Thread-3 (]: Using duckdb connection "model.supercell.dim_resource"
[0m15:43:04.044000 [debug] [Thread-4 (]: SQL status: OK in 0.005 seconds
[0m15:43:04.044599 [debug] [Thread-3 (]: On model.supercell.dim_resource: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.dim_resource"} */
alter table "supercell"."main"."dim_resource__dbt_tmp" rename to "dim_resource"
[0m15:43:04.046329 [debug] [Thread-4 (]: On model.supercell.fact_bill_generation: Close
[0m15:43:04.047949 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m15:43:04.051601 [debug] [Thread-3 (]: On model.supercell.dim_resource: COMMIT
[0m15:43:04.052687 [debug] [Thread-3 (]: Using duckdb connection "model.supercell.dim_resource"
[0m15:43:04.053504 [debug] [Thread-3 (]: On model.supercell.dim_resource: COMMIT
[0m15:43:04.060926 [info ] [Thread-4 (]: 6 of 7 OK created sql table model main.fact_bill_generation .................... [[32mOK[0m in 0.56s]
[0m15:43:04.061775 [debug] [Thread-4 (]: Finished running node model.supercell.fact_bill_generation
[0m15:43:04.068065 [debug] [Thread-3 (]: SQL status: OK in 0.013 seconds
[0m15:43:04.075688 [debug] [Thread-3 (]: Using duckdb connection "model.supercell.dim_resource"
[0m15:43:04.077000 [debug] [Thread-3 (]: On model.supercell.dim_resource: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.dim_resource"} */
drop table if exists "supercell"."main"."dim_resource__dbt_backup" cascade
[0m15:43:04.082309 [debug] [Thread-3 (]: SQL status: OK in 0.004 seconds
[0m15:43:04.085878 [debug] [Thread-3 (]: On model.supercell.dim_resource: Close
[0m15:43:04.088625 [info ] [Thread-3 (]: 5 of 7 OK created sql table model main.dim_resource ............................ [[32mOK[0m in 0.60s]
[0m15:43:04.090399 [debug] [Thread-3 (]: Finished running node model.supercell.dim_resource
[0m15:43:04.093133 [debug] [Thread-1 (]: Began running node model.supercell.total_cost
[0m15:43:04.094603 [info ] [Thread-1 (]: 7 of 7 START sql table model main.total_cost ................................... [RUN]
[0m15:43:04.095760 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.supercell.cleaned_usagelogs, now model.supercell.total_cost)
[0m15:43:04.096519 [debug] [Thread-1 (]: Began compiling node model.supercell.total_cost
[0m15:43:04.104414 [debug] [Thread-1 (]: Writing injected SQL for node "model.supercell.total_cost"
[0m15:43:04.106383 [debug] [Thread-1 (]: Began executing node model.supercell.total_cost
[0m15:43:04.111489 [debug] [Thread-1 (]: Writing runtime sql for node "model.supercell.total_cost"
[0m15:43:04.112912 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.total_cost"
[0m15:43:04.113517 [debug] [Thread-1 (]: On model.supercell.total_cost: BEGIN
[0m15:43:04.113980 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:43:04.114932 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:43:04.115381 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.total_cost"
[0m15:43:04.115824 [debug] [Thread-1 (]: On model.supercell.total_cost: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.total_cost"} */

  
    
    

    create  table
      "supercell"."main"."total_cost__dbt_tmp"
  
    as (
      

with base as (
    select
        fact_bill_generation.resource_id as resource_id,
        fact_bill_generation.date_trunc('month', bill_date) as month,
        bill_amount,
        dim_resource.instance_type as instance_type,
        dim_resource.service_code as service_code,
        dim_resource.region as region,
        dim_resource.pricing_model as pricing_model,
        dim_accounts.tag_values as tag_values,
        dim_accounts.tag_keys as tag_keys,
    from "supercell"."main"."fact_bill_generation" as fact_bill_generation
    left join "supercell"."main"."dim_resource" using (resource_id) as dim_resource
    left join "supercell"."main"."dim_accounts" using (linked_account_id) as dim_accounts
)

select
    month,
    sum(bill_amount) as total_cost,
    instance_type,
    service_code,
    region,
    pricing_model,
    tag_keys,
    tag_values
from base
group by
    month,
    instance_type,
    service_code,
    region,
    pricing_model,
    tag_keys,
    tag_values
    );
  
  
[0m15:43:04.117017 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.total_cost"} */

  
    
    

    create  table
      "supercell"."main"."total_cost__dbt_tmp"
  
    as (
      

with base as (
    select
        fact_bill_generation.resource_id as resource_id,
        fact_bill_generation.date_trunc('month', bill_date) as month,
        bill_amount,
        dim_resource.instance_type as instance_type,
        dim_resource.service_code as service_code,
        dim_resource.region as region,
        dim_resource.pricing_model as pricing_model,
        dim_accounts.tag_values as tag_values,
        dim_accounts.tag_keys as tag_keys,
    from "supercell"."main"."fact_bill_generation" as fact_bill_generation
    left join "supercell"."main"."dim_resource" using (resource_id) as dim_resource
    left join "supercell"."main"."dim_accounts" using (linked_account_id) as dim_accounts
)

select
    month,
    sum(bill_amount) as total_cost,
    instance_type,
    service_code,
    region,
    pricing_model,
    tag_keys,
    tag_values
from base
group by
    month,
    instance_type,
    service_code,
    region,
    pricing_model,
    tag_keys,
    tag_values
    );
  
  
[0m15:43:04.117518 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m15:43:04.118084 [debug] [Thread-1 (]: On model.supercell.total_cost: ROLLBACK
[0m15:43:04.122846 [debug] [Thread-1 (]: Failed to rollback 'model.supercell.total_cost'
[0m15:43:04.123380 [debug] [Thread-1 (]: On model.supercell.total_cost: Close
[0m15:43:04.126165 [debug] [Thread-1 (]: Runtime Error in model total_cost (models/supercell_models/metrics/total_cost.sql)
  Parser Error: syntax error at or near "as"
[0m15:43:04.127042 [error] [Thread-1 (]: 7 of 7 ERROR creating sql table model main.total_cost .......................... [[31mERROR[0m in 0.03s]
[0m15:43:04.127739 [debug] [Thread-1 (]: Finished running node model.supercell.total_cost
[0m15:43:04.128760 [debug] [Thread-7 (]: Marking all children of 'model.supercell.total_cost' to be skipped because of status 'error'.  Reason: Runtime Error in model total_cost (models/supercell_models/metrics/total_cost.sql)
  Parser Error: syntax error at or near "as".
[0m15:43:04.131733 [debug] [MainThread]: Using duckdb connection "master"
[0m15:43:04.132181 [debug] [MainThread]: On master: BEGIN
[0m15:43:04.132536 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:43:04.133345 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m15:43:04.133762 [debug] [MainThread]: On master: COMMIT
[0m15:43:04.134119 [debug] [MainThread]: Using duckdb connection "master"
[0m15:43:04.134441 [debug] [MainThread]: On master: COMMIT
[0m15:43:04.135043 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m15:43:04.135405 [debug] [MainThread]: On master: Close
[0m15:43:04.135968 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:43:04.136336 [debug] [MainThread]: Connection 'model.supercell.total_cost' was properly closed.
[0m15:43:04.136635 [debug] [MainThread]: Connection 'model.supercell.dim_accounts' was properly closed.
[0m15:43:04.136930 [debug] [MainThread]: Connection 'model.supercell.fact_bill_generation' was properly closed.
[0m15:43:04.137199 [debug] [MainThread]: Connection 'model.supercell.dim_resource' was properly closed.
[0m15:43:04.137628 [info ] [MainThread]: 
[0m15:43:04.138123 [info ] [MainThread]: Finished running 6 table models, 1 view model in 0 hours 0 minutes and 1.61 seconds (1.61s).
[0m15:43:04.139635 [debug] [MainThread]: Command end result
[0m15:43:04.177532 [debug] [MainThread]: Wrote artifact WritableManifest to /home/harsha/data_actions/supercell_cloudops/target/manifest.json
[0m15:43:04.179981 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/harsha/data_actions/supercell_cloudops/target/semantic_manifest.json
[0m15:43:04.187389 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/harsha/data_actions/supercell_cloudops/target/run_results.json
[0m15:43:04.187906 [info ] [MainThread]: 
[0m15:43:04.188351 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m15:43:04.188765 [info ] [MainThread]: 
[0m15:43:04.189189 [error] [MainThread]:   Runtime Error in model total_cost (models/supercell_models/metrics/total_cost.sql)
  Parser Error: syntax error at or near "as"
[0m15:43:04.189520 [info ] [MainThread]: 
[0m15:43:04.189913 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=1 SKIP=0 TOTAL=7
[0m15:43:04.191271 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 2.6792388, "process_in_blocks": "8", "process_kernel_time": 0.66137, "process_mem_max_rss": "362784", "process_out_blocks": "58360", "process_user_time": 8.723703}
[0m15:43:04.191963 [debug] [MainThread]: Command `dbt run` failed at 15:43:04.191824 after 2.68 seconds
[0m15:43:04.192400 [debug] [MainThread]: Flushing usage events


============================== 15:45:30.802267 | 520899af-b467-4a0e-a8ce-109758b83429 ==============================
[0m15:45:30.802267 [info ] [MainThread]: Running with dbt=1.9.4
[0m15:45:30.807909 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/harsha/data_actions/supercell_cloudops', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/harsha/data_actions/supercell_cloudops/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'False'}
[0m15:45:30.808606 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality

User config should be moved from the 'config' key in profiles.yml to the 'flags' key in dbt_project.yml.
[0m15:45:31.163394 [info ] [MainThread]: Registered adapter: duckdb=1.9.3
[0m15:45:31.237186 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m15:45:31.348306 [debug] [MainThread]: Partial parsing enabled: 3 files deleted, 0 files added, 1 files changed.
[0m15:45:31.349067 [debug] [MainThread]: Partial parsing: deleted file: supercell://models/example/my_second_dbt_model.sql
[0m15:45:31.349503 [debug] [MainThread]: Partial parsing: deleted file: supercell://models/example/my_first_dbt_model.sql
[0m15:45:31.350056 [debug] [MainThread]: Partial parsing: updated file: supercell://models/supercell_models/metrics/total_cost.sql
[0m15:45:31.646994 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.supercell.example
[0m15:45:31.712425 [debug] [MainThread]: Wrote artifact WritableManifest to /home/harsha/data_actions/supercell_cloudops/target/manifest.json
[0m15:45:31.714420 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/harsha/data_actions/supercell_cloudops/target/semantic_manifest.json
[0m15:45:31.732904 [info ] [MainThread]: Found 5 models, 428 macros
[0m15:45:31.736539 [info ] [MainThread]: 
[0m15:45:31.737414 [info ] [MainThread]: Concurrency: 4 threads (target='default')
[0m15:45:31.738014 [info ] [MainThread]: 
[0m15:45:31.738922 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m15:45:31.749806 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_supercell'
[0m15:45:31.816764 [debug] [ThreadPool]: Using duckdb connection "list_supercell"
[0m15:45:31.817457 [debug] [ThreadPool]: On list_supercell: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "connection_name": "list_supercell"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"supercell"'
    
  
  
[0m15:45:31.817967 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:45:31.837038 [debug] [ThreadPool]: SQL status: OK in 0.019 seconds
[0m15:45:31.838903 [debug] [ThreadPool]: On list_supercell: Close
[0m15:45:31.839920 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_supercell, now create_supercell_main)
[0m15:45:31.840536 [debug] [ThreadPool]: Creating schema "database: "supercell"
schema: "main"
"
[0m15:45:31.848459 [debug] [ThreadPool]: Using duckdb connection "create_supercell_main"
[0m15:45:31.848911 [debug] [ThreadPool]: On create_supercell_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "connection_name": "create_supercell_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='supercell'
        and type='sqlite'
    
  
[0m15:45:31.849270 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:45:31.850458 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m15:45:31.852033 [debug] [ThreadPool]: Using duckdb connection "create_supercell_main"
[0m15:45:31.852423 [debug] [ThreadPool]: On create_supercell_main: BEGIN
[0m15:45:31.853001 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m15:45:31.853336 [debug] [ThreadPool]: Using duckdb connection "create_supercell_main"
[0m15:45:31.853629 [debug] [ThreadPool]: On create_supercell_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "connection_name": "create_supercell_main"} */

    
    
        create schema if not exists "supercell"."main"
    
[0m15:45:31.854193 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m15:45:31.855171 [debug] [ThreadPool]: On create_supercell_main: COMMIT
[0m15:45:31.855571 [debug] [ThreadPool]: Using duckdb connection "create_supercell_main"
[0m15:45:31.855906 [debug] [ThreadPool]: On create_supercell_main: COMMIT
[0m15:45:31.856462 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m15:45:31.856839 [debug] [ThreadPool]: On create_supercell_main: Close
[0m15:45:31.858965 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_supercell_main, now list_supercell_main)
[0m15:45:31.867270 [debug] [ThreadPool]: Using duckdb connection "list_supercell_main"
[0m15:45:31.867844 [debug] [ThreadPool]: On list_supercell_main: BEGIN
[0m15:45:31.868309 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:45:31.869242 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m15:45:31.869731 [debug] [ThreadPool]: Using duckdb connection "list_supercell_main"
[0m15:45:31.870217 [debug] [ThreadPool]: On list_supercell_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "connection_name": "list_supercell_main"} */
select
      'supercell' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'supercell'
  
[0m15:45:31.893333 [debug] [ThreadPool]: SQL status: OK in 0.022 seconds
[0m15:45:31.897311 [debug] [ThreadPool]: On list_supercell_main: ROLLBACK
[0m15:45:31.900225 [debug] [ThreadPool]: Failed to rollback 'list_supercell_main'
[0m15:45:31.900897 [debug] [ThreadPool]: On list_supercell_main: Close
[0m15:45:31.904634 [debug] [MainThread]: Using duckdb connection "master"
[0m15:45:31.905326 [debug] [MainThread]: On master: BEGIN
[0m15:45:31.905829 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:45:31.907081 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m15:45:31.907848 [debug] [MainThread]: On master: COMMIT
[0m15:45:31.908679 [debug] [MainThread]: Using duckdb connection "master"
[0m15:45:31.909289 [debug] [MainThread]: On master: COMMIT
[0m15:45:31.910148 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m15:45:31.910629 [debug] [MainThread]: On master: Close
[0m15:45:31.915468 [debug] [Thread-1 (]: Began running node model.supercell.cleaned_usagelogs
[0m15:45:31.916614 [info ] [Thread-1 (]: 1 of 5 START sql table model main.cleaned_usagelogs ............................ [RUN]
[0m15:45:31.917714 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_supercell_main, now model.supercell.cleaned_usagelogs)
[0m15:45:31.918565 [debug] [Thread-1 (]: Began compiling node model.supercell.cleaned_usagelogs
[0m15:45:31.934142 [debug] [Thread-1 (]: Writing injected SQL for node "model.supercell.cleaned_usagelogs"
[0m15:45:31.935864 [debug] [Thread-1 (]: Began executing node model.supercell.cleaned_usagelogs
[0m15:45:31.981616 [debug] [Thread-1 (]: Writing runtime sql for node "model.supercell.cleaned_usagelogs"
[0m15:45:31.982691 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.cleaned_usagelogs"
[0m15:45:31.983190 [debug] [Thread-1 (]: On model.supercell.cleaned_usagelogs: BEGIN
[0m15:45:31.983589 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:45:31.984734 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:45:31.985210 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.cleaned_usagelogs"
[0m15:45:31.985719 [debug] [Thread-1 (]: On model.supercell.cleaned_usagelogs: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.cleaned_usagelogs"} */

  
    
    

    create  table
      "supercell"."main"."cleaned_usagelogs__dbt_tmp"
  
    as (
      


SELECT
    CAST("LinkedAccountId" AS VARCHAR) AS linked_account_id,
    CAST("bill/PayerAccountId" AS VARCHAR) AS payer_account_id,
    CAST("lineItem/UsageStartDate" AS TIMESTAMP) AS usage_start_date,
    CAST("lineItem/UsageEndDate" AS TIMESTAMP) AS usage_end_date,
    CAST("lineItem/UsageAmount" AS DECIMAL(18, 6)) AS usage_amount,
    CAST("lineItem/Operation" AS VARCHAR) AS operation,
    CAST("pricing/PricingModel" AS VARCHAR) AS pricing_model,
    CAST("resourceTags/TagKeys" AS VARCHAR) AS tag_keys,
    CAST("resourceTags/TagValues" AS VARCHAR) AS tag_values,
    CAST("product/Region" AS VARCHAR) AS region,
    CAST("product/ServiceCode" AS VARCHAR) AS service_code,
    CAST("product/InstanceType" AS VARCHAR) AS instance_type,
    CAST("amortized_cost" AS DECIMAL(18, 6)) AS amortized_cost,
    CAST("product/Description" AS VARCHAR) AS description
FROM supercell_usagelogs
    );
  
  
[0m15:45:32.524940 [debug] [Thread-1 (]: SQL status: OK in 0.539 seconds
[0m15:45:32.532450 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.cleaned_usagelogs"
[0m15:45:32.533004 [debug] [Thread-1 (]: On model.supercell.cleaned_usagelogs: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.cleaned_usagelogs"} */
alter table "supercell"."main"."cleaned_usagelogs" rename to "cleaned_usagelogs__dbt_backup"
[0m15:45:32.534113 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:45:32.537417 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.cleaned_usagelogs"
[0m15:45:32.537903 [debug] [Thread-1 (]: On model.supercell.cleaned_usagelogs: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.cleaned_usagelogs"} */
alter table "supercell"."main"."cleaned_usagelogs__dbt_tmp" rename to "cleaned_usagelogs"
[0m15:45:32.538766 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:45:32.557623 [debug] [Thread-1 (]: On model.supercell.cleaned_usagelogs: COMMIT
[0m15:45:32.558274 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.cleaned_usagelogs"
[0m15:45:32.558727 [debug] [Thread-1 (]: On model.supercell.cleaned_usagelogs: COMMIT
[0m15:45:32.586435 [debug] [Thread-1 (]: SQL status: OK in 0.027 seconds
[0m15:45:32.594346 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.cleaned_usagelogs"
[0m15:45:32.594936 [debug] [Thread-1 (]: On model.supercell.cleaned_usagelogs: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.cleaned_usagelogs"} */
drop table if exists "supercell"."main"."cleaned_usagelogs__dbt_backup" cascade
[0m15:45:32.599343 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m15:45:32.602471 [debug] [Thread-1 (]: On model.supercell.cleaned_usagelogs: Close
[0m15:45:32.605937 [info ] [Thread-1 (]: 1 of 5 OK created sql table model main.cleaned_usagelogs ....................... [[32mOK[0m in 0.69s]
[0m15:45:32.606721 [debug] [Thread-1 (]: Finished running node model.supercell.cleaned_usagelogs
[0m15:45:32.608386 [debug] [Thread-3 (]: Began running node model.supercell.dim_accounts
[0m15:45:32.609769 [debug] [Thread-4 (]: Began running node model.supercell.dim_resource
[0m15:45:32.610969 [debug] [Thread-2 (]: Began running node model.supercell.fact_bill_generation
[0m15:45:32.612137 [info ] [Thread-3 (]: 2 of 5 START sql table model main.dim_accounts ................................. [RUN]
[0m15:45:32.613544 [info ] [Thread-4 (]: 3 of 5 START sql table model main.dim_resource ................................. [RUN]
[0m15:45:32.615149 [info ] [Thread-2 (]: 4 of 5 START sql table model main.fact_bill_generation ......................... [RUN]
[0m15:45:32.616857 [debug] [Thread-3 (]: Acquiring new duckdb connection 'model.supercell.dim_accounts'
[0m15:45:32.618749 [debug] [Thread-4 (]: Acquiring new duckdb connection 'model.supercell.dim_resource'
[0m15:45:32.620672 [debug] [Thread-2 (]: Acquiring new duckdb connection 'model.supercell.fact_bill_generation'
[0m15:45:32.622166 [debug] [Thread-3 (]: Began compiling node model.supercell.dim_accounts
[0m15:45:32.623862 [debug] [Thread-4 (]: Began compiling node model.supercell.dim_resource
[0m15:45:32.625404 [debug] [Thread-2 (]: Began compiling node model.supercell.fact_bill_generation
[0m15:45:32.632907 [debug] [Thread-3 (]: Writing injected SQL for node "model.supercell.dim_accounts"
[0m15:45:32.641762 [debug] [Thread-4 (]: Writing injected SQL for node "model.supercell.dim_resource"
[0m15:45:32.648688 [debug] [Thread-2 (]: Writing injected SQL for node "model.supercell.fact_bill_generation"
[0m15:45:32.650562 [debug] [Thread-3 (]: Began executing node model.supercell.dim_accounts
[0m15:45:32.658163 [debug] [Thread-4 (]: Began executing node model.supercell.dim_resource
[0m15:45:32.664466 [debug] [Thread-2 (]: Began executing node model.supercell.fact_bill_generation
[0m15:45:32.666355 [debug] [Thread-3 (]: Writing runtime sql for node "model.supercell.dim_accounts"
[0m15:45:32.671918 [debug] [Thread-2 (]: Writing runtime sql for node "model.supercell.fact_bill_generation"
[0m15:45:32.674277 [debug] [Thread-4 (]: Writing runtime sql for node "model.supercell.dim_resource"
[0m15:45:32.675579 [debug] [Thread-3 (]: Using duckdb connection "model.supercell.dim_accounts"
[0m15:45:32.677445 [debug] [Thread-2 (]: Using duckdb connection "model.supercell.fact_bill_generation"
[0m15:45:32.678408 [debug] [Thread-4 (]: Using duckdb connection "model.supercell.dim_resource"
[0m15:45:32.679323 [debug] [Thread-3 (]: On model.supercell.dim_accounts: BEGIN
[0m15:45:32.680178 [debug] [Thread-2 (]: On model.supercell.fact_bill_generation: BEGIN
[0m15:45:32.681101 [debug] [Thread-4 (]: On model.supercell.dim_resource: BEGIN
[0m15:45:32.682057 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m15:45:32.682942 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m15:45:32.683894 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m15:45:32.686311 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m15:45:32.687447 [debug] [Thread-2 (]: Using duckdb connection "model.supercell.fact_bill_generation"
[0m15:45:32.688159 [debug] [Thread-2 (]: On model.supercell.fact_bill_generation: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.fact_bill_generation"} */

  
    
    

    create  table
      "supercell"."main"."fact_bill_generation__dbt_tmp"
  
    as (
      


select
    md5(concat(linked_account_id, '_', service_code, '_', instance_type, '_', region, '_', CAST(usage_start_date AS VARCHAR), '_', CAST(usage_end_date AS VARCHAR))) AS resource_id,
    usage_start_date as start_date,
    usage_end_date as bill_date,
    usage_amount as bill_amount,
    operation
from "supercell"."main"."cleaned_usagelogs"
    );
  
  
[0m15:45:32.689416 [debug] [Thread-4 (]: SQL status: OK in 0.005 seconds
[0m15:45:32.690555 [debug] [Thread-4 (]: Using duckdb connection "model.supercell.dim_resource"
[0m15:45:32.692177 [debug] [Thread-3 (]: SQL status: OK in 0.010 seconds
[0m15:45:32.693454 [debug] [Thread-4 (]: On model.supercell.dim_resource: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.dim_resource"} */

  
    
    

    create  table
      "supercell"."main"."dim_resource__dbt_tmp"
  
    as (
      


select
    md5(concat(linked_account_id, '_', service_code, '_', instance_type, '_', region, '_', CAST(usage_start_date AS VARCHAR), '_', CAST(usage_end_date AS VARCHAR))) AS resource_id,
    linked_account_id as linked_account_id,
    region,
    service_code as product,
    instance_type as instance_type,
    pricing_model as pricing_model
from "supercell"."main"."cleaned_usagelogs"
    );
  
  
[0m15:45:32.694980 [debug] [Thread-3 (]: Using duckdb connection "model.supercell.dim_accounts"
[0m15:45:32.697413 [debug] [Thread-3 (]: On model.supercell.dim_accounts: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.dim_accounts"} */

  
    
    

    create  table
      "supercell"."main"."dim_accounts__dbt_tmp"
  
    as (
      


select
    linked_account_id as linked_account_id,
    tag_keys as tag_keys,
    tag_values as tag_values
from "supercell"."main"."cleaned_usagelogs"
    );
  
  
[0m15:45:33.014308 [debug] [Thread-2 (]: SQL status: OK in 0.325 seconds
[0m15:45:33.019707 [debug] [Thread-2 (]: Using duckdb connection "model.supercell.fact_bill_generation"
[0m15:45:33.020606 [debug] [Thread-2 (]: On model.supercell.fact_bill_generation: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.fact_bill_generation"} */
alter table "supercell"."main"."fact_bill_generation" rename to "fact_bill_generation__dbt_backup"
[0m15:45:33.022228 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m15:45:33.027442 [debug] [Thread-2 (]: Using duckdb connection "model.supercell.fact_bill_generation"
[0m15:45:33.028309 [debug] [Thread-2 (]: On model.supercell.fact_bill_generation: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.fact_bill_generation"} */
alter table "supercell"."main"."fact_bill_generation__dbt_tmp" rename to "fact_bill_generation"
[0m15:45:33.029099 [debug] [Thread-3 (]: SQL status: OK in 0.330 seconds
[0m15:45:33.034013 [debug] [Thread-3 (]: Using duckdb connection "model.supercell.dim_accounts"
[0m15:45:33.034873 [debug] [Thread-3 (]: On model.supercell.dim_accounts: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.dim_accounts"} */
alter table "supercell"."main"."dim_accounts" rename to "dim_accounts__dbt_backup"
[0m15:45:33.035707 [debug] [Thread-2 (]: SQL status: OK in 0.006 seconds
[0m15:45:33.039274 [debug] [Thread-2 (]: On model.supercell.fact_bill_generation: COMMIT
[0m15:45:33.040106 [debug] [Thread-2 (]: Using duckdb connection "model.supercell.fact_bill_generation"
[0m15:45:33.040895 [debug] [Thread-3 (]: SQL status: OK in 0.004 seconds
[0m15:45:33.041928 [debug] [Thread-2 (]: On model.supercell.fact_bill_generation: COMMIT
[0m15:45:33.046799 [debug] [Thread-3 (]: Using duckdb connection "model.supercell.dim_accounts"
[0m15:45:33.047933 [debug] [Thread-3 (]: On model.supercell.dim_accounts: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.dim_accounts"} */
alter table "supercell"."main"."dim_accounts__dbt_tmp" rename to "dim_accounts"
[0m15:45:33.049350 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m15:45:33.052888 [debug] [Thread-3 (]: On model.supercell.dim_accounts: COMMIT
[0m15:45:33.053716 [debug] [Thread-3 (]: Using duckdb connection "model.supercell.dim_accounts"
[0m15:45:33.054409 [debug] [Thread-3 (]: On model.supercell.dim_accounts: COMMIT
[0m15:45:33.097065 [debug] [Thread-2 (]: SQL status: OK in 0.049 seconds
[0m15:45:33.103510 [debug] [Thread-2 (]: Using duckdb connection "model.supercell.fact_bill_generation"
[0m15:45:33.104568 [debug] [Thread-2 (]: On model.supercell.fact_bill_generation: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.fact_bill_generation"} */
drop table if exists "supercell"."main"."fact_bill_generation__dbt_backup" cascade
[0m15:45:33.105524 [debug] [Thread-3 (]: SQL status: OK in 0.050 seconds
[0m15:45:33.109814 [debug] [Thread-3 (]: Using duckdb connection "model.supercell.dim_accounts"
[0m15:45:33.110627 [debug] [Thread-3 (]: On model.supercell.dim_accounts: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.dim_accounts"} */
drop table if exists "supercell"."main"."dim_accounts__dbt_backup" cascade
[0m15:45:33.112924 [debug] [Thread-2 (]: SQL status: OK in 0.007 seconds
[0m15:45:33.115692 [debug] [Thread-2 (]: On model.supercell.fact_bill_generation: Close
[0m15:45:33.118180 [debug] [Thread-3 (]: SQL status: OK in 0.007 seconds
[0m15:45:33.121227 [debug] [Thread-3 (]: On model.supercell.dim_accounts: Close
[0m15:45:33.127616 [info ] [Thread-2 (]: 4 of 5 OK created sql table model main.fact_bill_generation .................... [[32mOK[0m in 0.51s]
[0m15:45:33.129180 [info ] [Thread-3 (]: 2 of 5 OK created sql table model main.dim_accounts ............................ [[32mOK[0m in 0.51s]
[0m15:45:33.130475 [debug] [Thread-2 (]: Finished running node model.supercell.fact_bill_generation
[0m15:45:33.131863 [debug] [Thread-3 (]: Finished running node model.supercell.dim_accounts
[0m15:45:33.232091 [debug] [Thread-4 (]: SQL status: OK in 0.536 seconds
[0m15:45:33.236474 [debug] [Thread-4 (]: Using duckdb connection "model.supercell.dim_resource"
[0m15:45:33.237190 [debug] [Thread-4 (]: On model.supercell.dim_resource: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.dim_resource"} */
alter table "supercell"."main"."dim_resource" rename to "dim_resource__dbt_backup"
[0m15:45:33.238491 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m15:45:33.243629 [debug] [Thread-4 (]: Using duckdb connection "model.supercell.dim_resource"
[0m15:45:33.244395 [debug] [Thread-4 (]: On model.supercell.dim_resource: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.dim_resource"} */
alter table "supercell"."main"."dim_resource__dbt_tmp" rename to "dim_resource"
[0m15:45:33.245792 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m15:45:33.248787 [debug] [Thread-4 (]: On model.supercell.dim_resource: COMMIT
[0m15:45:33.249428 [debug] [Thread-4 (]: Using duckdb connection "model.supercell.dim_resource"
[0m15:45:33.249977 [debug] [Thread-4 (]: On model.supercell.dim_resource: COMMIT
[0m15:45:33.263531 [debug] [Thread-4 (]: SQL status: OK in 0.013 seconds
[0m15:45:33.267929 [debug] [Thread-4 (]: Using duckdb connection "model.supercell.dim_resource"
[0m15:45:33.268589 [debug] [Thread-4 (]: On model.supercell.dim_resource: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.dim_resource"} */
drop table if exists "supercell"."main"."dim_resource__dbt_backup" cascade
[0m15:45:33.271849 [debug] [Thread-4 (]: SQL status: OK in 0.003 seconds
[0m15:45:33.274344 [debug] [Thread-4 (]: On model.supercell.dim_resource: Close
[0m15:45:33.278503 [info ] [Thread-4 (]: 3 of 5 OK created sql table model main.dim_resource ............................ [[32mOK[0m in 0.66s]
[0m15:45:33.279583 [debug] [Thread-4 (]: Finished running node model.supercell.dim_resource
[0m15:45:33.280813 [debug] [Thread-1 (]: Began running node model.supercell.total_cost
[0m15:45:33.281746 [info ] [Thread-1 (]: 5 of 5 START sql table model main.total_cost ................................... [RUN]
[0m15:45:33.282888 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.supercell.cleaned_usagelogs, now model.supercell.total_cost)
[0m15:45:33.284172 [debug] [Thread-1 (]: Began compiling node model.supercell.total_cost
[0m15:45:33.291148 [debug] [Thread-1 (]: Writing injected SQL for node "model.supercell.total_cost"
[0m15:45:33.292479 [debug] [Thread-1 (]: Began executing node model.supercell.total_cost
[0m15:45:33.296683 [debug] [Thread-1 (]: Writing runtime sql for node "model.supercell.total_cost"
[0m15:45:33.297724 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.total_cost"
[0m15:45:33.298227 [debug] [Thread-1 (]: On model.supercell.total_cost: BEGIN
[0m15:45:33.298592 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:45:33.299496 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:45:33.300003 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.total_cost"
[0m15:45:33.300446 [debug] [Thread-1 (]: On model.supercell.total_cost: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.total_cost"} */

  
    
    

    create  table
      "supercell"."main"."total_cost__dbt_tmp"
  
    as (
      

with base as (
    select
        fact_bill_generation.resource_id as resource_id,
        date_trunc('month', bill_date) as month,
        bill_amount,
        dim_resource.instance_type as instance_type,
        dim_resource.service_code as service_code,
        dim_resource.region as region,
        dim_resource.pricing_model as pricing_model,
        dim_accounts.tag_values as tag_values,
        dim_accounts.tag_keys as tag_keys,
    from "supercell"."main"."fact_bill_generation" as fact_bill_generation
    left join "supercell"."main"."dim_resource" using (resource_id) as dim_resource
    left join "supercell"."main"."dim_accounts" using (linked_account_id) as dim_accounts
)

select
    month,
    sum(bill_amount) as total_cost,
    instance_type,
    service_code,
    region,
    pricing_model,
    tag_keys,
    tag_values
from base
group by
    month,
    instance_type,
    service_code,
    region,
    pricing_model,
    tag_keys,
    tag_values
    );
  
  
[0m15:45:33.301318 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.total_cost"} */

  
    
    

    create  table
      "supercell"."main"."total_cost__dbt_tmp"
  
    as (
      

with base as (
    select
        fact_bill_generation.resource_id as resource_id,
        date_trunc('month', bill_date) as month,
        bill_amount,
        dim_resource.instance_type as instance_type,
        dim_resource.service_code as service_code,
        dim_resource.region as region,
        dim_resource.pricing_model as pricing_model,
        dim_accounts.tag_values as tag_values,
        dim_accounts.tag_keys as tag_keys,
    from "supercell"."main"."fact_bill_generation" as fact_bill_generation
    left join "supercell"."main"."dim_resource" using (resource_id) as dim_resource
    left join "supercell"."main"."dim_accounts" using (linked_account_id) as dim_accounts
)

select
    month,
    sum(bill_amount) as total_cost,
    instance_type,
    service_code,
    region,
    pricing_model,
    tag_keys,
    tag_values
from base
group by
    month,
    instance_type,
    service_code,
    region,
    pricing_model,
    tag_keys,
    tag_values
    );
  
  
[0m15:45:33.301920 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m15:45:33.302493 [debug] [Thread-1 (]: On model.supercell.total_cost: ROLLBACK
[0m15:45:33.307144 [debug] [Thread-1 (]: Failed to rollback 'model.supercell.total_cost'
[0m15:45:33.307717 [debug] [Thread-1 (]: On model.supercell.total_cost: Close
[0m15:45:33.310493 [debug] [Thread-1 (]: Runtime Error in model total_cost (models/supercell_models/metrics/total_cost.sql)
  Parser Error: syntax error at or near "as"
[0m15:45:33.311376 [error] [Thread-1 (]: 5 of 5 ERROR creating sql table model main.total_cost .......................... [[31mERROR[0m in 0.03s]
[0m15:45:33.312097 [debug] [Thread-1 (]: Finished running node model.supercell.total_cost
[0m15:45:33.313149 [debug] [Thread-7 (]: Marking all children of 'model.supercell.total_cost' to be skipped because of status 'error'.  Reason: Runtime Error in model total_cost (models/supercell_models/metrics/total_cost.sql)
  Parser Error: syntax error at or near "as".
[0m15:45:33.316723 [debug] [MainThread]: Using duckdb connection "master"
[0m15:45:33.317421 [debug] [MainThread]: On master: BEGIN
[0m15:45:33.318182 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:45:33.319611 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m15:45:33.320293 [debug] [MainThread]: On master: COMMIT
[0m15:45:33.320984 [debug] [MainThread]: Using duckdb connection "master"
[0m15:45:33.321606 [debug] [MainThread]: On master: COMMIT
[0m15:45:33.322682 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m15:45:33.323451 [debug] [MainThread]: On master: Close
[0m15:45:33.324606 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:45:33.325408 [debug] [MainThread]: Connection 'model.supercell.total_cost' was properly closed.
[0m15:45:33.326110 [debug] [MainThread]: Connection 'model.supercell.dim_accounts' was properly closed.
[0m15:45:33.326818 [debug] [MainThread]: Connection 'model.supercell.dim_resource' was properly closed.
[0m15:45:33.327427 [debug] [MainThread]: Connection 'model.supercell.fact_bill_generation' was properly closed.
[0m15:45:33.328453 [info ] [MainThread]: 
[0m15:45:33.329455 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 1.59 seconds (1.59s).
[0m15:45:33.333359 [debug] [MainThread]: Command end result
[0m15:45:33.433011 [debug] [MainThread]: Wrote artifact WritableManifest to /home/harsha/data_actions/supercell_cloudops/target/manifest.json
[0m15:45:33.434911 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/harsha/data_actions/supercell_cloudops/target/semantic_manifest.json
[0m15:45:33.442000 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/harsha/data_actions/supercell_cloudops/target/run_results.json
[0m15:45:33.442498 [info ] [MainThread]: 
[0m15:45:33.442937 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m15:45:33.443292 [info ] [MainThread]: 
[0m15:45:33.443711 [error] [MainThread]:   Runtime Error in model total_cost (models/supercell_models/metrics/total_cost.sql)
  Parser Error: syntax error at or near "as"
[0m15:45:33.444072 [info ] [MainThread]: 
[0m15:45:33.444428 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
[0m15:45:33.445593 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 2.7068737, "process_in_blocks": "0", "process_kernel_time": 0.610063, "process_mem_max_rss": "368312", "process_out_blocks": "59192", "process_user_time": 8.496951}
[0m15:45:33.446201 [debug] [MainThread]: Command `dbt run` failed at 15:45:33.446084 after 2.71 seconds
[0m15:45:33.446610 [debug] [MainThread]: Flushing usage events


============================== 15:46:50.899873 | 0c0b7d5b-3194-4512-8bae-2b584c1d8e9a ==============================
[0m15:46:50.899873 [info ] [MainThread]: Running with dbt=1.9.4
[0m15:46:50.905278 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/harsha/data_actions/supercell_cloudops', 'debug': 'False', 'warn_error': 'None', 'log_path': '/home/harsha/data_actions/supercell_cloudops/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'False'}
[0m15:46:50.905810 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality

User config should be moved from the 'config' key in profiles.yml to the 'flags' key in dbt_project.yml.
[0m15:46:51.224207 [info ] [MainThread]: Registered adapter: duckdb=1.9.3
[0m15:46:51.297240 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m15:46:51.380320 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:46:51.381105 [debug] [MainThread]: Partial parsing: updated file: supercell://models/supercell_models/metrics/total_cost.sql
[0m15:46:51.674237 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.supercell.example
[0m15:46:51.746570 [debug] [MainThread]: Wrote artifact WritableManifest to /home/harsha/data_actions/supercell_cloudops/target/manifest.json
[0m15:46:51.748496 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/harsha/data_actions/supercell_cloudops/target/semantic_manifest.json
[0m15:46:51.761241 [info ] [MainThread]: Found 5 models, 428 macros
[0m15:46:51.763930 [info ] [MainThread]: 
[0m15:46:51.764540 [info ] [MainThread]: Concurrency: 4 threads (target='default')
[0m15:46:51.764935 [info ] [MainThread]: 
[0m15:46:51.765503 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m15:46:51.775464 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_supercell'
[0m15:46:51.834995 [debug] [ThreadPool]: Using duckdb connection "list_supercell"
[0m15:46:51.835730 [debug] [ThreadPool]: On list_supercell: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "connection_name": "list_supercell"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"supercell"'
    
  
  
[0m15:46:51.836239 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:46:51.852917 [debug] [ThreadPool]: SQL status: OK in 0.017 seconds
[0m15:46:51.854666 [debug] [ThreadPool]: On list_supercell: Close
[0m15:46:51.855676 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_supercell, now create_supercell_main)
[0m15:46:51.856238 [debug] [ThreadPool]: Creating schema "database: "supercell"
schema: "main"
"
[0m15:46:51.864213 [debug] [ThreadPool]: Using duckdb connection "create_supercell_main"
[0m15:46:51.864727 [debug] [ThreadPool]: On create_supercell_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "connection_name": "create_supercell_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='supercell'
        and type='sqlite'
    
  
[0m15:46:51.865074 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:46:51.866374 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m15:46:51.867902 [debug] [ThreadPool]: Using duckdb connection "create_supercell_main"
[0m15:46:51.868324 [debug] [ThreadPool]: On create_supercell_main: BEGIN
[0m15:46:51.868920 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m15:46:51.869289 [debug] [ThreadPool]: Using duckdb connection "create_supercell_main"
[0m15:46:51.869606 [debug] [ThreadPool]: On create_supercell_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "connection_name": "create_supercell_main"} */

    
    
        create schema if not exists "supercell"."main"
    
[0m15:46:51.870183 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m15:46:51.871168 [debug] [ThreadPool]: On create_supercell_main: COMMIT
[0m15:46:51.871553 [debug] [ThreadPool]: Using duckdb connection "create_supercell_main"
[0m15:46:51.871902 [debug] [ThreadPool]: On create_supercell_main: COMMIT
[0m15:46:51.872391 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m15:46:51.872747 [debug] [ThreadPool]: On create_supercell_main: Close
[0m15:46:51.874812 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_supercell_main, now list_supercell_main)
[0m15:46:51.884105 [debug] [ThreadPool]: Using duckdb connection "list_supercell_main"
[0m15:46:51.884678 [debug] [ThreadPool]: On list_supercell_main: BEGIN
[0m15:46:51.885097 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:46:51.886072 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m15:46:51.886524 [debug] [ThreadPool]: Using duckdb connection "list_supercell_main"
[0m15:46:51.886957 [debug] [ThreadPool]: On list_supercell_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "connection_name": "list_supercell_main"} */
select
      'supercell' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'supercell'
  
[0m15:46:51.907332 [debug] [ThreadPool]: SQL status: OK in 0.020 seconds
[0m15:46:51.909733 [debug] [ThreadPool]: On list_supercell_main: ROLLBACK
[0m15:46:51.911488 [debug] [ThreadPool]: Failed to rollback 'list_supercell_main'
[0m15:46:51.912099 [debug] [ThreadPool]: On list_supercell_main: Close
[0m15:46:51.915190 [debug] [MainThread]: Using duckdb connection "master"
[0m15:46:51.915816 [debug] [MainThread]: On master: BEGIN
[0m15:46:51.916312 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:46:51.917406 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m15:46:51.917999 [debug] [MainThread]: On master: COMMIT
[0m15:46:51.918496 [debug] [MainThread]: Using duckdb connection "master"
[0m15:46:51.918949 [debug] [MainThread]: On master: COMMIT
[0m15:46:51.919604 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m15:46:51.920083 [debug] [MainThread]: On master: Close
[0m15:46:51.924763 [debug] [Thread-1 (]: Began running node model.supercell.cleaned_usagelogs
[0m15:46:51.925958 [info ] [Thread-1 (]: 1 of 5 START sql table model main.cleaned_usagelogs ............................ [RUN]
[0m15:46:51.926991 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_supercell_main, now model.supercell.cleaned_usagelogs)
[0m15:46:51.928019 [debug] [Thread-1 (]: Began compiling node model.supercell.cleaned_usagelogs
[0m15:46:51.944885 [debug] [Thread-1 (]: Writing injected SQL for node "model.supercell.cleaned_usagelogs"
[0m15:46:51.946186 [debug] [Thread-1 (]: Began executing node model.supercell.cleaned_usagelogs
[0m15:46:51.991283 [debug] [Thread-1 (]: Writing runtime sql for node "model.supercell.cleaned_usagelogs"
[0m15:46:51.992229 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.cleaned_usagelogs"
[0m15:46:51.992724 [debug] [Thread-1 (]: On model.supercell.cleaned_usagelogs: BEGIN
[0m15:46:51.993105 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:46:51.994114 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:46:51.994575 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.cleaned_usagelogs"
[0m15:46:51.995021 [debug] [Thread-1 (]: On model.supercell.cleaned_usagelogs: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.cleaned_usagelogs"} */

  
    
    

    create  table
      "supercell"."main"."cleaned_usagelogs__dbt_tmp"
  
    as (
      


SELECT
    CAST("LinkedAccountId" AS VARCHAR) AS linked_account_id,
    CAST("bill/PayerAccountId" AS VARCHAR) AS payer_account_id,
    CAST("lineItem/UsageStartDate" AS TIMESTAMP) AS usage_start_date,
    CAST("lineItem/UsageEndDate" AS TIMESTAMP) AS usage_end_date,
    CAST("lineItem/UsageAmount" AS DECIMAL(18, 6)) AS usage_amount,
    CAST("lineItem/Operation" AS VARCHAR) AS operation,
    CAST("pricing/PricingModel" AS VARCHAR) AS pricing_model,
    CAST("resourceTags/TagKeys" AS VARCHAR) AS tag_keys,
    CAST("resourceTags/TagValues" AS VARCHAR) AS tag_values,
    CAST("product/Region" AS VARCHAR) AS region,
    CAST("product/ServiceCode" AS VARCHAR) AS service_code,
    CAST("product/InstanceType" AS VARCHAR) AS instance_type,
    CAST("amortized_cost" AS DECIMAL(18, 6)) AS amortized_cost,
    CAST("product/Description" AS VARCHAR) AS description
FROM supercell_usagelogs
    );
  
  
[0m15:46:52.524318 [debug] [Thread-1 (]: SQL status: OK in 0.529 seconds
[0m15:46:52.531975 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.cleaned_usagelogs"
[0m15:46:52.532531 [debug] [Thread-1 (]: On model.supercell.cleaned_usagelogs: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.cleaned_usagelogs"} */
alter table "supercell"."main"."cleaned_usagelogs" rename to "cleaned_usagelogs__dbt_backup"
[0m15:46:52.533557 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:46:52.536733 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.cleaned_usagelogs"
[0m15:46:52.537226 [debug] [Thread-1 (]: On model.supercell.cleaned_usagelogs: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.cleaned_usagelogs"} */
alter table "supercell"."main"."cleaned_usagelogs__dbt_tmp" rename to "cleaned_usagelogs"
[0m15:46:52.538038 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:46:52.556600 [debug] [Thread-1 (]: On model.supercell.cleaned_usagelogs: COMMIT
[0m15:46:52.557200 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.cleaned_usagelogs"
[0m15:46:52.557599 [debug] [Thread-1 (]: On model.supercell.cleaned_usagelogs: COMMIT
[0m15:46:52.588297 [debug] [Thread-1 (]: SQL status: OK in 0.030 seconds
[0m15:46:52.594384 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.cleaned_usagelogs"
[0m15:46:52.594912 [debug] [Thread-1 (]: On model.supercell.cleaned_usagelogs: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.cleaned_usagelogs"} */
drop table if exists "supercell"."main"."cleaned_usagelogs__dbt_backup" cascade
[0m15:46:52.599997 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m15:46:52.603108 [debug] [Thread-1 (]: On model.supercell.cleaned_usagelogs: Close
[0m15:46:52.606591 [info ] [Thread-1 (]: 1 of 5 OK created sql table model main.cleaned_usagelogs ....................... [[32mOK[0m in 0.68s]
[0m15:46:52.607367 [debug] [Thread-1 (]: Finished running node model.supercell.cleaned_usagelogs
[0m15:46:52.609068 [debug] [Thread-3 (]: Began running node model.supercell.dim_accounts
[0m15:46:52.610430 [debug] [Thread-4 (]: Began running node model.supercell.dim_resource
[0m15:46:52.611883 [debug] [Thread-2 (]: Began running node model.supercell.fact_bill_generation
[0m15:46:52.613180 [info ] [Thread-3 (]: 2 of 5 START sql table model main.dim_accounts ................................. [RUN]
[0m15:46:52.615556 [info ] [Thread-4 (]: 3 of 5 START sql table model main.dim_resource ................................. [RUN]
[0m15:46:52.616967 [info ] [Thread-2 (]: 4 of 5 START sql table model main.fact_bill_generation ......................... [RUN]
[0m15:46:52.619144 [debug] [Thread-3 (]: Acquiring new duckdb connection 'model.supercell.dim_accounts'
[0m15:46:52.620324 [debug] [Thread-4 (]: Acquiring new duckdb connection 'model.supercell.dim_resource'
[0m15:46:52.621639 [debug] [Thread-2 (]: Acquiring new duckdb connection 'model.supercell.fact_bill_generation'
[0m15:46:52.622902 [debug] [Thread-3 (]: Began compiling node model.supercell.dim_accounts
[0m15:46:52.623995 [debug] [Thread-4 (]: Began compiling node model.supercell.dim_resource
[0m15:46:52.625283 [debug] [Thread-2 (]: Began compiling node model.supercell.fact_bill_generation
[0m15:46:52.642270 [debug] [Thread-4 (]: Writing injected SQL for node "model.supercell.dim_resource"
[0m15:46:52.636749 [debug] [Thread-3 (]: Writing injected SQL for node "model.supercell.dim_accounts"
[0m15:46:52.650004 [debug] [Thread-2 (]: Writing injected SQL for node "model.supercell.fact_bill_generation"
[0m15:46:52.651863 [debug] [Thread-4 (]: Began executing node model.supercell.dim_resource
[0m15:46:52.653117 [debug] [Thread-3 (]: Began executing node model.supercell.dim_accounts
[0m15:46:52.660030 [debug] [Thread-2 (]: Began executing node model.supercell.fact_bill_generation
[0m15:46:52.661515 [debug] [Thread-4 (]: Writing runtime sql for node "model.supercell.dim_resource"
[0m15:46:52.668534 [debug] [Thread-3 (]: Writing runtime sql for node "model.supercell.dim_accounts"
[0m15:46:52.674131 [debug] [Thread-2 (]: Writing runtime sql for node "model.supercell.fact_bill_generation"
[0m15:46:52.676113 [debug] [Thread-4 (]: Using duckdb connection "model.supercell.dim_resource"
[0m15:46:52.677059 [debug] [Thread-3 (]: Using duckdb connection "model.supercell.dim_accounts"
[0m15:46:52.677951 [debug] [Thread-4 (]: On model.supercell.dim_resource: BEGIN
[0m15:46:52.678667 [debug] [Thread-2 (]: Using duckdb connection "model.supercell.fact_bill_generation"
[0m15:46:52.679579 [debug] [Thread-3 (]: On model.supercell.dim_accounts: BEGIN
[0m15:46:52.680490 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m15:46:52.681228 [debug] [Thread-2 (]: On model.supercell.fact_bill_generation: BEGIN
[0m15:46:52.682119 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m15:46:52.683461 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m15:46:52.684771 [debug] [Thread-4 (]: SQL status: OK in 0.004 seconds
[0m15:46:52.685768 [debug] [Thread-4 (]: Using duckdb connection "model.supercell.dim_resource"
[0m15:46:52.686579 [debug] [Thread-3 (]: SQL status: OK in 0.004 seconds
[0m15:46:52.687492 [debug] [Thread-4 (]: On model.supercell.dim_resource: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.dim_resource"} */

  
    
    

    create  table
      "supercell"."main"."dim_resource__dbt_tmp"
  
    as (
      


select
    md5(concat(linked_account_id, '_', service_code, '_', instance_type, '_', region, '_', CAST(usage_start_date AS VARCHAR), '_', CAST(usage_end_date AS VARCHAR))) AS resource_id,
    linked_account_id as linked_account_id,
    region,
    service_code as product,
    instance_type as instance_type,
    pricing_model as pricing_model
from "supercell"."main"."cleaned_usagelogs"
    );
  
  
[0m15:46:52.688236 [debug] [Thread-2 (]: SQL status: OK in 0.005 seconds
[0m15:46:52.689172 [debug] [Thread-3 (]: Using duckdb connection "model.supercell.dim_accounts"
[0m15:46:52.690566 [debug] [Thread-2 (]: Using duckdb connection "model.supercell.fact_bill_generation"
[0m15:46:52.691712 [debug] [Thread-3 (]: On model.supercell.dim_accounts: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.dim_accounts"} */

  
    
    

    create  table
      "supercell"."main"."dim_accounts__dbt_tmp"
  
    as (
      


select
    linked_account_id as linked_account_id,
    tag_keys as tag_keys,
    tag_values as tag_values
from "supercell"."main"."cleaned_usagelogs"
    );
  
  
[0m15:46:52.693124 [debug] [Thread-2 (]: On model.supercell.fact_bill_generation: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.fact_bill_generation"} */

  
    
    

    create  table
      "supercell"."main"."fact_bill_generation__dbt_tmp"
  
    as (
      


select
    md5(concat(linked_account_id, '_', service_code, '_', instance_type, '_', region, '_', CAST(usage_start_date AS VARCHAR), '_', CAST(usage_end_date AS VARCHAR))) AS resource_id,
    usage_start_date as start_date,
    usage_end_date as bill_date,
    usage_amount as bill_amount,
    operation
from "supercell"."main"."cleaned_usagelogs"
    );
  
  
[0m15:46:52.980837 [debug] [Thread-3 (]: SQL status: OK in 0.286 seconds
[0m15:46:52.986229 [debug] [Thread-3 (]: Using duckdb connection "model.supercell.dim_accounts"
[0m15:46:52.987374 [debug] [Thread-3 (]: On model.supercell.dim_accounts: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.dim_accounts"} */
alter table "supercell"."main"."dim_accounts" rename to "dim_accounts__dbt_backup"
[0m15:46:52.988689 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m15:46:52.992706 [debug] [Thread-3 (]: Using duckdb connection "model.supercell.dim_accounts"
[0m15:46:52.993481 [debug] [Thread-3 (]: On model.supercell.dim_accounts: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.dim_accounts"} */
alter table "supercell"."main"."dim_accounts__dbt_tmp" rename to "dim_accounts"
[0m15:46:52.994575 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m15:46:52.996767 [debug] [Thread-3 (]: On model.supercell.dim_accounts: COMMIT
[0m15:46:52.997415 [debug] [Thread-3 (]: Using duckdb connection "model.supercell.dim_accounts"
[0m15:46:52.997891 [debug] [Thread-3 (]: On model.supercell.dim_accounts: COMMIT
[0m15:46:53.078980 [debug] [Thread-3 (]: SQL status: OK in 0.080 seconds
[0m15:46:53.082706 [debug] [Thread-3 (]: Using duckdb connection "model.supercell.dim_accounts"
[0m15:46:53.083482 [debug] [Thread-2 (]: SQL status: OK in 0.389 seconds
[0m15:46:53.083978 [debug] [Thread-3 (]: On model.supercell.dim_accounts: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.dim_accounts"} */
drop table if exists "supercell"."main"."dim_accounts__dbt_backup" cascade
[0m15:46:53.087148 [debug] [Thread-2 (]: Using duckdb connection "model.supercell.fact_bill_generation"
[0m15:46:53.088131 [debug] [Thread-2 (]: On model.supercell.fact_bill_generation: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.fact_bill_generation"} */
alter table "supercell"."main"."fact_bill_generation" rename to "fact_bill_generation__dbt_backup"
[0m15:46:53.089242 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m15:46:53.092566 [debug] [Thread-2 (]: Using duckdb connection "model.supercell.fact_bill_generation"
[0m15:46:53.093242 [debug] [Thread-2 (]: On model.supercell.fact_bill_generation: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.fact_bill_generation"} */
alter table "supercell"."main"."fact_bill_generation__dbt_tmp" rename to "fact_bill_generation"
[0m15:46:53.093790 [debug] [Thread-3 (]: SQL status: OK in 0.006 seconds
[0m15:46:53.095815 [debug] [Thread-3 (]: On model.supercell.dim_accounts: Close
[0m15:46:53.096740 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m15:46:53.100673 [debug] [Thread-2 (]: On model.supercell.fact_bill_generation: COMMIT
[0m15:46:53.101676 [debug] [Thread-2 (]: Using duckdb connection "model.supercell.fact_bill_generation"
[0m15:46:53.102522 [debug] [Thread-2 (]: On model.supercell.fact_bill_generation: COMMIT
[0m15:46:53.105869 [info ] [Thread-3 (]: 2 of 5 OK created sql table model main.dim_accounts ............................ [[32mOK[0m in 0.49s]
[0m15:46:53.106744 [debug] [Thread-3 (]: Finished running node model.supercell.dim_accounts
[0m15:46:53.116031 [debug] [Thread-2 (]: SQL status: OK in 0.012 seconds
[0m15:46:53.122418 [debug] [Thread-2 (]: Using duckdb connection "model.supercell.fact_bill_generation"
[0m15:46:53.122997 [debug] [Thread-2 (]: On model.supercell.fact_bill_generation: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.fact_bill_generation"} */
drop table if exists "supercell"."main"."fact_bill_generation__dbt_backup" cascade
[0m15:46:53.125726 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m15:46:53.128635 [debug] [Thread-2 (]: On model.supercell.fact_bill_generation: Close
[0m15:46:53.132508 [info ] [Thread-2 (]: 4 of 5 OK created sql table model main.fact_bill_generation .................... [[32mOK[0m in 0.51s]
[0m15:46:53.133668 [debug] [Thread-2 (]: Finished running node model.supercell.fact_bill_generation
[0m15:46:53.173468 [debug] [Thread-4 (]: SQL status: OK in 0.483 seconds
[0m15:46:53.176904 [debug] [Thread-4 (]: Using duckdb connection "model.supercell.dim_resource"
[0m15:46:53.177393 [debug] [Thread-4 (]: On model.supercell.dim_resource: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.dim_resource"} */
alter table "supercell"."main"."dim_resource" rename to "dim_resource__dbt_backup"
[0m15:46:53.178366 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m15:46:53.181784 [debug] [Thread-4 (]: Using duckdb connection "model.supercell.dim_resource"
[0m15:46:53.182345 [debug] [Thread-4 (]: On model.supercell.dim_resource: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.dim_resource"} */
alter table "supercell"."main"."dim_resource__dbt_tmp" rename to "dim_resource"
[0m15:46:53.183246 [debug] [Thread-4 (]: SQL status: OK in 0.000 seconds
[0m15:46:53.185162 [debug] [Thread-4 (]: On model.supercell.dim_resource: COMMIT
[0m15:46:53.185598 [debug] [Thread-4 (]: Using duckdb connection "model.supercell.dim_resource"
[0m15:46:53.185991 [debug] [Thread-4 (]: On model.supercell.dim_resource: COMMIT
[0m15:46:53.198722 [debug] [Thread-4 (]: SQL status: OK in 0.012 seconds
[0m15:46:53.203089 [debug] [Thread-4 (]: Using duckdb connection "model.supercell.dim_resource"
[0m15:46:53.203740 [debug] [Thread-4 (]: On model.supercell.dim_resource: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.dim_resource"} */
drop table if exists "supercell"."main"."dim_resource__dbt_backup" cascade
[0m15:46:53.206415 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m15:46:53.208857 [debug] [Thread-4 (]: On model.supercell.dim_resource: Close
[0m15:46:53.211969 [info ] [Thread-4 (]: 3 of 5 OK created sql table model main.dim_resource ............................ [[32mOK[0m in 0.59s]
[0m15:46:53.212961 [debug] [Thread-4 (]: Finished running node model.supercell.dim_resource
[0m15:46:53.214909 [debug] [Thread-1 (]: Began running node model.supercell.total_cost
[0m15:46:53.216211 [info ] [Thread-1 (]: 5 of 5 START sql table model main.total_cost ................................... [RUN]
[0m15:46:53.217905 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.supercell.cleaned_usagelogs, now model.supercell.total_cost)
[0m15:46:53.218559 [debug] [Thread-1 (]: Began compiling node model.supercell.total_cost
[0m15:46:53.224890 [debug] [Thread-1 (]: Writing injected SQL for node "model.supercell.total_cost"
[0m15:46:53.226278 [debug] [Thread-1 (]: Began executing node model.supercell.total_cost
[0m15:46:53.231138 [debug] [Thread-1 (]: Writing runtime sql for node "model.supercell.total_cost"
[0m15:46:53.232410 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.total_cost"
[0m15:46:53.232988 [debug] [Thread-1 (]: On model.supercell.total_cost: BEGIN
[0m15:46:53.233390 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:46:53.235085 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m15:46:53.235590 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.total_cost"
[0m15:46:53.236055 [debug] [Thread-1 (]: On model.supercell.total_cost: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.total_cost"} */

  
    
    

    create  table
      "supercell"."main"."total_cost__dbt_tmp"
  
    as (
      

with base as (
    select
        fact_bill_generation.resource_id as resource_id,
        date_trunc('month', bill_date) as month,
        bill_amount,
        dim_resource.instance_type as instance_type,
        dim_resource.service_code as service_code,
        dim_resource.region as region,
        dim_resource.pricing_model as pricing_model,
        dim_accounts.tag_values as tag_values,
        dim_accounts.tag_keys as tag_keys,
    from "supercell"."main"."fact_bill_generation" as fact_bill_generation
    left join "supercell"."main"."dim_resource" as dim_resource using (resource_id) 
    left join "supercell"."main"."dim_accounts" as dim_accounts using (linked_account_id) 
)

select
    month,
    sum(bill_amount) as total_cost,
    instance_type,
    service_code,
    region,
    pricing_model,
    tag_keys,
    tag_values
from base
group by
    month,
    instance_type,
    service_code,
    region,
    pricing_model,
    tag_keys,
    tag_values
    );
  
  
[0m15:46:53.238907 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.total_cost"} */

  
    
    

    create  table
      "supercell"."main"."total_cost__dbt_tmp"
  
    as (
      

with base as (
    select
        fact_bill_generation.resource_id as resource_id,
        date_trunc('month', bill_date) as month,
        bill_amount,
        dim_resource.instance_type as instance_type,
        dim_resource.service_code as service_code,
        dim_resource.region as region,
        dim_resource.pricing_model as pricing_model,
        dim_accounts.tag_values as tag_values,
        dim_accounts.tag_keys as tag_keys,
    from "supercell"."main"."fact_bill_generation" as fact_bill_generation
    left join "supercell"."main"."dim_resource" as dim_resource using (resource_id) 
    left join "supercell"."main"."dim_accounts" as dim_accounts using (linked_account_id) 
)

select
    month,
    sum(bill_amount) as total_cost,
    instance_type,
    service_code,
    region,
    pricing_model,
    tag_keys,
    tag_values
from base
group by
    month,
    instance_type,
    service_code,
    region,
    pricing_model,
    tag_keys,
    tag_values
    );
  
  
[0m15:46:53.239477 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m15:46:53.240121 [debug] [Thread-1 (]: On model.supercell.total_cost: ROLLBACK
[0m15:46:53.244102 [debug] [Thread-1 (]: Failed to rollback 'model.supercell.total_cost'
[0m15:46:53.244582 [debug] [Thread-1 (]: On model.supercell.total_cost: Close
[0m15:46:53.247299 [debug] [Thread-1 (]: Runtime Error in model total_cost (models/supercell_models/metrics/total_cost.sql)
  Binder Error: Table "dim_resource" does not have a column named "service_code"
  
  Candidate bindings: : "pricing_model"
  
  LINE 19:         dim_resource.service_code as service_code,
                   ^
[0m15:46:53.248212 [error] [Thread-1 (]: 5 of 5 ERROR creating sql table model main.total_cost .......................... [[31mERROR[0m in 0.03s]
[0m15:46:53.248902 [debug] [Thread-1 (]: Finished running node model.supercell.total_cost
[0m15:46:53.249908 [debug] [Thread-7 (]: Marking all children of 'model.supercell.total_cost' to be skipped because of status 'error'.  Reason: Runtime Error in model total_cost (models/supercell_models/metrics/total_cost.sql)
  Binder Error: Table "dim_resource" does not have a column named "service_code"
  
  Candidate bindings: : "pricing_model"
  
  LINE 19:         dim_resource.service_code as service_code,
                   ^.
[0m15:46:53.253440 [debug] [MainThread]: Using duckdb connection "master"
[0m15:46:53.253934 [debug] [MainThread]: On master: BEGIN
[0m15:46:53.254300 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:46:53.255285 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m15:46:53.255761 [debug] [MainThread]: On master: COMMIT
[0m15:46:53.256156 [debug] [MainThread]: Using duckdb connection "master"
[0m15:46:53.256544 [debug] [MainThread]: On master: COMMIT
[0m15:46:53.257421 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m15:46:53.257882 [debug] [MainThread]: On master: Close
[0m15:46:53.258846 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:46:53.259544 [debug] [MainThread]: Connection 'model.supercell.total_cost' was properly closed.
[0m15:46:53.260228 [debug] [MainThread]: Connection 'model.supercell.dim_accounts' was properly closed.
[0m15:46:53.260690 [debug] [MainThread]: Connection 'model.supercell.dim_resource' was properly closed.
[0m15:46:53.261100 [debug] [MainThread]: Connection 'model.supercell.fact_bill_generation' was properly closed.
[0m15:46:53.261714 [info ] [MainThread]: 
[0m15:46:53.262369 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 1.50 seconds (1.50s).
[0m15:46:53.264400 [debug] [MainThread]: Command end result
[0m15:46:53.294678 [debug] [MainThread]: Wrote artifact WritableManifest to /home/harsha/data_actions/supercell_cloudops/target/manifest.json
[0m15:46:53.296984 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/harsha/data_actions/supercell_cloudops/target/semantic_manifest.json
[0m15:46:53.304134 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/harsha/data_actions/supercell_cloudops/target/run_results.json
[0m15:46:53.304562 [info ] [MainThread]: 
[0m15:46:53.305138 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m15:46:53.305500 [info ] [MainThread]: 
[0m15:46:53.305941 [error] [MainThread]:   Runtime Error in model total_cost (models/supercell_models/metrics/total_cost.sql)
  Binder Error: Table "dim_resource" does not have a column named "service_code"
  
  Candidate bindings: : "pricing_model"
  
  LINE 19:         dim_resource.service_code as service_code,
                   ^
[0m15:46:53.306306 [info ] [MainThread]: 
[0m15:46:53.306747 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
[0m15:46:53.307829 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 2.4717224, "process_in_blocks": "400", "process_kernel_time": 0.724788, "process_mem_max_rss": "378492", "process_out_blocks": "59712", "process_user_time": 8.188912}
[0m15:46:53.308465 [debug] [MainThread]: Command `dbt run` failed at 15:46:53.308340 after 2.47 seconds
[0m15:46:53.308967 [debug] [MainThread]: Flushing usage events


============================== 15:47:17.469599 | 59ba3592-5b59-4b97-86ee-39ade9442f1f ==============================
[0m15:47:17.469599 [info ] [MainThread]: Running with dbt=1.9.4
[0m15:47:17.473480 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/home/harsha/data_actions/supercell_cloudops', 'log_path': '/home/harsha/data_actions/supercell_cloudops/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'invocation_command': 'dbt run', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'False'}
[0m15:47:17.473985 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality

User config should be moved from the 'config' key in profiles.yml to the 'flags' key in dbt_project.yml.
[0m15:47:17.815709 [info ] [MainThread]: Registered adapter: duckdb=1.9.3
[0m15:47:17.901532 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m15:47:17.988248 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:47:17.989053 [debug] [MainThread]: Partial parsing: updated file: supercell://models/supercell_models/metrics/total_cost.sql
[0m15:47:18.282002 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.supercell.example
[0m15:47:18.350995 [debug] [MainThread]: Wrote artifact WritableManifest to /home/harsha/data_actions/supercell_cloudops/target/manifest.json
[0m15:47:18.352853 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/harsha/data_actions/supercell_cloudops/target/semantic_manifest.json
[0m15:47:18.365925 [info ] [MainThread]: Found 5 models, 428 macros
[0m15:47:18.368313 [info ] [MainThread]: 
[0m15:47:18.368946 [info ] [MainThread]: Concurrency: 4 threads (target='default')
[0m15:47:18.369326 [info ] [MainThread]: 
[0m15:47:18.369908 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m15:47:18.378068 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_supercell'
[0m15:47:18.427128 [debug] [ThreadPool]: Using duckdb connection "list_supercell"
[0m15:47:18.428059 [debug] [ThreadPool]: On list_supercell: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "connection_name": "list_supercell"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"supercell"'
    
  
  
[0m15:47:18.428547 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:47:18.445349 [debug] [ThreadPool]: SQL status: OK in 0.017 seconds
[0m15:47:18.447188 [debug] [ThreadPool]: On list_supercell: Close
[0m15:47:18.448234 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_supercell, now create_supercell_main)
[0m15:47:18.448837 [debug] [ThreadPool]: Creating schema "database: "supercell"
schema: "main"
"
[0m15:47:18.456688 [debug] [ThreadPool]: Using duckdb connection "create_supercell_main"
[0m15:47:18.457309 [debug] [ThreadPool]: On create_supercell_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "connection_name": "create_supercell_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='supercell'
        and type='sqlite'
    
  
[0m15:47:18.457688 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:47:18.459220 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m15:47:18.460926 [debug] [ThreadPool]: Using duckdb connection "create_supercell_main"
[0m15:47:18.461369 [debug] [ThreadPool]: On create_supercell_main: BEGIN
[0m15:47:18.462212 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m15:47:18.462575 [debug] [ThreadPool]: Using duckdb connection "create_supercell_main"
[0m15:47:18.462914 [debug] [ThreadPool]: On create_supercell_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "connection_name": "create_supercell_main"} */

    
    
        create schema if not exists "supercell"."main"
    
[0m15:47:18.463954 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m15:47:18.465030 [debug] [ThreadPool]: On create_supercell_main: COMMIT
[0m15:47:18.465404 [debug] [ThreadPool]: Using duckdb connection "create_supercell_main"
[0m15:47:18.465746 [debug] [ThreadPool]: On create_supercell_main: COMMIT
[0m15:47:18.466310 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m15:47:18.466701 [debug] [ThreadPool]: On create_supercell_main: Close
[0m15:47:18.468661 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_supercell_main, now list_supercell_main)
[0m15:47:18.475670 [debug] [ThreadPool]: Using duckdb connection "list_supercell_main"
[0m15:47:18.476228 [debug] [ThreadPool]: On list_supercell_main: BEGIN
[0m15:47:18.476627 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:47:18.477726 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m15:47:18.478230 [debug] [ThreadPool]: Using duckdb connection "list_supercell_main"
[0m15:47:18.478610 [debug] [ThreadPool]: On list_supercell_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "connection_name": "list_supercell_main"} */
select
      'supercell' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'supercell'
  
[0m15:47:18.500128 [debug] [ThreadPool]: SQL status: OK in 0.021 seconds
[0m15:47:18.502060 [debug] [ThreadPool]: On list_supercell_main: ROLLBACK
[0m15:47:18.503400 [debug] [ThreadPool]: Failed to rollback 'list_supercell_main'
[0m15:47:18.503875 [debug] [ThreadPool]: On list_supercell_main: Close
[0m15:47:18.506198 [debug] [MainThread]: Using duckdb connection "master"
[0m15:47:18.506599 [debug] [MainThread]: On master: BEGIN
[0m15:47:18.506988 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:47:18.507882 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m15:47:18.508471 [debug] [MainThread]: On master: COMMIT
[0m15:47:18.508953 [debug] [MainThread]: Using duckdb connection "master"
[0m15:47:18.509291 [debug] [MainThread]: On master: COMMIT
[0m15:47:18.509894 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m15:47:18.510454 [debug] [MainThread]: On master: Close
[0m15:47:18.515297 [debug] [Thread-1 (]: Began running node model.supercell.cleaned_usagelogs
[0m15:47:18.517024 [info ] [Thread-1 (]: 1 of 5 START sql table model main.cleaned_usagelogs ............................ [RUN]
[0m15:47:18.518191 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_supercell_main, now model.supercell.cleaned_usagelogs)
[0m15:47:18.519664 [debug] [Thread-1 (]: Began compiling node model.supercell.cleaned_usagelogs
[0m15:47:18.530026 [debug] [Thread-1 (]: Writing injected SQL for node "model.supercell.cleaned_usagelogs"
[0m15:47:18.531055 [debug] [Thread-1 (]: Began executing node model.supercell.cleaned_usagelogs
[0m15:47:18.569220 [debug] [Thread-1 (]: Writing runtime sql for node "model.supercell.cleaned_usagelogs"
[0m15:47:18.570222 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.cleaned_usagelogs"
[0m15:47:18.570725 [debug] [Thread-1 (]: On model.supercell.cleaned_usagelogs: BEGIN
[0m15:47:18.571130 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:47:18.572141 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:47:18.572590 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.cleaned_usagelogs"
[0m15:47:18.573034 [debug] [Thread-1 (]: On model.supercell.cleaned_usagelogs: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.cleaned_usagelogs"} */

  
    
    

    create  table
      "supercell"."main"."cleaned_usagelogs__dbt_tmp"
  
    as (
      


SELECT
    CAST("LinkedAccountId" AS VARCHAR) AS linked_account_id,
    CAST("bill/PayerAccountId" AS VARCHAR) AS payer_account_id,
    CAST("lineItem/UsageStartDate" AS TIMESTAMP) AS usage_start_date,
    CAST("lineItem/UsageEndDate" AS TIMESTAMP) AS usage_end_date,
    CAST("lineItem/UsageAmount" AS DECIMAL(18, 6)) AS usage_amount,
    CAST("lineItem/Operation" AS VARCHAR) AS operation,
    CAST("pricing/PricingModel" AS VARCHAR) AS pricing_model,
    CAST("resourceTags/TagKeys" AS VARCHAR) AS tag_keys,
    CAST("resourceTags/TagValues" AS VARCHAR) AS tag_values,
    CAST("product/Region" AS VARCHAR) AS region,
    CAST("product/ServiceCode" AS VARCHAR) AS service_code,
    CAST("product/InstanceType" AS VARCHAR) AS instance_type,
    CAST("amortized_cost" AS DECIMAL(18, 6)) AS amortized_cost,
    CAST("product/Description" AS VARCHAR) AS description
FROM supercell_usagelogs
    );
  
  
[0m15:47:19.112479 [debug] [Thread-1 (]: SQL status: OK in 0.539 seconds
[0m15:47:19.119875 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.cleaned_usagelogs"
[0m15:47:19.120371 [debug] [Thread-1 (]: On model.supercell.cleaned_usagelogs: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.cleaned_usagelogs"} */
alter table "supercell"."main"."cleaned_usagelogs" rename to "cleaned_usagelogs__dbt_backup"
[0m15:47:19.121463 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:47:19.124711 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.cleaned_usagelogs"
[0m15:47:19.125212 [debug] [Thread-1 (]: On model.supercell.cleaned_usagelogs: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.cleaned_usagelogs"} */
alter table "supercell"."main"."cleaned_usagelogs__dbt_tmp" rename to "cleaned_usagelogs"
[0m15:47:19.126107 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:47:19.145581 [debug] [Thread-1 (]: On model.supercell.cleaned_usagelogs: COMMIT
[0m15:47:19.146206 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.cleaned_usagelogs"
[0m15:47:19.146603 [debug] [Thread-1 (]: On model.supercell.cleaned_usagelogs: COMMIT
[0m15:47:19.176104 [debug] [Thread-1 (]: SQL status: OK in 0.029 seconds
[0m15:47:19.182622 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.cleaned_usagelogs"
[0m15:47:19.183201 [debug] [Thread-1 (]: On model.supercell.cleaned_usagelogs: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.cleaned_usagelogs"} */
drop table if exists "supercell"."main"."cleaned_usagelogs__dbt_backup" cascade
[0m15:47:19.186081 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m15:47:19.189115 [debug] [Thread-1 (]: On model.supercell.cleaned_usagelogs: Close
[0m15:47:19.193263 [info ] [Thread-1 (]: 1 of 5 OK created sql table model main.cleaned_usagelogs ....................... [[32mOK[0m in 0.67s]
[0m15:47:19.194054 [debug] [Thread-1 (]: Finished running node model.supercell.cleaned_usagelogs
[0m15:47:19.196137 [debug] [Thread-3 (]: Began running node model.supercell.dim_accounts
[0m15:47:19.197248 [debug] [Thread-4 (]: Began running node model.supercell.dim_resource
[0m15:47:19.198403 [info ] [Thread-3 (]: 2 of 5 START sql table model main.dim_accounts ................................. [RUN]
[0m15:47:19.199751 [debug] [Thread-2 (]: Began running node model.supercell.fact_bill_generation
[0m15:47:19.200884 [info ] [Thread-4 (]: 3 of 5 START sql table model main.dim_resource ................................. [RUN]
[0m15:47:19.202492 [debug] [Thread-3 (]: Acquiring new duckdb connection 'model.supercell.dim_accounts'
[0m15:47:19.204434 [info ] [Thread-2 (]: 4 of 5 START sql table model main.fact_bill_generation ......................... [RUN]
[0m15:47:19.205983 [debug] [Thread-4 (]: Acquiring new duckdb connection 'model.supercell.dim_resource'
[0m15:47:19.207294 [debug] [Thread-3 (]: Began compiling node model.supercell.dim_accounts
[0m15:47:19.208621 [debug] [Thread-2 (]: Acquiring new duckdb connection 'model.supercell.fact_bill_generation'
[0m15:47:19.209637 [debug] [Thread-4 (]: Began compiling node model.supercell.dim_resource
[0m15:47:19.218783 [debug] [Thread-3 (]: Writing injected SQL for node "model.supercell.dim_accounts"
[0m15:47:19.219909 [debug] [Thread-2 (]: Began compiling node model.supercell.fact_bill_generation
[0m15:47:19.223777 [debug] [Thread-4 (]: Writing injected SQL for node "model.supercell.dim_resource"
[0m15:47:19.229442 [debug] [Thread-2 (]: Writing injected SQL for node "model.supercell.fact_bill_generation"
[0m15:47:19.231117 [debug] [Thread-3 (]: Began executing node model.supercell.dim_accounts
[0m15:47:19.232311 [debug] [Thread-4 (]: Began executing node model.supercell.dim_resource
[0m15:47:19.238305 [debug] [Thread-3 (]: Writing runtime sql for node "model.supercell.dim_accounts"
[0m15:47:19.244549 [debug] [Thread-4 (]: Writing runtime sql for node "model.supercell.dim_resource"
[0m15:47:19.245931 [debug] [Thread-2 (]: Began executing node model.supercell.fact_bill_generation
[0m15:47:19.253255 [debug] [Thread-3 (]: Using duckdb connection "model.supercell.dim_accounts"
[0m15:47:19.254036 [debug] [Thread-3 (]: On model.supercell.dim_accounts: BEGIN
[0m15:47:19.254807 [debug] [Thread-2 (]: Writing runtime sql for node "model.supercell.fact_bill_generation"
[0m15:47:19.255614 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m15:47:19.256667 [debug] [Thread-4 (]: Using duckdb connection "model.supercell.dim_resource"
[0m15:47:19.258524 [debug] [Thread-2 (]: Using duckdb connection "model.supercell.fact_bill_generation"
[0m15:47:19.259440 [debug] [Thread-4 (]: On model.supercell.dim_resource: BEGIN
[0m15:47:19.260769 [debug] [Thread-2 (]: On model.supercell.fact_bill_generation: BEGIN
[0m15:47:19.261701 [debug] [Thread-3 (]: SQL status: OK in 0.006 seconds
[0m15:47:19.262928 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m15:47:19.264076 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m15:47:19.265330 [debug] [Thread-3 (]: Using duckdb connection "model.supercell.dim_accounts"
[0m15:47:19.267625 [debug] [Thread-3 (]: On model.supercell.dim_accounts: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.dim_accounts"} */

  
    
    

    create  table
      "supercell"."main"."dim_accounts__dbt_tmp"
  
    as (
      


select
    linked_account_id as linked_account_id,
    tag_keys as tag_keys,
    tag_values as tag_values
from "supercell"."main"."cleaned_usagelogs"
    );
  
  
[0m15:47:19.268987 [debug] [Thread-4 (]: SQL status: OK in 0.006 seconds
[0m15:47:19.270199 [debug] [Thread-4 (]: Using duckdb connection "model.supercell.dim_resource"
[0m15:47:19.271437 [debug] [Thread-4 (]: On model.supercell.dim_resource: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.dim_resource"} */

  
    
    

    create  table
      "supercell"."main"."dim_resource__dbt_tmp"
  
    as (
      


select
    md5(concat(linked_account_id, '_', service_code, '_', instance_type, '_', region, '_', CAST(usage_start_date AS VARCHAR), '_', CAST(usage_end_date AS VARCHAR))) AS resource_id,
    linked_account_id as linked_account_id,
    region,
    service_code as product,
    instance_type as instance_type,
    pricing_model as pricing_model
from "supercell"."main"."cleaned_usagelogs"
    );
  
  
[0m15:47:19.272715 [debug] [Thread-2 (]: SQL status: OK in 0.009 seconds
[0m15:47:19.273980 [debug] [Thread-2 (]: Using duckdb connection "model.supercell.fact_bill_generation"
[0m15:47:19.275907 [debug] [Thread-2 (]: On model.supercell.fact_bill_generation: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.fact_bill_generation"} */

  
    
    

    create  table
      "supercell"."main"."fact_bill_generation__dbt_tmp"
  
    as (
      


select
    md5(concat(linked_account_id, '_', service_code, '_', instance_type, '_', region, '_', CAST(usage_start_date AS VARCHAR), '_', CAST(usage_end_date AS VARCHAR))) AS resource_id,
    usage_start_date as start_date,
    usage_end_date as bill_date,
    usage_amount as bill_amount,
    operation
from "supercell"."main"."cleaned_usagelogs"
    );
  
  
[0m15:47:19.491853 [debug] [Thread-3 (]: SQL status: OK in 0.223 seconds
[0m15:47:19.498278 [debug] [Thread-3 (]: Using duckdb connection "model.supercell.dim_accounts"
[0m15:47:19.499232 [debug] [Thread-3 (]: On model.supercell.dim_accounts: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.dim_accounts"} */
alter table "supercell"."main"."dim_accounts" rename to "dim_accounts__dbt_backup"
[0m15:47:19.500824 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m15:47:19.506896 [debug] [Thread-3 (]: Using duckdb connection "model.supercell.dim_accounts"
[0m15:47:19.508539 [debug] [Thread-3 (]: On model.supercell.dim_accounts: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.dim_accounts"} */
alter table "supercell"."main"."dim_accounts__dbt_tmp" rename to "dim_accounts"
[0m15:47:19.510559 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m15:47:19.515187 [debug] [Thread-3 (]: On model.supercell.dim_accounts: COMMIT
[0m15:47:19.516469 [debug] [Thread-3 (]: Using duckdb connection "model.supercell.dim_accounts"
[0m15:47:19.517384 [debug] [Thread-3 (]: On model.supercell.dim_accounts: COMMIT
[0m15:47:19.540855 [debug] [Thread-3 (]: SQL status: OK in 0.022 seconds
[0m15:47:19.546269 [debug] [Thread-3 (]: Using duckdb connection "model.supercell.dim_accounts"
[0m15:47:19.547421 [debug] [Thread-3 (]: On model.supercell.dim_accounts: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.dim_accounts"} */
drop table if exists "supercell"."main"."dim_accounts__dbt_backup" cascade
[0m15:47:19.550881 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m15:47:19.553999 [debug] [Thread-3 (]: On model.supercell.dim_accounts: Close
[0m15:47:19.562744 [info ] [Thread-3 (]: 2 of 5 OK created sql table model main.dim_accounts ............................ [[32mOK[0m in 0.36s]
[0m15:47:19.564296 [debug] [Thread-3 (]: Finished running node model.supercell.dim_accounts
[0m15:47:19.658338 [debug] [Thread-2 (]: SQL status: OK in 0.381 seconds
[0m15:47:19.663981 [debug] [Thread-2 (]: Using duckdb connection "model.supercell.fact_bill_generation"
[0m15:47:19.664918 [debug] [Thread-2 (]: On model.supercell.fact_bill_generation: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.fact_bill_generation"} */
alter table "supercell"."main"."fact_bill_generation" rename to "fact_bill_generation__dbt_backup"
[0m15:47:19.666729 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m15:47:19.671719 [debug] [Thread-2 (]: Using duckdb connection "model.supercell.fact_bill_generation"
[0m15:47:19.672532 [debug] [Thread-2 (]: On model.supercell.fact_bill_generation: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.fact_bill_generation"} */
alter table "supercell"."main"."fact_bill_generation__dbt_tmp" rename to "fact_bill_generation"
[0m15:47:19.674448 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m15:47:19.678110 [debug] [Thread-2 (]: On model.supercell.fact_bill_generation: COMMIT
[0m15:47:19.679222 [debug] [Thread-2 (]: Using duckdb connection "model.supercell.fact_bill_generation"
[0m15:47:19.679969 [debug] [Thread-2 (]: On model.supercell.fact_bill_generation: COMMIT
[0m15:47:19.718867 [debug] [Thread-2 (]: SQL status: OK in 0.038 seconds
[0m15:47:19.723335 [debug] [Thread-2 (]: Using duckdb connection "model.supercell.fact_bill_generation"
[0m15:47:19.723865 [debug] [Thread-2 (]: On model.supercell.fact_bill_generation: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.fact_bill_generation"} */
drop table if exists "supercell"."main"."fact_bill_generation__dbt_backup" cascade
[0m15:47:19.726392 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m15:47:19.729118 [debug] [Thread-2 (]: On model.supercell.fact_bill_generation: Close
[0m15:47:19.739995 [info ] [Thread-2 (]: 4 of 5 OK created sql table model main.fact_bill_generation .................... [[32mOK[0m in 0.53s]
[0m15:47:19.740964 [debug] [Thread-2 (]: Finished running node model.supercell.fact_bill_generation
[0m15:47:19.801470 [debug] [Thread-4 (]: SQL status: OK in 0.529 seconds
[0m15:47:19.804733 [debug] [Thread-4 (]: Using duckdb connection "model.supercell.dim_resource"
[0m15:47:19.805232 [debug] [Thread-4 (]: On model.supercell.dim_resource: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.dim_resource"} */
alter table "supercell"."main"."dim_resource" rename to "dim_resource__dbt_backup"
[0m15:47:19.806284 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m15:47:19.809364 [debug] [Thread-4 (]: Using duckdb connection "model.supercell.dim_resource"
[0m15:47:19.809827 [debug] [Thread-4 (]: On model.supercell.dim_resource: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.dim_resource"} */
alter table "supercell"."main"."dim_resource__dbt_tmp" rename to "dim_resource"
[0m15:47:19.810726 [debug] [Thread-4 (]: SQL status: OK in 0.000 seconds
[0m15:47:19.812713 [debug] [Thread-4 (]: On model.supercell.dim_resource: COMMIT
[0m15:47:19.813177 [debug] [Thread-4 (]: Using duckdb connection "model.supercell.dim_resource"
[0m15:47:19.813573 [debug] [Thread-4 (]: On model.supercell.dim_resource: COMMIT
[0m15:47:19.825558 [debug] [Thread-4 (]: SQL status: OK in 0.011 seconds
[0m15:47:19.828147 [debug] [Thread-4 (]: Using duckdb connection "model.supercell.dim_resource"
[0m15:47:19.828685 [debug] [Thread-4 (]: On model.supercell.dim_resource: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.dim_resource"} */
drop table if exists "supercell"."main"."dim_resource__dbt_backup" cascade
[0m15:47:19.831190 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m15:47:19.832838 [debug] [Thread-4 (]: On model.supercell.dim_resource: Close
[0m15:47:19.835002 [info ] [Thread-4 (]: 3 of 5 OK created sql table model main.dim_resource ............................ [[32mOK[0m in 0.63s]
[0m15:47:19.835684 [debug] [Thread-4 (]: Finished running node model.supercell.dim_resource
[0m15:47:19.837224 [debug] [Thread-1 (]: Began running node model.supercell.total_cost
[0m15:47:19.838351 [info ] [Thread-1 (]: 5 of 5 START sql table model main.total_cost ................................... [RUN]
[0m15:47:19.839414 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.supercell.cleaned_usagelogs, now model.supercell.total_cost)
[0m15:47:19.840510 [debug] [Thread-1 (]: Began compiling node model.supercell.total_cost
[0m15:47:19.848627 [debug] [Thread-1 (]: Writing injected SQL for node "model.supercell.total_cost"
[0m15:47:19.849610 [debug] [Thread-1 (]: Began executing node model.supercell.total_cost
[0m15:47:19.854187 [debug] [Thread-1 (]: Writing runtime sql for node "model.supercell.total_cost"
[0m15:47:19.855426 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.total_cost"
[0m15:47:19.855897 [debug] [Thread-1 (]: On model.supercell.total_cost: BEGIN
[0m15:47:19.856262 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:47:19.857596 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:47:19.858456 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.total_cost"
[0m15:47:19.858935 [debug] [Thread-1 (]: On model.supercell.total_cost: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.total_cost"} */

  
    
    

    create  table
      "supercell"."main"."total_cost__dbt_tmp"
  
    as (
      

with base as (
    select
        fact_bill_generation.resource_id as resource_id,
        date_trunc('month', bill_date) as month,
        bill_amount,
        dim_resource.instance_type as instance_type,
        dim_resource.product as product,
        dim_resource.region as region,
        dim_resource.pricing_model as pricing_model,
        dim_accounts.tag_values as tag_values,
        dim_accounts.tag_keys as tag_keys,
    from "supercell"."main"."fact_bill_generation" as fact_bill_generation
    left join "supercell"."main"."dim_resource" as dim_resource using (resource_id) 
    left join "supercell"."main"."dim_accounts" as dim_accounts using (linked_account_id) 
)

select
    month,
    sum(bill_amount) as total_cost,
    instance_type,
    service_code,
    region,
    pricing_model,
    tag_keys,
    tag_values
from base
group by
    month,
    instance_type,
    service_code,
    region,
    pricing_model,
    tag_keys,
    tag_values
    );
  
  
[0m15:47:19.860516 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.total_cost"} */

  
    
    

    create  table
      "supercell"."main"."total_cost__dbt_tmp"
  
    as (
      

with base as (
    select
        fact_bill_generation.resource_id as resource_id,
        date_trunc('month', bill_date) as month,
        bill_amount,
        dim_resource.instance_type as instance_type,
        dim_resource.product as product,
        dim_resource.region as region,
        dim_resource.pricing_model as pricing_model,
        dim_accounts.tag_values as tag_values,
        dim_accounts.tag_keys as tag_keys,
    from "supercell"."main"."fact_bill_generation" as fact_bill_generation
    left join "supercell"."main"."dim_resource" as dim_resource using (resource_id) 
    left join "supercell"."main"."dim_accounts" as dim_accounts using (linked_account_id) 
)

select
    month,
    sum(bill_amount) as total_cost,
    instance_type,
    service_code,
    region,
    pricing_model,
    tag_keys,
    tag_values
from base
group by
    month,
    instance_type,
    service_code,
    region,
    pricing_model,
    tag_keys,
    tag_values
    );
  
  
[0m15:47:19.861067 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m15:47:19.861701 [debug] [Thread-1 (]: On model.supercell.total_cost: ROLLBACK
[0m15:47:19.865765 [debug] [Thread-1 (]: Failed to rollback 'model.supercell.total_cost'
[0m15:47:19.866245 [debug] [Thread-1 (]: On model.supercell.total_cost: Close
[0m15:47:19.869549 [debug] [Thread-1 (]: Runtime Error in model total_cost (models/supercell_models/metrics/total_cost.sql)
  Binder Error: Referenced column "service_code" not found in FROM clause!
  Candidate bindings: "resource_id", "pricing_model", "instance_type", "region", "bill_amount"
  
  LINE 42:     service_code,
               ^
[0m15:47:19.870402 [error] [Thread-1 (]: 5 of 5 ERROR creating sql table model main.total_cost .......................... [[31mERROR[0m in 0.03s]
[0m15:47:19.871091 [debug] [Thread-1 (]: Finished running node model.supercell.total_cost
[0m15:47:19.872134 [debug] [Thread-7 (]: Marking all children of 'model.supercell.total_cost' to be skipped because of status 'error'.  Reason: Runtime Error in model total_cost (models/supercell_models/metrics/total_cost.sql)
  Binder Error: Referenced column "service_code" not found in FROM clause!
  Candidate bindings: "resource_id", "pricing_model", "instance_type", "region", "bill_amount"
  
  LINE 42:     service_code,
               ^.
[0m15:47:19.875357 [debug] [MainThread]: Using duckdb connection "master"
[0m15:47:19.876137 [debug] [MainThread]: On master: BEGIN
[0m15:47:19.876853 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:47:19.878581 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m15:47:19.879786 [debug] [MainThread]: On master: COMMIT
[0m15:47:19.880638 [debug] [MainThread]: Using duckdb connection "master"
[0m15:47:19.881383 [debug] [MainThread]: On master: COMMIT
[0m15:47:19.883015 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m15:47:19.884069 [debug] [MainThread]: On master: Close
[0m15:47:19.885079 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:47:19.885555 [debug] [MainThread]: Connection 'model.supercell.total_cost' was properly closed.
[0m15:47:19.885985 [debug] [MainThread]: Connection 'model.supercell.dim_accounts' was properly closed.
[0m15:47:19.886394 [debug] [MainThread]: Connection 'model.supercell.dim_resource' was properly closed.
[0m15:47:19.886944 [debug] [MainThread]: Connection 'model.supercell.fact_bill_generation' was properly closed.
[0m15:47:19.887618 [info ] [MainThread]: 
[0m15:47:19.888196 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 1.52 seconds (1.52s).
[0m15:47:19.889660 [debug] [MainThread]: Command end result
[0m15:47:19.908278 [debug] [MainThread]: Wrote artifact WritableManifest to /home/harsha/data_actions/supercell_cloudops/target/manifest.json
[0m15:47:19.911237 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/harsha/data_actions/supercell_cloudops/target/semantic_manifest.json
[0m15:47:19.920029 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/harsha/data_actions/supercell_cloudops/target/run_results.json
[0m15:47:19.920523 [info ] [MainThread]: 
[0m15:47:19.920963 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m15:47:19.921310 [info ] [MainThread]: 
[0m15:47:19.921721 [error] [MainThread]:   Runtime Error in model total_cost (models/supercell_models/metrics/total_cost.sql)
  Binder Error: Referenced column "service_code" not found in FROM clause!
  Candidate bindings: "resource_id", "pricing_model", "instance_type", "region", "bill_amount"
  
  LINE 42:     service_code,
               ^
[0m15:47:19.922052 [info ] [MainThread]: 
[0m15:47:19.922415 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
[0m15:47:19.923433 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 2.5180085, "process_in_blocks": "0", "process_kernel_time": 0.670668, "process_mem_max_rss": "354792", "process_out_blocks": "59712", "process_user_time": 8.371889}
[0m15:47:19.924120 [debug] [MainThread]: Command `dbt run` failed at 15:47:19.923999 after 2.52 seconds
[0m15:47:19.924615 [debug] [MainThread]: Flushing usage events


============================== 15:47:43.911563 | 372c09f4-f20f-4716-a8dc-dbfcbd9cbb37 ==============================
[0m15:47:43.911563 [info ] [MainThread]: Running with dbt=1.9.4
[0m15:47:43.916187 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/harsha/data_actions/supercell_cloudops', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/home/harsha/data_actions/supercell_cloudops/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'False'}
[0m15:47:43.916634 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality

User config should be moved from the 'config' key in profiles.yml to the 'flags' key in dbt_project.yml.
[0m15:47:44.243825 [info ] [MainThread]: Registered adapter: duckdb=1.9.3
[0m15:47:44.320718 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m15:47:44.403188 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:47:44.403932 [debug] [MainThread]: Partial parsing: updated file: supercell://models/supercell_models/metrics/total_cost.sql
[0m15:47:44.688937 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.supercell.example
[0m15:47:44.756870 [debug] [MainThread]: Wrote artifact WritableManifest to /home/harsha/data_actions/supercell_cloudops/target/manifest.json
[0m15:47:44.759027 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/harsha/data_actions/supercell_cloudops/target/semantic_manifest.json
[0m15:47:44.772271 [info ] [MainThread]: Found 5 models, 428 macros
[0m15:47:44.775074 [info ] [MainThread]: 
[0m15:47:44.776159 [info ] [MainThread]: Concurrency: 4 threads (target='default')
[0m15:47:44.776627 [info ] [MainThread]: 
[0m15:47:44.777455 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m15:47:44.785893 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_supercell'
[0m15:47:44.830966 [debug] [ThreadPool]: Using duckdb connection "list_supercell"
[0m15:47:44.831515 [debug] [ThreadPool]: On list_supercell: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "connection_name": "list_supercell"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"supercell"'
    
  
  
[0m15:47:44.831934 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:47:44.847465 [debug] [ThreadPool]: SQL status: OK in 0.015 seconds
[0m15:47:44.849191 [debug] [ThreadPool]: On list_supercell: Close
[0m15:47:44.850323 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_supercell, now create_supercell_main)
[0m15:47:44.850947 [debug] [ThreadPool]: Creating schema "database: "supercell"
schema: "main"
"
[0m15:47:44.858813 [debug] [ThreadPool]: Using duckdb connection "create_supercell_main"
[0m15:47:44.859322 [debug] [ThreadPool]: On create_supercell_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "connection_name": "create_supercell_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='supercell'
        and type='sqlite'
    
  
[0m15:47:44.859679 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:47:44.861105 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m15:47:44.862708 [debug] [ThreadPool]: Using duckdb connection "create_supercell_main"
[0m15:47:44.863105 [debug] [ThreadPool]: On create_supercell_main: BEGIN
[0m15:47:44.863656 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m15:47:44.864031 [debug] [ThreadPool]: Using duckdb connection "create_supercell_main"
[0m15:47:44.864332 [debug] [ThreadPool]: On create_supercell_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "connection_name": "create_supercell_main"} */

    
    
        create schema if not exists "supercell"."main"
    
[0m15:47:44.864950 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m15:47:44.865966 [debug] [ThreadPool]: On create_supercell_main: COMMIT
[0m15:47:44.866355 [debug] [ThreadPool]: Using duckdb connection "create_supercell_main"
[0m15:47:44.866683 [debug] [ThreadPool]: On create_supercell_main: COMMIT
[0m15:47:44.867190 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m15:47:44.867556 [debug] [ThreadPool]: On create_supercell_main: Close
[0m15:47:44.869672 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_supercell_main, now list_supercell_main)
[0m15:47:44.878079 [debug] [ThreadPool]: Using duckdb connection "list_supercell_main"
[0m15:47:44.878587 [debug] [ThreadPool]: On list_supercell_main: BEGIN
[0m15:47:44.878959 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:47:44.879788 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m15:47:44.880198 [debug] [ThreadPool]: Using duckdb connection "list_supercell_main"
[0m15:47:44.880541 [debug] [ThreadPool]: On list_supercell_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "connection_name": "list_supercell_main"} */
select
      'supercell' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'supercell'
  
[0m15:47:44.900594 [debug] [ThreadPool]: SQL status: OK in 0.020 seconds
[0m15:47:44.902844 [debug] [ThreadPool]: On list_supercell_main: ROLLBACK
[0m15:47:44.904354 [debug] [ThreadPool]: Failed to rollback 'list_supercell_main'
[0m15:47:44.904835 [debug] [ThreadPool]: On list_supercell_main: Close
[0m15:47:44.908231 [debug] [MainThread]: Using duckdb connection "master"
[0m15:47:44.909017 [debug] [MainThread]: On master: BEGIN
[0m15:47:44.909583 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:47:44.910865 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m15:47:44.911513 [debug] [MainThread]: On master: COMMIT
[0m15:47:44.912118 [debug] [MainThread]: Using duckdb connection "master"
[0m15:47:44.912685 [debug] [MainThread]: On master: COMMIT
[0m15:47:44.913974 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m15:47:44.914608 [debug] [MainThread]: On master: Close
[0m15:47:44.919465 [debug] [Thread-1 (]: Began running node model.supercell.cleaned_usagelogs
[0m15:47:44.920550 [info ] [Thread-1 (]: 1 of 5 START sql table model main.cleaned_usagelogs ............................ [RUN]
[0m15:47:44.921456 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_supercell_main, now model.supercell.cleaned_usagelogs)
[0m15:47:44.922235 [debug] [Thread-1 (]: Began compiling node model.supercell.cleaned_usagelogs
[0m15:47:44.939389 [debug] [Thread-1 (]: Writing injected SQL for node "model.supercell.cleaned_usagelogs"
[0m15:47:44.940619 [debug] [Thread-1 (]: Began executing node model.supercell.cleaned_usagelogs
[0m15:47:44.984019 [debug] [Thread-1 (]: Writing runtime sql for node "model.supercell.cleaned_usagelogs"
[0m15:47:44.984964 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.cleaned_usagelogs"
[0m15:47:44.985436 [debug] [Thread-1 (]: On model.supercell.cleaned_usagelogs: BEGIN
[0m15:47:44.985839 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:47:44.986816 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:47:44.987231 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.cleaned_usagelogs"
[0m15:47:44.987631 [debug] [Thread-1 (]: On model.supercell.cleaned_usagelogs: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.cleaned_usagelogs"} */

  
    
    

    create  table
      "supercell"."main"."cleaned_usagelogs__dbt_tmp"
  
    as (
      


SELECT
    CAST("LinkedAccountId" AS VARCHAR) AS linked_account_id,
    CAST("bill/PayerAccountId" AS VARCHAR) AS payer_account_id,
    CAST("lineItem/UsageStartDate" AS TIMESTAMP) AS usage_start_date,
    CAST("lineItem/UsageEndDate" AS TIMESTAMP) AS usage_end_date,
    CAST("lineItem/UsageAmount" AS DECIMAL(18, 6)) AS usage_amount,
    CAST("lineItem/Operation" AS VARCHAR) AS operation,
    CAST("pricing/PricingModel" AS VARCHAR) AS pricing_model,
    CAST("resourceTags/TagKeys" AS VARCHAR) AS tag_keys,
    CAST("resourceTags/TagValues" AS VARCHAR) AS tag_values,
    CAST("product/Region" AS VARCHAR) AS region,
    CAST("product/ServiceCode" AS VARCHAR) AS service_code,
    CAST("product/InstanceType" AS VARCHAR) AS instance_type,
    CAST("amortized_cost" AS DECIMAL(18, 6)) AS amortized_cost,
    CAST("product/Description" AS VARCHAR) AS description
FROM supercell_usagelogs
    );
  
  
[0m15:47:45.563838 [debug] [Thread-1 (]: SQL status: OK in 0.576 seconds
[0m15:47:45.572259 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.cleaned_usagelogs"
[0m15:47:45.572871 [debug] [Thread-1 (]: On model.supercell.cleaned_usagelogs: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.cleaned_usagelogs"} */
alter table "supercell"."main"."cleaned_usagelogs" rename to "cleaned_usagelogs__dbt_backup"
[0m15:47:45.573981 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:47:45.577745 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.cleaned_usagelogs"
[0m15:47:45.578302 [debug] [Thread-1 (]: On model.supercell.cleaned_usagelogs: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.cleaned_usagelogs"} */
alter table "supercell"."main"."cleaned_usagelogs__dbt_tmp" rename to "cleaned_usagelogs"
[0m15:47:45.579403 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:47:45.601071 [debug] [Thread-1 (]: On model.supercell.cleaned_usagelogs: COMMIT
[0m15:47:45.601727 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.cleaned_usagelogs"
[0m15:47:45.602241 [debug] [Thread-1 (]: On model.supercell.cleaned_usagelogs: COMMIT
[0m15:47:45.637890 [debug] [Thread-1 (]: SQL status: OK in 0.035 seconds
[0m15:47:45.644114 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.cleaned_usagelogs"
[0m15:47:45.644679 [debug] [Thread-1 (]: On model.supercell.cleaned_usagelogs: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.cleaned_usagelogs"} */
drop table if exists "supercell"."main"."cleaned_usagelogs__dbt_backup" cascade
[0m15:47:45.647628 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m15:47:45.650523 [debug] [Thread-1 (]: On model.supercell.cleaned_usagelogs: Close
[0m15:47:45.654678 [info ] [Thread-1 (]: 1 of 5 OK created sql table model main.cleaned_usagelogs ....................... [[32mOK[0m in 0.73s]
[0m15:47:45.655412 [debug] [Thread-1 (]: Finished running node model.supercell.cleaned_usagelogs
[0m15:47:45.657140 [debug] [Thread-3 (]: Began running node model.supercell.dim_accounts
[0m15:47:45.658401 [info ] [Thread-3 (]: 2 of 5 START sql table model main.dim_accounts ................................. [RUN]
[0m15:47:45.659279 [debug] [Thread-3 (]: Acquiring new duckdb connection 'model.supercell.dim_accounts'
[0m15:47:45.660187 [debug] [Thread-4 (]: Began running node model.supercell.dim_resource
[0m15:47:45.661156 [debug] [Thread-3 (]: Began compiling node model.supercell.dim_accounts
[0m15:47:45.662176 [debug] [Thread-2 (]: Began running node model.supercell.fact_bill_generation
[0m15:47:45.663547 [info ] [Thread-4 (]: 3 of 5 START sql table model main.dim_resource ................................. [RUN]
[0m15:47:45.671131 [debug] [Thread-3 (]: Writing injected SQL for node "model.supercell.dim_accounts"
[0m15:47:45.672360 [info ] [Thread-2 (]: 4 of 5 START sql table model main.fact_bill_generation ......................... [RUN]
[0m15:47:45.674116 [debug] [Thread-4 (]: Acquiring new duckdb connection 'model.supercell.dim_resource'
[0m15:47:45.676685 [debug] [Thread-2 (]: Acquiring new duckdb connection 'model.supercell.fact_bill_generation'
[0m15:47:45.678169 [debug] [Thread-4 (]: Began compiling node model.supercell.dim_resource
[0m15:47:45.679379 [debug] [Thread-2 (]: Began compiling node model.supercell.fact_bill_generation
[0m15:47:45.680451 [debug] [Thread-3 (]: Began executing node model.supercell.dim_accounts
[0m15:47:45.685936 [debug] [Thread-4 (]: Writing injected SQL for node "model.supercell.dim_resource"
[0m15:47:45.689611 [debug] [Thread-2 (]: Writing injected SQL for node "model.supercell.fact_bill_generation"
[0m15:47:45.696662 [debug] [Thread-3 (]: Writing runtime sql for node "model.supercell.dim_accounts"
[0m15:47:45.699704 [debug] [Thread-2 (]: Began executing node model.supercell.fact_bill_generation
[0m15:47:45.700626 [debug] [Thread-4 (]: Began executing node model.supercell.dim_resource
[0m15:47:45.706690 [debug] [Thread-2 (]: Writing runtime sql for node "model.supercell.fact_bill_generation"
[0m15:47:45.715288 [debug] [Thread-4 (]: Writing runtime sql for node "model.supercell.dim_resource"
[0m15:47:45.717135 [debug] [Thread-3 (]: Using duckdb connection "model.supercell.dim_accounts"
[0m15:47:45.718729 [debug] [Thread-3 (]: On model.supercell.dim_accounts: BEGIN
[0m15:47:45.719865 [debug] [Thread-2 (]: Using duckdb connection "model.supercell.fact_bill_generation"
[0m15:47:45.720797 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m15:47:45.722247 [debug] [Thread-4 (]: Using duckdb connection "model.supercell.dim_resource"
[0m15:47:45.723575 [debug] [Thread-2 (]: On model.supercell.fact_bill_generation: BEGIN
[0m15:47:45.725734 [debug] [Thread-4 (]: On model.supercell.dim_resource: BEGIN
[0m15:47:45.727097 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m15:47:45.728393 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m15:47:45.729555 [debug] [Thread-3 (]: SQL status: OK in 0.009 seconds
[0m15:47:45.731942 [debug] [Thread-2 (]: SQL status: OK in 0.005 seconds
[0m15:47:45.733094 [debug] [Thread-3 (]: Using duckdb connection "model.supercell.dim_accounts"
[0m15:47:45.734068 [debug] [Thread-4 (]: SQL status: OK in 0.006 seconds
[0m15:47:45.735088 [debug] [Thread-2 (]: Using duckdb connection "model.supercell.fact_bill_generation"
[0m15:47:45.736102 [debug] [Thread-3 (]: On model.supercell.dim_accounts: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.dim_accounts"} */

  
    
    

    create  table
      "supercell"."main"."dim_accounts__dbt_tmp"
  
    as (
      


select
    linked_account_id as linked_account_id,
    tag_keys as tag_keys,
    tag_values as tag_values
from "supercell"."main"."cleaned_usagelogs"
    );
  
  
[0m15:47:45.737165 [debug] [Thread-4 (]: Using duckdb connection "model.supercell.dim_resource"
[0m15:47:45.738349 [debug] [Thread-2 (]: On model.supercell.fact_bill_generation: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.fact_bill_generation"} */

  
    
    

    create  table
      "supercell"."main"."fact_bill_generation__dbt_tmp"
  
    as (
      


select
    md5(concat(linked_account_id, '_', service_code, '_', instance_type, '_', region, '_', CAST(usage_start_date AS VARCHAR), '_', CAST(usage_end_date AS VARCHAR))) AS resource_id,
    usage_start_date as start_date,
    usage_end_date as bill_date,
    usage_amount as bill_amount,
    operation
from "supercell"."main"."cleaned_usagelogs"
    );
  
  
[0m15:47:45.740198 [debug] [Thread-4 (]: On model.supercell.dim_resource: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.dim_resource"} */

  
    
    

    create  table
      "supercell"."main"."dim_resource__dbt_tmp"
  
    as (
      


select
    md5(concat(linked_account_id, '_', service_code, '_', instance_type, '_', region, '_', CAST(usage_start_date AS VARCHAR), '_', CAST(usage_end_date AS VARCHAR))) AS resource_id,
    linked_account_id as linked_account_id,
    region,
    service_code as product,
    instance_type as instance_type,
    pricing_model as pricing_model
from "supercell"."main"."cleaned_usagelogs"
    );
  
  
[0m15:47:45.958909 [debug] [Thread-3 (]: SQL status: OK in 0.219 seconds
[0m15:47:45.965042 [debug] [Thread-3 (]: Using duckdb connection "model.supercell.dim_accounts"
[0m15:47:45.966048 [debug] [Thread-3 (]: On model.supercell.dim_accounts: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.dim_accounts"} */
alter table "supercell"."main"."dim_accounts" rename to "dim_accounts__dbt_backup"
[0m15:47:45.967376 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m15:47:45.971153 [debug] [Thread-3 (]: Using duckdb connection "model.supercell.dim_accounts"
[0m15:47:45.971985 [debug] [Thread-3 (]: On model.supercell.dim_accounts: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.dim_accounts"} */
alter table "supercell"."main"."dim_accounts__dbt_tmp" rename to "dim_accounts"
[0m15:47:45.973317 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m15:47:45.976183 [debug] [Thread-3 (]: On model.supercell.dim_accounts: COMMIT
[0m15:47:45.977187 [debug] [Thread-3 (]: Using duckdb connection "model.supercell.dim_accounts"
[0m15:47:45.977739 [debug] [Thread-3 (]: On model.supercell.dim_accounts: COMMIT
[0m15:47:45.999013 [debug] [Thread-3 (]: SQL status: OK in 0.021 seconds
[0m15:47:46.002376 [debug] [Thread-3 (]: Using duckdb connection "model.supercell.dim_accounts"
[0m15:47:46.003109 [debug] [Thread-3 (]: On model.supercell.dim_accounts: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.dim_accounts"} */
drop table if exists "supercell"."main"."dim_accounts__dbt_backup" cascade
[0m15:47:46.005615 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m15:47:46.008681 [debug] [Thread-3 (]: On model.supercell.dim_accounts: Close
[0m15:47:46.016199 [info ] [Thread-3 (]: 2 of 5 OK created sql table model main.dim_accounts ............................ [[32mOK[0m in 0.36s]
[0m15:47:46.022538 [debug] [Thread-3 (]: Finished running node model.supercell.dim_accounts
[0m15:47:46.134666 [debug] [Thread-2 (]: SQL status: OK in 0.393 seconds
[0m15:47:46.142018 [debug] [Thread-2 (]: Using duckdb connection "model.supercell.fact_bill_generation"
[0m15:47:46.143269 [debug] [Thread-2 (]: On model.supercell.fact_bill_generation: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.fact_bill_generation"} */
alter table "supercell"."main"."fact_bill_generation" rename to "fact_bill_generation__dbt_backup"
[0m15:47:46.148401 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m15:47:46.155925 [debug] [Thread-2 (]: Using duckdb connection "model.supercell.fact_bill_generation"
[0m15:47:46.157846 [debug] [Thread-2 (]: On model.supercell.fact_bill_generation: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.fact_bill_generation"} */
alter table "supercell"."main"."fact_bill_generation__dbt_tmp" rename to "fact_bill_generation"
[0m15:47:46.159854 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m15:47:46.164731 [debug] [Thread-2 (]: On model.supercell.fact_bill_generation: COMMIT
[0m15:47:46.166039 [debug] [Thread-2 (]: Using duckdb connection "model.supercell.fact_bill_generation"
[0m15:47:46.167032 [debug] [Thread-2 (]: On model.supercell.fact_bill_generation: COMMIT
[0m15:47:46.228440 [debug] [Thread-2 (]: SQL status: OK in 0.061 seconds
[0m15:47:46.235670 [debug] [Thread-2 (]: Using duckdb connection "model.supercell.fact_bill_generation"
[0m15:47:46.236459 [debug] [Thread-2 (]: On model.supercell.fact_bill_generation: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.fact_bill_generation"} */
drop table if exists "supercell"."main"."fact_bill_generation__dbt_backup" cascade
[0m15:47:46.241792 [debug] [Thread-2 (]: SQL status: OK in 0.005 seconds
[0m15:47:46.243784 [debug] [Thread-2 (]: On model.supercell.fact_bill_generation: Close
[0m15:47:46.252679 [info ] [Thread-2 (]: 4 of 5 OK created sql table model main.fact_bill_generation .................... [[32mOK[0m in 0.58s]
[0m15:47:46.253516 [debug] [Thread-2 (]: Finished running node model.supercell.fact_bill_generation
[0m15:47:46.290746 [debug] [Thread-4 (]: SQL status: OK in 0.548 seconds
[0m15:47:46.294316 [debug] [Thread-4 (]: Using duckdb connection "model.supercell.dim_resource"
[0m15:47:46.294867 [debug] [Thread-4 (]: On model.supercell.dim_resource: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.dim_resource"} */
alter table "supercell"."main"."dim_resource" rename to "dim_resource__dbt_backup"
[0m15:47:46.295918 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m15:47:46.299164 [debug] [Thread-4 (]: Using duckdb connection "model.supercell.dim_resource"
[0m15:47:46.299628 [debug] [Thread-4 (]: On model.supercell.dim_resource: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.dim_resource"} */
alter table "supercell"."main"."dim_resource__dbt_tmp" rename to "dim_resource"
[0m15:47:46.300470 [debug] [Thread-4 (]: SQL status: OK in 0.000 seconds
[0m15:47:46.302471 [debug] [Thread-4 (]: On model.supercell.dim_resource: COMMIT
[0m15:47:46.302938 [debug] [Thread-4 (]: Using duckdb connection "model.supercell.dim_resource"
[0m15:47:46.303325 [debug] [Thread-4 (]: On model.supercell.dim_resource: COMMIT
[0m15:47:46.315715 [debug] [Thread-4 (]: SQL status: OK in 0.012 seconds
[0m15:47:46.319378 [debug] [Thread-4 (]: Using duckdb connection "model.supercell.dim_resource"
[0m15:47:46.319953 [debug] [Thread-4 (]: On model.supercell.dim_resource: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.dim_resource"} */
drop table if exists "supercell"."main"."dim_resource__dbt_backup" cascade
[0m15:47:46.322519 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m15:47:46.325335 [debug] [Thread-4 (]: On model.supercell.dim_resource: Close
[0m15:47:46.327244 [info ] [Thread-4 (]: 3 of 5 OK created sql table model main.dim_resource ............................ [[32mOK[0m in 0.65s]
[0m15:47:46.328001 [debug] [Thread-4 (]: Finished running node model.supercell.dim_resource
[0m15:47:46.329282 [debug] [Thread-1 (]: Began running node model.supercell.total_cost
[0m15:47:46.330353 [info ] [Thread-1 (]: 5 of 5 START sql table model main.total_cost ................................... [RUN]
[0m15:47:46.331062 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.supercell.cleaned_usagelogs, now model.supercell.total_cost)
[0m15:47:46.331512 [debug] [Thread-1 (]: Began compiling node model.supercell.total_cost
[0m15:47:46.336504 [debug] [Thread-1 (]: Writing injected SQL for node "model.supercell.total_cost"
[0m15:47:46.338397 [debug] [Thread-1 (]: Began executing node model.supercell.total_cost
[0m15:47:46.343974 [debug] [Thread-1 (]: Writing runtime sql for node "model.supercell.total_cost"
[0m15:47:46.345326 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.total_cost"
[0m15:47:46.346052 [debug] [Thread-1 (]: On model.supercell.total_cost: BEGIN
[0m15:47:46.346499 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:47:46.347542 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:47:46.348032 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.total_cost"
[0m15:47:46.348467 [debug] [Thread-1 (]: On model.supercell.total_cost: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.total_cost"} */

  
    
    

    create  table
      "supercell"."main"."total_cost__dbt_tmp"
  
    as (
      

with base as (
    select
        fact_bill_generation.resource_id as resource_id,
        date_trunc('month', bill_date) as month,
        bill_amount,
        dim_resource.instance_type as instance_type,
        dim_resource.product as product,
        dim_resource.region as region,
        dim_resource.pricing_model as pricing_model,
        dim_accounts.tag_values as tag_values,
        dim_accounts.tag_keys as tag_keys,
    from "supercell"."main"."fact_bill_generation" as fact_bill_generation
    left join "supercell"."main"."dim_resource" as dim_resource using (resource_id) 
    left join "supercell"."main"."dim_accounts" as dim_accounts using (linked_account_id) 
)

select
    month,
    sum(bill_amount) as total_cost,
    instance_type,
    product,
    region,
    pricing_model,
    tag_keys,
    tag_values
from base
group by
    month,
    instance_type,
    product,
    region,
    pricing_model,
    tag_keys,
    tag_values
    );
  
  
[0m15:48:44.114179 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/harsha/data_actions/supercell_cloudops/target/run_results.json
[0m15:48:44.116067 [debug] [MainThread]: DuckDB adapter: cancelling query on connection model.supercell.total_cost. Details: Connection(type='duckdb', name='model.supercell.total_cost', state=<ConnectionState.OPEN: 'open'>, transaction_open=True, _handle=<dbt.adapters.duckdb.environments.local.DuckDBConnectionWrapper object at 0x715a381e5e80>, _credentials=DuckDBCredentials(database='supercell', schema='main', path='/home/harsha/data_actions/supercell_cloudops/supercell.duckdb', config_options=None, extensions=None, settings={}, secrets=[], external_root='.', use_credential_provider=None, attach=None, filesystems=None, remote=None, plugins=None, disable_transactions=False, keep_open=True, module_paths=None, retries=None))
[0m15:48:44.117125 [debug] [MainThread]: DuckDB adapter: query cancelled on connection model.supercell.total_cost
[0m15:48:44.118131 [error] [MainThread]: CANCEL query model.supercell.total_cost ........................................ [[31mCANCEL[0m]
[0m15:48:44.118623 [error] [MainThread]: CANCEL query model.supercell.dim_accounts ...................................... [[31mCANCEL[0m]
[0m15:48:44.118980 [error] [MainThread]: CANCEL query model.supercell.dim_resource ...................................... [[31mCANCEL[0m]
[0m15:48:44.119286 [error] [MainThread]: CANCEL query model.supercell.fact_bill_generation .............................. [[31mCANCEL[0m]
[0m15:48:44.120423 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.total_cost"} */

  
    
    

    create  table
      "supercell"."main"."total_cost__dbt_tmp"
  
    as (
      

with base as (
    select
        fact_bill_generation.resource_id as resource_id,
        date_trunc('month', bill_date) as month,
        bill_amount,
        dim_resource.instance_type as instance_type,
        dim_resource.product as product,
        dim_resource.region as region,
        dim_resource.pricing_model as pricing_model,
        dim_accounts.tag_values as tag_values,
        dim_accounts.tag_keys as tag_keys,
    from "supercell"."main"."fact_bill_generation" as fact_bill_generation
    left join "supercell"."main"."dim_resource" as dim_resource using (resource_id) 
    left join "supercell"."main"."dim_accounts" as dim_accounts using (linked_account_id) 
)

select
    month,
    sum(bill_amount) as total_cost,
    instance_type,
    product,
    region,
    pricing_model,
    tag_keys,
    tag_values
from base
group by
    month,
    instance_type,
    product,
    region,
    pricing_model,
    tag_keys,
    tag_values
    );
  
  
[0m15:48:44.121309 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m15:48:44.122218 [debug] [Thread-1 (]: On model.supercell.total_cost: ROLLBACK
[0m15:48:44.129964 [debug] [Thread-1 (]: Failed to rollback 'model.supercell.total_cost'
[0m15:48:44.130904 [debug] [Thread-1 (]: On model.supercell.total_cost: Close
[0m15:48:44.145054 [debug] [Thread-1 (]: Runtime Error in model total_cost (models/supercell_models/metrics/total_cost.sql)
  INTERRUPT Error: Interrupted!
[0m15:48:44.146065 [error] [Thread-1 (]: 5 of 5 ERROR creating sql table model main.total_cost .......................... [[31mERROR[0m in 57.81s]
[0m15:48:44.146833 [debug] [Thread-1 (]: Finished running node model.supercell.total_cost
[0m15:48:44.147424 [info ] [MainThread]: 
[0m15:48:44.148030 [info ] [MainThread]: [33mExited because of keyboard interrupt[0m
[0m15:48:44.148417 [info ] [MainThread]: 
[0m15:48:44.148810 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m15:48:44.149162 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:48:44.149450 [debug] [MainThread]: Connection 'model.supercell.total_cost' was properly closed.
[0m15:48:44.149732 [debug] [MainThread]: Connection 'model.supercell.dim_accounts' was properly closed.
[0m15:48:44.149998 [debug] [MainThread]: Connection 'model.supercell.dim_resource' was properly closed.
[0m15:48:44.150274 [debug] [MainThread]: Connection 'model.supercell.fact_bill_generation' was properly closed.
[0m15:48:44.150634 [info ] [MainThread]: 
[0m15:48:44.151005 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 59.37 seconds (59.37s).
[0m15:48:44.151496 [error] [MainThread]: Encountered an error:

[0m15:48:44.155785 [error] [MainThread]: Traceback (most recent call last):
  File "/home/harsha/data_actions/supercell_cloudops/supercell_env/lib/python3.12/site-packages/dbt/cli/requires.py", line 153, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "/home/harsha/data_actions/supercell_cloudops/supercell_env/lib/python3.12/site-packages/dbt/cli/requires.py", line 103, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/harsha/data_actions/supercell_cloudops/supercell_env/lib/python3.12/site-packages/dbt/cli/requires.py", line 235, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/harsha/data_actions/supercell_cloudops/supercell_env/lib/python3.12/site-packages/dbt/cli/requires.py", line 264, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/harsha/data_actions/supercell_cloudops/supercell_env/lib/python3.12/site-packages/dbt/cli/requires.py", line 311, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/harsha/data_actions/supercell_cloudops/supercell_env/lib/python3.12/site-packages/dbt/cli/requires.py", line 328, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/harsha/data_actions/supercell_cloudops/supercell_env/lib/python3.12/site-packages/dbt/cli/main.py", line 578, in run
    results = task.run()
              ^^^^^^^^^^
  File "/home/harsha/data_actions/supercell_cloudops/supercell_env/lib/python3.12/site-packages/dbt/task/runnable.py", line 590, in run
    result = self.execute_with_hooks(selected_uids)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/harsha/data_actions/supercell_cloudops/supercell_env/lib/python3.12/site-packages/dbt/task/runnable.py", line 532, in execute_with_hooks
    res = self.execute_nodes()
          ^^^^^^^^^^^^^^^^^^^^
  File "/home/harsha/data_actions/supercell_cloudops/supercell_env/lib/python3.12/site-packages/dbt/task/runnable.py", line 413, in execute_nodes
    self.run_queue(pool)
  File "/home/harsha/data_actions/supercell_cloudops/supercell_env/lib/python3.12/site-packages/dbt/task/runnable.py", line 340, in run_queue
    self.job_queue.join()
  File "/home/harsha/data_actions/supercell_cloudops/supercell_env/lib/python3.12/site-packages/dbt/graph/queue.py", line 206, in join
    self.inner.join()
  File "/usr/lib/python3.12/queue.py", line 90, in join
    self.all_tasks_done.wait()
  File "/usr/lib/python3.12/threading.py", line 355, in wait
    waiter.acquire()
KeyboardInterrupt

[0m15:48:44.157392 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 60.311596, "process_in_blocks": "568", "process_kernel_time": 0.79882, "process_mem_max_rss": "337548", "process_out_blocks": "58848", "process_user_time": 296.87216}
[0m15:48:44.158177 [debug] [MainThread]: Command `dbt run` failed at 15:48:44.158025 after 60.31 seconds
[0m15:48:44.158772 [debug] [MainThread]: Flushing usage events


============================== 15:48:58.748201 | 663a356c-36ae-4c99-b001-e79a14e1a132 ==============================
[0m15:48:58.748201 [info ] [MainThread]: Running with dbt=1.9.4
[0m15:48:58.754059 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/harsha/data_actions/supercell_cloudops/logs', 'debug': 'False', 'profiles_dir': '/home/harsha/data_actions/supercell_cloudops', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'False'}
[0m15:48:58.755358 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality

User config should be moved from the 'config' key in profiles.yml to the 'flags' key in dbt_project.yml.
[0m15:48:59.073049 [info ] [MainThread]: Registered adapter: duckdb=1.9.3
[0m15:48:59.151438 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m15:48:59.232721 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:48:59.233262 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:48:59.242415 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.supercell.example
[0m15:48:59.324994 [debug] [MainThread]: Wrote artifact WritableManifest to /home/harsha/data_actions/supercell_cloudops/target/manifest.json
[0m15:48:59.326822 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/harsha/data_actions/supercell_cloudops/target/semantic_manifest.json
[0m15:48:59.340283 [info ] [MainThread]: Found 5 models, 428 macros
[0m15:48:59.342690 [info ] [MainThread]: 
[0m15:48:59.343255 [info ] [MainThread]: Concurrency: 4 threads (target='default')
[0m15:48:59.343635 [info ] [MainThread]: 
[0m15:48:59.344245 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m15:48:59.352141 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_supercell'
[0m15:48:59.396594 [debug] [ThreadPool]: Using duckdb connection "list_supercell"
[0m15:48:59.397214 [debug] [ThreadPool]: On list_supercell: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "connection_name": "list_supercell"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"supercell"'
    
  
  
[0m15:48:59.397641 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:48:59.413231 [debug] [ThreadPool]: SQL status: OK in 0.015 seconds
[0m15:48:59.414935 [debug] [ThreadPool]: On list_supercell: Close
[0m15:48:59.416081 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_supercell, now create_supercell_main)
[0m15:48:59.416718 [debug] [ThreadPool]: Creating schema "database: "supercell"
schema: "main"
"
[0m15:48:59.425138 [debug] [ThreadPool]: Using duckdb connection "create_supercell_main"
[0m15:48:59.425661 [debug] [ThreadPool]: On create_supercell_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "connection_name": "create_supercell_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='supercell'
        and type='sqlite'
    
  
[0m15:48:59.426019 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:48:59.427515 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m15:48:59.429132 [debug] [ThreadPool]: Using duckdb connection "create_supercell_main"
[0m15:48:59.429531 [debug] [ThreadPool]: On create_supercell_main: BEGIN
[0m15:48:59.430128 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m15:48:59.430470 [debug] [ThreadPool]: Using duckdb connection "create_supercell_main"
[0m15:48:59.430804 [debug] [ThreadPool]: On create_supercell_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "connection_name": "create_supercell_main"} */

    
    
        create schema if not exists "supercell"."main"
    
[0m15:48:59.431369 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m15:48:59.432353 [debug] [ThreadPool]: On create_supercell_main: COMMIT
[0m15:48:59.432786 [debug] [ThreadPool]: Using duckdb connection "create_supercell_main"
[0m15:48:59.433127 [debug] [ThreadPool]: On create_supercell_main: COMMIT
[0m15:48:59.433931 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m15:48:59.434908 [debug] [ThreadPool]: On create_supercell_main: Close
[0m15:48:59.437877 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_supercell_main, now list_supercell_main)
[0m15:48:59.445170 [debug] [ThreadPool]: Using duckdb connection "list_supercell_main"
[0m15:48:59.445608 [debug] [ThreadPool]: On list_supercell_main: BEGIN
[0m15:48:59.445955 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:48:59.446723 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m15:48:59.447077 [debug] [ThreadPool]: Using duckdb connection "list_supercell_main"
[0m15:48:59.447387 [debug] [ThreadPool]: On list_supercell_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "connection_name": "list_supercell_main"} */
select
      'supercell' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'supercell'
  
[0m15:48:59.463708 [debug] [ThreadPool]: SQL status: OK in 0.016 seconds
[0m15:48:59.465493 [debug] [ThreadPool]: On list_supercell_main: ROLLBACK
[0m15:48:59.466839 [debug] [ThreadPool]: Failed to rollback 'list_supercell_main'
[0m15:48:59.467264 [debug] [ThreadPool]: On list_supercell_main: Close
[0m15:48:59.469819 [debug] [MainThread]: Using duckdb connection "master"
[0m15:48:59.470291 [debug] [MainThread]: On master: BEGIN
[0m15:48:59.470658 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:48:59.471607 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m15:48:59.471999 [debug] [MainThread]: On master: COMMIT
[0m15:48:59.472352 [debug] [MainThread]: Using duckdb connection "master"
[0m15:48:59.472672 [debug] [MainThread]: On master: COMMIT
[0m15:48:59.473207 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m15:48:59.473564 [debug] [MainThread]: On master: Close
[0m15:48:59.477124 [debug] [Thread-1 (]: Began running node model.supercell.cleaned_usagelogs
[0m15:48:59.478126 [info ] [Thread-1 (]: 1 of 5 START sql table model main.cleaned_usagelogs ............................ [RUN]
[0m15:48:59.479154 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_supercell_main, now model.supercell.cleaned_usagelogs)
[0m15:48:59.480100 [debug] [Thread-1 (]: Began compiling node model.supercell.cleaned_usagelogs
[0m15:48:59.489727 [debug] [Thread-1 (]: Writing injected SQL for node "model.supercell.cleaned_usagelogs"
[0m15:48:59.490595 [debug] [Thread-1 (]: Began executing node model.supercell.cleaned_usagelogs
[0m15:48:59.530955 [debug] [Thread-1 (]: Writing runtime sql for node "model.supercell.cleaned_usagelogs"
[0m15:48:59.531868 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.cleaned_usagelogs"
[0m15:48:59.532334 [debug] [Thread-1 (]: On model.supercell.cleaned_usagelogs: BEGIN
[0m15:48:59.532717 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:48:59.533742 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:48:59.534442 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.cleaned_usagelogs"
[0m15:48:59.535047 [debug] [Thread-1 (]: On model.supercell.cleaned_usagelogs: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.cleaned_usagelogs"} */

  
    
    

    create  table
      "supercell"."main"."cleaned_usagelogs__dbt_tmp"
  
    as (
      


SELECT
    CAST("LinkedAccountId" AS VARCHAR) AS linked_account_id,
    CAST("bill/PayerAccountId" AS VARCHAR) AS payer_account_id,
    CAST("lineItem/UsageStartDate" AS TIMESTAMP) AS usage_start_date,
    CAST("lineItem/UsageEndDate" AS TIMESTAMP) AS usage_end_date,
    CAST("lineItem/UsageAmount" AS DECIMAL(18, 6)) AS usage_amount,
    CAST("lineItem/Operation" AS VARCHAR) AS operation,
    CAST("pricing/PricingModel" AS VARCHAR) AS pricing_model,
    CAST("resourceTags/TagKeys" AS VARCHAR) AS tag_keys,
    CAST("resourceTags/TagValues" AS VARCHAR) AS tag_values,
    CAST("product/Region" AS VARCHAR) AS region,
    CAST("product/ServiceCode" AS VARCHAR) AS service_code,
    CAST("product/InstanceType" AS VARCHAR) AS instance_type,
    CAST("amortized_cost" AS DECIMAL(18, 6)) AS amortized_cost,
    CAST("product/Description" AS VARCHAR) AS description
FROM supercell_usagelogs
    );
  
  
[0m15:49:00.077773 [debug] [Thread-1 (]: SQL status: OK in 0.542 seconds
[0m15:49:00.085345 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.cleaned_usagelogs"
[0m15:49:00.085903 [debug] [Thread-1 (]: On model.supercell.cleaned_usagelogs: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.cleaned_usagelogs"} */
alter table "supercell"."main"."cleaned_usagelogs" rename to "cleaned_usagelogs__dbt_backup"
[0m15:49:00.087089 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:49:00.090231 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.cleaned_usagelogs"
[0m15:49:00.090707 [debug] [Thread-1 (]: On model.supercell.cleaned_usagelogs: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.cleaned_usagelogs"} */
alter table "supercell"."main"."cleaned_usagelogs__dbt_tmp" rename to "cleaned_usagelogs"
[0m15:49:00.091533 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:49:00.110372 [debug] [Thread-1 (]: On model.supercell.cleaned_usagelogs: COMMIT
[0m15:49:00.110941 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.cleaned_usagelogs"
[0m15:49:00.111334 [debug] [Thread-1 (]: On model.supercell.cleaned_usagelogs: COMMIT
[0m15:49:00.142861 [debug] [Thread-1 (]: SQL status: OK in 0.031 seconds
[0m15:49:00.149438 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.cleaned_usagelogs"
[0m15:49:00.149950 [debug] [Thread-1 (]: On model.supercell.cleaned_usagelogs: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.cleaned_usagelogs"} */
drop table if exists "supercell"."main"."cleaned_usagelogs__dbt_backup" cascade
[0m15:49:00.153308 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m15:49:00.156383 [debug] [Thread-1 (]: On model.supercell.cleaned_usagelogs: Close
[0m15:49:00.159119 [info ] [Thread-1 (]: 1 of 5 OK created sql table model main.cleaned_usagelogs ....................... [[32mOK[0m in 0.68s]
[0m15:49:00.159863 [debug] [Thread-1 (]: Finished running node model.supercell.cleaned_usagelogs
[0m15:49:00.161546 [debug] [Thread-3 (]: Began running node model.supercell.dim_accounts
[0m15:49:00.162643 [debug] [Thread-4 (]: Began running node model.supercell.dim_resource
[0m15:49:00.164007 [info ] [Thread-3 (]: 2 of 5 START sql table model main.dim_accounts ................................. [RUN]
[0m15:49:00.165429 [debug] [Thread-2 (]: Began running node model.supercell.fact_bill_generation
[0m15:49:00.166921 [info ] [Thread-4 (]: 3 of 5 START sql table model main.dim_resource ................................. [RUN]
[0m15:49:00.169389 [debug] [Thread-3 (]: Acquiring new duckdb connection 'model.supercell.dim_accounts'
[0m15:49:00.171491 [info ] [Thread-2 (]: 4 of 5 START sql table model main.fact_bill_generation ......................... [RUN]
[0m15:49:00.173901 [debug] [Thread-4 (]: Acquiring new duckdb connection 'model.supercell.dim_resource'
[0m15:49:00.175461 [debug] [Thread-3 (]: Began compiling node model.supercell.dim_accounts
[0m15:49:00.177355 [debug] [Thread-2 (]: Acquiring new duckdb connection 'model.supercell.fact_bill_generation'
[0m15:49:00.178797 [debug] [Thread-4 (]: Began compiling node model.supercell.dim_resource
[0m15:49:00.186392 [debug] [Thread-3 (]: Writing injected SQL for node "model.supercell.dim_accounts"
[0m15:49:00.187611 [debug] [Thread-2 (]: Began compiling node model.supercell.fact_bill_generation
[0m15:49:00.195961 [debug] [Thread-4 (]: Writing injected SQL for node "model.supercell.dim_resource"
[0m15:49:00.202309 [debug] [Thread-2 (]: Writing injected SQL for node "model.supercell.fact_bill_generation"
[0m15:49:00.203433 [debug] [Thread-3 (]: Began executing node model.supercell.dim_accounts
[0m15:49:00.210413 [debug] [Thread-3 (]: Writing runtime sql for node "model.supercell.dim_accounts"
[0m15:49:00.211530 [debug] [Thread-4 (]: Began executing node model.supercell.dim_resource
[0m15:49:00.213162 [debug] [Thread-2 (]: Began executing node model.supercell.fact_bill_generation
[0m15:49:00.214465 [debug] [Thread-3 (]: Using duckdb connection "model.supercell.dim_accounts"
[0m15:49:00.220041 [debug] [Thread-4 (]: Writing runtime sql for node "model.supercell.dim_resource"
[0m15:49:00.227403 [debug] [Thread-2 (]: Writing runtime sql for node "model.supercell.fact_bill_generation"
[0m15:49:00.228288 [debug] [Thread-3 (]: On model.supercell.dim_accounts: BEGIN
[0m15:49:00.229597 [debug] [Thread-4 (]: Using duckdb connection "model.supercell.dim_resource"
[0m15:49:00.230248 [debug] [Thread-2 (]: Using duckdb connection "model.supercell.fact_bill_generation"
[0m15:49:00.230999 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m15:49:00.231866 [debug] [Thread-4 (]: On model.supercell.dim_resource: BEGIN
[0m15:49:00.232514 [debug] [Thread-2 (]: On model.supercell.fact_bill_generation: BEGIN
[0m15:49:00.233493 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m15:49:00.234050 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m15:49:00.235055 [debug] [Thread-3 (]: SQL status: OK in 0.004 seconds
[0m15:49:00.235964 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m15:49:00.236668 [debug] [Thread-3 (]: Using duckdb connection "model.supercell.dim_accounts"
[0m15:49:00.237494 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m15:49:00.238267 [debug] [Thread-4 (]: Using duckdb connection "model.supercell.dim_resource"
[0m15:49:00.239144 [debug] [Thread-3 (]: On model.supercell.dim_accounts: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.dim_accounts"} */

  
    
    

    create  table
      "supercell"."main"."dim_accounts__dbt_tmp"
  
    as (
      


select
    linked_account_id as linked_account_id,
    tag_keys as tag_keys,
    tag_values as tag_values
from "supercell"."main"."cleaned_usagelogs"
    );
  
  
[0m15:49:00.239939 [debug] [Thread-2 (]: Using duckdb connection "model.supercell.fact_bill_generation"
[0m15:49:00.240598 [debug] [Thread-4 (]: On model.supercell.dim_resource: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.dim_resource"} */

  
    
    

    create  table
      "supercell"."main"."dim_resource__dbt_tmp"
  
    as (
      


select
    md5(concat(linked_account_id, '_', service_code, '_', instance_type, '_', region, '_', CAST(usage_start_date AS VARCHAR), '_', CAST(usage_end_date AS VARCHAR))) AS resource_id,
    linked_account_id as linked_account_id,
    region,
    service_code as product,
    instance_type as instance_type,
    pricing_model as pricing_model
from "supercell"."main"."cleaned_usagelogs"
    );
  
  
[0m15:49:00.241809 [debug] [Thread-2 (]: On model.supercell.fact_bill_generation: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.fact_bill_generation"} */

  
    
    

    create  table
      "supercell"."main"."fact_bill_generation__dbt_tmp"
  
    as (
      


select
    md5(concat(linked_account_id, '_', service_code, '_', instance_type, '_', region, '_', CAST(usage_start_date AS VARCHAR), '_', CAST(usage_end_date AS VARCHAR))) AS resource_id,
    usage_start_date as start_date,
    usage_end_date as bill_date,
    usage_amount as bill_amount,
    operation
from "supercell"."main"."cleaned_usagelogs"
    );
  
  
[0m15:49:00.432297 [debug] [Thread-3 (]: SQL status: OK in 0.191 seconds
[0m15:49:00.438354 [debug] [Thread-3 (]: Using duckdb connection "model.supercell.dim_accounts"
[0m15:49:00.439357 [debug] [Thread-3 (]: On model.supercell.dim_accounts: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.dim_accounts"} */
alter table "supercell"."main"."dim_accounts" rename to "dim_accounts__dbt_backup"
[0m15:49:00.441063 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m15:49:00.446674 [debug] [Thread-3 (]: Using duckdb connection "model.supercell.dim_accounts"
[0m15:49:00.447599 [debug] [Thread-3 (]: On model.supercell.dim_accounts: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.dim_accounts"} */
alter table "supercell"."main"."dim_accounts__dbt_tmp" rename to "dim_accounts"
[0m15:49:00.449176 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m15:49:00.452809 [debug] [Thread-3 (]: On model.supercell.dim_accounts: COMMIT
[0m15:49:00.453811 [debug] [Thread-3 (]: Using duckdb connection "model.supercell.dim_accounts"
[0m15:49:00.454623 [debug] [Thread-3 (]: On model.supercell.dim_accounts: COMMIT
[0m15:49:00.480112 [debug] [Thread-3 (]: SQL status: OK in 0.025 seconds
[0m15:49:00.484844 [debug] [Thread-3 (]: Using duckdb connection "model.supercell.dim_accounts"
[0m15:49:00.485902 [debug] [Thread-3 (]: On model.supercell.dim_accounts: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.dim_accounts"} */
drop table if exists "supercell"."main"."dim_accounts__dbt_backup" cascade
[0m15:49:00.489281 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m15:49:00.492393 [debug] [Thread-3 (]: On model.supercell.dim_accounts: Close
[0m15:49:00.499234 [info ] [Thread-3 (]: 2 of 5 OK created sql table model main.dim_accounts ............................ [[32mOK[0m in 0.33s]
[0m15:49:00.500321 [debug] [Thread-3 (]: Finished running node model.supercell.dim_accounts
[0m15:49:00.628025 [debug] [Thread-2 (]: SQL status: OK in 0.385 seconds
[0m15:49:00.631281 [debug] [Thread-2 (]: Using duckdb connection "model.supercell.fact_bill_generation"
[0m15:49:00.631997 [debug] [Thread-2 (]: On model.supercell.fact_bill_generation: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.fact_bill_generation"} */
alter table "supercell"."main"."fact_bill_generation" rename to "fact_bill_generation__dbt_backup"
[0m15:49:00.632987 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m15:49:00.636288 [debug] [Thread-2 (]: Using duckdb connection "model.supercell.fact_bill_generation"
[0m15:49:00.637017 [debug] [Thread-2 (]: On model.supercell.fact_bill_generation: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.fact_bill_generation"} */
alter table "supercell"."main"."fact_bill_generation__dbt_tmp" rename to "fact_bill_generation"
[0m15:49:00.638228 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m15:49:00.640874 [debug] [Thread-2 (]: On model.supercell.fact_bill_generation: COMMIT
[0m15:49:00.641513 [debug] [Thread-2 (]: Using duckdb connection "model.supercell.fact_bill_generation"
[0m15:49:00.641955 [debug] [Thread-2 (]: On model.supercell.fact_bill_generation: COMMIT
[0m15:49:00.686323 [debug] [Thread-2 (]: SQL status: OK in 0.044 seconds
[0m15:49:00.689212 [debug] [Thread-2 (]: Using duckdb connection "model.supercell.fact_bill_generation"
[0m15:49:00.689713 [debug] [Thread-2 (]: On model.supercell.fact_bill_generation: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.fact_bill_generation"} */
drop table if exists "supercell"."main"."fact_bill_generation__dbt_backup" cascade
[0m15:49:00.692262 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m15:49:00.693950 [debug] [Thread-2 (]: On model.supercell.fact_bill_generation: Close
[0m15:49:00.703294 [info ] [Thread-2 (]: 4 of 5 OK created sql table model main.fact_bill_generation .................... [[32mOK[0m in 0.53s]
[0m15:49:00.704151 [debug] [Thread-2 (]: Finished running node model.supercell.fact_bill_generation
[0m15:49:00.789164 [debug] [Thread-4 (]: SQL status: OK in 0.547 seconds
[0m15:49:00.792442 [debug] [Thread-4 (]: Using duckdb connection "model.supercell.dim_resource"
[0m15:49:00.792955 [debug] [Thread-4 (]: On model.supercell.dim_resource: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.dim_resource"} */
alter table "supercell"."main"."dim_resource" rename to "dim_resource__dbt_backup"
[0m15:49:00.794131 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m15:49:00.797202 [debug] [Thread-4 (]: Using duckdb connection "model.supercell.dim_resource"
[0m15:49:00.797653 [debug] [Thread-4 (]: On model.supercell.dim_resource: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.dim_resource"} */
alter table "supercell"."main"."dim_resource__dbt_tmp" rename to "dim_resource"
[0m15:49:00.798490 [debug] [Thread-4 (]: SQL status: OK in 0.000 seconds
[0m15:49:00.800396 [debug] [Thread-4 (]: On model.supercell.dim_resource: COMMIT
[0m15:49:00.800856 [debug] [Thread-4 (]: Using duckdb connection "model.supercell.dim_resource"
[0m15:49:00.801233 [debug] [Thread-4 (]: On model.supercell.dim_resource: COMMIT
[0m15:49:00.813469 [debug] [Thread-4 (]: SQL status: OK in 0.012 seconds
[0m15:49:00.816325 [debug] [Thread-4 (]: Using duckdb connection "model.supercell.dim_resource"
[0m15:49:00.816834 [debug] [Thread-4 (]: On model.supercell.dim_resource: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.dim_resource"} */
drop table if exists "supercell"."main"."dim_resource__dbt_backup" cascade
[0m15:49:00.819431 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m15:49:00.821378 [debug] [Thread-4 (]: On model.supercell.dim_resource: Close
[0m15:49:00.824476 [info ] [Thread-4 (]: 3 of 5 OK created sql table model main.dim_resource ............................ [[32mOK[0m in 0.65s]
[0m15:49:00.825256 [debug] [Thread-4 (]: Finished running node model.supercell.dim_resource
[0m15:49:00.826817 [debug] [Thread-1 (]: Began running node model.supercell.total_cost
[0m15:49:00.827689 [info ] [Thread-1 (]: 5 of 5 START sql table model main.total_cost ................................... [RUN]
[0m15:49:00.828435 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.supercell.cleaned_usagelogs, now model.supercell.total_cost)
[0m15:49:00.829041 [debug] [Thread-1 (]: Began compiling node model.supercell.total_cost
[0m15:49:00.835031 [debug] [Thread-1 (]: Writing injected SQL for node "model.supercell.total_cost"
[0m15:49:00.836907 [debug] [Thread-1 (]: Began executing node model.supercell.total_cost
[0m15:49:00.841727 [debug] [Thread-1 (]: Writing runtime sql for node "model.supercell.total_cost"
[0m15:49:00.842916 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.total_cost"
[0m15:49:00.843384 [debug] [Thread-1 (]: On model.supercell.total_cost: BEGIN
[0m15:49:00.843787 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:49:00.845481 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m15:49:00.845981 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.total_cost"
[0m15:49:00.846393 [debug] [Thread-1 (]: On model.supercell.total_cost: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.total_cost"} */

  
    
    

    create  table
      "supercell"."main"."total_cost__dbt_tmp"
  
    as (
      

with base as (
    select
        fact_bill_generation.resource_id as resource_id,
        date_trunc('month', bill_date) as month,
        bill_amount,
        dim_resource.instance_type as instance_type,
        dim_resource.product as product,
        dim_resource.region as region,
        dim_resource.pricing_model as pricing_model,
        dim_accounts.tag_values as tag_values,
        dim_accounts.tag_keys as tag_keys,
    from "supercell"."main"."fact_bill_generation" as fact_bill_generation
    left join "supercell"."main"."dim_resource" as dim_resource using (resource_id) 
    left join "supercell"."main"."dim_accounts" as dim_accounts using (linked_account_id) 
)

select
    month,
    sum(bill_amount) as total_cost,
    instance_type,
    product,
    region,
    pricing_model,
    tag_keys,
    tag_values
from base
group by
    month,
    instance_type,
    product,
    region,
    pricing_model,
    tag_keys,
    tag_values
    );
  
  
[0m15:49:58.600349 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/harsha/data_actions/supercell_cloudops/target/run_results.json
[0m15:49:58.603812 [debug] [MainThread]: DuckDB adapter: cancelling query on connection model.supercell.total_cost. Details: Connection(type='duckdb', name='model.supercell.total_cost', state=<ConnectionState.OPEN: 'open'>, transaction_open=True, _handle=<dbt.adapters.duckdb.environments.local.DuckDBConnectionWrapper object at 0x79f224e8d100>, _credentials=DuckDBCredentials(database='supercell', schema='main', path='/home/harsha/data_actions/supercell_cloudops/supercell.duckdb', config_options=None, extensions=None, settings={}, secrets=[], external_root='.', use_credential_provider=None, attach=None, filesystems=None, remote=None, plugins=None, disable_transactions=False, keep_open=True, module_paths=None, retries=None))
[0m15:49:58.604752 [debug] [MainThread]: DuckDB adapter: query cancelled on connection model.supercell.total_cost
[0m15:49:58.605446 [error] [MainThread]: CANCEL query model.supercell.total_cost ........................................ [[31mCANCEL[0m]
[0m15:49:58.606268 [error] [MainThread]: CANCEL query model.supercell.dim_accounts ...................................... [[31mCANCEL[0m]
[0m15:49:58.607520 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.total_cost"} */

  
    
    

    create  table
      "supercell"."main"."total_cost__dbt_tmp"
  
    as (
      

with base as (
    select
        fact_bill_generation.resource_id as resource_id,
        date_trunc('month', bill_date) as month,
        bill_amount,
        dim_resource.instance_type as instance_type,
        dim_resource.product as product,
        dim_resource.region as region,
        dim_resource.pricing_model as pricing_model,
        dim_accounts.tag_values as tag_values,
        dim_accounts.tag_keys as tag_keys,
    from "supercell"."main"."fact_bill_generation" as fact_bill_generation
    left join "supercell"."main"."dim_resource" as dim_resource using (resource_id) 
    left join "supercell"."main"."dim_accounts" as dim_accounts using (linked_account_id) 
)

select
    month,
    sum(bill_amount) as total_cost,
    instance_type,
    product,
    region,
    pricing_model,
    tag_keys,
    tag_values
from base
group by
    month,
    instance_type,
    product,
    region,
    pricing_model,
    tag_keys,
    tag_values
    );
  
  
[0m15:49:58.608229 [error] [MainThread]: CANCEL query model.supercell.dim_resource ...................................... [[31mCANCEL[0m]
[0m15:49:58.609150 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m15:49:58.609802 [error] [MainThread]: CANCEL query model.supercell.fact_bill_generation .............................. [[31mCANCEL[0m]
[0m15:49:58.610898 [debug] [Thread-1 (]: On model.supercell.total_cost: ROLLBACK
[0m15:49:58.618350 [debug] [Thread-1 (]: Failed to rollback 'model.supercell.total_cost'
[0m15:49:58.619235 [debug] [Thread-1 (]: On model.supercell.total_cost: Close
[0m15:49:58.637731 [debug] [Thread-1 (]: Runtime Error in model total_cost (models/supercell_models/metrics/total_cost.sql)
  INTERRUPT Error: Interrupted!
[0m15:49:58.639170 [error] [Thread-1 (]: 5 of 5 ERROR creating sql table model main.total_cost .......................... [[31mERROR[0m in 57.81s]
[0m15:49:58.640604 [debug] [Thread-1 (]: Finished running node model.supercell.total_cost
[0m15:49:58.641167 [info ] [MainThread]: 
[0m15:49:58.642362 [info ] [MainThread]: [33mExited because of keyboard interrupt[0m
[0m15:49:58.643416 [info ] [MainThread]: 
[0m15:49:58.644231 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m15:49:58.644951 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:49:58.645577 [debug] [MainThread]: Connection 'model.supercell.total_cost' was properly closed.
[0m15:49:58.646160 [debug] [MainThread]: Connection 'model.supercell.dim_accounts' was properly closed.
[0m15:49:58.646684 [debug] [MainThread]: Connection 'model.supercell.dim_resource' was properly closed.
[0m15:49:58.647232 [debug] [MainThread]: Connection 'model.supercell.fact_bill_generation' was properly closed.
[0m15:49:58.648146 [info ] [MainThread]: 
[0m15:49:58.648891 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 59.30 seconds (59.30s).
[0m15:49:58.649864 [error] [MainThread]: Encountered an error:

[0m15:49:58.653258 [error] [MainThread]: Traceback (most recent call last):
  File "/home/harsha/data_actions/supercell_cloudops/supercell_env/lib/python3.12/site-packages/dbt/cli/requires.py", line 153, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "/home/harsha/data_actions/supercell_cloudops/supercell_env/lib/python3.12/site-packages/dbt/cli/requires.py", line 103, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/harsha/data_actions/supercell_cloudops/supercell_env/lib/python3.12/site-packages/dbt/cli/requires.py", line 235, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/harsha/data_actions/supercell_cloudops/supercell_env/lib/python3.12/site-packages/dbt/cli/requires.py", line 264, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/harsha/data_actions/supercell_cloudops/supercell_env/lib/python3.12/site-packages/dbt/cli/requires.py", line 311, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/harsha/data_actions/supercell_cloudops/supercell_env/lib/python3.12/site-packages/dbt/cli/requires.py", line 328, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/harsha/data_actions/supercell_cloudops/supercell_env/lib/python3.12/site-packages/dbt/cli/main.py", line 578, in run
    results = task.run()
              ^^^^^^^^^^
  File "/home/harsha/data_actions/supercell_cloudops/supercell_env/lib/python3.12/site-packages/dbt/task/runnable.py", line 590, in run
    result = self.execute_with_hooks(selected_uids)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/harsha/data_actions/supercell_cloudops/supercell_env/lib/python3.12/site-packages/dbt/task/runnable.py", line 532, in execute_with_hooks
    res = self.execute_nodes()
          ^^^^^^^^^^^^^^^^^^^^
  File "/home/harsha/data_actions/supercell_cloudops/supercell_env/lib/python3.12/site-packages/dbt/task/runnable.py", line 413, in execute_nodes
    self.run_queue(pool)
  File "/home/harsha/data_actions/supercell_cloudops/supercell_env/lib/python3.12/site-packages/dbt/task/runnable.py", line 340, in run_queue
    self.job_queue.join()
  File "/home/harsha/data_actions/supercell_cloudops/supercell_env/lib/python3.12/site-packages/dbt/graph/queue.py", line 206, in join
    self.inner.join()
  File "/usr/lib/python3.12/queue.py", line 90, in join
    self.all_tasks_done.wait()
  File "/usr/lib/python3.12/threading.py", line 355, in wait
    waiter.acquire()
KeyboardInterrupt

[0m15:49:58.655553 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 59.96973, "process_in_blocks": "0", "process_kernel_time": 0.749861, "process_mem_max_rss": "327972", "process_out_blocks": "57472", "process_user_time": 296.22534}
[0m15:49:58.656692 [debug] [MainThread]: Command `dbt run` failed at 15:49:58.656445 after 59.97 seconds
[0m15:49:58.657578 [debug] [MainThread]: Flushing usage events


============================== 15:52:47.924249 | 6a8eacbd-2f9f-4e6f-96d7-cb9589ffcd10 ==============================
[0m15:52:47.924249 [info ] [MainThread]: Running with dbt=1.9.4
[0m15:52:47.930437 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/harsha/data_actions/supercell_cloudops/logs', 'debug': 'False', 'profiles_dir': '/home/harsha/data_actions/supercell_cloudops', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'False'}
[0m15:52:47.931219 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality

User config should be moved from the 'config' key in profiles.yml to the 'flags' key in dbt_project.yml.
[0m15:52:48.246891 [info ] [MainThread]: Registered adapter: duckdb=1.9.3
[0m15:52:48.319525 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m15:52:48.401486 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:52:48.402256 [debug] [MainThread]: Partial parsing: updated file: supercell://models/supercell_models/metrics/total_cost.sql
[0m15:52:48.684161 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.supercell.example
[0m15:52:48.748530 [debug] [MainThread]: Wrote artifact WritableManifest to /home/harsha/data_actions/supercell_cloudops/target/manifest.json
[0m15:52:48.750438 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/harsha/data_actions/supercell_cloudops/target/semantic_manifest.json
[0m15:52:48.763419 [info ] [MainThread]: Found 5 models, 428 macros
[0m15:52:48.765845 [info ] [MainThread]: 
[0m15:52:48.766417 [info ] [MainThread]: Concurrency: 4 threads (target='default')
[0m15:52:48.766845 [info ] [MainThread]: 
[0m15:52:48.767458 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m15:52:48.775285 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_supercell'
[0m15:52:48.827882 [debug] [ThreadPool]: Using duckdb connection "list_supercell"
[0m15:52:48.829075 [debug] [ThreadPool]: On list_supercell: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "connection_name": "list_supercell"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"supercell"'
    
  
  
[0m15:52:48.829919 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:52:48.845313 [debug] [ThreadPool]: SQL status: OK in 0.015 seconds
[0m15:52:48.847168 [debug] [ThreadPool]: On list_supercell: Close
[0m15:52:48.848385 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_supercell, now create_supercell_main)
[0m15:52:48.849012 [debug] [ThreadPool]: Creating schema "database: "supercell"
schema: "main"
"
[0m15:52:48.856728 [debug] [ThreadPool]: Using duckdb connection "create_supercell_main"
[0m15:52:48.857176 [debug] [ThreadPool]: On create_supercell_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "connection_name": "create_supercell_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='supercell'
        and type='sqlite'
    
  
[0m15:52:48.857549 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:52:48.858930 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m15:52:48.860480 [debug] [ThreadPool]: Using duckdb connection "create_supercell_main"
[0m15:52:48.860896 [debug] [ThreadPool]: On create_supercell_main: BEGIN
[0m15:52:48.861452 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m15:52:48.861814 [debug] [ThreadPool]: Using duckdb connection "create_supercell_main"
[0m15:52:48.862127 [debug] [ThreadPool]: On create_supercell_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "connection_name": "create_supercell_main"} */

    
    
        create schema if not exists "supercell"."main"
    
[0m15:52:48.862783 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m15:52:48.863833 [debug] [ThreadPool]: On create_supercell_main: COMMIT
[0m15:52:48.864204 [debug] [ThreadPool]: Using duckdb connection "create_supercell_main"
[0m15:52:48.864523 [debug] [ThreadPool]: On create_supercell_main: COMMIT
[0m15:52:48.865033 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m15:52:48.865379 [debug] [ThreadPool]: On create_supercell_main: Close
[0m15:52:48.867667 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_supercell_main, now list_supercell_main)
[0m15:52:48.874617 [debug] [ThreadPool]: Using duckdb connection "list_supercell_main"
[0m15:52:48.875091 [debug] [ThreadPool]: On list_supercell_main: BEGIN
[0m15:52:48.875428 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:52:48.876210 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m15:52:48.876611 [debug] [ThreadPool]: Using duckdb connection "list_supercell_main"
[0m15:52:48.876981 [debug] [ThreadPool]: On list_supercell_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "connection_name": "list_supercell_main"} */
select
      'supercell' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'supercell'
  
[0m15:52:48.897023 [debug] [ThreadPool]: SQL status: OK in 0.020 seconds
[0m15:52:48.899420 [debug] [ThreadPool]: On list_supercell_main: ROLLBACK
[0m15:52:48.901068 [debug] [ThreadPool]: Failed to rollback 'list_supercell_main'
[0m15:52:48.901587 [debug] [ThreadPool]: On list_supercell_main: Close
[0m15:52:48.904190 [debug] [MainThread]: Using duckdb connection "master"
[0m15:52:48.904722 [debug] [MainThread]: On master: BEGIN
[0m15:52:48.905187 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:52:48.906255 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m15:52:48.906783 [debug] [MainThread]: On master: COMMIT
[0m15:52:48.907226 [debug] [MainThread]: Using duckdb connection "master"
[0m15:52:48.907641 [debug] [MainThread]: On master: COMMIT
[0m15:52:48.908347 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m15:52:48.908889 [debug] [MainThread]: On master: Close
[0m15:52:48.913409 [debug] [Thread-1 (]: Began running node model.supercell.cleaned_usagelogs
[0m15:52:48.914899 [info ] [Thread-1 (]: 1 of 5 START sql table model main.cleaned_usagelogs ............................ [RUN]
[0m15:52:48.915847 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_supercell_main, now model.supercell.cleaned_usagelogs)
[0m15:52:48.916480 [debug] [Thread-1 (]: Began compiling node model.supercell.cleaned_usagelogs
[0m15:52:48.932529 [debug] [Thread-1 (]: Writing injected SQL for node "model.supercell.cleaned_usagelogs"
[0m15:52:48.933754 [debug] [Thread-1 (]: Began executing node model.supercell.cleaned_usagelogs
[0m15:52:48.980989 [debug] [Thread-1 (]: Writing runtime sql for node "model.supercell.cleaned_usagelogs"
[0m15:52:48.981976 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.cleaned_usagelogs"
[0m15:52:48.982447 [debug] [Thread-1 (]: On model.supercell.cleaned_usagelogs: BEGIN
[0m15:52:48.982843 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:52:48.983950 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:52:48.984403 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.cleaned_usagelogs"
[0m15:52:48.984821 [debug] [Thread-1 (]: On model.supercell.cleaned_usagelogs: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.cleaned_usagelogs"} */

  
    
    

    create  table
      "supercell"."main"."cleaned_usagelogs__dbt_tmp"
  
    as (
      


SELECT
    CAST("LinkedAccountId" AS VARCHAR) AS linked_account_id,
    CAST("bill/PayerAccountId" AS VARCHAR) AS payer_account_id,
    CAST("lineItem/UsageStartDate" AS TIMESTAMP) AS usage_start_date,
    CAST("lineItem/UsageEndDate" AS TIMESTAMP) AS usage_end_date,
    CAST("lineItem/UsageAmount" AS DECIMAL(18, 6)) AS usage_amount,
    CAST("lineItem/Operation" AS VARCHAR) AS operation,
    CAST("pricing/PricingModel" AS VARCHAR) AS pricing_model,
    CAST("resourceTags/TagKeys" AS VARCHAR) AS tag_keys,
    CAST("resourceTags/TagValues" AS VARCHAR) AS tag_values,
    CAST("product/Region" AS VARCHAR) AS region,
    CAST("product/ServiceCode" AS VARCHAR) AS service_code,
    CAST("product/InstanceType" AS VARCHAR) AS instance_type,
    CAST("amortized_cost" AS DECIMAL(18, 6)) AS amortized_cost,
    CAST("product/Description" AS VARCHAR) AS description
FROM supercell_usagelogs
    );
  
  
[0m15:52:49.535122 [debug] [Thread-1 (]: SQL status: OK in 0.550 seconds
[0m15:52:49.542746 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.cleaned_usagelogs"
[0m15:52:49.543262 [debug] [Thread-1 (]: On model.supercell.cleaned_usagelogs: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.cleaned_usagelogs"} */
alter table "supercell"."main"."cleaned_usagelogs" rename to "cleaned_usagelogs__dbt_backup"
[0m15:52:49.544464 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:52:49.547740 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.cleaned_usagelogs"
[0m15:52:49.548212 [debug] [Thread-1 (]: On model.supercell.cleaned_usagelogs: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.cleaned_usagelogs"} */
alter table "supercell"."main"."cleaned_usagelogs__dbt_tmp" rename to "cleaned_usagelogs"
[0m15:52:49.549188 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:52:49.568214 [debug] [Thread-1 (]: On model.supercell.cleaned_usagelogs: COMMIT
[0m15:52:49.568782 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.cleaned_usagelogs"
[0m15:52:49.569221 [debug] [Thread-1 (]: On model.supercell.cleaned_usagelogs: COMMIT
[0m15:52:49.585526 [debug] [Thread-1 (]: SQL status: OK in 0.016 seconds
[0m15:52:49.591978 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.cleaned_usagelogs"
[0m15:52:49.592498 [debug] [Thread-1 (]: On model.supercell.cleaned_usagelogs: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.cleaned_usagelogs"} */
drop table if exists "supercell"."main"."cleaned_usagelogs__dbt_backup" cascade
[0m15:52:49.595098 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m15:52:49.598237 [debug] [Thread-1 (]: On model.supercell.cleaned_usagelogs: Close
[0m15:52:49.603389 [info ] [Thread-1 (]: 1 of 5 OK created sql table model main.cleaned_usagelogs ....................... [[32mOK[0m in 0.69s]
[0m15:52:49.604172 [debug] [Thread-1 (]: Finished running node model.supercell.cleaned_usagelogs
[0m15:52:49.605910 [debug] [Thread-3 (]: Began running node model.supercell.dim_accounts
[0m15:52:49.607153 [info ] [Thread-3 (]: 2 of 5 START sql table model main.dim_accounts ................................. [RUN]
[0m15:52:49.608299 [debug] [Thread-4 (]: Began running node model.supercell.dim_resource
[0m15:52:49.609796 [debug] [Thread-2 (]: Began running node model.supercell.fact_bill_generation
[0m15:52:49.611250 [debug] [Thread-3 (]: Acquiring new duckdb connection 'model.supercell.dim_accounts'
[0m15:52:49.612711 [info ] [Thread-4 (]: 3 of 5 START sql table model main.dim_resource ................................. [RUN]
[0m15:52:49.615329 [info ] [Thread-2 (]: 4 of 5 START sql table model main.fact_bill_generation ......................... [RUN]
[0m15:52:49.616767 [debug] [Thread-3 (]: Began compiling node model.supercell.dim_accounts
[0m15:52:49.618260 [debug] [Thread-4 (]: Acquiring new duckdb connection 'model.supercell.dim_resource'
[0m15:52:49.619721 [debug] [Thread-2 (]: Acquiring new duckdb connection 'model.supercell.fact_bill_generation'
[0m15:52:49.626667 [debug] [Thread-3 (]: Writing injected SQL for node "model.supercell.dim_accounts"
[0m15:52:49.627624 [debug] [Thread-4 (]: Began compiling node model.supercell.dim_resource
[0m15:52:49.628773 [debug] [Thread-2 (]: Began compiling node model.supercell.fact_bill_generation
[0m15:52:49.637849 [debug] [Thread-4 (]: Writing injected SQL for node "model.supercell.dim_resource"
[0m15:52:49.643589 [debug] [Thread-2 (]: Writing injected SQL for node "model.supercell.fact_bill_generation"
[0m15:52:49.644711 [debug] [Thread-3 (]: Began executing node model.supercell.dim_accounts
[0m15:52:49.647055 [debug] [Thread-2 (]: Began executing node model.supercell.fact_bill_generation
[0m15:52:49.654047 [debug] [Thread-4 (]: Began executing node model.supercell.dim_resource
[0m15:52:49.662058 [debug] [Thread-3 (]: Writing runtime sql for node "model.supercell.dim_accounts"
[0m15:52:49.663517 [debug] [Thread-2 (]: Writing runtime sql for node "model.supercell.fact_bill_generation"
[0m15:52:49.669474 [debug] [Thread-4 (]: Writing runtime sql for node "model.supercell.dim_resource"
[0m15:52:49.671710 [debug] [Thread-3 (]: Using duckdb connection "model.supercell.dim_accounts"
[0m15:52:49.672908 [debug] [Thread-4 (]: Using duckdb connection "model.supercell.dim_resource"
[0m15:52:49.673800 [debug] [Thread-2 (]: Using duckdb connection "model.supercell.fact_bill_generation"
[0m15:52:49.674625 [debug] [Thread-3 (]: On model.supercell.dim_accounts: BEGIN
[0m15:52:49.675579 [debug] [Thread-4 (]: On model.supercell.dim_resource: BEGIN
[0m15:52:49.676516 [debug] [Thread-2 (]: On model.supercell.fact_bill_generation: BEGIN
[0m15:52:49.677394 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m15:52:49.678240 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m15:52:49.679118 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m15:52:49.681126 [debug] [Thread-3 (]: SQL status: OK in 0.004 seconds
[0m15:52:49.681775 [debug] [Thread-3 (]: Using duckdb connection "model.supercell.dim_accounts"
[0m15:52:49.682337 [debug] [Thread-3 (]: On model.supercell.dim_accounts: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.dim_accounts"} */

  
    
    

    create  table
      "supercell"."main"."dim_accounts__dbt_tmp"
  
    as (
      


select
    linked_account_id as linked_account_id,
    tag_keys as tag_keys,
    tag_values as tag_values
from "supercell"."main"."cleaned_usagelogs"
    );
  
  
[0m15:52:49.683363 [debug] [Thread-4 (]: SQL status: OK in 0.005 seconds
[0m15:52:49.684263 [debug] [Thread-2 (]: SQL status: OK in 0.005 seconds
[0m15:52:49.685336 [debug] [Thread-4 (]: Using duckdb connection "model.supercell.dim_resource"
[0m15:52:49.686351 [debug] [Thread-2 (]: Using duckdb connection "model.supercell.fact_bill_generation"
[0m15:52:49.687503 [debug] [Thread-4 (]: On model.supercell.dim_resource: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.dim_resource"} */

  
    
    

    create  table
      "supercell"."main"."dim_resource__dbt_tmp"
  
    as (
      


select
    md5(concat(linked_account_id, '_', service_code, '_', instance_type, '_', region, '_', CAST(usage_start_date AS VARCHAR), '_', CAST(usage_end_date AS VARCHAR))) AS resource_id,
    linked_account_id as linked_account_id,
    region,
    service_code as product,
    instance_type as instance_type,
    pricing_model as pricing_model
from "supercell"."main"."cleaned_usagelogs"
    );
  
  
[0m15:52:49.688708 [debug] [Thread-2 (]: On model.supercell.fact_bill_generation: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.fact_bill_generation"} */

  
    
    

    create  table
      "supercell"."main"."fact_bill_generation__dbt_tmp"
  
    as (
      


select
    md5(concat(linked_account_id, '_', service_code, '_', instance_type, '_', region, '_', CAST(usage_start_date AS VARCHAR), '_', CAST(usage_end_date AS VARCHAR))) AS resource_id,
    usage_start_date as start_date,
    usage_end_date as bill_date,
    usage_amount as bill_amount,
    operation
from "supercell"."main"."cleaned_usagelogs"
    );
  
  
[0m15:52:49.876198 [debug] [Thread-3 (]: SQL status: OK in 0.193 seconds
[0m15:52:49.881950 [debug] [Thread-3 (]: Using duckdb connection "model.supercell.dim_accounts"
[0m15:52:49.882914 [debug] [Thread-3 (]: On model.supercell.dim_accounts: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.dim_accounts"} */
alter table "supercell"."main"."dim_accounts" rename to "dim_accounts__dbt_backup"
[0m15:52:49.884528 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m15:52:49.889642 [debug] [Thread-3 (]: Using duckdb connection "model.supercell.dim_accounts"
[0m15:52:49.890940 [debug] [Thread-3 (]: On model.supercell.dim_accounts: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.dim_accounts"} */
alter table "supercell"."main"."dim_accounts__dbt_tmp" rename to "dim_accounts"
[0m15:52:49.892484 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m15:52:49.896188 [debug] [Thread-3 (]: On model.supercell.dim_accounts: COMMIT
[0m15:52:49.897455 [debug] [Thread-3 (]: Using duckdb connection "model.supercell.dim_accounts"
[0m15:52:49.898383 [debug] [Thread-3 (]: On model.supercell.dim_accounts: COMMIT
[0m15:52:49.906043 [debug] [Thread-3 (]: SQL status: OK in 0.007 seconds
[0m15:52:49.910754 [debug] [Thread-3 (]: Using duckdb connection "model.supercell.dim_accounts"
[0m15:52:49.911711 [debug] [Thread-3 (]: On model.supercell.dim_accounts: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.dim_accounts"} */
drop table if exists "supercell"."main"."dim_accounts__dbt_backup" cascade
[0m15:52:49.915162 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m15:52:49.918464 [debug] [Thread-3 (]: On model.supercell.dim_accounts: Close
[0m15:52:49.924310 [info ] [Thread-3 (]: 2 of 5 OK created sql table model main.dim_accounts ............................ [[32mOK[0m in 0.31s]
[0m15:52:49.926313 [debug] [Thread-3 (]: Finished running node model.supercell.dim_accounts
[0m15:52:50.059321 [debug] [Thread-2 (]: SQL status: OK in 0.369 seconds
[0m15:52:50.062874 [debug] [Thread-2 (]: Using duckdb connection "model.supercell.fact_bill_generation"
[0m15:52:50.063535 [debug] [Thread-2 (]: On model.supercell.fact_bill_generation: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.fact_bill_generation"} */
alter table "supercell"."main"."fact_bill_generation" rename to "fact_bill_generation__dbt_backup"
[0m15:52:50.064756 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m15:52:50.067868 [debug] [Thread-2 (]: Using duckdb connection "model.supercell.fact_bill_generation"
[0m15:52:50.068312 [debug] [Thread-2 (]: On model.supercell.fact_bill_generation: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.fact_bill_generation"} */
alter table "supercell"."main"."fact_bill_generation__dbt_tmp" rename to "fact_bill_generation"
[0m15:52:50.069173 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m15:52:50.071326 [debug] [Thread-2 (]: On model.supercell.fact_bill_generation: COMMIT
[0m15:52:50.071813 [debug] [Thread-2 (]: Using duckdb connection "model.supercell.fact_bill_generation"
[0m15:52:50.072200 [debug] [Thread-2 (]: On model.supercell.fact_bill_generation: COMMIT
[0m15:52:50.087006 [debug] [Thread-2 (]: SQL status: OK in 0.014 seconds
[0m15:52:50.092188 [debug] [Thread-2 (]: Using duckdb connection "model.supercell.fact_bill_generation"
[0m15:52:50.092783 [debug] [Thread-2 (]: On model.supercell.fact_bill_generation: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.fact_bill_generation"} */
drop table if exists "supercell"."main"."fact_bill_generation__dbt_backup" cascade
[0m15:52:50.095121 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m15:52:50.097014 [debug] [Thread-2 (]: On model.supercell.fact_bill_generation: Close
[0m15:52:50.104283 [info ] [Thread-2 (]: 4 of 5 OK created sql table model main.fact_bill_generation .................... [[32mOK[0m in 0.48s]
[0m15:52:50.105113 [debug] [Thread-2 (]: Finished running node model.supercell.fact_bill_generation
[0m15:52:50.215166 [debug] [Thread-4 (]: SQL status: OK in 0.525 seconds
[0m15:52:50.218566 [debug] [Thread-4 (]: Using duckdb connection "model.supercell.dim_resource"
[0m15:52:50.219046 [debug] [Thread-4 (]: On model.supercell.dim_resource: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.dim_resource"} */
alter table "supercell"."main"."dim_resource" rename to "dim_resource__dbt_backup"
[0m15:52:50.219974 [debug] [Thread-4 (]: SQL status: OK in 0.000 seconds
[0m15:52:50.223083 [debug] [Thread-4 (]: Using duckdb connection "model.supercell.dim_resource"
[0m15:52:50.223572 [debug] [Thread-4 (]: On model.supercell.dim_resource: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.dim_resource"} */
alter table "supercell"."main"."dim_resource__dbt_tmp" rename to "dim_resource"
[0m15:52:50.224338 [debug] [Thread-4 (]: SQL status: OK in 0.000 seconds
[0m15:52:50.226332 [debug] [Thread-4 (]: On model.supercell.dim_resource: COMMIT
[0m15:52:50.226789 [debug] [Thread-4 (]: Using duckdb connection "model.supercell.dim_resource"
[0m15:52:50.227175 [debug] [Thread-4 (]: On model.supercell.dim_resource: COMMIT
[0m15:52:50.234488 [debug] [Thread-4 (]: SQL status: OK in 0.007 seconds
[0m15:52:50.236994 [debug] [Thread-4 (]: Using duckdb connection "model.supercell.dim_resource"
[0m15:52:50.237449 [debug] [Thread-4 (]: On model.supercell.dim_resource: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.dim_resource"} */
drop table if exists "supercell"."main"."dim_resource__dbt_backup" cascade
[0m15:52:50.239696 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m15:52:50.241309 [debug] [Thread-4 (]: On model.supercell.dim_resource: Close
[0m15:52:50.245739 [info ] [Thread-4 (]: 3 of 5 OK created sql table model main.dim_resource ............................ [[32mOK[0m in 0.63s]
[0m15:52:50.246555 [debug] [Thread-4 (]: Finished running node model.supercell.dim_resource
[0m15:52:50.248151 [debug] [Thread-1 (]: Began running node model.supercell.total_cost
[0m15:52:50.249196 [info ] [Thread-1 (]: 5 of 5 START sql table model main.total_cost ................................... [RUN]
[0m15:52:50.250189 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.supercell.cleaned_usagelogs, now model.supercell.total_cost)
[0m15:52:50.250705 [debug] [Thread-1 (]: Began compiling node model.supercell.total_cost
[0m15:52:50.255892 [debug] [Thread-1 (]: Writing injected SQL for node "model.supercell.total_cost"
[0m15:52:50.258063 [debug] [Thread-1 (]: Began executing node model.supercell.total_cost
[0m15:52:50.265409 [debug] [Thread-1 (]: Writing runtime sql for node "model.supercell.total_cost"
[0m15:52:50.266502 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.total_cost"
[0m15:52:50.267039 [debug] [Thread-1 (]: On model.supercell.total_cost: BEGIN
[0m15:52:50.267536 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:52:50.268692 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:52:50.269244 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.total_cost"
[0m15:52:50.269703 [debug] [Thread-1 (]: On model.supercell.total_cost: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.total_cost"} */

  
    
    

    create  table
      "supercell"."main"."total_cost__dbt_tmp"
  
    as (
      

with base as (
    select
        fact_bill_generation.resource_id as resource_id,
        date_trunc('month', bill_date) as month,
        bill_amount,
        dim_resource.instance_type as instance_type,
        dim_resource.product as product,
        dim_resource.region as region,
        dim_resource.pricing_model as pricing_model
    from "supercell"."main"."fact_bill_generation" as fact_bill_generation
    left join "supercell"."main"."dim_resource" as dim_resource using (resource_id) 
)

select
    month,
    sum(bill_amount) as total_cost,
    instance_type,
    product,
    region,
    pricing_model
from base
group by
    month,
    instance_type,
    product,
    region,
    pricing_model
    );
  
  
[0m15:52:50.843207 [debug] [Thread-1 (]: SQL status: OK in 0.573 seconds
[0m15:52:50.848660 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.total_cost"
[0m15:52:50.849266 [debug] [Thread-1 (]: On model.supercell.total_cost: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.total_cost"} */
alter table "supercell"."main"."total_cost" rename to "total_cost__dbt_backup"
[0m15:52:50.850885 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:52:50.854297 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.total_cost"
[0m15:52:50.854782 [debug] [Thread-1 (]: On model.supercell.total_cost: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.total_cost"} */
alter table "supercell"."main"."total_cost__dbt_tmp" rename to "total_cost"
[0m15:52:50.855663 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:52:50.857874 [debug] [Thread-1 (]: On model.supercell.total_cost: COMMIT
[0m15:52:50.858350 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.total_cost"
[0m15:52:50.858759 [debug] [Thread-1 (]: On model.supercell.total_cost: COMMIT
[0m15:52:50.862539 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m15:52:50.865641 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.total_cost"
[0m15:52:50.866152 [debug] [Thread-1 (]: On model.supercell.total_cost: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.total_cost"} */
drop table if exists "supercell"."main"."total_cost__dbt_backup" cascade
[0m15:52:50.868602 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m15:52:50.870288 [debug] [Thread-1 (]: On model.supercell.total_cost: Close
[0m15:52:50.875834 [info ] [Thread-1 (]: 5 of 5 OK created sql table model main.total_cost .............................. [[32mOK[0m in 0.63s]
[0m15:52:50.876689 [debug] [Thread-1 (]: Finished running node model.supercell.total_cost
[0m15:52:50.879514 [debug] [MainThread]: Using duckdb connection "master"
[0m15:52:50.880896 [debug] [MainThread]: On master: BEGIN
[0m15:52:50.882032 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:52:50.883504 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m15:52:50.884380 [debug] [MainThread]: On master: COMMIT
[0m15:52:50.885391 [debug] [MainThread]: Using duckdb connection "master"
[0m15:52:50.885957 [debug] [MainThread]: On master: COMMIT
[0m15:52:50.886964 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m15:52:50.887737 [debug] [MainThread]: On master: Close
[0m15:52:50.888629 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:52:50.889055 [debug] [MainThread]: Connection 'model.supercell.total_cost' was properly closed.
[0m15:52:50.889406 [debug] [MainThread]: Connection 'model.supercell.dim_accounts' was properly closed.
[0m15:52:50.889752 [debug] [MainThread]: Connection 'model.supercell.dim_resource' was properly closed.
[0m15:52:50.890117 [debug] [MainThread]: Connection 'model.supercell.fact_bill_generation' was properly closed.
[0m15:52:50.890758 [info ] [MainThread]: 
[0m15:52:50.891430 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 2.12 seconds (2.12s).
[0m15:52:50.893179 [debug] [MainThread]: Command end result
[0m15:52:50.991121 [debug] [MainThread]: Wrote artifact WritableManifest to /home/harsha/data_actions/supercell_cloudops/target/manifest.json
[0m15:52:50.993081 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/harsha/data_actions/supercell_cloudops/target/semantic_manifest.json
[0m15:52:51.000106 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/harsha/data_actions/supercell_cloudops/target/run_results.json
[0m15:52:51.000565 [info ] [MainThread]: 
[0m15:52:51.001025 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:52:51.001381 [info ] [MainThread]: 
[0m15:52:51.001774 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m15:52:51.002974 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 3.1424546, "process_in_blocks": "0", "process_kernel_time": 0.643402, "process_mem_max_rss": "337680", "process_out_blocks": "59744", "process_user_time": 10.482266}
[0m15:52:51.003614 [debug] [MainThread]: Command `dbt run` succeeded at 15:52:51.003438 after 3.14 seconds
[0m15:52:51.004137 [debug] [MainThread]: Flushing usage events


============================== 15:56:04.581054 | b3be73c1-927d-4d25-aa95-54ea2f6a6d0e ==============================
[0m15:56:04.581054 [info ] [MainThread]: Running with dbt=1.9.4
[0m15:56:04.587446 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/harsha/data_actions/supercell_cloudops', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/home/harsha/data_actions/supercell_cloudops/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'False'}
[0m15:56:04.588421 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality

User config should be moved from the 'config' key in profiles.yml to the 'flags' key in dbt_project.yml.
[0m15:56:04.908803 [info ] [MainThread]: Registered adapter: duckdb=1.9.3
[0m15:56:04.985653 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m15:56:05.068623 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:56:05.069392 [debug] [MainThread]: Partial parsing: updated file: supercell://models/supercell_models/metrics/total_cost.sql
[0m15:56:05.352904 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.supercell.example
[0m15:56:05.416306 [debug] [MainThread]: Wrote artifact WritableManifest to /home/harsha/data_actions/supercell_cloudops/target/manifest.json
[0m15:56:05.418242 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/harsha/data_actions/supercell_cloudops/target/semantic_manifest.json
[0m15:56:05.431506 [info ] [MainThread]: Found 5 models, 428 macros
[0m15:56:05.433897 [info ] [MainThread]: 
[0m15:56:05.434458 [info ] [MainThread]: Concurrency: 4 threads (target='default')
[0m15:56:05.434836 [info ] [MainThread]: 
[0m15:56:05.435420 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m15:56:05.443415 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_supercell'
[0m15:56:05.494194 [debug] [ThreadPool]: Using duckdb connection "list_supercell"
[0m15:56:05.494927 [debug] [ThreadPool]: On list_supercell: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "connection_name": "list_supercell"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"supercell"'
    
  
  
[0m15:56:05.495430 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:56:05.513486 [debug] [ThreadPool]: SQL status: OK in 0.018 seconds
[0m15:56:05.515254 [debug] [ThreadPool]: On list_supercell: Close
[0m15:56:05.516469 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_supercell, now create_supercell_main)
[0m15:56:05.517084 [debug] [ThreadPool]: Creating schema "database: "supercell"
schema: "main"
"
[0m15:56:05.525207 [debug] [ThreadPool]: Using duckdb connection "create_supercell_main"
[0m15:56:05.525760 [debug] [ThreadPool]: On create_supercell_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "connection_name": "create_supercell_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='supercell'
        and type='sqlite'
    
  
[0m15:56:05.526136 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:56:05.527512 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m15:56:05.529157 [debug] [ThreadPool]: Using duckdb connection "create_supercell_main"
[0m15:56:05.529559 [debug] [ThreadPool]: On create_supercell_main: BEGIN
[0m15:56:05.530200 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m15:56:05.530543 [debug] [ThreadPool]: Using duckdb connection "create_supercell_main"
[0m15:56:05.530867 [debug] [ThreadPool]: On create_supercell_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "connection_name": "create_supercell_main"} */

    
    
        create schema if not exists "supercell"."main"
    
[0m15:56:05.531444 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m15:56:05.532564 [debug] [ThreadPool]: On create_supercell_main: COMMIT
[0m15:56:05.532952 [debug] [ThreadPool]: Using duckdb connection "create_supercell_main"
[0m15:56:05.533280 [debug] [ThreadPool]: On create_supercell_main: COMMIT
[0m15:56:05.533792 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m15:56:05.534175 [debug] [ThreadPool]: On create_supercell_main: Close
[0m15:56:05.536351 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_supercell_main, now list_supercell_main)
[0m15:56:05.546214 [debug] [ThreadPool]: Using duckdb connection "list_supercell_main"
[0m15:56:05.546981 [debug] [ThreadPool]: On list_supercell_main: BEGIN
[0m15:56:05.547600 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:56:05.549067 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m15:56:05.549711 [debug] [ThreadPool]: Using duckdb connection "list_supercell_main"
[0m15:56:05.550208 [debug] [ThreadPool]: On list_supercell_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "connection_name": "list_supercell_main"} */
select
      'supercell' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'supercell'
  
[0m15:56:05.568699 [debug] [ThreadPool]: SQL status: OK in 0.018 seconds
[0m15:56:05.570576 [debug] [ThreadPool]: On list_supercell_main: ROLLBACK
[0m15:56:05.571949 [debug] [ThreadPool]: Failed to rollback 'list_supercell_main'
[0m15:56:05.572384 [debug] [ThreadPool]: On list_supercell_main: Close
[0m15:56:05.575526 [debug] [MainThread]: Using duckdb connection "master"
[0m15:56:05.576022 [debug] [MainThread]: On master: BEGIN
[0m15:56:05.576374 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:56:05.577416 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m15:56:05.577833 [debug] [MainThread]: On master: COMMIT
[0m15:56:05.578194 [debug] [MainThread]: Using duckdb connection "master"
[0m15:56:05.578518 [debug] [MainThread]: On master: COMMIT
[0m15:56:05.579167 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m15:56:05.579723 [debug] [MainThread]: On master: Close
[0m15:56:05.584564 [debug] [Thread-1 (]: Began running node model.supercell.cleaned_usagelogs
[0m15:56:05.585736 [info ] [Thread-1 (]: 1 of 5 START sql table model main.cleaned_usagelogs ............................ [RUN]
[0m15:56:05.586520 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_supercell_main, now model.supercell.cleaned_usagelogs)
[0m15:56:05.587072 [debug] [Thread-1 (]: Began compiling node model.supercell.cleaned_usagelogs
[0m15:56:05.598764 [debug] [Thread-1 (]: Writing injected SQL for node "model.supercell.cleaned_usagelogs"
[0m15:56:05.599672 [debug] [Thread-1 (]: Began executing node model.supercell.cleaned_usagelogs
[0m15:56:05.637939 [debug] [Thread-1 (]: Writing runtime sql for node "model.supercell.cleaned_usagelogs"
[0m15:56:05.638949 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.cleaned_usagelogs"
[0m15:56:05.639438 [debug] [Thread-1 (]: On model.supercell.cleaned_usagelogs: BEGIN
[0m15:56:05.639872 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:56:05.640949 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:56:05.641371 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.cleaned_usagelogs"
[0m15:56:05.641784 [debug] [Thread-1 (]: On model.supercell.cleaned_usagelogs: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.cleaned_usagelogs"} */

  
    
    

    create  table
      "supercell"."main"."cleaned_usagelogs__dbt_tmp"
  
    as (
      


SELECT
    CAST("LinkedAccountId" AS VARCHAR) AS linked_account_id,
    CAST("bill/PayerAccountId" AS VARCHAR) AS payer_account_id,
    CAST("lineItem/UsageStartDate" AS TIMESTAMP) AS usage_start_date,
    CAST("lineItem/UsageEndDate" AS TIMESTAMP) AS usage_end_date,
    CAST("lineItem/UsageAmount" AS DECIMAL(18, 6)) AS usage_amount,
    CAST("lineItem/Operation" AS VARCHAR) AS operation,
    CAST("pricing/PricingModel" AS VARCHAR) AS pricing_model,
    CAST("resourceTags/TagKeys" AS VARCHAR) AS tag_keys,
    CAST("resourceTags/TagValues" AS VARCHAR) AS tag_values,
    CAST("product/Region" AS VARCHAR) AS region,
    CAST("product/ServiceCode" AS VARCHAR) AS service_code,
    CAST("product/InstanceType" AS VARCHAR) AS instance_type,
    CAST("amortized_cost" AS DECIMAL(18, 6)) AS amortized_cost,
    CAST("product/Description" AS VARCHAR) AS description
FROM supercell_usagelogs
    );
  
  
[0m15:56:06.207074 [debug] [Thread-1 (]: SQL status: OK in 0.565 seconds
[0m15:56:06.214619 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.cleaned_usagelogs"
[0m15:56:06.215189 [debug] [Thread-1 (]: On model.supercell.cleaned_usagelogs: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.cleaned_usagelogs"} */
alter table "supercell"."main"."cleaned_usagelogs" rename to "cleaned_usagelogs__dbt_backup"
[0m15:56:06.216262 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:56:06.219480 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.cleaned_usagelogs"
[0m15:56:06.219941 [debug] [Thread-1 (]: On model.supercell.cleaned_usagelogs: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.cleaned_usagelogs"} */
alter table "supercell"."main"."cleaned_usagelogs__dbt_tmp" rename to "cleaned_usagelogs"
[0m15:56:06.220777 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:56:06.239558 [debug] [Thread-1 (]: On model.supercell.cleaned_usagelogs: COMMIT
[0m15:56:06.240221 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.cleaned_usagelogs"
[0m15:56:06.240697 [debug] [Thread-1 (]: On model.supercell.cleaned_usagelogs: COMMIT
[0m15:56:06.262743 [debug] [Thread-1 (]: SQL status: OK in 0.021 seconds
[0m15:56:06.271921 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.cleaned_usagelogs"
[0m15:56:06.272495 [debug] [Thread-1 (]: On model.supercell.cleaned_usagelogs: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.cleaned_usagelogs"} */
drop table if exists "supercell"."main"."cleaned_usagelogs__dbt_backup" cascade
[0m15:56:06.275399 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m15:56:06.278461 [debug] [Thread-1 (]: On model.supercell.cleaned_usagelogs: Close
[0m15:56:06.283606 [info ] [Thread-1 (]: 1 of 5 OK created sql table model main.cleaned_usagelogs ....................... [[32mOK[0m in 0.70s]
[0m15:56:06.284377 [debug] [Thread-1 (]: Finished running node model.supercell.cleaned_usagelogs
[0m15:56:06.286364 [debug] [Thread-3 (]: Began running node model.supercell.dim_accounts
[0m15:56:06.287468 [debug] [Thread-4 (]: Began running node model.supercell.dim_resource
[0m15:56:06.288751 [info ] [Thread-3 (]: 2 of 5 START sql table model main.dim_accounts ................................. [RUN]
[0m15:56:06.290225 [debug] [Thread-2 (]: Began running node model.supercell.fact_bill_generation
[0m15:56:06.291767 [info ] [Thread-4 (]: 3 of 5 START sql table model main.dim_resource ................................. [RUN]
[0m15:56:06.293103 [debug] [Thread-3 (]: Acquiring new duckdb connection 'model.supercell.dim_accounts'
[0m15:56:06.294617 [info ] [Thread-2 (]: 4 of 5 START sql table model main.fact_bill_generation ......................... [RUN]
[0m15:56:06.296099 [debug] [Thread-4 (]: Acquiring new duckdb connection 'model.supercell.dim_resource'
[0m15:56:06.297077 [debug] [Thread-3 (]: Began compiling node model.supercell.dim_accounts
[0m15:56:06.298260 [debug] [Thread-2 (]: Acquiring new duckdb connection 'model.supercell.fact_bill_generation'
[0m15:56:06.299193 [debug] [Thread-4 (]: Began compiling node model.supercell.dim_resource
[0m15:56:06.308235 [debug] [Thread-3 (]: Writing injected SQL for node "model.supercell.dim_accounts"
[0m15:56:06.309829 [debug] [Thread-2 (]: Began compiling node model.supercell.fact_bill_generation
[0m15:56:06.316217 [debug] [Thread-4 (]: Writing injected SQL for node "model.supercell.dim_resource"
[0m15:56:06.321555 [debug] [Thread-2 (]: Writing injected SQL for node "model.supercell.fact_bill_generation"
[0m15:56:06.322589 [debug] [Thread-3 (]: Began executing node model.supercell.dim_accounts
[0m15:56:06.323957 [debug] [Thread-4 (]: Began executing node model.supercell.dim_resource
[0m15:56:06.328328 [debug] [Thread-3 (]: Writing runtime sql for node "model.supercell.dim_accounts"
[0m15:56:06.333681 [debug] [Thread-4 (]: Writing runtime sql for node "model.supercell.dim_resource"
[0m15:56:06.334677 [debug] [Thread-2 (]: Began executing node model.supercell.fact_bill_generation
[0m15:56:06.342063 [debug] [Thread-2 (]: Writing runtime sql for node "model.supercell.fact_bill_generation"
[0m15:56:06.343327 [debug] [Thread-4 (]: Using duckdb connection "model.supercell.dim_resource"
[0m15:56:06.344306 [debug] [Thread-4 (]: On model.supercell.dim_resource: BEGIN
[0m15:56:06.345475 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m15:56:06.346891 [debug] [Thread-3 (]: Using duckdb connection "model.supercell.dim_accounts"
[0m15:56:06.347768 [debug] [Thread-2 (]: Using duckdb connection "model.supercell.fact_bill_generation"
[0m15:56:06.348483 [debug] [Thread-3 (]: On model.supercell.dim_accounts: BEGIN
[0m15:56:06.349399 [debug] [Thread-4 (]: SQL status: OK in 0.004 seconds
[0m15:56:06.350273 [debug] [Thread-2 (]: On model.supercell.fact_bill_generation: BEGIN
[0m15:56:06.350973 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m15:56:06.351914 [debug] [Thread-4 (]: Using duckdb connection "model.supercell.dim_resource"
[0m15:56:06.352737 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m15:56:06.353822 [debug] [Thread-4 (]: On model.supercell.dim_resource: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.dim_resource"} */

  
    
    

    create  table
      "supercell"."main"."dim_resource__dbt_tmp"
  
    as (
      


select
    md5(concat(linked_account_id, '_', service_code, '_', instance_type, '_', region, '_', CAST(usage_start_date AS VARCHAR), '_', CAST(usage_end_date AS VARCHAR))) AS resource_id,
    linked_account_id as linked_account_id,
    region,
    service_code as product,
    instance_type as instance_type,
    pricing_model as pricing_model
from "supercell"."main"."cleaned_usagelogs"
    );
  
  
[0m15:56:06.354921 [debug] [Thread-3 (]: SQL status: OK in 0.004 seconds
[0m15:56:06.356440 [debug] [Thread-2 (]: SQL status: OK in 0.004 seconds
[0m15:56:06.357152 [debug] [Thread-3 (]: Using duckdb connection "model.supercell.dim_accounts"
[0m15:56:06.358055 [debug] [Thread-2 (]: Using duckdb connection "model.supercell.fact_bill_generation"
[0m15:56:06.359123 [debug] [Thread-3 (]: On model.supercell.dim_accounts: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.dim_accounts"} */

  
    
    

    create  table
      "supercell"."main"."dim_accounts__dbt_tmp"
  
    as (
      


select
    linked_account_id as linked_account_id,
    tag_keys as tag_keys,
    tag_values as tag_values
from "supercell"."main"."cleaned_usagelogs"
    );
  
  
[0m15:56:06.360065 [debug] [Thread-2 (]: On model.supercell.fact_bill_generation: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.fact_bill_generation"} */

  
    
    

    create  table
      "supercell"."main"."fact_bill_generation__dbt_tmp"
  
    as (
      


select
    md5(concat(linked_account_id, '_', service_code, '_', instance_type, '_', region, '_', CAST(usage_start_date AS VARCHAR), '_', CAST(usage_end_date AS VARCHAR))) AS resource_id,
    usage_start_date as start_date,
    usage_end_date as bill_date,
    usage_amount as bill_amount,
    operation
from "supercell"."main"."cleaned_usagelogs"
    );
  
  
[0m15:56:06.664890 [debug] [Thread-3 (]: SQL status: OK in 0.304 seconds
[0m15:56:06.671330 [debug] [Thread-3 (]: Using duckdb connection "model.supercell.dim_accounts"
[0m15:56:06.672488 [debug] [Thread-3 (]: On model.supercell.dim_accounts: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.dim_accounts"} */
alter table "supercell"."main"."dim_accounts" rename to "dim_accounts__dbt_backup"
[0m15:56:06.678293 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m15:56:06.688078 [debug] [Thread-3 (]: Using duckdb connection "model.supercell.dim_accounts"
[0m15:56:06.690172 [debug] [Thread-3 (]: On model.supercell.dim_accounts: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.dim_accounts"} */
alter table "supercell"."main"."dim_accounts__dbt_tmp" rename to "dim_accounts"
[0m15:56:06.692080 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m15:56:06.695235 [debug] [Thread-3 (]: On model.supercell.dim_accounts: COMMIT
[0m15:56:06.696332 [debug] [Thread-3 (]: Using duckdb connection "model.supercell.dim_accounts"
[0m15:56:06.697187 [debug] [Thread-3 (]: On model.supercell.dim_accounts: COMMIT
[0m15:56:06.708436 [debug] [Thread-3 (]: SQL status: OK in 0.010 seconds
[0m15:56:06.713693 [debug] [Thread-3 (]: Using duckdb connection "model.supercell.dim_accounts"
[0m15:56:06.715038 [debug] [Thread-3 (]: On model.supercell.dim_accounts: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.dim_accounts"} */
drop table if exists "supercell"."main"."dim_accounts__dbt_backup" cascade
[0m15:56:06.719538 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m15:56:06.722704 [debug] [Thread-3 (]: On model.supercell.dim_accounts: Close
[0m15:56:06.733756 [info ] [Thread-3 (]: 2 of 5 OK created sql table model main.dim_accounts ............................ [[32mOK[0m in 0.44s]
[0m15:56:06.735159 [debug] [Thread-3 (]: Finished running node model.supercell.dim_accounts
[0m15:56:06.803611 [debug] [Thread-2 (]: SQL status: OK in 0.442 seconds
[0m15:56:06.807403 [debug] [Thread-2 (]: Using duckdb connection "model.supercell.fact_bill_generation"
[0m15:56:06.808023 [debug] [Thread-2 (]: On model.supercell.fact_bill_generation: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.fact_bill_generation"} */
alter table "supercell"."main"."fact_bill_generation" rename to "fact_bill_generation__dbt_backup"
[0m15:56:06.809178 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m15:56:06.812637 [debug] [Thread-2 (]: Using duckdb connection "model.supercell.fact_bill_generation"
[0m15:56:06.813250 [debug] [Thread-2 (]: On model.supercell.fact_bill_generation: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.fact_bill_generation"} */
alter table "supercell"."main"."fact_bill_generation__dbt_tmp" rename to "fact_bill_generation"
[0m15:56:06.814959 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m15:56:06.817292 [debug] [Thread-2 (]: On model.supercell.fact_bill_generation: COMMIT
[0m15:56:06.817812 [debug] [Thread-2 (]: Using duckdb connection "model.supercell.fact_bill_generation"
[0m15:56:06.818206 [debug] [Thread-2 (]: On model.supercell.fact_bill_generation: COMMIT
[0m15:56:06.827482 [debug] [Thread-2 (]: SQL status: OK in 0.009 seconds
[0m15:56:06.833192 [debug] [Thread-2 (]: Using duckdb connection "model.supercell.fact_bill_generation"
[0m15:56:06.833846 [debug] [Thread-2 (]: On model.supercell.fact_bill_generation: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.fact_bill_generation"} */
drop table if exists "supercell"."main"."fact_bill_generation__dbt_backup" cascade
[0m15:56:06.836069 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m15:56:06.838141 [debug] [Thread-2 (]: On model.supercell.fact_bill_generation: Close
[0m15:56:06.846714 [info ] [Thread-2 (]: 4 of 5 OK created sql table model main.fact_bill_generation .................... [[32mOK[0m in 0.55s]
[0m15:56:06.847855 [debug] [Thread-2 (]: Finished running node model.supercell.fact_bill_generation
[0m15:56:06.934525 [debug] [Thread-4 (]: SQL status: OK in 0.578 seconds
[0m15:56:06.937938 [debug] [Thread-4 (]: Using duckdb connection "model.supercell.dim_resource"
[0m15:56:06.938563 [debug] [Thread-4 (]: On model.supercell.dim_resource: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.dim_resource"} */
alter table "supercell"."main"."dim_resource" rename to "dim_resource__dbt_backup"
[0m15:56:06.939692 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m15:56:06.943099 [debug] [Thread-4 (]: Using duckdb connection "model.supercell.dim_resource"
[0m15:56:06.943570 [debug] [Thread-4 (]: On model.supercell.dim_resource: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.dim_resource"} */
alter table "supercell"."main"."dim_resource__dbt_tmp" rename to "dim_resource"
[0m15:56:06.944611 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m15:56:06.946798 [debug] [Thread-4 (]: On model.supercell.dim_resource: COMMIT
[0m15:56:06.947249 [debug] [Thread-4 (]: Using duckdb connection "model.supercell.dim_resource"
[0m15:56:06.947618 [debug] [Thread-4 (]: On model.supercell.dim_resource: COMMIT
[0m15:56:06.954441 [debug] [Thread-4 (]: SQL status: OK in 0.006 seconds
[0m15:56:06.957035 [debug] [Thread-4 (]: Using duckdb connection "model.supercell.dim_resource"
[0m15:56:06.957522 [debug] [Thread-4 (]: On model.supercell.dim_resource: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.dim_resource"} */
drop table if exists "supercell"."main"."dim_resource__dbt_backup" cascade
[0m15:56:06.959893 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m15:56:06.961790 [debug] [Thread-4 (]: On model.supercell.dim_resource: Close
[0m15:56:06.965064 [info ] [Thread-4 (]: 3 of 5 OK created sql table model main.dim_resource ............................ [[32mOK[0m in 0.67s]
[0m15:56:06.965965 [debug] [Thread-4 (]: Finished running node model.supercell.dim_resource
[0m15:56:06.967306 [debug] [Thread-1 (]: Began running node model.supercell.total_cost
[0m15:56:06.968574 [info ] [Thread-1 (]: 5 of 5 START sql table model main.total_cost ................................... [RUN]
[0m15:56:06.969600 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.supercell.cleaned_usagelogs, now model.supercell.total_cost)
[0m15:56:06.970463 [debug] [Thread-1 (]: Began compiling node model.supercell.total_cost
[0m15:56:06.978111 [debug] [Thread-1 (]: Writing injected SQL for node "model.supercell.total_cost"
[0m15:56:06.979633 [debug] [Thread-1 (]: Began executing node model.supercell.total_cost
[0m15:56:06.985634 [debug] [Thread-1 (]: Writing runtime sql for node "model.supercell.total_cost"
[0m15:56:06.987150 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.total_cost"
[0m15:56:06.988073 [debug] [Thread-1 (]: On model.supercell.total_cost: BEGIN
[0m15:56:06.989212 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:56:06.991580 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m15:56:06.992589 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.total_cost"
[0m15:56:06.993378 [debug] [Thread-1 (]: On model.supercell.total_cost: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.total_cost"} */

  
    
    

    create  table
      "supercell"."main"."total_cost__dbt_tmp"
  
    as (
      

with base as (
    select
        fact_bill_generation.resource_id as resource_id,
        date_trunc('month', bill_date) as month,
        bill_amount,
        dim_resource.instance_type as instance_type,
        dim_resource.product as product,
        dim_resource.region as region,
        dim_resource.pricing_model as pricing_model,
        dim_accounts.tag_keys as tag_keys,
        dim_accounts.tag_values as tag_values

    from "supercell"."main"."fact_bill_generation" as fact_bill_generation
    on left join "supercell"."main"."dim_resource" as dim_resource using fact_bill_generation.resource_id dim_resource.resource_id
    on left join "supercell"."main"."dim_accounts" as dim_accounts using dim_resource.linked_account_id dim_accounts.linked_account_id
)

select
    month,
    sum(bill_amount) as total_cost,
    instance_type,
    product,
    region,
    pricing_model
from base
group by
    month,
    instance_type,
    product,
    region,
    pricing_model
    );
  
  
[0m15:56:06.994919 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.total_cost"} */

  
    
    

    create  table
      "supercell"."main"."total_cost__dbt_tmp"
  
    as (
      

with base as (
    select
        fact_bill_generation.resource_id as resource_id,
        date_trunc('month', bill_date) as month,
        bill_amount,
        dim_resource.instance_type as instance_type,
        dim_resource.product as product,
        dim_resource.region as region,
        dim_resource.pricing_model as pricing_model,
        dim_accounts.tag_keys as tag_keys,
        dim_accounts.tag_values as tag_values

    from "supercell"."main"."fact_bill_generation" as fact_bill_generation
    on left join "supercell"."main"."dim_resource" as dim_resource using fact_bill_generation.resource_id dim_resource.resource_id
    on left join "supercell"."main"."dim_accounts" as dim_accounts using dim_resource.linked_account_id dim_accounts.linked_account_id
)

select
    month,
    sum(bill_amount) as total_cost,
    instance_type,
    product,
    region,
    pricing_model
from base
group by
    month,
    instance_type,
    product,
    region,
    pricing_model
    );
  
  
[0m15:56:06.995991 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m15:56:06.997252 [debug] [Thread-1 (]: On model.supercell.total_cost: ROLLBACK
[0m15:56:07.004635 [debug] [Thread-1 (]: Failed to rollback 'model.supercell.total_cost'
[0m15:56:07.006412 [debug] [Thread-1 (]: On model.supercell.total_cost: Close
[0m15:56:07.011234 [debug] [Thread-1 (]: Runtime Error in model total_cost (models/supercell_models/metrics/total_cost.sql)
  Parser Error: syntax error at or near "on"
[0m15:56:07.012798 [error] [Thread-1 (]: 5 of 5 ERROR creating sql table model main.total_cost .......................... [[31mERROR[0m in 0.04s]
[0m15:56:07.014077 [debug] [Thread-1 (]: Finished running node model.supercell.total_cost
[0m15:56:07.015288 [debug] [Thread-7 (]: Marking all children of 'model.supercell.total_cost' to be skipped because of status 'error'.  Reason: Runtime Error in model total_cost (models/supercell_models/metrics/total_cost.sql)
  Parser Error: syntax error at or near "on".
[0m15:56:07.019047 [debug] [MainThread]: Using duckdb connection "master"
[0m15:56:07.019852 [debug] [MainThread]: On master: BEGIN
[0m15:56:07.020508 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:56:07.021945 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m15:56:07.022665 [debug] [MainThread]: On master: COMMIT
[0m15:56:07.023307 [debug] [MainThread]: Using duckdb connection "master"
[0m15:56:07.023935 [debug] [MainThread]: On master: COMMIT
[0m15:56:07.025167 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m15:56:07.025760 [debug] [MainThread]: On master: Close
[0m15:56:07.026533 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:56:07.026995 [debug] [MainThread]: Connection 'model.supercell.total_cost' was properly closed.
[0m15:56:07.027323 [debug] [MainThread]: Connection 'model.supercell.dim_accounts' was properly closed.
[0m15:56:07.027658 [debug] [MainThread]: Connection 'model.supercell.dim_resource' was properly closed.
[0m15:56:07.028093 [debug] [MainThread]: Connection 'model.supercell.fact_bill_generation' was properly closed.
[0m15:56:07.028747 [info ] [MainThread]: 
[0m15:56:07.029302 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 1.59 seconds (1.59s).
[0m15:56:07.030981 [debug] [MainThread]: Command end result
[0m15:56:07.053990 [debug] [MainThread]: Wrote artifact WritableManifest to /home/harsha/data_actions/supercell_cloudops/target/manifest.json
[0m15:56:07.057550 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/harsha/data_actions/supercell_cloudops/target/semantic_manifest.json
[0m15:56:07.065951 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/harsha/data_actions/supercell_cloudops/target/run_results.json
[0m15:56:07.066463 [info ] [MainThread]: 
[0m15:56:07.066923 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m15:56:07.067293 [info ] [MainThread]: 
[0m15:56:07.067706 [error] [MainThread]:   Runtime Error in model total_cost (models/supercell_models/metrics/total_cost.sql)
  Parser Error: syntax error at or near "on"
[0m15:56:07.068035 [info ] [MainThread]: 
[0m15:56:07.068379 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
[0m15:56:07.069395 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 2.552685, "process_in_blocks": "0", "process_kernel_time": 0.695211, "process_mem_max_rss": "366912", "process_out_blocks": "59712", "process_user_time": 8.154375}
[0m15:56:07.070124 [debug] [MainThread]: Command `dbt run` failed at 15:56:07.069990 after 2.55 seconds
[0m15:56:07.070663 [debug] [MainThread]: Flushing usage events


============================== 15:57:06.729427 | 1e733fa3-6015-428c-bbc4-35e19a7b5ead ==============================
[0m15:57:06.729427 [info ] [MainThread]: Running with dbt=1.9.4
[0m15:57:06.735163 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/harsha/data_actions/supercell_cloudops', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/harsha/data_actions/supercell_cloudops/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'invocation_command': 'dbt run', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'False'}
[0m15:57:06.736090 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality

User config should be moved from the 'config' key in profiles.yml to the 'flags' key in dbt_project.yml.
[0m15:57:07.085571 [info ] [MainThread]: Registered adapter: duckdb=1.9.3
[0m15:57:07.160358 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m15:57:07.243229 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:57:07.244038 [debug] [MainThread]: Partial parsing: updated file: supercell://models/supercell_models/metrics/total_cost.sql
[0m15:57:07.538502 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.supercell.example
[0m15:57:07.603430 [debug] [MainThread]: Wrote artifact WritableManifest to /home/harsha/data_actions/supercell_cloudops/target/manifest.json
[0m15:57:07.605224 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/harsha/data_actions/supercell_cloudops/target/semantic_manifest.json
[0m15:57:07.618376 [info ] [MainThread]: Found 5 models, 428 macros
[0m15:57:07.620635 [info ] [MainThread]: 
[0m15:57:07.621260 [info ] [MainThread]: Concurrency: 4 threads (target='default')
[0m15:57:07.621633 [info ] [MainThread]: 
[0m15:57:07.622216 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m15:57:07.630378 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_supercell'
[0m15:57:07.676915 [debug] [ThreadPool]: Using duckdb connection "list_supercell"
[0m15:57:07.677538 [debug] [ThreadPool]: On list_supercell: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "connection_name": "list_supercell"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"supercell"'
    
  
  
[0m15:57:07.677991 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:57:07.693322 [debug] [ThreadPool]: SQL status: OK in 0.015 seconds
[0m15:57:07.695047 [debug] [ThreadPool]: On list_supercell: Close
[0m15:57:07.696043 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_supercell, now create_supercell_main)
[0m15:57:07.696640 [debug] [ThreadPool]: Creating schema "database: "supercell"
schema: "main"
"
[0m15:57:07.704469 [debug] [ThreadPool]: Using duckdb connection "create_supercell_main"
[0m15:57:07.704932 [debug] [ThreadPool]: On create_supercell_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "connection_name": "create_supercell_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='supercell'
        and type='sqlite'
    
  
[0m15:57:07.705275 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:57:07.706481 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m15:57:07.708129 [debug] [ThreadPool]: Using duckdb connection "create_supercell_main"
[0m15:57:07.708541 [debug] [ThreadPool]: On create_supercell_main: BEGIN
[0m15:57:07.709197 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m15:57:07.709559 [debug] [ThreadPool]: Using duckdb connection "create_supercell_main"
[0m15:57:07.709900 [debug] [ThreadPool]: On create_supercell_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "connection_name": "create_supercell_main"} */

    
    
        create schema if not exists "supercell"."main"
    
[0m15:57:07.710474 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m15:57:07.711488 [debug] [ThreadPool]: On create_supercell_main: COMMIT
[0m15:57:07.711902 [debug] [ThreadPool]: Using duckdb connection "create_supercell_main"
[0m15:57:07.712237 [debug] [ThreadPool]: On create_supercell_main: COMMIT
[0m15:57:07.712741 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m15:57:07.713103 [debug] [ThreadPool]: On create_supercell_main: Close
[0m15:57:07.714982 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_supercell_main, now list_supercell_main)
[0m15:57:07.723901 [debug] [ThreadPool]: Using duckdb connection "list_supercell_main"
[0m15:57:07.724406 [debug] [ThreadPool]: On list_supercell_main: BEGIN
[0m15:57:07.724769 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:57:07.725676 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m15:57:07.726070 [debug] [ThreadPool]: Using duckdb connection "list_supercell_main"
[0m15:57:07.726423 [debug] [ThreadPool]: On list_supercell_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "connection_name": "list_supercell_main"} */
select
      'supercell' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'supercell'
  
[0m15:57:07.746234 [debug] [ThreadPool]: SQL status: OK in 0.019 seconds
[0m15:57:07.748409 [debug] [ThreadPool]: On list_supercell_main: ROLLBACK
[0m15:57:07.749990 [debug] [ThreadPool]: Failed to rollback 'list_supercell_main'
[0m15:57:07.750491 [debug] [ThreadPool]: On list_supercell_main: Close
[0m15:57:07.753440 [debug] [MainThread]: Using duckdb connection "master"
[0m15:57:07.754022 [debug] [MainThread]: On master: BEGIN
[0m15:57:07.754453 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:57:07.755348 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m15:57:07.755831 [debug] [MainThread]: On master: COMMIT
[0m15:57:07.756237 [debug] [MainThread]: Using duckdb connection "master"
[0m15:57:07.756636 [debug] [MainThread]: On master: COMMIT
[0m15:57:07.757682 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m15:57:07.758272 [debug] [MainThread]: On master: Close
[0m15:57:07.762545 [debug] [Thread-1 (]: Began running node model.supercell.cleaned_usagelogs
[0m15:57:07.763609 [info ] [Thread-1 (]: 1 of 5 START sql table model main.cleaned_usagelogs ............................ [RUN]
[0m15:57:07.764507 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_supercell_main, now model.supercell.cleaned_usagelogs)
[0m15:57:07.765278 [debug] [Thread-1 (]: Began compiling node model.supercell.cleaned_usagelogs
[0m15:57:07.781350 [debug] [Thread-1 (]: Writing injected SQL for node "model.supercell.cleaned_usagelogs"
[0m15:57:07.782728 [debug] [Thread-1 (]: Began executing node model.supercell.cleaned_usagelogs
[0m15:57:07.828392 [debug] [Thread-1 (]: Writing runtime sql for node "model.supercell.cleaned_usagelogs"
[0m15:57:07.829438 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.cleaned_usagelogs"
[0m15:57:07.830000 [debug] [Thread-1 (]: On model.supercell.cleaned_usagelogs: BEGIN
[0m15:57:07.830396 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:57:07.831583 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:57:07.832075 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.cleaned_usagelogs"
[0m15:57:07.832509 [debug] [Thread-1 (]: On model.supercell.cleaned_usagelogs: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.cleaned_usagelogs"} */

  
    
    

    create  table
      "supercell"."main"."cleaned_usagelogs__dbt_tmp"
  
    as (
      


SELECT
    CAST("LinkedAccountId" AS VARCHAR) AS linked_account_id,
    CAST("bill/PayerAccountId" AS VARCHAR) AS payer_account_id,
    CAST("lineItem/UsageStartDate" AS TIMESTAMP) AS usage_start_date,
    CAST("lineItem/UsageEndDate" AS TIMESTAMP) AS usage_end_date,
    CAST("lineItem/UsageAmount" AS DECIMAL(18, 6)) AS usage_amount,
    CAST("lineItem/Operation" AS VARCHAR) AS operation,
    CAST("pricing/PricingModel" AS VARCHAR) AS pricing_model,
    CAST("resourceTags/TagKeys" AS VARCHAR) AS tag_keys,
    CAST("resourceTags/TagValues" AS VARCHAR) AS tag_values,
    CAST("product/Region" AS VARCHAR) AS region,
    CAST("product/ServiceCode" AS VARCHAR) AS service_code,
    CAST("product/InstanceType" AS VARCHAR) AS instance_type,
    CAST("amortized_cost" AS DECIMAL(18, 6)) AS amortized_cost,
    CAST("product/Description" AS VARCHAR) AS description
FROM supercell_usagelogs
    );
  
  
[0m15:57:08.389543 [debug] [Thread-1 (]: SQL status: OK in 0.556 seconds
[0m15:57:08.397238 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.cleaned_usagelogs"
[0m15:57:08.397827 [debug] [Thread-1 (]: On model.supercell.cleaned_usagelogs: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.cleaned_usagelogs"} */
alter table "supercell"."main"."cleaned_usagelogs" rename to "cleaned_usagelogs__dbt_backup"
[0m15:57:08.399024 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:57:08.402299 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.cleaned_usagelogs"
[0m15:57:08.402792 [debug] [Thread-1 (]: On model.supercell.cleaned_usagelogs: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.cleaned_usagelogs"} */
alter table "supercell"."main"."cleaned_usagelogs__dbt_tmp" rename to "cleaned_usagelogs"
[0m15:57:08.403636 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:57:08.424362 [debug] [Thread-1 (]: On model.supercell.cleaned_usagelogs: COMMIT
[0m15:57:08.425167 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.cleaned_usagelogs"
[0m15:57:08.425630 [debug] [Thread-1 (]: On model.supercell.cleaned_usagelogs: COMMIT
[0m15:57:08.444150 [debug] [Thread-1 (]: SQL status: OK in 0.018 seconds
[0m15:57:08.454594 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.cleaned_usagelogs"
[0m15:57:08.455215 [debug] [Thread-1 (]: On model.supercell.cleaned_usagelogs: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.cleaned_usagelogs"} */
drop table if exists "supercell"."main"."cleaned_usagelogs__dbt_backup" cascade
[0m15:57:08.457946 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m15:57:08.464566 [debug] [Thread-1 (]: On model.supercell.cleaned_usagelogs: Close
[0m15:57:08.469579 [info ] [Thread-1 (]: 1 of 5 OK created sql table model main.cleaned_usagelogs ....................... [[32mOK[0m in 0.70s]
[0m15:57:08.470596 [debug] [Thread-1 (]: Finished running node model.supercell.cleaned_usagelogs
[0m15:57:08.472242 [debug] [Thread-3 (]: Began running node model.supercell.dim_accounts
[0m15:57:08.473233 [debug] [Thread-4 (]: Began running node model.supercell.dim_resource
[0m15:57:08.474687 [debug] [Thread-2 (]: Began running node model.supercell.fact_bill_generation
[0m15:57:08.475915 [info ] [Thread-3 (]: 2 of 5 START sql table model main.dim_accounts ................................. [RUN]
[0m15:57:08.477478 [info ] [Thread-4 (]: 3 of 5 START sql table model main.dim_resource ................................. [RUN]
[0m15:57:08.479353 [info ] [Thread-2 (]: 4 of 5 START sql table model main.fact_bill_generation ......................... [RUN]
[0m15:57:08.480511 [debug] [Thread-3 (]: Acquiring new duckdb connection 'model.supercell.dim_accounts'
[0m15:57:08.481762 [debug] [Thread-4 (]: Acquiring new duckdb connection 'model.supercell.dim_resource'
[0m15:57:08.482905 [debug] [Thread-2 (]: Acquiring new duckdb connection 'model.supercell.fact_bill_generation'
[0m15:57:08.483683 [debug] [Thread-3 (]: Began compiling node model.supercell.dim_accounts
[0m15:57:08.484663 [debug] [Thread-4 (]: Began compiling node model.supercell.dim_resource
[0m15:57:08.485572 [debug] [Thread-2 (]: Began compiling node model.supercell.fact_bill_generation
[0m15:57:08.496730 [debug] [Thread-3 (]: Writing injected SQL for node "model.supercell.dim_accounts"
[0m15:57:08.506841 [debug] [Thread-4 (]: Writing injected SQL for node "model.supercell.dim_resource"
[0m15:57:08.515072 [debug] [Thread-2 (]: Writing injected SQL for node "model.supercell.fact_bill_generation"
[0m15:57:08.517751 [debug] [Thread-3 (]: Began executing node model.supercell.dim_accounts
[0m15:57:08.519605 [debug] [Thread-4 (]: Began executing node model.supercell.dim_resource
[0m15:57:08.530525 [debug] [Thread-3 (]: Writing runtime sql for node "model.supercell.dim_accounts"
[0m15:57:08.537876 [debug] [Thread-2 (]: Began executing node model.supercell.fact_bill_generation
[0m15:57:08.541482 [debug] [Thread-4 (]: Writing runtime sql for node "model.supercell.dim_resource"
[0m15:57:08.550066 [debug] [Thread-2 (]: Writing runtime sql for node "model.supercell.fact_bill_generation"
[0m15:57:08.551910 [debug] [Thread-3 (]: Using duckdb connection "model.supercell.dim_accounts"
[0m15:57:08.553440 [debug] [Thread-3 (]: On model.supercell.dim_accounts: BEGIN
[0m15:57:08.554430 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m15:57:08.556141 [debug] [Thread-4 (]: Using duckdb connection "model.supercell.dim_resource"
[0m15:57:08.557392 [debug] [Thread-4 (]: On model.supercell.dim_resource: BEGIN
[0m15:57:08.558300 [debug] [Thread-3 (]: SQL status: OK in 0.004 seconds
[0m15:57:08.559319 [debug] [Thread-2 (]: Using duckdb connection "model.supercell.fact_bill_generation"
[0m15:57:08.560534 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m15:57:08.561996 [debug] [Thread-3 (]: Using duckdb connection "model.supercell.dim_accounts"
[0m15:57:08.563345 [debug] [Thread-2 (]: On model.supercell.fact_bill_generation: BEGIN
[0m15:57:08.565484 [debug] [Thread-3 (]: On model.supercell.dim_accounts: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.dim_accounts"} */

  
    
    

    create  table
      "supercell"."main"."dim_accounts__dbt_tmp"
  
    as (
      


select
    linked_account_id as linked_account_id,
    tag_keys as tag_keys,
    tag_values as tag_values
from "supercell"."main"."cleaned_usagelogs"
    );
  
  
[0m15:57:08.566905 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m15:57:08.568113 [debug] [Thread-4 (]: SQL status: OK in 0.007 seconds
[0m15:57:08.570904 [debug] [Thread-4 (]: Using duckdb connection "model.supercell.dim_resource"
[0m15:57:08.572624 [debug] [Thread-4 (]: On model.supercell.dim_resource: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.dim_resource"} */

  
    
    

    create  table
      "supercell"."main"."dim_resource__dbt_tmp"
  
    as (
      


select
    md5(concat(linked_account_id, '_', service_code, '_', instance_type, '_', region, '_', CAST(usage_start_date AS VARCHAR), '_', CAST(usage_end_date AS VARCHAR))) AS resource_id,
    linked_account_id as linked_account_id,
    region,
    service_code as product,
    instance_type as instance_type,
    pricing_model as pricing_model
from "supercell"."main"."cleaned_usagelogs"
    );
  
  
[0m15:57:08.576311 [debug] [Thread-2 (]: SQL status: OK in 0.009 seconds
[0m15:57:08.578227 [debug] [Thread-2 (]: Using duckdb connection "model.supercell.fact_bill_generation"
[0m15:57:08.583197 [debug] [Thread-2 (]: On model.supercell.fact_bill_generation: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.fact_bill_generation"} */

  
    
    

    create  table
      "supercell"."main"."fact_bill_generation__dbt_tmp"
  
    as (
      


select
    md5(concat(linked_account_id, '_', service_code, '_', instance_type, '_', region, '_', CAST(usage_start_date AS VARCHAR), '_', CAST(usage_end_date AS VARCHAR))) AS resource_id,
    usage_start_date as start_date,
    usage_end_date as bill_date,
    usage_amount as bill_amount,
    operation
from "supercell"."main"."cleaned_usagelogs"
    );
  
  
[0m15:57:08.836467 [debug] [Thread-3 (]: SQL status: OK in 0.267 seconds
[0m15:57:08.844390 [debug] [Thread-3 (]: Using duckdb connection "model.supercell.dim_accounts"
[0m15:57:08.845610 [debug] [Thread-3 (]: On model.supercell.dim_accounts: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.dim_accounts"} */
alter table "supercell"."main"."dim_accounts" rename to "dim_accounts__dbt_backup"
[0m15:57:08.847727 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m15:57:08.853833 [debug] [Thread-3 (]: Using duckdb connection "model.supercell.dim_accounts"
[0m15:57:08.855280 [debug] [Thread-3 (]: On model.supercell.dim_accounts: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.dim_accounts"} */
alter table "supercell"."main"."dim_accounts__dbt_tmp" rename to "dim_accounts"
[0m15:57:08.857407 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m15:57:08.861623 [debug] [Thread-3 (]: On model.supercell.dim_accounts: COMMIT
[0m15:57:08.862769 [debug] [Thread-3 (]: Using duckdb connection "model.supercell.dim_accounts"
[0m15:57:08.863836 [debug] [Thread-3 (]: On model.supercell.dim_accounts: COMMIT
[0m15:57:08.875336 [debug] [Thread-3 (]: SQL status: OK in 0.010 seconds
[0m15:57:08.880689 [debug] [Thread-3 (]: Using duckdb connection "model.supercell.dim_accounts"
[0m15:57:08.882142 [debug] [Thread-3 (]: On model.supercell.dim_accounts: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.dim_accounts"} */
drop table if exists "supercell"."main"."dim_accounts__dbt_backup" cascade
[0m15:57:08.885698 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m15:57:08.888862 [debug] [Thread-3 (]: On model.supercell.dim_accounts: Close
[0m15:57:08.899273 [info ] [Thread-3 (]: 2 of 5 OK created sql table model main.dim_accounts ............................ [[32mOK[0m in 0.42s]
[0m15:57:08.901231 [debug] [Thread-3 (]: Finished running node model.supercell.dim_accounts
[0m15:57:08.969066 [debug] [Thread-2 (]: SQL status: OK in 0.381 seconds
[0m15:57:08.974782 [debug] [Thread-2 (]: Using duckdb connection "model.supercell.fact_bill_generation"
[0m15:57:08.975938 [debug] [Thread-2 (]: On model.supercell.fact_bill_generation: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.fact_bill_generation"} */
alter table "supercell"."main"."fact_bill_generation" rename to "fact_bill_generation__dbt_backup"
[0m15:57:08.977843 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m15:57:08.983205 [debug] [Thread-2 (]: Using duckdb connection "model.supercell.fact_bill_generation"
[0m15:57:08.984143 [debug] [Thread-2 (]: On model.supercell.fact_bill_generation: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.fact_bill_generation"} */
alter table "supercell"."main"."fact_bill_generation__dbt_tmp" rename to "fact_bill_generation"
[0m15:57:08.985707 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m15:57:08.989120 [debug] [Thread-2 (]: On model.supercell.fact_bill_generation: COMMIT
[0m15:57:08.989960 [debug] [Thread-2 (]: Using duckdb connection "model.supercell.fact_bill_generation"
[0m15:57:08.990714 [debug] [Thread-2 (]: On model.supercell.fact_bill_generation: COMMIT
[0m15:57:09.000552 [debug] [Thread-2 (]: SQL status: OK in 0.009 seconds
[0m15:57:09.007252 [debug] [Thread-2 (]: Using duckdb connection "model.supercell.fact_bill_generation"
[0m15:57:09.008360 [debug] [Thread-2 (]: On model.supercell.fact_bill_generation: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.fact_bill_generation"} */
drop table if exists "supercell"."main"."fact_bill_generation__dbt_backup" cascade
[0m15:57:09.011187 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m15:57:09.012994 [debug] [Thread-2 (]: On model.supercell.fact_bill_generation: Close
[0m15:57:09.018974 [info ] [Thread-2 (]: 4 of 5 OK created sql table model main.fact_bill_generation .................... [[32mOK[0m in 0.54s]
[0m15:57:09.020154 [debug] [Thread-2 (]: Finished running node model.supercell.fact_bill_generation
[0m15:57:09.132435 [debug] [Thread-4 (]: SQL status: OK in 0.559 seconds
[0m15:57:09.135766 [debug] [Thread-4 (]: Using duckdb connection "model.supercell.dim_resource"
[0m15:57:09.136273 [debug] [Thread-4 (]: On model.supercell.dim_resource: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.dim_resource"} */
alter table "supercell"."main"."dim_resource" rename to "dim_resource__dbt_backup"
[0m15:57:09.137190 [debug] [Thread-4 (]: SQL status: OK in 0.000 seconds
[0m15:57:09.140290 [debug] [Thread-4 (]: Using duckdb connection "model.supercell.dim_resource"
[0m15:57:09.140759 [debug] [Thread-4 (]: On model.supercell.dim_resource: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.dim_resource"} */
alter table "supercell"."main"."dim_resource__dbt_tmp" rename to "dim_resource"
[0m15:57:09.141858 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m15:57:09.143935 [debug] [Thread-4 (]: On model.supercell.dim_resource: COMMIT
[0m15:57:09.144419 [debug] [Thread-4 (]: Using duckdb connection "model.supercell.dim_resource"
[0m15:57:09.144851 [debug] [Thread-4 (]: On model.supercell.dim_resource: COMMIT
[0m15:57:09.151570 [debug] [Thread-4 (]: SQL status: OK in 0.006 seconds
[0m15:57:09.155567 [debug] [Thread-4 (]: Using duckdb connection "model.supercell.dim_resource"
[0m15:57:09.156375 [debug] [Thread-4 (]: On model.supercell.dim_resource: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.dim_resource"} */
drop table if exists "supercell"."main"."dim_resource__dbt_backup" cascade
[0m15:57:09.159199 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m15:57:09.161983 [debug] [Thread-4 (]: On model.supercell.dim_resource: Close
[0m15:57:09.166586 [info ] [Thread-4 (]: 3 of 5 OK created sql table model main.dim_resource ............................ [[32mOK[0m in 0.68s]
[0m15:57:09.168030 [debug] [Thread-4 (]: Finished running node model.supercell.dim_resource
[0m15:57:09.169522 [debug] [Thread-1 (]: Began running node model.supercell.total_cost
[0m15:57:09.170321 [info ] [Thread-1 (]: 5 of 5 START sql table model main.total_cost ................................... [RUN]
[0m15:57:09.171035 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.supercell.cleaned_usagelogs, now model.supercell.total_cost)
[0m15:57:09.171519 [debug] [Thread-1 (]: Began compiling node model.supercell.total_cost
[0m15:57:09.176490 [debug] [Thread-1 (]: Writing injected SQL for node "model.supercell.total_cost"
[0m15:57:09.177488 [debug] [Thread-1 (]: Began executing node model.supercell.total_cost
[0m15:57:09.182916 [debug] [Thread-1 (]: Writing runtime sql for node "model.supercell.total_cost"
[0m15:57:09.183956 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.total_cost"
[0m15:57:09.184453 [debug] [Thread-1 (]: On model.supercell.total_cost: BEGIN
[0m15:57:09.184869 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:57:09.186086 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:57:09.186669 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.total_cost"
[0m15:57:09.187148 [debug] [Thread-1 (]: On model.supercell.total_cost: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.total_cost"} */

  
    
    

    create  table
      "supercell"."main"."total_cost__dbt_tmp"
  
    as (
      

with base as (
    select
        fact_bill_generation.resource_id,
        date_trunc('month', fact_bill_generation.bill_date) as month,
        fact_bill_generation.bill_amount,
        dim_resource.instance_type,
        dim_resource.product,
        dim_resource.region,
        dim_resource.pricing_model,
        dim_accounts.tag_keys,
        dim_accounts.tag_values
    from "supercell"."main"."fact_bill_generation" as fact_bill_generation
    left join "supercell"."main"."dim_resource" as dim_resource 
        on fact_bill_generation.resource_id = dim_resource.resource_id
    left join "supercell"."main"."dim_accounts" as dim_accounts 
        on dim_resource.linked_account_id = dim_accounts.linked_account_id
)

select
    month,
    sum(bill_amount) as total_cost,
    instance_type,
    product,
    region,
    pricing_model
from base
group by
    month,
    instance_type,
    product,
    region,
    pricing_model
order by
    month,
    instance_type,
    product,
    region,
    pricing_model
    );
  
  
[0m15:58:11.603315 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/harsha/data_actions/supercell_cloudops/target/run_results.json
[0m15:58:11.605499 [debug] [MainThread]: DuckDB adapter: cancelling query on connection model.supercell.total_cost. Details: Connection(type='duckdb', name='model.supercell.total_cost', state=<ConnectionState.OPEN: 'open'>, transaction_open=True, _handle=<dbt.adapters.duckdb.environments.local.DuckDBConnectionWrapper object at 0x774db98bdb80>, _credentials=DuckDBCredentials(database='supercell', schema='main', path='/home/harsha/data_actions/supercell_cloudops/supercell.duckdb', config_options=None, extensions=None, settings={}, secrets=[], external_root='.', use_credential_provider=None, attach=None, filesystems=None, remote=None, plugins=None, disable_transactions=False, keep_open=True, module_paths=None, retries=None))
[0m15:58:11.606475 [debug] [MainThread]: DuckDB adapter: query cancelled on connection model.supercell.total_cost
[0m15:58:11.607210 [error] [MainThread]: CANCEL query model.supercell.total_cost ........................................ [[31mCANCEL[0m]
[0m15:58:11.607921 [error] [MainThread]: CANCEL query model.supercell.dim_accounts ...................................... [[31mCANCEL[0m]
[0m15:58:11.609180 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.total_cost"} */

  
    
    

    create  table
      "supercell"."main"."total_cost__dbt_tmp"
  
    as (
      

with base as (
    select
        fact_bill_generation.resource_id,
        date_trunc('month', fact_bill_generation.bill_date) as month,
        fact_bill_generation.bill_amount,
        dim_resource.instance_type,
        dim_resource.product,
        dim_resource.region,
        dim_resource.pricing_model,
        dim_accounts.tag_keys,
        dim_accounts.tag_values
    from "supercell"."main"."fact_bill_generation" as fact_bill_generation
    left join "supercell"."main"."dim_resource" as dim_resource 
        on fact_bill_generation.resource_id = dim_resource.resource_id
    left join "supercell"."main"."dim_accounts" as dim_accounts 
        on dim_resource.linked_account_id = dim_accounts.linked_account_id
)

select
    month,
    sum(bill_amount) as total_cost,
    instance_type,
    product,
    region,
    pricing_model
from base
group by
    month,
    instance_type,
    product,
    region,
    pricing_model
order by
    month,
    instance_type,
    product,
    region,
    pricing_model
    );
  
  
[0m15:58:11.610020 [error] [MainThread]: CANCEL query model.supercell.dim_resource ...................................... [[31mCANCEL[0m]
[0m15:58:11.611132 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m15:58:11.611772 [error] [MainThread]: CANCEL query model.supercell.fact_bill_generation .............................. [[31mCANCEL[0m]
[0m15:58:11.612897 [debug] [Thread-1 (]: On model.supercell.total_cost: ROLLBACK
[0m15:58:11.618234 [debug] [Thread-1 (]: Failed to rollback 'model.supercell.total_cost'
[0m15:58:11.618780 [debug] [Thread-1 (]: On model.supercell.total_cost: Close
[0m15:58:11.630335 [debug] [Thread-1 (]: Runtime Error in model total_cost (models/supercell_models/metrics/total_cost.sql)
  INTERRUPT Error: Interrupted!
[0m15:58:11.631411 [error] [Thread-1 (]: 5 of 5 ERROR creating sql table model main.total_cost .......................... [[31mERROR[0m in 62.46s]
[0m15:58:11.632138 [debug] [Thread-1 (]: Finished running node model.supercell.total_cost
[0m15:58:11.632736 [info ] [MainThread]: 
[0m15:58:11.633678 [info ] [MainThread]: [33mExited because of keyboard interrupt[0m
[0m15:58:11.634189 [info ] [MainThread]: 
[0m15:58:11.634586 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m15:58:11.634964 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:58:11.635267 [debug] [MainThread]: Connection 'model.supercell.total_cost' was properly closed.
[0m15:58:11.635553 [debug] [MainThread]: Connection 'model.supercell.dim_accounts' was properly closed.
[0m15:58:11.635872 [debug] [MainThread]: Connection 'model.supercell.dim_resource' was properly closed.
[0m15:58:11.636181 [debug] [MainThread]: Connection 'model.supercell.fact_bill_generation' was properly closed.
[0m15:58:11.636556 [info ] [MainThread]: 
[0m15:58:11.636954 [info ] [MainThread]: Finished running 4 table models in 0 hours 1 minutes and 4.01 seconds (64.01s).
[0m15:58:11.637447 [error] [MainThread]: Encountered an error:

[0m15:58:11.639472 [error] [MainThread]: Traceback (most recent call last):
  File "/home/harsha/data_actions/supercell_cloudops/supercell_env/lib/python3.12/site-packages/dbt/cli/requires.py", line 153, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "/home/harsha/data_actions/supercell_cloudops/supercell_env/lib/python3.12/site-packages/dbt/cli/requires.py", line 103, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/harsha/data_actions/supercell_cloudops/supercell_env/lib/python3.12/site-packages/dbt/cli/requires.py", line 235, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/harsha/data_actions/supercell_cloudops/supercell_env/lib/python3.12/site-packages/dbt/cli/requires.py", line 264, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/harsha/data_actions/supercell_cloudops/supercell_env/lib/python3.12/site-packages/dbt/cli/requires.py", line 311, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/harsha/data_actions/supercell_cloudops/supercell_env/lib/python3.12/site-packages/dbt/cli/requires.py", line 328, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/harsha/data_actions/supercell_cloudops/supercell_env/lib/python3.12/site-packages/dbt/cli/main.py", line 578, in run
    results = task.run()
              ^^^^^^^^^^
  File "/home/harsha/data_actions/supercell_cloudops/supercell_env/lib/python3.12/site-packages/dbt/task/runnable.py", line 590, in run
    result = self.execute_with_hooks(selected_uids)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/harsha/data_actions/supercell_cloudops/supercell_env/lib/python3.12/site-packages/dbt/task/runnable.py", line 532, in execute_with_hooks
    res = self.execute_nodes()
          ^^^^^^^^^^^^^^^^^^^^
  File "/home/harsha/data_actions/supercell_cloudops/supercell_env/lib/python3.12/site-packages/dbt/task/runnable.py", line 413, in execute_nodes
    self.run_queue(pool)
  File "/home/harsha/data_actions/supercell_cloudops/supercell_env/lib/python3.12/site-packages/dbt/task/runnable.py", line 340, in run_queue
    self.job_queue.join()
  File "/home/harsha/data_actions/supercell_cloudops/supercell_env/lib/python3.12/site-packages/dbt/graph/queue.py", line 206, in join
    self.inner.join()
  File "/usr/lib/python3.12/queue.py", line 90, in join
    self.all_tasks_done.wait()
  File "/usr/lib/python3.12/threading.py", line 355, in wait
    waiter.acquire()
KeyboardInterrupt

[0m15:58:11.641593 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 64.97633, "process_in_blocks": "0", "process_kernel_time": 0.770577, "process_mem_max_rss": "358588", "process_out_blocks": "58336", "process_user_time": 319.8117}
[0m15:58:11.642387 [debug] [MainThread]: Command `dbt run` failed at 15:58:11.642243 after 64.98 seconds
[0m15:58:11.642907 [debug] [MainThread]: Flushing usage events


============================== 15:58:16.704721 | 4c1a3302-d77c-4bc2-819d-c96fe0703566 ==============================
[0m15:58:16.704721 [info ] [MainThread]: Running with dbt=1.9.4
[0m15:58:16.709449 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/harsha/data_actions/supercell_cloudops', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/harsha/data_actions/supercell_cloudops/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'False'}
[0m15:58:16.709937 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality

User config should be moved from the 'config' key in profiles.yml to the 'flags' key in dbt_project.yml.
[0m15:58:17.040614 [info ] [MainThread]: Registered adapter: duckdb=1.9.3
[0m15:58:17.125449 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m15:58:17.210874 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m15:58:17.211376 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m15:58:17.221509 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.supercell.example
[0m15:58:17.313238 [debug] [MainThread]: Wrote artifact WritableManifest to /home/harsha/data_actions/supercell_cloudops/target/manifest.json
[0m15:58:17.315467 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/harsha/data_actions/supercell_cloudops/target/semantic_manifest.json
[0m15:58:17.332974 [info ] [MainThread]: Found 5 models, 428 macros
[0m15:58:17.337525 [info ] [MainThread]: 
[0m15:58:17.338491 [info ] [MainThread]: Concurrency: 4 threads (target='default')
[0m15:58:17.339207 [info ] [MainThread]: 
[0m15:58:17.341570 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m15:58:17.355902 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_supercell'
[0m15:58:17.419045 [debug] [ThreadPool]: Using duckdb connection "list_supercell"
[0m15:58:17.419605 [debug] [ThreadPool]: On list_supercell: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "connection_name": "list_supercell"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"supercell"'
    
  
  
[0m15:58:17.420017 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:58:17.436049 [debug] [ThreadPool]: SQL status: OK in 0.016 seconds
[0m15:58:17.437817 [debug] [ThreadPool]: On list_supercell: Close
[0m15:58:17.438990 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_supercell, now create_supercell_main)
[0m15:58:17.439600 [debug] [ThreadPool]: Creating schema "database: "supercell"
schema: "main"
"
[0m15:58:17.447718 [debug] [ThreadPool]: Using duckdb connection "create_supercell_main"
[0m15:58:17.448266 [debug] [ThreadPool]: On create_supercell_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "connection_name": "create_supercell_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='supercell'
        and type='sqlite'
    
  
[0m15:58:17.448664 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:58:17.450261 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m15:58:17.452455 [debug] [ThreadPool]: Using duckdb connection "create_supercell_main"
[0m15:58:17.452879 [debug] [ThreadPool]: On create_supercell_main: BEGIN
[0m15:58:17.453461 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m15:58:17.453817 [debug] [ThreadPool]: Using duckdb connection "create_supercell_main"
[0m15:58:17.454119 [debug] [ThreadPool]: On create_supercell_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "connection_name": "create_supercell_main"} */

    
    
        create schema if not exists "supercell"."main"
    
[0m15:58:17.454723 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m15:58:17.455756 [debug] [ThreadPool]: On create_supercell_main: COMMIT
[0m15:58:17.456140 [debug] [ThreadPool]: Using duckdb connection "create_supercell_main"
[0m15:58:17.456466 [debug] [ThreadPool]: On create_supercell_main: COMMIT
[0m15:58:17.456975 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m15:58:17.457370 [debug] [ThreadPool]: On create_supercell_main: Close
[0m15:58:17.459736 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_supercell_main, now list_supercell_main)
[0m15:58:17.468499 [debug] [ThreadPool]: Using duckdb connection "list_supercell_main"
[0m15:58:17.469188 [debug] [ThreadPool]: On list_supercell_main: BEGIN
[0m15:58:17.469684 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:58:17.470594 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m15:58:17.471030 [debug] [ThreadPool]: Using duckdb connection "list_supercell_main"
[0m15:58:17.471404 [debug] [ThreadPool]: On list_supercell_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "connection_name": "list_supercell_main"} */
select
      'supercell' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'supercell'
  
[0m15:58:17.497808 [debug] [ThreadPool]: SQL status: OK in 0.026 seconds
[0m15:58:17.500924 [debug] [ThreadPool]: On list_supercell_main: ROLLBACK
[0m15:58:17.503805 [debug] [ThreadPool]: Failed to rollback 'list_supercell_main'
[0m15:58:17.504454 [debug] [ThreadPool]: On list_supercell_main: Close
[0m15:58:17.507995 [debug] [MainThread]: Using duckdb connection "master"
[0m15:58:17.508596 [debug] [MainThread]: On master: BEGIN
[0m15:58:17.509060 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:58:17.510052 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m15:58:17.510533 [debug] [MainThread]: On master: COMMIT
[0m15:58:17.510986 [debug] [MainThread]: Using duckdb connection "master"
[0m15:58:17.511370 [debug] [MainThread]: On master: COMMIT
[0m15:58:17.512022 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m15:58:17.512484 [debug] [MainThread]: On master: Close
[0m15:58:17.517441 [debug] [Thread-1 (]: Began running node model.supercell.cleaned_usagelogs
[0m15:58:17.519347 [info ] [Thread-1 (]: 1 of 5 START sql table model main.cleaned_usagelogs ............................ [RUN]
[0m15:58:17.520592 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_supercell_main, now model.supercell.cleaned_usagelogs)
[0m15:58:17.521711 [debug] [Thread-1 (]: Began compiling node model.supercell.cleaned_usagelogs
[0m15:58:17.540537 [debug] [Thread-1 (]: Writing injected SQL for node "model.supercell.cleaned_usagelogs"
[0m15:58:17.542299 [debug] [Thread-1 (]: Began executing node model.supercell.cleaned_usagelogs
[0m15:58:17.602179 [debug] [Thread-1 (]: Writing runtime sql for node "model.supercell.cleaned_usagelogs"
[0m15:58:17.603132 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.cleaned_usagelogs"
[0m15:58:17.603604 [debug] [Thread-1 (]: On model.supercell.cleaned_usagelogs: BEGIN
[0m15:58:17.603998 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:58:17.605042 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:58:17.605507 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.cleaned_usagelogs"
[0m15:58:17.605955 [debug] [Thread-1 (]: On model.supercell.cleaned_usagelogs: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.cleaned_usagelogs"} */

  
    
    

    create  table
      "supercell"."main"."cleaned_usagelogs__dbt_tmp"
  
    as (
      


SELECT
    CAST("LinkedAccountId" AS VARCHAR) AS linked_account_id,
    CAST("bill/PayerAccountId" AS VARCHAR) AS payer_account_id,
    CAST("lineItem/UsageStartDate" AS TIMESTAMP) AS usage_start_date,
    CAST("lineItem/UsageEndDate" AS TIMESTAMP) AS usage_end_date,
    CAST("lineItem/UsageAmount" AS DECIMAL(18, 6)) AS usage_amount,
    CAST("lineItem/Operation" AS VARCHAR) AS operation,
    CAST("pricing/PricingModel" AS VARCHAR) AS pricing_model,
    CAST("resourceTags/TagKeys" AS VARCHAR) AS tag_keys,
    CAST("resourceTags/TagValues" AS VARCHAR) AS tag_values,
    CAST("product/Region" AS VARCHAR) AS region,
    CAST("product/ServiceCode" AS VARCHAR) AS service_code,
    CAST("product/InstanceType" AS VARCHAR) AS instance_type,
    CAST("amortized_cost" AS DECIMAL(18, 6)) AS amortized_cost,
    CAST("product/Description" AS VARCHAR) AS description
FROM supercell_usagelogs
    );
  
  
[0m15:58:18.180726 [debug] [Thread-1 (]: SQL status: OK in 0.574 seconds
[0m15:58:18.189259 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.cleaned_usagelogs"
[0m15:58:18.189852 [debug] [Thread-1 (]: On model.supercell.cleaned_usagelogs: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.cleaned_usagelogs"} */
alter table "supercell"."main"."cleaned_usagelogs" rename to "cleaned_usagelogs__dbt_backup"
[0m15:58:18.190979 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:58:18.194659 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.cleaned_usagelogs"
[0m15:58:18.195225 [debug] [Thread-1 (]: On model.supercell.cleaned_usagelogs: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.cleaned_usagelogs"} */
alter table "supercell"."main"."cleaned_usagelogs__dbt_tmp" rename to "cleaned_usagelogs"
[0m15:58:18.196268 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:58:18.218743 [debug] [Thread-1 (]: On model.supercell.cleaned_usagelogs: COMMIT
[0m15:58:18.219358 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.cleaned_usagelogs"
[0m15:58:18.219830 [debug] [Thread-1 (]: On model.supercell.cleaned_usagelogs: COMMIT
[0m15:58:18.238426 [debug] [Thread-1 (]: SQL status: OK in 0.018 seconds
[0m15:58:18.244808 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.cleaned_usagelogs"
[0m15:58:18.245307 [debug] [Thread-1 (]: On model.supercell.cleaned_usagelogs: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.cleaned_usagelogs"} */
drop table if exists "supercell"."main"."cleaned_usagelogs__dbt_backup" cascade
[0m15:58:18.248158 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m15:58:18.251208 [debug] [Thread-1 (]: On model.supercell.cleaned_usagelogs: Close
[0m15:58:18.254515 [info ] [Thread-1 (]: 1 of 5 OK created sql table model main.cleaned_usagelogs ....................... [[32mOK[0m in 0.73s]
[0m15:58:18.255285 [debug] [Thread-1 (]: Finished running node model.supercell.cleaned_usagelogs
[0m15:58:18.256937 [debug] [Thread-3 (]: Began running node model.supercell.dim_accounts
[0m15:58:18.258037 [info ] [Thread-3 (]: 2 of 5 START sql table model main.dim_accounts ................................. [RUN]
[0m15:58:18.258832 [debug] [Thread-4 (]: Began running node model.supercell.dim_resource
[0m15:58:18.259558 [debug] [Thread-2 (]: Began running node model.supercell.fact_bill_generation
[0m15:58:18.260588 [debug] [Thread-3 (]: Acquiring new duckdb connection 'model.supercell.dim_accounts'
[0m15:58:18.261411 [info ] [Thread-4 (]: 3 of 5 START sql table model main.dim_resource ................................. [RUN]
[0m15:58:18.262713 [info ] [Thread-2 (]: 4 of 5 START sql table model main.fact_bill_generation ......................... [RUN]
[0m15:58:18.264532 [debug] [Thread-3 (]: Began compiling node model.supercell.dim_accounts
[0m15:58:18.266393 [debug] [Thread-4 (]: Acquiring new duckdb connection 'model.supercell.dim_resource'
[0m15:58:18.267987 [debug] [Thread-2 (]: Acquiring new duckdb connection 'model.supercell.fact_bill_generation'
[0m15:58:18.272859 [debug] [Thread-3 (]: Writing injected SQL for node "model.supercell.dim_accounts"
[0m15:58:18.273797 [debug] [Thread-4 (]: Began compiling node model.supercell.dim_resource
[0m15:58:18.274693 [debug] [Thread-2 (]: Began compiling node model.supercell.fact_bill_generation
[0m15:58:18.281849 [debug] [Thread-4 (]: Writing injected SQL for node "model.supercell.dim_resource"
[0m15:58:18.283280 [debug] [Thread-3 (]: Began executing node model.supercell.dim_accounts
[0m15:58:18.290070 [debug] [Thread-2 (]: Writing injected SQL for node "model.supercell.fact_bill_generation"
[0m15:58:18.297158 [debug] [Thread-3 (]: Writing runtime sql for node "model.supercell.dim_accounts"
[0m15:58:18.299233 [debug] [Thread-4 (]: Began executing node model.supercell.dim_resource
[0m15:58:18.300706 [debug] [Thread-3 (]: Using duckdb connection "model.supercell.dim_accounts"
[0m15:58:18.301779 [debug] [Thread-2 (]: Began executing node model.supercell.fact_bill_generation
[0m15:58:18.308046 [debug] [Thread-4 (]: Writing runtime sql for node "model.supercell.dim_resource"
[0m15:58:18.308994 [debug] [Thread-3 (]: On model.supercell.dim_accounts: BEGIN
[0m15:58:18.318225 [debug] [Thread-2 (]: Writing runtime sql for node "model.supercell.fact_bill_generation"
[0m15:58:18.319451 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m15:58:18.320435 [debug] [Thread-4 (]: Using duckdb connection "model.supercell.dim_resource"
[0m15:58:18.322050 [debug] [Thread-4 (]: On model.supercell.dim_resource: BEGIN
[0m15:58:18.322936 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m15:58:18.323858 [debug] [Thread-3 (]: SQL status: OK in 0.004 seconds
[0m15:58:18.324959 [debug] [Thread-2 (]: Using duckdb connection "model.supercell.fact_bill_generation"
[0m15:58:18.325837 [debug] [Thread-3 (]: Using duckdb connection "model.supercell.dim_accounts"
[0m15:58:18.326783 [debug] [Thread-4 (]: SQL status: OK in 0.004 seconds
[0m15:58:18.327671 [debug] [Thread-2 (]: On model.supercell.fact_bill_generation: BEGIN
[0m15:58:18.328631 [debug] [Thread-3 (]: On model.supercell.dim_accounts: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.dim_accounts"} */

  
    
    

    create  table
      "supercell"."main"."dim_accounts__dbt_tmp"
  
    as (
      


select
    linked_account_id as linked_account_id,
    tag_keys as tag_keys,
    tag_values as tag_values
from "supercell"."main"."cleaned_usagelogs"
    );
  
  
[0m15:58:18.329470 [debug] [Thread-4 (]: Using duckdb connection "model.supercell.dim_resource"
[0m15:58:18.330389 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m15:58:18.331861 [debug] [Thread-4 (]: On model.supercell.dim_resource: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.dim_resource"} */

  
    
    

    create  table
      "supercell"."main"."dim_resource__dbt_tmp"
  
    as (
      


select
    md5(concat(linked_account_id, '_', service_code, '_', instance_type, '_', region, '_', CAST(usage_start_date AS VARCHAR), '_', CAST(usage_end_date AS VARCHAR))) AS resource_id,
    linked_account_id as linked_account_id,
    region,
    service_code as product,
    instance_type as instance_type,
    pricing_model as pricing_model
from "supercell"."main"."cleaned_usagelogs"
    );
  
  
[0m15:58:18.333881 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m15:58:18.335882 [debug] [Thread-2 (]: Using duckdb connection "model.supercell.fact_bill_generation"
[0m15:58:18.337405 [debug] [Thread-2 (]: On model.supercell.fact_bill_generation: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.fact_bill_generation"} */

  
    
    

    create  table
      "supercell"."main"."fact_bill_generation__dbt_tmp"
  
    as (
      


select
    md5(concat(linked_account_id, '_', service_code, '_', instance_type, '_', region, '_', CAST(usage_start_date AS VARCHAR), '_', CAST(usage_end_date AS VARCHAR))) AS resource_id,
    usage_start_date as start_date,
    usage_end_date as bill_date,
    usage_amount as bill_amount,
    operation
from "supercell"."main"."cleaned_usagelogs"
    );
  
  
[0m15:58:18.541578 [debug] [Thread-3 (]: SQL status: OK in 0.210 seconds
[0m15:58:18.547711 [debug] [Thread-3 (]: Using duckdb connection "model.supercell.dim_accounts"
[0m15:58:18.548818 [debug] [Thread-3 (]: On model.supercell.dim_accounts: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.dim_accounts"} */
alter table "supercell"."main"."dim_accounts" rename to "dim_accounts__dbt_backup"
[0m15:58:18.550728 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m15:58:18.556505 [debug] [Thread-3 (]: Using duckdb connection "model.supercell.dim_accounts"
[0m15:58:18.557539 [debug] [Thread-3 (]: On model.supercell.dim_accounts: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.dim_accounts"} */
alter table "supercell"."main"."dim_accounts__dbt_tmp" rename to "dim_accounts"
[0m15:58:18.559235 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m15:58:18.563102 [debug] [Thread-3 (]: On model.supercell.dim_accounts: COMMIT
[0m15:58:18.564253 [debug] [Thread-3 (]: Using duckdb connection "model.supercell.dim_accounts"
[0m15:58:18.565141 [debug] [Thread-3 (]: On model.supercell.dim_accounts: COMMIT
[0m15:58:18.574407 [debug] [Thread-3 (]: SQL status: OK in 0.008 seconds
[0m15:58:18.579900 [debug] [Thread-3 (]: Using duckdb connection "model.supercell.dim_accounts"
[0m15:58:18.581023 [debug] [Thread-3 (]: On model.supercell.dim_accounts: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.dim_accounts"} */
drop table if exists "supercell"."main"."dim_accounts__dbt_backup" cascade
[0m15:58:18.584292 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m15:58:18.587322 [debug] [Thread-3 (]: On model.supercell.dim_accounts: Close
[0m15:58:18.595053 [info ] [Thread-3 (]: 2 of 5 OK created sql table model main.dim_accounts ............................ [[32mOK[0m in 0.33s]
[0m15:58:18.596872 [debug] [Thread-3 (]: Finished running node model.supercell.dim_accounts
[0m15:58:18.763524 [debug] [Thread-2 (]: SQL status: OK in 0.425 seconds
[0m15:58:18.768305 [debug] [Thread-2 (]: Using duckdb connection "model.supercell.fact_bill_generation"
[0m15:58:18.769056 [debug] [Thread-2 (]: On model.supercell.fact_bill_generation: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.fact_bill_generation"} */
alter table "supercell"."main"."fact_bill_generation" rename to "fact_bill_generation__dbt_backup"
[0m15:58:18.770191 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m15:58:18.773225 [debug] [Thread-2 (]: Using duckdb connection "model.supercell.fact_bill_generation"
[0m15:58:18.773703 [debug] [Thread-2 (]: On model.supercell.fact_bill_generation: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.fact_bill_generation"} */
alter table "supercell"."main"."fact_bill_generation__dbt_tmp" rename to "fact_bill_generation"
[0m15:58:18.774514 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m15:58:18.776704 [debug] [Thread-2 (]: On model.supercell.fact_bill_generation: COMMIT
[0m15:58:18.777188 [debug] [Thread-2 (]: Using duckdb connection "model.supercell.fact_bill_generation"
[0m15:58:18.777575 [debug] [Thread-2 (]: On model.supercell.fact_bill_generation: COMMIT
[0m15:58:18.789122 [debug] [Thread-2 (]: SQL status: OK in 0.011 seconds
[0m15:58:18.791969 [debug] [Thread-2 (]: Using duckdb connection "model.supercell.fact_bill_generation"
[0m15:58:18.792494 [debug] [Thread-2 (]: On model.supercell.fact_bill_generation: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.fact_bill_generation"} */
drop table if exists "supercell"."main"."fact_bill_generation__dbt_backup" cascade
[0m15:58:18.794686 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m15:58:18.796339 [debug] [Thread-2 (]: On model.supercell.fact_bill_generation: Close
[0m15:58:18.807006 [info ] [Thread-2 (]: 4 of 5 OK created sql table model main.fact_bill_generation .................... [[32mOK[0m in 0.54s]
[0m15:58:18.807886 [debug] [Thread-2 (]: Finished running node model.supercell.fact_bill_generation
[0m15:58:18.839150 [debug] [Thread-4 (]: SQL status: OK in 0.506 seconds
[0m15:58:18.842538 [debug] [Thread-4 (]: Using duckdb connection "model.supercell.dim_resource"
[0m15:58:18.843051 [debug] [Thread-4 (]: On model.supercell.dim_resource: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.dim_resource"} */
alter table "supercell"."main"."dim_resource" rename to "dim_resource__dbt_backup"
[0m15:58:18.844183 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m15:58:18.847445 [debug] [Thread-4 (]: Using duckdb connection "model.supercell.dim_resource"
[0m15:58:18.848012 [debug] [Thread-4 (]: On model.supercell.dim_resource: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.dim_resource"} */
alter table "supercell"."main"."dim_resource__dbt_tmp" rename to "dim_resource"
[0m15:58:18.849042 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m15:58:18.851058 [debug] [Thread-4 (]: On model.supercell.dim_resource: COMMIT
[0m15:58:18.851519 [debug] [Thread-4 (]: Using duckdb connection "model.supercell.dim_resource"
[0m15:58:18.851935 [debug] [Thread-4 (]: On model.supercell.dim_resource: COMMIT
[0m15:58:18.861333 [debug] [Thread-4 (]: SQL status: OK in 0.009 seconds
[0m15:58:18.863817 [debug] [Thread-4 (]: Using duckdb connection "model.supercell.dim_resource"
[0m15:58:18.864293 [debug] [Thread-4 (]: On model.supercell.dim_resource: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.dim_resource"} */
drop table if exists "supercell"."main"."dim_resource__dbt_backup" cascade
[0m15:58:18.866861 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m15:58:18.868755 [debug] [Thread-4 (]: On model.supercell.dim_resource: Close
[0m15:58:18.870722 [info ] [Thread-4 (]: 3 of 5 OK created sql table model main.dim_resource ............................ [[32mOK[0m in 0.60s]
[0m15:58:18.871510 [debug] [Thread-4 (]: Finished running node model.supercell.dim_resource
[0m15:58:18.873096 [debug] [Thread-1 (]: Began running node model.supercell.total_cost
[0m15:58:18.874059 [info ] [Thread-1 (]: 5 of 5 START sql table model main.total_cost ................................... [RUN]
[0m15:58:18.874852 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.supercell.cleaned_usagelogs, now model.supercell.total_cost)
[0m15:58:18.875395 [debug] [Thread-1 (]: Began compiling node model.supercell.total_cost
[0m15:58:18.881182 [debug] [Thread-1 (]: Writing injected SQL for node "model.supercell.total_cost"
[0m15:58:18.883159 [debug] [Thread-1 (]: Began executing node model.supercell.total_cost
[0m15:58:18.887787 [debug] [Thread-1 (]: Writing runtime sql for node "model.supercell.total_cost"
[0m15:58:18.889077 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.total_cost"
[0m15:58:18.889633 [debug] [Thread-1 (]: On model.supercell.total_cost: BEGIN
[0m15:58:18.890168 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:58:18.891995 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m15:58:18.892554 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.total_cost"
[0m15:58:18.893030 [debug] [Thread-1 (]: On model.supercell.total_cost: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.total_cost"} */

  
    
    

    create  table
      "supercell"."main"."total_cost__dbt_tmp"
  
    as (
      

with base as (
    select
        fact_bill_generation.resource_id,
        date_trunc('month', fact_bill_generation.bill_date) as month,
        fact_bill_generation.bill_amount,
        dim_resource.instance_type,
        dim_resource.product,
        dim_resource.region,
        dim_resource.pricing_model,
        dim_accounts.tag_keys,
        dim_accounts.tag_values
    from "supercell"."main"."fact_bill_generation" as fact_bill_generation
    left join "supercell"."main"."dim_resource" as dim_resource 
        on fact_bill_generation.resource_id = dim_resource.resource_id
    left join "supercell"."main"."dim_accounts" as dim_accounts 
        on dim_resource.linked_account_id = dim_accounts.linked_account_id
)

select
    month,
    sum(bill_amount) as total_cost,
    instance_type,
    product,
    region,
    pricing_model
from base
group by
    month,
    instance_type,
    product,
    region,
    pricing_model
order by
    month,
    instance_type,
    product,
    region,
    pricing_model
    );
  
  
[0m15:58:36.645476 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/harsha/data_actions/supercell_cloudops/target/run_results.json
[0m15:58:36.648257 [debug] [MainThread]: DuckDB adapter: cancelling query on connection model.supercell.total_cost. Details: Connection(type='duckdb', name='model.supercell.total_cost', state=<ConnectionState.OPEN: 'open'>, transaction_open=True, _handle=<dbt.adapters.duckdb.environments.local.DuckDBConnectionWrapper object at 0x7b85d15d5220>, _credentials=DuckDBCredentials(database='supercell', schema='main', path='/home/harsha/data_actions/supercell_cloudops/supercell.duckdb', config_options=None, extensions=None, settings={}, secrets=[], external_root='.', use_credential_provider=None, attach=None, filesystems=None, remote=None, plugins=None, disable_transactions=False, keep_open=True, module_paths=None, retries=None))
[0m15:58:36.649314 [debug] [MainThread]: DuckDB adapter: query cancelled on connection model.supercell.total_cost
[0m15:58:36.650080 [error] [MainThread]: CANCEL query model.supercell.total_cost ........................................ [[31mCANCEL[0m]
[0m15:58:36.651168 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.total_cost"} */

  
    
    

    create  table
      "supercell"."main"."total_cost__dbt_tmp"
  
    as (
      

with base as (
    select
        fact_bill_generation.resource_id,
        date_trunc('month', fact_bill_generation.bill_date) as month,
        fact_bill_generation.bill_amount,
        dim_resource.instance_type,
        dim_resource.product,
        dim_resource.region,
        dim_resource.pricing_model,
        dim_accounts.tag_keys,
        dim_accounts.tag_values
    from "supercell"."main"."fact_bill_generation" as fact_bill_generation
    left join "supercell"."main"."dim_resource" as dim_resource 
        on fact_bill_generation.resource_id = dim_resource.resource_id
    left join "supercell"."main"."dim_accounts" as dim_accounts 
        on dim_resource.linked_account_id = dim_accounts.linked_account_id
)

select
    month,
    sum(bill_amount) as total_cost,
    instance_type,
    product,
    region,
    pricing_model
from base
group by
    month,
    instance_type,
    product,
    region,
    pricing_model
order by
    month,
    instance_type,
    product,
    region,
    pricing_model
    );
  
  
[0m15:58:36.651982 [error] [MainThread]: CANCEL query model.supercell.dim_accounts ...................................... [[31mCANCEL[0m]
[0m15:58:36.652902 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m15:58:36.654495 [debug] [Thread-1 (]: On model.supercell.total_cost: ROLLBACK
[0m15:58:36.653668 [error] [MainThread]: CANCEL query model.supercell.dim_resource ...................................... [[31mCANCEL[0m]
[0m15:58:36.656799 [error] [MainThread]: CANCEL query model.supercell.fact_bill_generation .............................. [[31mCANCEL[0m]
[0m15:58:36.660552 [debug] [Thread-1 (]: Failed to rollback 'model.supercell.total_cost'
[0m15:58:36.661218 [debug] [Thread-1 (]: On model.supercell.total_cost: Close
[0m15:58:36.677910 [debug] [Thread-1 (]: Runtime Error in model total_cost (models/supercell_models/metrics/total_cost.sql)
  INTERRUPT Error: Interrupted!
[0m15:58:36.678998 [error] [Thread-1 (]: 5 of 5 ERROR creating sql table model main.total_cost .......................... [[31mERROR[0m in 17.80s]
[0m15:58:36.679798 [debug] [Thread-1 (]: Finished running node model.supercell.total_cost
[0m15:58:36.680362 [info ] [MainThread]: 
[0m15:58:36.681437 [info ] [MainThread]: [33mExited because of keyboard interrupt[0m
[0m15:58:36.682305 [info ] [MainThread]: 
[0m15:58:36.683215 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m15:58:36.684053 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:58:36.684816 [debug] [MainThread]: Connection 'model.supercell.total_cost' was properly closed.
[0m15:58:36.685508 [debug] [MainThread]: Connection 'model.supercell.dim_accounts' was properly closed.
[0m15:58:36.686141 [debug] [MainThread]: Connection 'model.supercell.dim_resource' was properly closed.
[0m15:58:36.686683 [debug] [MainThread]: Connection 'model.supercell.fact_bill_generation' was properly closed.
[0m15:58:36.687355 [info ] [MainThread]: 
[0m15:58:36.688003 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 19.35 seconds (19.35s).
[0m15:58:36.688821 [error] [MainThread]: Encountered an error:

[0m15:58:36.692572 [error] [MainThread]: Traceback (most recent call last):
  File "/home/harsha/data_actions/supercell_cloudops/supercell_env/lib/python3.12/site-packages/dbt/cli/requires.py", line 153, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "/home/harsha/data_actions/supercell_cloudops/supercell_env/lib/python3.12/site-packages/dbt/cli/requires.py", line 103, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/harsha/data_actions/supercell_cloudops/supercell_env/lib/python3.12/site-packages/dbt/cli/requires.py", line 235, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/harsha/data_actions/supercell_cloudops/supercell_env/lib/python3.12/site-packages/dbt/cli/requires.py", line 264, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/harsha/data_actions/supercell_cloudops/supercell_env/lib/python3.12/site-packages/dbt/cli/requires.py", line 311, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/harsha/data_actions/supercell_cloudops/supercell_env/lib/python3.12/site-packages/dbt/cli/requires.py", line 328, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/harsha/data_actions/supercell_cloudops/supercell_env/lib/python3.12/site-packages/dbt/cli/main.py", line 578, in run
    results = task.run()
              ^^^^^^^^^^
  File "/home/harsha/data_actions/supercell_cloudops/supercell_env/lib/python3.12/site-packages/dbt/task/runnable.py", line 590, in run
    result = self.execute_with_hooks(selected_uids)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/harsha/data_actions/supercell_cloudops/supercell_env/lib/python3.12/site-packages/dbt/task/runnable.py", line 532, in execute_with_hooks
    res = self.execute_nodes()
          ^^^^^^^^^^^^^^^^^^^^
  File "/home/harsha/data_actions/supercell_cloudops/supercell_env/lib/python3.12/site-packages/dbt/task/runnable.py", line 413, in execute_nodes
    self.run_queue(pool)
  File "/home/harsha/data_actions/supercell_cloudops/supercell_env/lib/python3.12/site-packages/dbt/task/runnable.py", line 340, in run_queue
    self.job_queue.join()
  File "/home/harsha/data_actions/supercell_cloudops/supercell_env/lib/python3.12/site-packages/dbt/graph/queue.py", line 206, in join
    self.inner.join()
  File "/usr/lib/python3.12/queue.py", line 90, in join
    self.all_tasks_done.wait()
  File "/usr/lib/python3.12/threading.py", line 355, in wait
    waiter.acquire()
KeyboardInterrupt

[0m15:58:36.695158 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 20.055244, "process_in_blocks": "0", "process_kernel_time": 0.829731, "process_mem_max_rss": "335116", "process_out_blocks": "57464", "process_user_time": 96.80067}
[0m15:58:36.696321 [debug] [MainThread]: Command `dbt run` failed at 15:58:36.696072 after 20.06 seconds
[0m15:58:36.697287 [debug] [MainThread]: Flushing usage events


============================== 15:58:40.023154 | 915c6d6e-f44f-4f61-96ec-fce071f5f61f ==============================
[0m15:58:40.023154 [info ] [MainThread]: Running with dbt=1.9.4
[0m15:58:40.028570 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/harsha/data_actions/supercell_cloudops', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/harsha/data_actions/supercell_cloudops/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'False'}
[0m15:58:40.029365 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality

User config should be moved from the 'config' key in profiles.yml to the 'flags' key in dbt_project.yml.
[0m15:58:40.345259 [info ] [MainThread]: Registered adapter: duckdb=1.9.3
[0m15:58:40.417317 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m15:58:40.502370 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m15:58:40.503173 [debug] [MainThread]: Partial parsing: updated file: supercell://models/supercell_models/metrics/total_cost.sql
[0m15:58:40.789897 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.supercell.example
[0m15:58:40.866500 [debug] [MainThread]: Wrote artifact WritableManifest to /home/harsha/data_actions/supercell_cloudops/target/manifest.json
[0m15:58:40.868419 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/harsha/data_actions/supercell_cloudops/target/semantic_manifest.json
[0m15:58:40.881357 [info ] [MainThread]: Found 5 models, 428 macros
[0m15:58:40.883877 [info ] [MainThread]: 
[0m15:58:40.884470 [info ] [MainThread]: Concurrency: 4 threads (target='default')
[0m15:58:40.884852 [info ] [MainThread]: 
[0m15:58:40.885472 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m15:58:40.893692 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_supercell'
[0m15:58:40.935916 [debug] [ThreadPool]: Using duckdb connection "list_supercell"
[0m15:58:40.936452 [debug] [ThreadPool]: On list_supercell: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "connection_name": "list_supercell"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"supercell"'
    
  
  
[0m15:58:40.936838 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m15:58:40.952134 [debug] [ThreadPool]: SQL status: OK in 0.015 seconds
[0m15:58:40.953851 [debug] [ThreadPool]: On list_supercell: Close
[0m15:58:40.955041 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_supercell, now create_supercell_main)
[0m15:58:40.955643 [debug] [ThreadPool]: Creating schema "database: "supercell"
schema: "main"
"
[0m15:58:40.963435 [debug] [ThreadPool]: Using duckdb connection "create_supercell_main"
[0m15:58:40.963923 [debug] [ThreadPool]: On create_supercell_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "connection_name": "create_supercell_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='supercell'
        and type='sqlite'
    
  
[0m15:58:40.964284 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:58:40.965529 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m15:58:40.967062 [debug] [ThreadPool]: Using duckdb connection "create_supercell_main"
[0m15:58:40.967463 [debug] [ThreadPool]: On create_supercell_main: BEGIN
[0m15:58:40.968037 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m15:58:40.969146 [debug] [ThreadPool]: Using duckdb connection "create_supercell_main"
[0m15:58:40.969472 [debug] [ThreadPool]: On create_supercell_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "connection_name": "create_supercell_main"} */

    
    
        create schema if not exists "supercell"."main"
    
[0m15:58:40.970432 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m15:58:40.972387 [debug] [ThreadPool]: On create_supercell_main: COMMIT
[0m15:58:40.973010 [debug] [ThreadPool]: Using duckdb connection "create_supercell_main"
[0m15:58:40.973908 [debug] [ThreadPool]: On create_supercell_main: COMMIT
[0m15:58:40.975060 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m15:58:40.975427 [debug] [ThreadPool]: On create_supercell_main: Close
[0m15:58:40.979108 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_supercell_main, now list_supercell_main)
[0m15:58:40.985808 [debug] [ThreadPool]: Using duckdb connection "list_supercell_main"
[0m15:58:40.986246 [debug] [ThreadPool]: On list_supercell_main: BEGIN
[0m15:58:40.986568 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m15:58:40.987353 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m15:58:40.987718 [debug] [ThreadPool]: Using duckdb connection "list_supercell_main"
[0m15:58:40.988038 [debug] [ThreadPool]: On list_supercell_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "connection_name": "list_supercell_main"} */
select
      'supercell' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'supercell'
  
[0m15:58:41.004434 [debug] [ThreadPool]: SQL status: OK in 0.016 seconds
[0m15:58:41.006265 [debug] [ThreadPool]: On list_supercell_main: ROLLBACK
[0m15:58:41.007563 [debug] [ThreadPool]: Failed to rollback 'list_supercell_main'
[0m15:58:41.007982 [debug] [ThreadPool]: On list_supercell_main: Close
[0m15:58:41.011486 [debug] [MainThread]: Using duckdb connection "master"
[0m15:58:41.012185 [debug] [MainThread]: On master: BEGIN
[0m15:58:41.012746 [debug] [MainThread]: Opening a new connection, currently in state init
[0m15:58:41.013896 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m15:58:41.014504 [debug] [MainThread]: On master: COMMIT
[0m15:58:41.015062 [debug] [MainThread]: Using duckdb connection "master"
[0m15:58:41.015570 [debug] [MainThread]: On master: COMMIT
[0m15:58:41.016465 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m15:58:41.016924 [debug] [MainThread]: On master: Close
[0m15:58:41.021058 [debug] [Thread-1 (]: Began running node model.supercell.cleaned_usagelogs
[0m15:58:41.022165 [info ] [Thread-1 (]: 1 of 5 START sql table model main.cleaned_usagelogs ............................ [RUN]
[0m15:58:41.023048 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_supercell_main, now model.supercell.cleaned_usagelogs)
[0m15:58:41.023794 [debug] [Thread-1 (]: Began compiling node model.supercell.cleaned_usagelogs
[0m15:58:41.035204 [debug] [Thread-1 (]: Writing injected SQL for node "model.supercell.cleaned_usagelogs"
[0m15:58:41.036074 [debug] [Thread-1 (]: Began executing node model.supercell.cleaned_usagelogs
[0m15:58:41.076911 [debug] [Thread-1 (]: Writing runtime sql for node "model.supercell.cleaned_usagelogs"
[0m15:58:41.077877 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.cleaned_usagelogs"
[0m15:58:41.078342 [debug] [Thread-1 (]: On model.supercell.cleaned_usagelogs: BEGIN
[0m15:58:41.078753 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:58:41.079833 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:58:41.080251 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.cleaned_usagelogs"
[0m15:58:41.080642 [debug] [Thread-1 (]: On model.supercell.cleaned_usagelogs: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.cleaned_usagelogs"} */

  
    
    

    create  table
      "supercell"."main"."cleaned_usagelogs__dbt_tmp"
  
    as (
      


SELECT
    CAST("LinkedAccountId" AS VARCHAR) AS linked_account_id,
    CAST("bill/PayerAccountId" AS VARCHAR) AS payer_account_id,
    CAST("lineItem/UsageStartDate" AS TIMESTAMP) AS usage_start_date,
    CAST("lineItem/UsageEndDate" AS TIMESTAMP) AS usage_end_date,
    CAST("lineItem/UsageAmount" AS DECIMAL(18, 6)) AS usage_amount,
    CAST("lineItem/Operation" AS VARCHAR) AS operation,
    CAST("pricing/PricingModel" AS VARCHAR) AS pricing_model,
    CAST("resourceTags/TagKeys" AS VARCHAR) AS tag_keys,
    CAST("resourceTags/TagValues" AS VARCHAR) AS tag_values,
    CAST("product/Region" AS VARCHAR) AS region,
    CAST("product/ServiceCode" AS VARCHAR) AS service_code,
    CAST("product/InstanceType" AS VARCHAR) AS instance_type,
    CAST("amortized_cost" AS DECIMAL(18, 6)) AS amortized_cost,
    CAST("product/Description" AS VARCHAR) AS description
FROM supercell_usagelogs
    );
  
  
[0m15:58:41.621619 [debug] [Thread-1 (]: SQL status: OK in 0.540 seconds
[0m15:58:41.629081 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.cleaned_usagelogs"
[0m15:58:41.629626 [debug] [Thread-1 (]: On model.supercell.cleaned_usagelogs: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.cleaned_usagelogs"} */
alter table "supercell"."main"."cleaned_usagelogs" rename to "cleaned_usagelogs__dbt_backup"
[0m15:58:41.630766 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:58:41.633957 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.cleaned_usagelogs"
[0m15:58:41.634404 [debug] [Thread-1 (]: On model.supercell.cleaned_usagelogs: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.cleaned_usagelogs"} */
alter table "supercell"."main"."cleaned_usagelogs__dbt_tmp" rename to "cleaned_usagelogs"
[0m15:58:41.635168 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:58:41.653765 [debug] [Thread-1 (]: On model.supercell.cleaned_usagelogs: COMMIT
[0m15:58:41.654295 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.cleaned_usagelogs"
[0m15:58:41.654696 [debug] [Thread-1 (]: On model.supercell.cleaned_usagelogs: COMMIT
[0m15:58:41.683096 [debug] [Thread-1 (]: SQL status: OK in 0.028 seconds
[0m15:58:41.689312 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.cleaned_usagelogs"
[0m15:58:41.689831 [debug] [Thread-1 (]: On model.supercell.cleaned_usagelogs: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.cleaned_usagelogs"} */
drop table if exists "supercell"."main"."cleaned_usagelogs__dbt_backup" cascade
[0m15:58:41.692705 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m15:58:41.695743 [debug] [Thread-1 (]: On model.supercell.cleaned_usagelogs: Close
[0m15:58:41.699284 [info ] [Thread-1 (]: 1 of 5 OK created sql table model main.cleaned_usagelogs ....................... [[32mOK[0m in 0.67s]
[0m15:58:41.700029 [debug] [Thread-1 (]: Finished running node model.supercell.cleaned_usagelogs
[0m15:58:41.701589 [debug] [Thread-3 (]: Began running node model.supercell.dim_accounts
[0m15:58:41.702885 [debug] [Thread-4 (]: Began running node model.supercell.dim_resource
[0m15:58:41.704132 [info ] [Thread-3 (]: 2 of 5 START sql table model main.dim_accounts ................................. [RUN]
[0m15:58:41.705299 [debug] [Thread-2 (]: Began running node model.supercell.fact_bill_generation
[0m15:58:41.706531 [info ] [Thread-4 (]: 3 of 5 START sql table model main.dim_resource ................................. [RUN]
[0m15:58:41.708387 [debug] [Thread-3 (]: Acquiring new duckdb connection 'model.supercell.dim_accounts'
[0m15:58:41.710406 [info ] [Thread-2 (]: 4 of 5 START sql table model main.fact_bill_generation ......................... [RUN]
[0m15:58:41.712173 [debug] [Thread-4 (]: Acquiring new duckdb connection 'model.supercell.dim_resource'
[0m15:58:41.713414 [debug] [Thread-3 (]: Began compiling node model.supercell.dim_accounts
[0m15:58:41.714828 [debug] [Thread-2 (]: Acquiring new duckdb connection 'model.supercell.fact_bill_generation'
[0m15:58:41.716094 [debug] [Thread-4 (]: Began compiling node model.supercell.dim_resource
[0m15:58:41.724884 [debug] [Thread-3 (]: Writing injected SQL for node "model.supercell.dim_accounts"
[0m15:58:41.726006 [debug] [Thread-2 (]: Began compiling node model.supercell.fact_bill_generation
[0m15:58:41.732566 [debug] [Thread-4 (]: Writing injected SQL for node "model.supercell.dim_resource"
[0m15:58:41.737520 [debug] [Thread-2 (]: Writing injected SQL for node "model.supercell.fact_bill_generation"
[0m15:58:41.738659 [debug] [Thread-3 (]: Began executing node model.supercell.dim_accounts
[0m15:58:41.740417 [debug] [Thread-4 (]: Began executing node model.supercell.dim_resource
[0m15:58:41.745818 [debug] [Thread-3 (]: Writing runtime sql for node "model.supercell.dim_accounts"
[0m15:58:41.753909 [debug] [Thread-4 (]: Writing runtime sql for node "model.supercell.dim_resource"
[0m15:58:41.755360 [debug] [Thread-2 (]: Began executing node model.supercell.fact_bill_generation
[0m15:58:41.756978 [debug] [Thread-3 (]: Using duckdb connection "model.supercell.dim_accounts"
[0m15:58:41.762498 [debug] [Thread-2 (]: Writing runtime sql for node "model.supercell.fact_bill_generation"
[0m15:58:41.763593 [debug] [Thread-3 (]: On model.supercell.dim_accounts: BEGIN
[0m15:58:41.764803 [debug] [Thread-4 (]: Using duckdb connection "model.supercell.dim_resource"
[0m15:58:41.765944 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m15:58:41.766893 [debug] [Thread-2 (]: Using duckdb connection "model.supercell.fact_bill_generation"
[0m15:58:41.767788 [debug] [Thread-4 (]: On model.supercell.dim_resource: BEGIN
[0m15:58:41.769194 [debug] [Thread-2 (]: On model.supercell.fact_bill_generation: BEGIN
[0m15:58:41.770182 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m15:58:41.771267 [debug] [Thread-3 (]: SQL status: OK in 0.005 seconds
[0m15:58:41.772121 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m15:58:41.773529 [debug] [Thread-3 (]: Using duckdb connection "model.supercell.dim_accounts"
[0m15:58:41.774593 [debug] [Thread-4 (]: SQL status: OK in 0.004 seconds
[0m15:58:41.775725 [debug] [Thread-3 (]: On model.supercell.dim_accounts: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.dim_accounts"} */

  
    
    

    create  table
      "supercell"."main"."dim_accounts__dbt_tmp"
  
    as (
      


select
    linked_account_id as linked_account_id,
    tag_keys as tag_keys,
    tag_values as tag_values
from "supercell"."main"."cleaned_usagelogs"
    );
  
  
[0m15:58:41.776584 [debug] [Thread-4 (]: Using duckdb connection "model.supercell.dim_resource"
[0m15:58:41.778090 [debug] [Thread-2 (]: SQL status: OK in 0.006 seconds
[0m15:58:41.779068 [debug] [Thread-4 (]: On model.supercell.dim_resource: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.dim_resource"} */

  
    
    

    create  table
      "supercell"."main"."dim_resource__dbt_tmp"
  
    as (
      


select
    md5(concat(linked_account_id, '_', service_code, '_', instance_type, '_', region, '_', CAST(usage_start_date AS VARCHAR), '_', CAST(usage_end_date AS VARCHAR))) AS resource_id,
    linked_account_id as linked_account_id,
    region,
    service_code as product,
    instance_type as instance_type,
    pricing_model as pricing_model
from "supercell"."main"."cleaned_usagelogs"
    );
  
  
[0m15:58:41.780253 [debug] [Thread-2 (]: Using duckdb connection "model.supercell.fact_bill_generation"
[0m15:58:41.781937 [debug] [Thread-2 (]: On model.supercell.fact_bill_generation: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.fact_bill_generation"} */

  
    
    

    create  table
      "supercell"."main"."fact_bill_generation__dbt_tmp"
  
    as (
      


select
    md5(concat(linked_account_id, '_', service_code, '_', instance_type, '_', region, '_', CAST(usage_start_date AS VARCHAR), '_', CAST(usage_end_date AS VARCHAR))) AS resource_id,
    usage_start_date as start_date,
    usage_end_date as bill_date,
    usage_amount as bill_amount,
    operation
from "supercell"."main"."cleaned_usagelogs"
    );
  
  
[0m15:58:41.991346 [debug] [Thread-3 (]: SQL status: OK in 0.214 seconds
[0m15:58:41.998755 [debug] [Thread-3 (]: Using duckdb connection "model.supercell.dim_accounts"
[0m15:58:42.000157 [debug] [Thread-3 (]: On model.supercell.dim_accounts: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.dim_accounts"} */
alter table "supercell"."main"."dim_accounts" rename to "dim_accounts__dbt_backup"
[0m15:58:42.002138 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m15:58:42.008289 [debug] [Thread-3 (]: Using duckdb connection "model.supercell.dim_accounts"
[0m15:58:42.009748 [debug] [Thread-3 (]: On model.supercell.dim_accounts: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.dim_accounts"} */
alter table "supercell"."main"."dim_accounts__dbt_tmp" rename to "dim_accounts"
[0m15:58:42.011793 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m15:58:42.015663 [debug] [Thread-3 (]: On model.supercell.dim_accounts: COMMIT
[0m15:58:42.016795 [debug] [Thread-3 (]: Using duckdb connection "model.supercell.dim_accounts"
[0m15:58:42.017699 [debug] [Thread-3 (]: On model.supercell.dim_accounts: COMMIT
[0m15:58:42.033929 [debug] [Thread-3 (]: SQL status: OK in 0.015 seconds
[0m15:58:42.038752 [debug] [Thread-3 (]: Using duckdb connection "model.supercell.dim_accounts"
[0m15:58:42.039673 [debug] [Thread-3 (]: On model.supercell.dim_accounts: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.dim_accounts"} */
drop table if exists "supercell"."main"."dim_accounts__dbt_backup" cascade
[0m15:58:42.042568 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m15:58:42.045641 [debug] [Thread-3 (]: On model.supercell.dim_accounts: Close
[0m15:58:42.056372 [info ] [Thread-3 (]: 2 of 5 OK created sql table model main.dim_accounts ............................ [[32mOK[0m in 0.35s]
[0m15:58:42.058115 [debug] [Thread-3 (]: Finished running node model.supercell.dim_accounts
[0m15:58:42.205588 [debug] [Thread-2 (]: SQL status: OK in 0.423 seconds
[0m15:58:42.209350 [debug] [Thread-2 (]: Using duckdb connection "model.supercell.fact_bill_generation"
[0m15:58:42.209920 [debug] [Thread-2 (]: On model.supercell.fact_bill_generation: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.fact_bill_generation"} */
alter table "supercell"."main"."fact_bill_generation" rename to "fact_bill_generation__dbt_backup"
[0m15:58:42.211226 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m15:58:42.214255 [debug] [Thread-2 (]: Using duckdb connection "model.supercell.fact_bill_generation"
[0m15:58:42.214704 [debug] [Thread-2 (]: On model.supercell.fact_bill_generation: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.fact_bill_generation"} */
alter table "supercell"."main"."fact_bill_generation__dbt_tmp" rename to "fact_bill_generation"
[0m15:58:42.215584 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m15:58:42.217827 [debug] [Thread-2 (]: On model.supercell.fact_bill_generation: COMMIT
[0m15:58:42.218293 [debug] [Thread-2 (]: Using duckdb connection "model.supercell.fact_bill_generation"
[0m15:58:42.218684 [debug] [Thread-2 (]: On model.supercell.fact_bill_generation: COMMIT
[0m15:58:42.256453 [debug] [Thread-2 (]: SQL status: OK in 0.037 seconds
[0m15:58:42.261390 [debug] [Thread-2 (]: Using duckdb connection "model.supercell.fact_bill_generation"
[0m15:58:42.262014 [debug] [Thread-2 (]: On model.supercell.fact_bill_generation: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.fact_bill_generation"} */
drop table if exists "supercell"."main"."fact_bill_generation__dbt_backup" cascade
[0m15:58:42.262952 [debug] [Thread-4 (]: SQL status: OK in 0.481 seconds
[0m15:58:42.266771 [debug] [Thread-4 (]: Using duckdb connection "model.supercell.dim_resource"
[0m15:58:42.267260 [debug] [Thread-4 (]: On model.supercell.dim_resource: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.dim_resource"} */
alter table "supercell"."main"."dim_resource" rename to "dim_resource__dbt_backup"
[0m15:58:42.268181 [debug] [Thread-4 (]: SQL status: OK in 0.000 seconds
[0m15:58:42.271133 [debug] [Thread-4 (]: Using duckdb connection "model.supercell.dim_resource"
[0m15:58:42.271568 [debug] [Thread-4 (]: On model.supercell.dim_resource: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.dim_resource"} */
alter table "supercell"."main"."dim_resource__dbt_tmp" rename to "dim_resource"
[0m15:58:42.272295 [debug] [Thread-2 (]: SQL status: OK in 0.010 seconds
[0m15:58:42.274954 [debug] [Thread-2 (]: On model.supercell.fact_bill_generation: Close
[0m15:58:42.275765 [debug] [Thread-4 (]: SQL status: OK in 0.004 seconds
[0m15:58:42.277894 [debug] [Thread-4 (]: On model.supercell.dim_resource: COMMIT
[0m15:58:42.278445 [debug] [Thread-4 (]: Using duckdb connection "model.supercell.dim_resource"
[0m15:58:42.278911 [debug] [Thread-4 (]: On model.supercell.dim_resource: COMMIT
[0m15:58:42.287821 [info ] [Thread-2 (]: 4 of 5 OK created sql table model main.fact_bill_generation .................... [[32mOK[0m in 0.57s]
[0m15:58:42.288583 [debug] [Thread-2 (]: Finished running node model.supercell.fact_bill_generation
[0m15:58:42.290915 [debug] [Thread-4 (]: SQL status: OK in 0.011 seconds
[0m15:58:42.296334 [debug] [Thread-4 (]: Using duckdb connection "model.supercell.dim_resource"
[0m15:58:42.298112 [debug] [Thread-4 (]: On model.supercell.dim_resource: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.dim_resource"} */
drop table if exists "supercell"."main"."dim_resource__dbt_backup" cascade
[0m15:58:42.301304 [debug] [Thread-4 (]: SQL status: OK in 0.003 seconds
[0m15:58:42.303269 [debug] [Thread-4 (]: On model.supercell.dim_resource: Close
[0m15:58:42.304838 [info ] [Thread-4 (]: 3 of 5 OK created sql table model main.dim_resource ............................ [[32mOK[0m in 0.59s]
[0m15:58:42.305547 [debug] [Thread-4 (]: Finished running node model.supercell.dim_resource
[0m15:58:42.306918 [debug] [Thread-1 (]: Began running node model.supercell.total_cost
[0m15:58:42.307636 [info ] [Thread-1 (]: 5 of 5 START sql table model main.total_cost ................................... [RUN]
[0m15:58:42.308261 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.supercell.cleaned_usagelogs, now model.supercell.total_cost)
[0m15:58:42.308746 [debug] [Thread-1 (]: Began compiling node model.supercell.total_cost
[0m15:58:42.312726 [debug] [Thread-1 (]: Writing injected SQL for node "model.supercell.total_cost"
[0m15:58:42.313525 [debug] [Thread-1 (]: Began executing node model.supercell.total_cost
[0m15:58:42.320907 [debug] [Thread-1 (]: Writing runtime sql for node "model.supercell.total_cost"
[0m15:58:42.322291 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.total_cost"
[0m15:58:42.323214 [debug] [Thread-1 (]: On model.supercell.total_cost: BEGIN
[0m15:58:42.323954 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m15:58:42.325385 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m15:58:42.326018 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.total_cost"
[0m15:58:42.326569 [debug] [Thread-1 (]: On model.supercell.total_cost: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.total_cost"} */

  
    
    

    create  table
      "supercell"."main"."total_cost__dbt_tmp"
  
    as (
      

with base as (
    select
        fact_bill_generation.resource_id,
        date_trunc('month', fact_bill_generation.bill_date) as month,
        fact_bill_generation.bill_amount,
        dim_resource.instance_type,
        dim_resource.product,
        dim_resource.region,
        dim_resource.pricing_model,
        -- dim_accounts.tag_keys,
        -- dim_accounts.tag_values
    from "supercell"."main"."fact_bill_generation" as fact_bill_generation
    left join "supercell"."main"."dim_resource" as dim_resource 
        on fact_bill_generation.resource_id = dim_resource.resource_id
    -- left join "supercell"."main"."dim_accounts" as dim_accounts 
    --     on dim_resource.linked_account_id = dim_accounts.linked_account_id
)

select
    month,
    sum(bill_amount) as total_cost,
    instance_type,
    product,
    region,
    pricing_model
from base
group by
    month,
    instance_type,
    product,
    region,
    pricing_model
order by
    month,
    instance_type,
    product,
    region,
    pricing_model
    );
  
  
[0m15:58:42.831356 [debug] [Thread-1 (]: SQL status: OK in 0.504 seconds
[0m15:58:42.834960 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.total_cost"
[0m15:58:42.835443 [debug] [Thread-1 (]: On model.supercell.total_cost: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.total_cost"} */
alter table "supercell"."main"."total_cost" rename to "total_cost__dbt_backup"
[0m15:58:42.836388 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:58:42.839327 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.total_cost"
[0m15:58:42.839919 [debug] [Thread-1 (]: On model.supercell.total_cost: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.total_cost"} */
alter table "supercell"."main"."total_cost__dbt_tmp" rename to "total_cost"
[0m15:58:42.840856 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m15:58:42.842735 [debug] [Thread-1 (]: On model.supercell.total_cost: COMMIT
[0m15:58:42.843168 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.total_cost"
[0m15:58:42.843534 [debug] [Thread-1 (]: On model.supercell.total_cost: COMMIT
[0m15:58:42.848693 [debug] [Thread-1 (]: SQL status: OK in 0.005 seconds
[0m15:58:42.851351 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.total_cost"
[0m15:58:42.851856 [debug] [Thread-1 (]: On model.supercell.total_cost: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.total_cost"} */
drop table if exists "supercell"."main"."total_cost__dbt_backup" cascade
[0m15:58:42.854701 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m15:58:42.857051 [debug] [Thread-1 (]: On model.supercell.total_cost: Close
[0m15:58:42.865087 [info ] [Thread-1 (]: 5 of 5 OK created sql table model main.total_cost .............................. [[32mOK[0m in 0.56s]
[0m15:58:42.866129 [debug] [Thread-1 (]: Finished running node model.supercell.total_cost
[0m15:58:42.869027 [debug] [MainThread]: Using duckdb connection "master"
[0m15:58:42.869732 [debug] [MainThread]: On master: BEGIN
[0m15:58:42.870247 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m15:58:42.871556 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m15:58:42.872301 [debug] [MainThread]: On master: COMMIT
[0m15:58:42.872844 [debug] [MainThread]: Using duckdb connection "master"
[0m15:58:42.873330 [debug] [MainThread]: On master: COMMIT
[0m15:58:42.874244 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m15:58:42.875012 [debug] [MainThread]: On master: Close
[0m15:58:42.876085 [debug] [MainThread]: Connection 'master' was properly closed.
[0m15:58:42.876766 [debug] [MainThread]: Connection 'model.supercell.total_cost' was properly closed.
[0m15:58:42.877346 [debug] [MainThread]: Connection 'model.supercell.dim_accounts' was properly closed.
[0m15:58:42.877861 [debug] [MainThread]: Connection 'model.supercell.dim_resource' was properly closed.
[0m15:58:42.878324 [debug] [MainThread]: Connection 'model.supercell.fact_bill_generation' was properly closed.
[0m15:58:42.879092 [info ] [MainThread]: 
[0m15:58:42.879859 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 1.99 seconds (1.99s).
[0m15:58:42.882031 [debug] [MainThread]: Command end result
[0m15:58:42.983186 [debug] [MainThread]: Wrote artifact WritableManifest to /home/harsha/data_actions/supercell_cloudops/target/manifest.json
[0m15:58:42.985151 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/harsha/data_actions/supercell_cloudops/target/semantic_manifest.json
[0m15:58:42.992035 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/harsha/data_actions/supercell_cloudops/target/run_results.json
[0m15:58:42.992461 [info ] [MainThread]: 
[0m15:58:42.992905 [info ] [MainThread]: [32mCompleted successfully[0m
[0m15:58:42.993261 [info ] [MainThread]: 
[0m15:58:42.993661 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m15:58:42.995222 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 3.0413563, "process_in_blocks": "0", "process_kernel_time": 0.787906, "process_mem_max_rss": "356620", "process_out_blocks": "59736", "process_user_time": 10.193857}
[0m15:58:42.996024 [debug] [MainThread]: Command `dbt run` succeeded at 15:58:42.995878 after 3.04 seconds
[0m15:58:42.996461 [debug] [MainThread]: Flushing usage events


============================== 17:07:06.168765 | 65a27e3f-c802-4d3d-b470-410852ebfff0 ==============================
[0m17:07:06.168765 [info ] [MainThread]: Running with dbt=1.9.4
[0m17:07:06.171439 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/harsha/data_actions/supercell_cloudops', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/harsha/data_actions/supercell_cloudops/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'False'}
[0m17:07:06.171686 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality

User config should be moved from the 'config' key in profiles.yml to the 'flags' key in dbt_project.yml.
[0m17:07:06.333265 [info ] [MainThread]: Registered adapter: duckdb=1.9.3
[0m17:07:06.377648 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m17:07:06.416568 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m17:07:06.416952 [debug] [MainThread]: Partial parsing: updated file: supercell://models/supercell_models/metrics/total_cost.sql
[0m17:07:06.417208 [debug] [MainThread]: Partial parsing: updated file: supercell://models/supercell_models/dim_accounts.sql
[0m17:07:06.554078 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.supercell.example
[0m17:07:06.585677 [debug] [MainThread]: Wrote artifact WritableManifest to /home/harsha/data_actions/supercell_cloudops/target/manifest.json
[0m17:07:06.586757 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/harsha/data_actions/supercell_cloudops/target/semantic_manifest.json
[0m17:07:06.593995 [info ] [MainThread]: Found 5 models, 428 macros
[0m17:07:06.595418 [info ] [MainThread]: 
[0m17:07:06.595857 [info ] [MainThread]: Concurrency: 4 threads (target='default')
[0m17:07:06.596078 [info ] [MainThread]: 
[0m17:07:06.596492 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m17:07:06.601464 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_supercell'
[0m17:07:06.629098 [debug] [ThreadPool]: Using duckdb connection "list_supercell"
[0m17:07:06.629442 [debug] [ThreadPool]: On list_supercell: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "connection_name": "list_supercell"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"supercell"'
    
  
  
[0m17:07:06.629642 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:07:06.637573 [debug] [ThreadPool]: SQL status: OK in 0.008 seconds
[0m17:07:06.638494 [debug] [ThreadPool]: On list_supercell: Close
[0m17:07:06.639105 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_supercell, now create_supercell_main)
[0m17:07:06.639389 [debug] [ThreadPool]: Creating schema "database: "supercell"
schema: "main"
"
[0m17:07:06.643277 [debug] [ThreadPool]: Using duckdb connection "create_supercell_main"
[0m17:07:06.643517 [debug] [ThreadPool]: On create_supercell_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "connection_name": "create_supercell_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='supercell'
        and type='sqlite'
    
  
[0m17:07:06.643706 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:07:06.644295 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m17:07:06.644998 [debug] [ThreadPool]: Using duckdb connection "create_supercell_main"
[0m17:07:06.645209 [debug] [ThreadPool]: On create_supercell_main: BEGIN
[0m17:07:06.645502 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:07:06.645694 [debug] [ThreadPool]: Using duckdb connection "create_supercell_main"
[0m17:07:06.645858 [debug] [ThreadPool]: On create_supercell_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "connection_name": "create_supercell_main"} */

    
    
        create schema if not exists "supercell"."main"
    
[0m17:07:06.646306 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:07:06.646783 [debug] [ThreadPool]: On create_supercell_main: COMMIT
[0m17:07:06.646958 [debug] [ThreadPool]: Using duckdb connection "create_supercell_main"
[0m17:07:06.647099 [debug] [ThreadPool]: On create_supercell_main: COMMIT
[0m17:07:06.647354 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:07:06.647534 [debug] [ThreadPool]: On create_supercell_main: Close
[0m17:07:06.648668 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_supercell_main, now list_supercell_main)
[0m17:07:06.652561 [debug] [ThreadPool]: Using duckdb connection "list_supercell_main"
[0m17:07:06.652829 [debug] [ThreadPool]: On list_supercell_main: BEGIN
[0m17:07:06.652989 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:07:06.653500 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:07:06.653678 [debug] [ThreadPool]: Using duckdb connection "list_supercell_main"
[0m17:07:06.653823 [debug] [ThreadPool]: On list_supercell_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "connection_name": "list_supercell_main"} */
select
      'supercell' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'supercell'
  
[0m17:07:06.661697 [debug] [ThreadPool]: SQL status: OK in 0.008 seconds
[0m17:07:06.662577 [debug] [ThreadPool]: On list_supercell_main: ROLLBACK
[0m17:07:06.663230 [debug] [ThreadPool]: Failed to rollback 'list_supercell_main'
[0m17:07:06.663426 [debug] [ThreadPool]: On list_supercell_main: Close
[0m17:07:06.664481 [debug] [MainThread]: Using duckdb connection "master"
[0m17:07:06.664670 [debug] [MainThread]: On master: BEGIN
[0m17:07:06.664825 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:07:06.665141 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:07:06.665360 [debug] [MainThread]: On master: COMMIT
[0m17:07:06.665523 [debug] [MainThread]: Using duckdb connection "master"
[0m17:07:06.665671 [debug] [MainThread]: On master: COMMIT
[0m17:07:06.665916 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:07:06.666083 [debug] [MainThread]: On master: Close
[0m17:07:06.667883 [debug] [Thread-1 (]: Began running node model.supercell.cleaned_usagelogs
[0m17:07:06.668466 [info ] [Thread-1 (]: 1 of 5 START sql table model main.cleaned_usagelogs ............................ [RUN]
[0m17:07:06.668973 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_supercell_main, now model.supercell.cleaned_usagelogs)
[0m17:07:06.669424 [debug] [Thread-1 (]: Began compiling node model.supercell.cleaned_usagelogs
[0m17:07:06.676743 [debug] [Thread-1 (]: Writing injected SQL for node "model.supercell.cleaned_usagelogs"
[0m17:07:06.677436 [debug] [Thread-1 (]: Began executing node model.supercell.cleaned_usagelogs
[0m17:07:06.699355 [debug] [Thread-1 (]: Writing runtime sql for node "model.supercell.cleaned_usagelogs"
[0m17:07:06.699846 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.cleaned_usagelogs"
[0m17:07:06.700064 [debug] [Thread-1 (]: On model.supercell.cleaned_usagelogs: BEGIN
[0m17:07:06.700249 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:07:06.700834 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:07:06.701055 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.cleaned_usagelogs"
[0m17:07:06.701279 [debug] [Thread-1 (]: On model.supercell.cleaned_usagelogs: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.cleaned_usagelogs"} */

  
    
    

    create  table
      "supercell"."main"."cleaned_usagelogs__dbt_tmp"
  
    as (
      


SELECT
    CAST("LinkedAccountId" AS VARCHAR) AS linked_account_id,
    CAST("bill/PayerAccountId" AS VARCHAR) AS payer_account_id,
    CAST("lineItem/UsageStartDate" AS TIMESTAMP) AS usage_start_date,
    CAST("lineItem/UsageEndDate" AS TIMESTAMP) AS usage_end_date,
    CAST("lineItem/UsageAmount" AS DECIMAL(18, 6)) AS usage_amount,
    CAST("lineItem/Operation" AS VARCHAR) AS operation,
    CAST("pricing/PricingModel" AS VARCHAR) AS pricing_model,
    CAST("resourceTags/TagKeys" AS VARCHAR) AS tag_keys,
    CAST("resourceTags/TagValues" AS VARCHAR) AS tag_values,
    CAST("product/Region" AS VARCHAR) AS region,
    CAST("product/ServiceCode" AS VARCHAR) AS service_code,
    CAST("product/InstanceType" AS VARCHAR) AS instance_type,
    CAST("amortized_cost" AS DECIMAL(18, 6)) AS amortized_cost,
    CAST("product/Description" AS VARCHAR) AS description
FROM supercell_usagelogs
    );
  
  
[0m17:07:06.966674 [debug] [Thread-1 (]: SQL status: OK in 0.265 seconds
[0m17:07:06.970763 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.cleaned_usagelogs"
[0m17:07:06.971052 [debug] [Thread-1 (]: On model.supercell.cleaned_usagelogs: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.cleaned_usagelogs"} */
alter table "supercell"."main"."cleaned_usagelogs" rename to "cleaned_usagelogs__dbt_backup"
[0m17:07:06.971676 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:07:06.973251 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.cleaned_usagelogs"
[0m17:07:06.973492 [debug] [Thread-1 (]: On model.supercell.cleaned_usagelogs: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.cleaned_usagelogs"} */
alter table "supercell"."main"."cleaned_usagelogs__dbt_tmp" rename to "cleaned_usagelogs"
[0m17:07:06.973883 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:07:06.982782 [debug] [Thread-1 (]: On model.supercell.cleaned_usagelogs: COMMIT
[0m17:07:06.983034 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.cleaned_usagelogs"
[0m17:07:06.983221 [debug] [Thread-1 (]: On model.supercell.cleaned_usagelogs: COMMIT
[0m17:07:06.994929 [debug] [Thread-1 (]: SQL status: OK in 0.011 seconds
[0m17:07:06.998314 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.cleaned_usagelogs"
[0m17:07:06.998583 [debug] [Thread-1 (]: On model.supercell.cleaned_usagelogs: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.cleaned_usagelogs"} */
drop table if exists "supercell"."main"."cleaned_usagelogs__dbt_backup" cascade
[0m17:07:07.000388 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m17:07:07.002973 [debug] [Thread-1 (]: On model.supercell.cleaned_usagelogs: Close
[0m17:07:07.012569 [info ] [Thread-1 (]: 1 of 5 OK created sql table model main.cleaned_usagelogs ....................... [[32mOK[0m in 0.34s]
[0m17:07:07.013038 [debug] [Thread-1 (]: Finished running node model.supercell.cleaned_usagelogs
[0m17:07:07.014034 [debug] [Thread-3 (]: Began running node model.supercell.dim_accounts
[0m17:07:07.014545 [debug] [Thread-4 (]: Began running node model.supercell.dim_resource
[0m17:07:07.015225 [debug] [Thread-2 (]: Began running node model.supercell.fact_bill_generation
[0m17:07:07.015834 [info ] [Thread-3 (]: 2 of 5 START sql table model main.dim_accounts ................................. [RUN]
[0m17:07:07.016694 [info ] [Thread-4 (]: 3 of 5 START sql table model main.dim_resource ................................. [RUN]
[0m17:07:07.017422 [info ] [Thread-2 (]: 4 of 5 START sql table model main.fact_bill_generation ......................... [RUN]
[0m17:07:07.018968 [debug] [Thread-3 (]: Acquiring new duckdb connection 'model.supercell.dim_accounts'
[0m17:07:07.019977 [debug] [Thread-4 (]: Acquiring new duckdb connection 'model.supercell.dim_resource'
[0m17:07:07.020756 [debug] [Thread-2 (]: Acquiring new duckdb connection 'model.supercell.fact_bill_generation'
[0m17:07:07.021401 [debug] [Thread-3 (]: Began compiling node model.supercell.dim_accounts
[0m17:07:07.021924 [debug] [Thread-4 (]: Began compiling node model.supercell.dim_resource
[0m17:07:07.022498 [debug] [Thread-2 (]: Began compiling node model.supercell.fact_bill_generation
[0m17:07:07.027146 [debug] [Thread-3 (]: Writing injected SQL for node "model.supercell.dim_accounts"
[0m17:07:07.030239 [debug] [Thread-4 (]: Writing injected SQL for node "model.supercell.dim_resource"
[0m17:07:07.032880 [debug] [Thread-2 (]: Writing injected SQL for node "model.supercell.fact_bill_generation"
[0m17:07:07.034045 [debug] [Thread-4 (]: Began executing node model.supercell.dim_resource
[0m17:07:07.034543 [debug] [Thread-3 (]: Began executing node model.supercell.dim_accounts
[0m17:07:07.036825 [debug] [Thread-4 (]: Writing runtime sql for node "model.supercell.dim_resource"
[0m17:07:07.038627 [debug] [Thread-3 (]: Writing runtime sql for node "model.supercell.dim_accounts"
[0m17:07:07.039125 [debug] [Thread-2 (]: Began executing node model.supercell.fact_bill_generation
[0m17:07:07.041564 [debug] [Thread-2 (]: Writing runtime sql for node "model.supercell.fact_bill_generation"
[0m17:07:07.042120 [debug] [Thread-2 (]: Using duckdb connection "model.supercell.fact_bill_generation"
[0m17:07:07.042369 [debug] [Thread-2 (]: On model.supercell.fact_bill_generation: BEGIN
[0m17:07:07.042764 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m17:07:07.043123 [debug] [Thread-4 (]: Using duckdb connection "model.supercell.dim_resource"
[0m17:07:07.043822 [debug] [Thread-3 (]: Using duckdb connection "model.supercell.dim_accounts"
[0m17:07:07.044182 [debug] [Thread-4 (]: On model.supercell.dim_resource: BEGIN
[0m17:07:07.044475 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m17:07:07.044832 [debug] [Thread-3 (]: On model.supercell.dim_accounts: BEGIN
[0m17:07:07.045199 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m17:07:07.045426 [debug] [Thread-2 (]: Using duckdb connection "model.supercell.fact_bill_generation"
[0m17:07:07.045709 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m17:07:07.046155 [debug] [Thread-2 (]: On model.supercell.fact_bill_generation: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.fact_bill_generation"} */

  
    
    

    create  table
      "supercell"."main"."fact_bill_generation__dbt_tmp"
  
    as (
      


select
    md5(concat(linked_account_id, '_', service_code, '_', instance_type, '_', region, '_', CAST(usage_start_date AS VARCHAR), '_', CAST(usage_end_date AS VARCHAR))) AS resource_id,
    usage_start_date as start_date,
    usage_end_date as bill_date,
    usage_amount as bill_amount,
    operation
from "supercell"."main"."cleaned_usagelogs"
    );
  
  
[0m17:07:07.046533 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m17:07:07.046858 [debug] [Thread-4 (]: Using duckdb connection "model.supercell.dim_resource"
[0m17:07:07.047066 [debug] [Thread-4 (]: On model.supercell.dim_resource: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.dim_resource"} */

  
    
    

    create  table
      "supercell"."main"."dim_resource__dbt_tmp"
  
    as (
      


select
    md5(concat(linked_account_id, '_', service_code, '_', instance_type, '_', region, '_', CAST(usage_start_date AS VARCHAR), '_', CAST(usage_end_date AS VARCHAR))) AS resource_id,
    linked_account_id as linked_account_id,
    region,
    service_code as product,
    instance_type as instance_type,
    pricing_model as pricing_model
from "supercell"."main"."cleaned_usagelogs"
    );
  
  
[0m17:07:07.047597 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m17:07:07.048896 [debug] [Thread-3 (]: Using duckdb connection "model.supercell.dim_accounts"
[0m17:07:07.050338 [debug] [Thread-3 (]: On model.supercell.dim_accounts: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.dim_accounts"} */

  
    
    

    create  table
      "supercell"."main"."dim_accounts__dbt_tmp"
  
    as (
      


select
    linked_account_id as linked_account_id,
    tag_keys as tag_keys,
    tag_values as tag_values
from "supercell"."main"."cleaned_usagelogs"
    );
  
  
[0m17:07:07.209611 [debug] [Thread-2 (]: SQL status: OK in 0.163 seconds
[0m17:07:07.211665 [debug] [Thread-2 (]: Using duckdb connection "model.supercell.fact_bill_generation"
[0m17:07:07.211951 [debug] [Thread-2 (]: On model.supercell.fact_bill_generation: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.fact_bill_generation"} */
alter table "supercell"."main"."fact_bill_generation" rename to "fact_bill_generation__dbt_backup"
[0m17:07:07.212766 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m17:07:07.214617 [debug] [Thread-2 (]: Using duckdb connection "model.supercell.fact_bill_generation"
[0m17:07:07.214999 [debug] [Thread-2 (]: On model.supercell.fact_bill_generation: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.fact_bill_generation"} */
alter table "supercell"."main"."fact_bill_generation__dbt_tmp" rename to "fact_bill_generation"
[0m17:07:07.215872 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m17:07:07.217175 [debug] [Thread-2 (]: On model.supercell.fact_bill_generation: COMMIT
[0m17:07:07.217549 [debug] [Thread-2 (]: Using duckdb connection "model.supercell.fact_bill_generation"
[0m17:07:07.217777 [debug] [Thread-2 (]: On model.supercell.fact_bill_generation: COMMIT
[0m17:07:07.234094 [debug] [Thread-2 (]: SQL status: OK in 0.016 seconds
[0m17:07:07.236380 [debug] [Thread-2 (]: Using duckdb connection "model.supercell.fact_bill_generation"
[0m17:07:07.236833 [debug] [Thread-2 (]: On model.supercell.fact_bill_generation: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.fact_bill_generation"} */
drop table if exists "supercell"."main"."fact_bill_generation__dbt_backup" cascade
[0m17:07:07.237179 [debug] [Thread-3 (]: SQL status: OK in 0.186 seconds
[0m17:07:07.239857 [debug] [Thread-3 (]: Using duckdb connection "model.supercell.dim_accounts"
[0m17:07:07.240419 [debug] [Thread-3 (]: On model.supercell.dim_accounts: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.dim_accounts"} */
alter table "supercell"."main"."dim_accounts" rename to "dim_accounts__dbt_backup"
[0m17:07:07.241279 [debug] [Thread-3 (]: SQL status: OK in 0.000 seconds
[0m17:07:07.243804 [debug] [Thread-3 (]: Using duckdb connection "model.supercell.dim_accounts"
[0m17:07:07.244278 [debug] [Thread-2 (]: SQL status: OK in 0.007 seconds
[0m17:07:07.244676 [debug] [Thread-3 (]: On model.supercell.dim_accounts: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.dim_accounts"} */
alter table "supercell"."main"."dim_accounts__dbt_tmp" rename to "dim_accounts"
[0m17:07:07.246025 [debug] [Thread-2 (]: On model.supercell.fact_bill_generation: Close
[0m17:07:07.246954 [debug] [Thread-3 (]: SQL status: OK in 0.000 seconds
[0m17:07:07.248766 [debug] [Thread-3 (]: On model.supercell.dim_accounts: COMMIT
[0m17:07:07.249246 [debug] [Thread-3 (]: Using duckdb connection "model.supercell.dim_accounts"
[0m17:07:07.249639 [debug] [Thread-3 (]: On model.supercell.dim_accounts: COMMIT
[0m17:07:07.252313 [info ] [Thread-2 (]: 4 of 5 OK created sql table model main.fact_bill_generation .................... [[32mOK[0m in 0.23s]
[0m17:07:07.253086 [debug] [Thread-2 (]: Finished running node model.supercell.fact_bill_generation
[0m17:07:07.254822 [debug] [Thread-3 (]: SQL status: OK in 0.005 seconds
[0m17:07:07.259539 [debug] [Thread-3 (]: Using duckdb connection "model.supercell.dim_accounts"
[0m17:07:07.260255 [debug] [Thread-3 (]: On model.supercell.dim_accounts: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.dim_accounts"} */
drop table if exists "supercell"."main"."dim_accounts__dbt_backup" cascade
[0m17:07:07.262186 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m17:07:07.263467 [debug] [Thread-3 (]: On model.supercell.dim_accounts: Close
[0m17:07:07.265121 [info ] [Thread-3 (]: 2 of 5 OK created sql table model main.dim_accounts ............................ [[32mOK[0m in 0.25s]
[0m17:07:07.265724 [debug] [Thread-3 (]: Finished running node model.supercell.dim_accounts
[0m17:07:07.300725 [debug] [Thread-4 (]: SQL status: OK in 0.253 seconds
[0m17:07:07.302707 [debug] [Thread-4 (]: Using duckdb connection "model.supercell.dim_resource"
[0m17:07:07.302969 [debug] [Thread-4 (]: On model.supercell.dim_resource: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.dim_resource"} */
alter table "supercell"."main"."dim_resource" rename to "dim_resource__dbt_backup"
[0m17:07:07.303543 [debug] [Thread-4 (]: SQL status: OK in 0.000 seconds
[0m17:07:07.305126 [debug] [Thread-4 (]: Using duckdb connection "model.supercell.dim_resource"
[0m17:07:07.305367 [debug] [Thread-4 (]: On model.supercell.dim_resource: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.dim_resource"} */
alter table "supercell"."main"."dim_resource__dbt_tmp" rename to "dim_resource"
[0m17:07:07.305753 [debug] [Thread-4 (]: SQL status: OK in 0.000 seconds
[0m17:07:07.306660 [debug] [Thread-4 (]: On model.supercell.dim_resource: COMMIT
[0m17:07:07.306890 [debug] [Thread-4 (]: Using duckdb connection "model.supercell.dim_resource"
[0m17:07:07.307071 [debug] [Thread-4 (]: On model.supercell.dim_resource: COMMIT
[0m17:07:07.310866 [debug] [Thread-4 (]: SQL status: OK in 0.004 seconds
[0m17:07:07.312109 [debug] [Thread-4 (]: Using duckdb connection "model.supercell.dim_resource"
[0m17:07:07.312351 [debug] [Thread-4 (]: On model.supercell.dim_resource: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.dim_resource"} */
drop table if exists "supercell"."main"."dim_resource__dbt_backup" cascade
[0m17:07:07.313765 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m17:07:07.314528 [debug] [Thread-4 (]: On model.supercell.dim_resource: Close
[0m17:07:07.315634 [info ] [Thread-4 (]: 3 of 5 OK created sql table model main.dim_resource ............................ [[32mOK[0m in 0.30s]
[0m17:07:07.315939 [debug] [Thread-4 (]: Finished running node model.supercell.dim_resource
[0m17:07:07.316759 [debug] [Thread-1 (]: Began running node model.supercell.total_cost
[0m17:07:07.317564 [info ] [Thread-1 (]: 5 of 5 START sql table model main.total_cost ................................... [RUN]
[0m17:07:07.318126 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.supercell.cleaned_usagelogs, now model.supercell.total_cost)
[0m17:07:07.318672 [debug] [Thread-1 (]: Began compiling node model.supercell.total_cost
[0m17:07:07.323049 [debug] [Thread-1 (]: Writing injected SQL for node "model.supercell.total_cost"
[0m17:07:07.323883 [debug] [Thread-1 (]: Began executing node model.supercell.total_cost
[0m17:07:07.327233 [debug] [Thread-1 (]: Writing runtime sql for node "model.supercell.total_cost"
[0m17:07:07.327909 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.total_cost"
[0m17:07:07.328304 [debug] [Thread-1 (]: On model.supercell.total_cost: BEGIN
[0m17:07:07.328678 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:07:07.329399 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:07:07.329760 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.total_cost"
[0m17:07:07.330116 [debug] [Thread-1 (]: On model.supercell.total_cost: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.total_cost"} */

  
    
    

    create  table
      "supercell"."main"."total_cost__dbt_tmp"
  
    as (
      

with base as (
    select
        fact_bill_generation.resource_id,
        date_trunc('month', fact_bill_generation.bill_date) as month,
        fact_bill_generation.bill_amount,
        dim_resource.instance_type,
        dim_resource.product,
        dim_resource.region,
        dim_resource.pricing_model,
        dim_accounts.tag_keys,
        dim_accounts.tag_values
    from "supercell"."main"."fact_bill_generation" as fact_bill_generation
    left join "supercell"."main"."dim_resource" as dim_resource
        on fact_bill_generation.resource_id = dim_resource.resource_id
    left join "supercell"."main"."dim_accounts" as dim_accounts
        on dim_resource.linked_account_id = dim_accounts.linked_account_id
)

select
    month,
    sum(bill_amount) as total_cost,
    instance_type,
    product,
    region,
    pricing_model
from base
group by
    month,
    instance_type,
    product,
    region,
    pricing_model
order by
    month,
    instance_type,
    product,
    region,
    pricing_model
    );
  
  
[0m17:07:40.334799 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/harsha/data_actions/supercell_cloudops/target/run_results.json
[0m17:07:40.337038 [debug] [MainThread]: DuckDB adapter: cancelling query on connection model.supercell.total_cost. Details: Connection(type='duckdb', name='model.supercell.total_cost', state=<ConnectionState.OPEN: 'open'>, transaction_open=True, _handle=<dbt.adapters.duckdb.environments.local.DuckDBConnectionWrapper object at 0x75d55c121970>, _credentials=DuckDBCredentials(database='supercell', schema='main', path='/home/harsha/data_actions/supercell_cloudops/supercell.duckdb', config_options=None, extensions=None, settings={}, secrets=[], external_root='.', use_credential_provider=None, attach=None, filesystems=None, remote=None, plugins=None, disable_transactions=False, keep_open=True, module_paths=None, retries=None))
[0m17:07:40.337908 [debug] [MainThread]: DuckDB adapter: query cancelled on connection model.supercell.total_cost
[0m17:07:40.338515 [error] [MainThread]: CANCEL query model.supercell.total_cost ........................................ [[31mCANCEL[0m]
[0m17:07:40.339368 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.total_cost"} */

  
    
    

    create  table
      "supercell"."main"."total_cost__dbt_tmp"
  
    as (
      

with base as (
    select
        fact_bill_generation.resource_id,
        date_trunc('month', fact_bill_generation.bill_date) as month,
        fact_bill_generation.bill_amount,
        dim_resource.instance_type,
        dim_resource.product,
        dim_resource.region,
        dim_resource.pricing_model,
        dim_accounts.tag_keys,
        dim_accounts.tag_values
    from "supercell"."main"."fact_bill_generation" as fact_bill_generation
    left join "supercell"."main"."dim_resource" as dim_resource
        on fact_bill_generation.resource_id = dim_resource.resource_id
    left join "supercell"."main"."dim_accounts" as dim_accounts
        on dim_resource.linked_account_id = dim_accounts.linked_account_id
)

select
    month,
    sum(bill_amount) as total_cost,
    instance_type,
    product,
    region,
    pricing_model
from base
group by
    month,
    instance_type,
    product,
    region,
    pricing_model
order by
    month,
    instance_type,
    product,
    region,
    pricing_model
    );
  
  
[0m17:07:40.339819 [error] [MainThread]: CANCEL query model.supercell.dim_accounts ...................................... [[31mCANCEL[0m]
[0m17:07:40.340507 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m17:07:40.340877 [error] [MainThread]: CANCEL query model.supercell.dim_resource ...................................... [[31mCANCEL[0m]
[0m17:07:40.341587 [debug] [Thread-1 (]: On model.supercell.total_cost: ROLLBACK
[0m17:07:40.341970 [error] [MainThread]: CANCEL query model.supercell.fact_bill_generation .............................. [[31mCANCEL[0m]
[0m17:07:40.345673 [debug] [Thread-1 (]: Failed to rollback 'model.supercell.total_cost'
[0m17:07:40.346050 [debug] [Thread-1 (]: On model.supercell.total_cost: Close
[0m17:07:40.354011 [debug] [Thread-1 (]: Runtime Error in model total_cost (models/supercell_models/metrics/total_cost.sql)
  INTERRUPT Error: Interrupted!
[0m17:07:40.354850 [error] [Thread-1 (]: 5 of 5 ERROR creating sql table model main.total_cost .......................... [[31mERROR[0m in 33.04s]
[0m17:07:40.355471 [debug] [Thread-1 (]: Finished running node model.supercell.total_cost
[0m17:07:40.355960 [info ] [MainThread]: 
[0m17:07:40.356666 [info ] [MainThread]: [33mExited because of keyboard interrupt[0m
[0m17:07:40.357170 [info ] [MainThread]: 
[0m17:07:40.357785 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m17:07:40.358409 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:07:40.358895 [debug] [MainThread]: Connection 'model.supercell.total_cost' was properly closed.
[0m17:07:40.359321 [debug] [MainThread]: Connection 'model.supercell.dim_accounts' was properly closed.
[0m17:07:40.359714 [debug] [MainThread]: Connection 'model.supercell.dim_resource' was properly closed.
[0m17:07:40.360106 [debug] [MainThread]: Connection 'model.supercell.fact_bill_generation' was properly closed.
[0m17:07:40.360794 [info ] [MainThread]: 
[0m17:07:40.361149 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 33.76 seconds (33.76s).
[0m17:07:40.361543 [error] [MainThread]: Encountered an error:

[0m17:07:40.362975 [error] [MainThread]: Traceback (most recent call last):
  File "/home/harsha/data_actions/supercell_cloudops/supercell_env/lib/python3.12/site-packages/dbt/cli/requires.py", line 153, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "/home/harsha/data_actions/supercell_cloudops/supercell_env/lib/python3.12/site-packages/dbt/cli/requires.py", line 103, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/harsha/data_actions/supercell_cloudops/supercell_env/lib/python3.12/site-packages/dbt/cli/requires.py", line 235, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/harsha/data_actions/supercell_cloudops/supercell_env/lib/python3.12/site-packages/dbt/cli/requires.py", line 264, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/harsha/data_actions/supercell_cloudops/supercell_env/lib/python3.12/site-packages/dbt/cli/requires.py", line 311, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/harsha/data_actions/supercell_cloudops/supercell_env/lib/python3.12/site-packages/dbt/cli/requires.py", line 328, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/harsha/data_actions/supercell_cloudops/supercell_env/lib/python3.12/site-packages/dbt/cli/main.py", line 578, in run
    results = task.run()
              ^^^^^^^^^^
  File "/home/harsha/data_actions/supercell_cloudops/supercell_env/lib/python3.12/site-packages/dbt/task/runnable.py", line 590, in run
    result = self.execute_with_hooks(selected_uids)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/harsha/data_actions/supercell_cloudops/supercell_env/lib/python3.12/site-packages/dbt/task/runnable.py", line 532, in execute_with_hooks
    res = self.execute_nodes()
          ^^^^^^^^^^^^^^^^^^^^
  File "/home/harsha/data_actions/supercell_cloudops/supercell_env/lib/python3.12/site-packages/dbt/task/runnable.py", line 413, in execute_nodes
    self.run_queue(pool)
  File "/home/harsha/data_actions/supercell_cloudops/supercell_env/lib/python3.12/site-packages/dbt/task/runnable.py", line 340, in run_queue
    self.job_queue.join()
  File "/home/harsha/data_actions/supercell_cloudops/supercell_env/lib/python3.12/site-packages/dbt/graph/queue.py", line 206, in join
    self.inner.join()
  File "/usr/lib/python3.12/queue.py", line 90, in join
    self.all_tasks_done.wait()
  File "/usr/lib/python3.12/threading.py", line 355, in wait
    waiter.acquire()
KeyboardInterrupt

[0m17:07:40.363905 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 34.226025, "process_in_blocks": "0", "process_kernel_time": 0.48997, "process_mem_max_rss": "371876", "process_out_blocks": "58336", "process_user_time": 168.99283}
[0m17:07:40.364343 [debug] [MainThread]: Command `dbt run` failed at 17:07:40.364253 after 34.23 seconds
[0m17:07:40.364640 [debug] [MainThread]: Flushing usage events


============================== 17:11:51.323386 | 24628ed4-10d1-4445-bc08-507615035819 ==============================
[0m17:11:51.323386 [info ] [MainThread]: Running with dbt=1.9.4
[0m17:11:51.325606 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/harsha/data_actions/supercell_cloudops/logs', 'debug': 'False', 'profiles_dir': '/home/harsha/data_actions/supercell_cloudops', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'False'}
[0m17:11:51.325879 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality

User config should be moved from the 'config' key in profiles.yml to the 'flags' key in dbt_project.yml.
[0m17:11:51.487374 [info ] [MainThread]: Registered adapter: duckdb=1.9.3
[0m17:11:51.525626 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m17:11:51.567611 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:11:51.568055 [debug] [MainThread]: Partial parsing: updated file: supercell://models/supercell_models/metrics/total_cost.sql
[0m17:11:51.710525 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.supercell.example
[0m17:11:51.743760 [debug] [MainThread]: Wrote artifact WritableManifest to /home/harsha/data_actions/supercell_cloudops/target/manifest.json
[0m17:11:51.744879 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/harsha/data_actions/supercell_cloudops/target/semantic_manifest.json
[0m17:11:51.752028 [info ] [MainThread]: Found 5 models, 428 macros
[0m17:11:51.753262 [info ] [MainThread]: 
[0m17:11:51.753566 [info ] [MainThread]: Concurrency: 4 threads (target='default')
[0m17:11:51.753752 [info ] [MainThread]: 
[0m17:11:51.754052 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m17:11:51.758278 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_supercell'
[0m17:11:51.780028 [debug] [ThreadPool]: Using duckdb connection "list_supercell"
[0m17:11:51.780374 [debug] [ThreadPool]: On list_supercell: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "connection_name": "list_supercell"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"supercell"'
    
  
  
[0m17:11:51.780553 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:11:51.788278 [debug] [ThreadPool]: SQL status: OK in 0.008 seconds
[0m17:11:51.789194 [debug] [ThreadPool]: On list_supercell: Close
[0m17:11:51.789797 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_supercell, now create_supercell_main)
[0m17:11:51.790087 [debug] [ThreadPool]: Creating schema "database: "supercell"
schema: "main"
"
[0m17:11:51.794244 [debug] [ThreadPool]: Using duckdb connection "create_supercell_main"
[0m17:11:51.794500 [debug] [ThreadPool]: On create_supercell_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "connection_name": "create_supercell_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='supercell'
        and type='sqlite'
    
  
[0m17:11:51.794683 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:11:51.795420 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m17:11:51.796229 [debug] [ThreadPool]: Using duckdb connection "create_supercell_main"
[0m17:11:51.796428 [debug] [ThreadPool]: On create_supercell_main: BEGIN
[0m17:11:51.796689 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:11:51.796847 [debug] [ThreadPool]: Using duckdb connection "create_supercell_main"
[0m17:11:51.796986 [debug] [ThreadPool]: On create_supercell_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "connection_name": "create_supercell_main"} */

    
    
        create schema if not exists "supercell"."main"
    
[0m17:11:51.797252 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:11:51.797702 [debug] [ThreadPool]: On create_supercell_main: COMMIT
[0m17:11:51.797888 [debug] [ThreadPool]: Using duckdb connection "create_supercell_main"
[0m17:11:51.798040 [debug] [ThreadPool]: On create_supercell_main: COMMIT
[0m17:11:51.798308 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:11:51.798482 [debug] [ThreadPool]: On create_supercell_main: Close
[0m17:11:51.799625 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_supercell_main, now list_supercell_main)
[0m17:11:51.804663 [debug] [ThreadPool]: Using duckdb connection "list_supercell_main"
[0m17:11:51.805012 [debug] [ThreadPool]: On list_supercell_main: BEGIN
[0m17:11:51.805322 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:11:51.805906 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m17:11:51.806228 [debug] [ThreadPool]: Using duckdb connection "list_supercell_main"
[0m17:11:51.806519 [debug] [ThreadPool]: On list_supercell_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "connection_name": "list_supercell_main"} */
select
      'supercell' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'supercell'
  
[0m17:11:51.814985 [debug] [ThreadPool]: SQL status: OK in 0.008 seconds
[0m17:11:51.815914 [debug] [ThreadPool]: On list_supercell_main: ROLLBACK
[0m17:11:51.816554 [debug] [ThreadPool]: Failed to rollback 'list_supercell_main'
[0m17:11:51.816757 [debug] [ThreadPool]: On list_supercell_main: Close
[0m17:11:51.817823 [debug] [MainThread]: Using duckdb connection "master"
[0m17:11:51.818020 [debug] [MainThread]: On master: BEGIN
[0m17:11:51.818202 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:11:51.818558 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:11:51.818749 [debug] [MainThread]: On master: COMMIT
[0m17:11:51.818915 [debug] [MainThread]: Using duckdb connection "master"
[0m17:11:51.819062 [debug] [MainThread]: On master: COMMIT
[0m17:11:51.819335 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:11:51.819500 [debug] [MainThread]: On master: Close
[0m17:11:51.821339 [debug] [Thread-1 (]: Began running node model.supercell.cleaned_usagelogs
[0m17:11:51.821879 [info ] [Thread-1 (]: 1 of 5 START sql table model main.cleaned_usagelogs ............................ [RUN]
[0m17:11:51.822342 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_supercell_main, now model.supercell.cleaned_usagelogs)
[0m17:11:51.822770 [debug] [Thread-1 (]: Began compiling node model.supercell.cleaned_usagelogs
[0m17:11:51.828820 [debug] [Thread-1 (]: Writing injected SQL for node "model.supercell.cleaned_usagelogs"
[0m17:11:51.829347 [debug] [Thread-1 (]: Began executing node model.supercell.cleaned_usagelogs
[0m17:11:51.847896 [debug] [Thread-1 (]: Writing runtime sql for node "model.supercell.cleaned_usagelogs"
[0m17:11:51.848406 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.cleaned_usagelogs"
[0m17:11:51.848650 [debug] [Thread-1 (]: On model.supercell.cleaned_usagelogs: BEGIN
[0m17:11:51.848854 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:11:51.849453 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:11:51.849665 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.cleaned_usagelogs"
[0m17:11:51.849853 [debug] [Thread-1 (]: On model.supercell.cleaned_usagelogs: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.cleaned_usagelogs"} */

  
    
    

    create  table
      "supercell"."main"."cleaned_usagelogs__dbt_tmp"
  
    as (
      


SELECT
    CAST("LinkedAccountId" AS VARCHAR) AS linked_account_id,
    CAST("bill/PayerAccountId" AS VARCHAR) AS payer_account_id,
    CAST("lineItem/UsageStartDate" AS TIMESTAMP) AS usage_start_date,
    CAST("lineItem/UsageEndDate" AS TIMESTAMP) AS usage_end_date,
    CAST("lineItem/UsageAmount" AS DECIMAL(18, 6)) AS usage_amount,
    CAST("lineItem/Operation" AS VARCHAR) AS operation,
    CAST("pricing/PricingModel" AS VARCHAR) AS pricing_model,
    CAST("resourceTags/TagKeys" AS VARCHAR) AS tag_keys,
    CAST("resourceTags/TagValues" AS VARCHAR) AS tag_values,
    CAST("product/Region" AS VARCHAR) AS region,
    CAST("product/ServiceCode" AS VARCHAR) AS service_code,
    CAST("product/InstanceType" AS VARCHAR) AS instance_type,
    CAST("amortized_cost" AS DECIMAL(18, 6)) AS amortized_cost,
    CAST("product/Description" AS VARCHAR) AS description
FROM supercell_usagelogs
    );
  
  
[0m17:11:52.120737 [debug] [Thread-1 (]: SQL status: OK in 0.271 seconds
[0m17:11:52.124504 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.cleaned_usagelogs"
[0m17:11:52.124779 [debug] [Thread-1 (]: On model.supercell.cleaned_usagelogs: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.cleaned_usagelogs"} */
alter table "supercell"."main"."cleaned_usagelogs" rename to "cleaned_usagelogs__dbt_backup"
[0m17:11:52.125320 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:11:52.126913 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.cleaned_usagelogs"
[0m17:11:52.127131 [debug] [Thread-1 (]: On model.supercell.cleaned_usagelogs: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.cleaned_usagelogs"} */
alter table "supercell"."main"."cleaned_usagelogs__dbt_tmp" rename to "cleaned_usagelogs"
[0m17:11:52.127547 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:11:52.136805 [debug] [Thread-1 (]: On model.supercell.cleaned_usagelogs: COMMIT
[0m17:11:52.137093 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.cleaned_usagelogs"
[0m17:11:52.137305 [debug] [Thread-1 (]: On model.supercell.cleaned_usagelogs: COMMIT
[0m17:11:52.159095 [debug] [Thread-1 (]: SQL status: OK in 0.021 seconds
[0m17:11:52.164212 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.cleaned_usagelogs"
[0m17:11:52.164671 [debug] [Thread-1 (]: On model.supercell.cleaned_usagelogs: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.cleaned_usagelogs"} */
drop table if exists "supercell"."main"."cleaned_usagelogs__dbt_backup" cascade
[0m17:11:52.167338 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m17:11:52.169002 [debug] [Thread-1 (]: On model.supercell.cleaned_usagelogs: Close
[0m17:11:52.174932 [info ] [Thread-1 (]: 1 of 5 OK created sql table model main.cleaned_usagelogs ....................... [[32mOK[0m in 0.35s]
[0m17:11:52.175392 [debug] [Thread-1 (]: Finished running node model.supercell.cleaned_usagelogs
[0m17:11:52.176293 [debug] [Thread-3 (]: Began running node model.supercell.dim_accounts
[0m17:11:52.176834 [debug] [Thread-4 (]: Began running node model.supercell.dim_resource
[0m17:11:52.177374 [debug] [Thread-2 (]: Began running node model.supercell.fact_bill_generation
[0m17:11:52.178369 [info ] [Thread-3 (]: 2 of 5 START sql table model main.dim_accounts ................................. [RUN]
[0m17:11:52.179478 [info ] [Thread-4 (]: 3 of 5 START sql table model main.dim_resource ................................. [RUN]
[0m17:11:52.180018 [info ] [Thread-2 (]: 4 of 5 START sql table model main.fact_bill_generation ......................... [RUN]
[0m17:11:52.180743 [debug] [Thread-3 (]: Acquiring new duckdb connection 'model.supercell.dim_accounts'
[0m17:11:52.181508 [debug] [Thread-4 (]: Acquiring new duckdb connection 'model.supercell.dim_resource'
[0m17:11:52.182120 [debug] [Thread-2 (]: Acquiring new duckdb connection 'model.supercell.fact_bill_generation'
[0m17:11:52.182734 [debug] [Thread-3 (]: Began compiling node model.supercell.dim_accounts
[0m17:11:52.183207 [debug] [Thread-4 (]: Began compiling node model.supercell.dim_resource
[0m17:11:52.183556 [debug] [Thread-2 (]: Began compiling node model.supercell.fact_bill_generation
[0m17:11:52.188245 [debug] [Thread-3 (]: Writing injected SQL for node "model.supercell.dim_accounts"
[0m17:11:52.190868 [debug] [Thread-4 (]: Writing injected SQL for node "model.supercell.dim_resource"
[0m17:11:52.192847 [debug] [Thread-2 (]: Writing injected SQL for node "model.supercell.fact_bill_generation"
[0m17:11:52.193371 [debug] [Thread-3 (]: Began executing node model.supercell.dim_accounts
[0m17:11:52.195475 [debug] [Thread-3 (]: Writing runtime sql for node "model.supercell.dim_accounts"
[0m17:11:52.196014 [debug] [Thread-4 (]: Began executing node model.supercell.dim_resource
[0m17:11:52.197882 [debug] [Thread-4 (]: Writing runtime sql for node "model.supercell.dim_resource"
[0m17:11:52.198516 [debug] [Thread-4 (]: Using duckdb connection "model.supercell.dim_resource"
[0m17:11:52.198745 [debug] [Thread-4 (]: On model.supercell.dim_resource: BEGIN
[0m17:11:52.198984 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m17:11:52.199330 [debug] [Thread-3 (]: Using duckdb connection "model.supercell.dim_accounts"
[0m17:11:52.199696 [debug] [Thread-2 (]: Began executing node model.supercell.fact_bill_generation
[0m17:11:52.200295 [debug] [Thread-3 (]: On model.supercell.dim_accounts: BEGIN
[0m17:11:52.202276 [debug] [Thread-2 (]: Writing runtime sql for node "model.supercell.fact_bill_generation"
[0m17:11:52.202565 [debug] [Thread-4 (]: SQL status: OK in 0.004 seconds
[0m17:11:52.202961 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m17:11:52.203472 [debug] [Thread-4 (]: Using duckdb connection "model.supercell.dim_resource"
[0m17:11:52.203851 [debug] [Thread-2 (]: Using duckdb connection "model.supercell.fact_bill_generation"
[0m17:11:52.204437 [debug] [Thread-4 (]: On model.supercell.dim_resource: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.dim_resource"} */

  
    
    

    create  table
      "supercell"."main"."dim_resource__dbt_tmp"
  
    as (
      


select
    md5(concat(linked_account_id, '_', service_code, '_', instance_type, '_', region, '_', CAST(usage_start_date AS VARCHAR), '_', CAST(usage_end_date AS VARCHAR))) AS resource_id,
    linked_account_id as linked_account_id,
    region,
    service_code as product,
    instance_type as instance_type,
    pricing_model as pricing_model
from "supercell"."main"."cleaned_usagelogs"
    );
  
  
[0m17:11:52.204865 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m17:11:52.205256 [debug] [Thread-2 (]: On model.supercell.fact_bill_generation: BEGIN
[0m17:11:52.205782 [debug] [Thread-3 (]: Using duckdb connection "model.supercell.dim_accounts"
[0m17:11:52.206172 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m17:11:52.206666 [debug] [Thread-3 (]: On model.supercell.dim_accounts: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.dim_accounts"} */

  
    
    

    create  table
      "supercell"."main"."dim_accounts__dbt_tmp"
  
    as (
      


select
    linked_account_id as linked_account_id,
    tag_keys as tag_keys,
    tag_values as tag_values
from "supercell"."main"."cleaned_usagelogs"
    );
  
  
[0m17:11:52.207597 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m17:11:52.208034 [debug] [Thread-2 (]: Using duckdb connection "model.supercell.fact_bill_generation"
[0m17:11:52.208973 [debug] [Thread-2 (]: On model.supercell.fact_bill_generation: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.fact_bill_generation"} */

  
    
    

    create  table
      "supercell"."main"."fact_bill_generation__dbt_tmp"
  
    as (
      


select
    md5(concat(linked_account_id, '_', service_code, '_', instance_type, '_', region, '_', CAST(usage_start_date AS VARCHAR), '_', CAST(usage_end_date AS VARCHAR))) AS resource_id,
    usage_start_date as start_date,
    usage_end_date as bill_date,
    usage_amount as bill_amount,
    operation
from "supercell"."main"."cleaned_usagelogs"
    );
  
  
[0m17:11:52.332245 [debug] [Thread-3 (]: SQL status: OK in 0.125 seconds
[0m17:11:52.336038 [debug] [Thread-3 (]: Using duckdb connection "model.supercell.dim_accounts"
[0m17:11:52.336684 [debug] [Thread-3 (]: On model.supercell.dim_accounts: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.dim_accounts"} */
alter table "supercell"."main"."dim_accounts" rename to "dim_accounts__dbt_backup"
[0m17:11:52.337844 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m17:11:52.341754 [debug] [Thread-3 (]: Using duckdb connection "model.supercell.dim_accounts"
[0m17:11:52.342389 [debug] [Thread-3 (]: On model.supercell.dim_accounts: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.dim_accounts"} */
alter table "supercell"."main"."dim_accounts__dbt_tmp" rename to "dim_accounts"
[0m17:11:52.343510 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m17:11:52.345555 [debug] [Thread-3 (]: On model.supercell.dim_accounts: COMMIT
[0m17:11:52.346098 [debug] [Thread-3 (]: Using duckdb connection "model.supercell.dim_accounts"
[0m17:11:52.346499 [debug] [Thread-3 (]: On model.supercell.dim_accounts: COMMIT
[0m17:11:52.384154 [debug] [Thread-3 (]: SQL status: OK in 0.037 seconds
[0m17:11:52.386360 [debug] [Thread-3 (]: Using duckdb connection "model.supercell.dim_accounts"
[0m17:11:52.386761 [debug] [Thread-3 (]: On model.supercell.dim_accounts: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.dim_accounts"} */
drop table if exists "supercell"."main"."dim_accounts__dbt_backup" cascade
[0m17:11:52.388947 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m17:11:52.390277 [debug] [Thread-3 (]: On model.supercell.dim_accounts: Close
[0m17:11:52.390704 [debug] [Thread-2 (]: SQL status: OK in 0.181 seconds
[0m17:11:52.392666 [debug] [Thread-2 (]: Using duckdb connection "model.supercell.fact_bill_generation"
[0m17:11:52.392943 [debug] [Thread-2 (]: On model.supercell.fact_bill_generation: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.fact_bill_generation"} */
alter table "supercell"."main"."fact_bill_generation" rename to "fact_bill_generation__dbt_backup"
[0m17:11:52.393605 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m17:11:52.395572 [debug] [Thread-2 (]: Using duckdb connection "model.supercell.fact_bill_generation"
[0m17:11:52.395917 [debug] [Thread-2 (]: On model.supercell.fact_bill_generation: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.fact_bill_generation"} */
alter table "supercell"."main"."fact_bill_generation__dbt_tmp" rename to "fact_bill_generation"
[0m17:11:52.396888 [info ] [Thread-3 (]: 2 of 5 OK created sql table model main.dim_accounts ............................ [[32mOK[0m in 0.22s]
[0m17:11:52.397703 [debug] [Thread-3 (]: Finished running node model.supercell.dim_accounts
[0m17:11:52.398258 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m17:11:52.399658 [debug] [Thread-2 (]: On model.supercell.fact_bill_generation: COMMIT
[0m17:11:52.400016 [debug] [Thread-2 (]: Using duckdb connection "model.supercell.fact_bill_generation"
[0m17:11:52.400335 [debug] [Thread-2 (]: On model.supercell.fact_bill_generation: COMMIT
[0m17:11:52.417032 [debug] [Thread-2 (]: SQL status: OK in 0.016 seconds
[0m17:11:52.420200 [debug] [Thread-2 (]: Using duckdb connection "model.supercell.fact_bill_generation"
[0m17:11:52.420522 [debug] [Thread-2 (]: On model.supercell.fact_bill_generation: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.fact_bill_generation"} */
drop table if exists "supercell"."main"."fact_bill_generation__dbt_backup" cascade
[0m17:11:52.422334 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m17:11:52.423271 [debug] [Thread-2 (]: On model.supercell.fact_bill_generation: Close
[0m17:11:52.424386 [info ] [Thread-2 (]: 4 of 5 OK created sql table model main.fact_bill_generation .................... [[32mOK[0m in 0.24s]
[0m17:11:52.424748 [debug] [Thread-2 (]: Finished running node model.supercell.fact_bill_generation
[0m17:11:52.460973 [debug] [Thread-4 (]: SQL status: OK in 0.255 seconds
[0m17:11:52.462912 [debug] [Thread-4 (]: Using duckdb connection "model.supercell.dim_resource"
[0m17:11:52.463191 [debug] [Thread-4 (]: On model.supercell.dim_resource: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.dim_resource"} */
alter table "supercell"."main"."dim_resource" rename to "dim_resource__dbt_backup"
[0m17:11:52.463770 [debug] [Thread-4 (]: SQL status: OK in 0.000 seconds
[0m17:11:52.465369 [debug] [Thread-4 (]: Using duckdb connection "model.supercell.dim_resource"
[0m17:11:52.465586 [debug] [Thread-4 (]: On model.supercell.dim_resource: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.dim_resource"} */
alter table "supercell"."main"."dim_resource__dbt_tmp" rename to "dim_resource"
[0m17:11:52.466011 [debug] [Thread-4 (]: SQL status: OK in 0.000 seconds
[0m17:11:52.467005 [debug] [Thread-4 (]: On model.supercell.dim_resource: COMMIT
[0m17:11:52.467228 [debug] [Thread-4 (]: Using duckdb connection "model.supercell.dim_resource"
[0m17:11:52.467410 [debug] [Thread-4 (]: On model.supercell.dim_resource: COMMIT
[0m17:11:52.475889 [debug] [Thread-4 (]: SQL status: OK in 0.008 seconds
[0m17:11:52.477063 [debug] [Thread-4 (]: Using duckdb connection "model.supercell.dim_resource"
[0m17:11:52.477290 [debug] [Thread-4 (]: On model.supercell.dim_resource: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.dim_resource"} */
drop table if exists "supercell"."main"."dim_resource__dbt_backup" cascade
[0m17:11:52.479378 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m17:11:52.480232 [debug] [Thread-4 (]: On model.supercell.dim_resource: Close
[0m17:11:52.481748 [info ] [Thread-4 (]: 3 of 5 OK created sql table model main.dim_resource ............................ [[32mOK[0m in 0.30s]
[0m17:11:52.482104 [debug] [Thread-4 (]: Finished running node model.supercell.dim_resource
[0m17:11:52.482931 [debug] [Thread-1 (]: Began running node model.supercell.total_cost
[0m17:11:52.483314 [info ] [Thread-1 (]: 5 of 5 START sql table model main.total_cost ................................... [RUN]
[0m17:11:52.483643 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.supercell.cleaned_usagelogs, now model.supercell.total_cost)
[0m17:11:52.483854 [debug] [Thread-1 (]: Began compiling node model.supercell.total_cost
[0m17:11:52.486305 [debug] [Thread-1 (]: Writing injected SQL for node "model.supercell.total_cost"
[0m17:11:52.486886 [debug] [Thread-1 (]: Began executing node model.supercell.total_cost
[0m17:11:52.489791 [debug] [Thread-1 (]: Writing runtime sql for node "model.supercell.total_cost"
[0m17:11:52.490400 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.total_cost"
[0m17:11:52.490669 [debug] [Thread-1 (]: On model.supercell.total_cost: BEGIN
[0m17:11:52.490850 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:11:52.491793 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:11:52.492079 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.total_cost"
[0m17:11:52.492321 [debug] [Thread-1 (]: On model.supercell.total_cost: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.total_cost"} */

  
    
    

    create  table
      "supercell"."main"."total_cost__dbt_tmp"
  
    as (
      

with base as (
    select
        fact_bill_generation.resource_id as resource_id,
        date_trunc('month', fact_bill_generation.bill_date) as month,
        fact_bill_generation.bill_amount as bill_amount,
        dim_resource.instance_type as instance_type,
        dim_resource.product as product,
        dim_resource.region as region,
        dim_resource.pricing_model as pricing_model
    from "supercell"."main"."fact_bill_generation" as fact_bill_generation
    left join "supercell"."main"."dim_resource" as dim_resource
        on fact_bill_generation.resource_id = dim_resource.resource_id
),

joined as (
    select
        base.resource_id,
        base.month,
        base.bill_amount,
        base.instance_type,
        base.product,
        base.region,
        base.pricing_model,
        dim_accounts.tag_keys as tag_keys,
        dim_accounts.tag_values as tag_values
    from base
    left join "supercell"."main"."dim_accounts" as dim_accounts
        on base.resource_id = dim_accounts.linked_account_id
)


select
    month,
    sum(bill_amount) as total_cost,
    instance_type,
    product,
    region,
    pricing_model
from joined
group by
    month,
    instance_type,
    product,
    region,
    pricing_model
order by
    month,
    instance_type,
    product,
    region,
    pricing_model
    );
  
  
[0m17:11:52.832575 [debug] [Thread-1 (]: SQL status: OK in 0.340 seconds
[0m17:11:52.834501 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.total_cost"
[0m17:11:52.834763 [debug] [Thread-1 (]: On model.supercell.total_cost: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.total_cost"} */
alter table "supercell"."main"."total_cost" rename to "total_cost__dbt_backup"
[0m17:11:52.835274 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:11:52.836954 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.total_cost"
[0m17:11:52.837200 [debug] [Thread-1 (]: On model.supercell.total_cost: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.total_cost"} */
alter table "supercell"."main"."total_cost__dbt_tmp" rename to "total_cost"
[0m17:11:52.837593 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:11:52.838720 [debug] [Thread-1 (]: On model.supercell.total_cost: COMMIT
[0m17:11:52.838958 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.total_cost"
[0m17:11:52.839167 [debug] [Thread-1 (]: On model.supercell.total_cost: COMMIT
[0m17:11:52.842626 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m17:11:52.843834 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.total_cost"
[0m17:11:52.844044 [debug] [Thread-1 (]: On model.supercell.total_cost: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.total_cost"} */
drop table if exists "supercell"."main"."total_cost__dbt_backup" cascade
[0m17:11:52.846763 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m17:11:52.847756 [debug] [Thread-1 (]: On model.supercell.total_cost: Close
[0m17:11:52.852360 [info ] [Thread-1 (]: 5 of 5 OK created sql table model main.total_cost .............................. [[32mOK[0m in 0.37s]
[0m17:11:52.852752 [debug] [Thread-1 (]: Finished running node model.supercell.total_cost
[0m17:11:52.854637 [debug] [MainThread]: Using duckdb connection "master"
[0m17:11:52.854960 [debug] [MainThread]: On master: BEGIN
[0m17:11:52.855179 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:11:52.856314 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m17:11:52.856622 [debug] [MainThread]: On master: COMMIT
[0m17:11:52.856810 [debug] [MainThread]: Using duckdb connection "master"
[0m17:11:52.856980 [debug] [MainThread]: On master: COMMIT
[0m17:11:52.857383 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:11:52.857597 [debug] [MainThread]: On master: Close
[0m17:11:52.858250 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:11:52.858532 [debug] [MainThread]: Connection 'model.supercell.total_cost' was properly closed.
[0m17:11:52.858693 [debug] [MainThread]: Connection 'model.supercell.dim_accounts' was properly closed.
[0m17:11:52.858833 [debug] [MainThread]: Connection 'model.supercell.dim_resource' was properly closed.
[0m17:11:52.858965 [debug] [MainThread]: Connection 'model.supercell.fact_bill_generation' was properly closed.
[0m17:11:52.859215 [info ] [MainThread]: 
[0m17:11:52.859429 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 1.11 seconds (1.11s).
[0m17:11:52.860021 [debug] [MainThread]: Command end result
[0m17:11:52.914090 [debug] [MainThread]: Wrote artifact WritableManifest to /home/harsha/data_actions/supercell_cloudops/target/manifest.json
[0m17:11:52.915101 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/harsha/data_actions/supercell_cloudops/target/semantic_manifest.json
[0m17:11:52.918670 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/harsha/data_actions/supercell_cloudops/target/run_results.json
[0m17:11:52.918875 [info ] [MainThread]: 
[0m17:11:52.919077 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:11:52.919260 [info ] [MainThread]: 
[0m17:11:52.919438 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m17:11:52.920096 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.6322925, "process_in_blocks": "0", "process_kernel_time": 0.401324, "process_mem_max_rss": "358732", "process_out_blocks": "59240", "process_user_time": 5.394476}
[0m17:11:52.920431 [debug] [MainThread]: Command `dbt run` succeeded at 17:11:52.920366 after 1.63 seconds
[0m17:11:52.920642 [debug] [MainThread]: Flushing usage events


============================== 17:12:12.511678 | a5aa1274-81b4-4f32-94c5-8e20612e9929 ==============================
[0m17:12:12.511678 [info ] [MainThread]: Running with dbt=1.9.4
[0m17:12:12.513913 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/harsha/data_actions/supercell_cloudops', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/harsha/data_actions/supercell_cloudops/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'False'}
[0m17:12:12.514175 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality

User config should be moved from the 'config' key in profiles.yml to the 'flags' key in dbt_project.yml.
[0m17:12:12.669897 [info ] [MainThread]: Registered adapter: duckdb=1.9.3
[0m17:12:12.707213 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m17:12:12.746516 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:12:12.746919 [debug] [MainThread]: Partial parsing: updated file: supercell://models/supercell_models/metrics/total_cost.sql
[0m17:12:12.881631 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.supercell.example
[0m17:12:12.913604 [debug] [MainThread]: Wrote artifact WritableManifest to /home/harsha/data_actions/supercell_cloudops/target/manifest.json
[0m17:12:12.914627 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/harsha/data_actions/supercell_cloudops/target/semantic_manifest.json
[0m17:12:12.921727 [info ] [MainThread]: Found 5 models, 428 macros
[0m17:12:12.922965 [info ] [MainThread]: 
[0m17:12:12.923417 [info ] [MainThread]: Concurrency: 4 threads (target='default')
[0m17:12:12.923650 [info ] [MainThread]: 
[0m17:12:12.924096 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m17:12:12.927748 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_supercell'
[0m17:12:12.948904 [debug] [ThreadPool]: Using duckdb connection "list_supercell"
[0m17:12:12.949212 [debug] [ThreadPool]: On list_supercell: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "connection_name": "list_supercell"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"supercell"'
    
  
  
[0m17:12:12.949412 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:12:12.957334 [debug] [ThreadPool]: SQL status: OK in 0.008 seconds
[0m17:12:12.958261 [debug] [ThreadPool]: On list_supercell: Close
[0m17:12:12.958783 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_supercell, now create_supercell_main)
[0m17:12:12.959067 [debug] [ThreadPool]: Creating schema "database: "supercell"
schema: "main"
"
[0m17:12:12.963000 [debug] [ThreadPool]: Using duckdb connection "create_supercell_main"
[0m17:12:12.963240 [debug] [ThreadPool]: On create_supercell_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "connection_name": "create_supercell_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='supercell'
        and type='sqlite'
    
  
[0m17:12:12.963423 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:12:12.964088 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m17:12:12.964904 [debug] [ThreadPool]: Using duckdb connection "create_supercell_main"
[0m17:12:12.965091 [debug] [ThreadPool]: On create_supercell_main: BEGIN
[0m17:12:12.965418 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:12:12.965617 [debug] [ThreadPool]: Using duckdb connection "create_supercell_main"
[0m17:12:12.965777 [debug] [ThreadPool]: On create_supercell_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "connection_name": "create_supercell_main"} */

    
    
        create schema if not exists "supercell"."main"
    
[0m17:12:12.966066 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:12:12.966558 [debug] [ThreadPool]: On create_supercell_main: COMMIT
[0m17:12:12.966748 [debug] [ThreadPool]: Using duckdb connection "create_supercell_main"
[0m17:12:12.966912 [debug] [ThreadPool]: On create_supercell_main: COMMIT
[0m17:12:12.967195 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:12:12.967371 [debug] [ThreadPool]: On create_supercell_main: Close
[0m17:12:12.968422 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_supercell_main, now list_supercell_main)
[0m17:12:12.973481 [debug] [ThreadPool]: Using duckdb connection "list_supercell_main"
[0m17:12:12.973882 [debug] [ThreadPool]: On list_supercell_main: BEGIN
[0m17:12:12.974193 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:12:12.974966 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m17:12:12.975295 [debug] [ThreadPool]: Using duckdb connection "list_supercell_main"
[0m17:12:12.975594 [debug] [ThreadPool]: On list_supercell_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "connection_name": "list_supercell_main"} */
select
      'supercell' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'supercell'
  
[0m17:12:12.985081 [debug] [ThreadPool]: SQL status: OK in 0.009 seconds
[0m17:12:12.985949 [debug] [ThreadPool]: On list_supercell_main: ROLLBACK
[0m17:12:12.986590 [debug] [ThreadPool]: Failed to rollback 'list_supercell_main'
[0m17:12:12.986797 [debug] [ThreadPool]: On list_supercell_main: Close
[0m17:12:12.988076 [debug] [MainThread]: Using duckdb connection "master"
[0m17:12:12.988307 [debug] [MainThread]: On master: BEGIN
[0m17:12:12.988480 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:12:12.988852 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:12:12.989027 [debug] [MainThread]: On master: COMMIT
[0m17:12:12.989231 [debug] [MainThread]: Using duckdb connection "master"
[0m17:12:12.989399 [debug] [MainThread]: On master: COMMIT
[0m17:12:12.989704 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:12:12.989903 [debug] [MainThread]: On master: Close
[0m17:12:12.992094 [debug] [Thread-1 (]: Began running node model.supercell.cleaned_usagelogs
[0m17:12:12.992658 [info ] [Thread-1 (]: 1 of 5 START sql table model main.cleaned_usagelogs ............................ [RUN]
[0m17:12:12.993103 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_supercell_main, now model.supercell.cleaned_usagelogs)
[0m17:12:12.993496 [debug] [Thread-1 (]: Began compiling node model.supercell.cleaned_usagelogs
[0m17:12:13.000930 [debug] [Thread-1 (]: Writing injected SQL for node "model.supercell.cleaned_usagelogs"
[0m17:12:13.001647 [debug] [Thread-1 (]: Began executing node model.supercell.cleaned_usagelogs
[0m17:12:13.020331 [debug] [Thread-1 (]: Writing runtime sql for node "model.supercell.cleaned_usagelogs"
[0m17:12:13.020864 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.cleaned_usagelogs"
[0m17:12:13.021107 [debug] [Thread-1 (]: On model.supercell.cleaned_usagelogs: BEGIN
[0m17:12:13.021331 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:12:13.021952 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:12:13.022168 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.cleaned_usagelogs"
[0m17:12:13.022369 [debug] [Thread-1 (]: On model.supercell.cleaned_usagelogs: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.cleaned_usagelogs"} */

  
    
    

    create  table
      "supercell"."main"."cleaned_usagelogs__dbt_tmp"
  
    as (
      


SELECT
    CAST("LinkedAccountId" AS VARCHAR) AS linked_account_id,
    CAST("bill/PayerAccountId" AS VARCHAR) AS payer_account_id,
    CAST("lineItem/UsageStartDate" AS TIMESTAMP) AS usage_start_date,
    CAST("lineItem/UsageEndDate" AS TIMESTAMP) AS usage_end_date,
    CAST("lineItem/UsageAmount" AS DECIMAL(18, 6)) AS usage_amount,
    CAST("lineItem/Operation" AS VARCHAR) AS operation,
    CAST("pricing/PricingModel" AS VARCHAR) AS pricing_model,
    CAST("resourceTags/TagKeys" AS VARCHAR) AS tag_keys,
    CAST("resourceTags/TagValues" AS VARCHAR) AS tag_values,
    CAST("product/Region" AS VARCHAR) AS region,
    CAST("product/ServiceCode" AS VARCHAR) AS service_code,
    CAST("product/InstanceType" AS VARCHAR) AS instance_type,
    CAST("amortized_cost" AS DECIMAL(18, 6)) AS amortized_cost,
    CAST("product/Description" AS VARCHAR) AS description
FROM supercell_usagelogs
    );
  
  
[0m17:12:13.279836 [debug] [Thread-1 (]: SQL status: OK in 0.257 seconds
[0m17:12:13.283568 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.cleaned_usagelogs"
[0m17:12:13.283836 [debug] [Thread-1 (]: On model.supercell.cleaned_usagelogs: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.cleaned_usagelogs"} */
alter table "supercell"."main"."cleaned_usagelogs" rename to "cleaned_usagelogs__dbt_backup"
[0m17:12:13.284378 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:12:13.285874 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.cleaned_usagelogs"
[0m17:12:13.286102 [debug] [Thread-1 (]: On model.supercell.cleaned_usagelogs: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.cleaned_usagelogs"} */
alter table "supercell"."main"."cleaned_usagelogs__dbt_tmp" rename to "cleaned_usagelogs"
[0m17:12:13.286551 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:12:13.296044 [debug] [Thread-1 (]: On model.supercell.cleaned_usagelogs: COMMIT
[0m17:12:13.296378 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.cleaned_usagelogs"
[0m17:12:13.296594 [debug] [Thread-1 (]: On model.supercell.cleaned_usagelogs: COMMIT
[0m17:12:13.322422 [debug] [Thread-1 (]: SQL status: OK in 0.026 seconds
[0m17:12:13.325539 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.cleaned_usagelogs"
[0m17:12:13.325804 [debug] [Thread-1 (]: On model.supercell.cleaned_usagelogs: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.cleaned_usagelogs"} */
drop table if exists "supercell"."main"."cleaned_usagelogs__dbt_backup" cascade
[0m17:12:13.328117 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m17:12:13.329598 [debug] [Thread-1 (]: On model.supercell.cleaned_usagelogs: Close
[0m17:12:13.334455 [info ] [Thread-1 (]: 1 of 5 OK created sql table model main.cleaned_usagelogs ....................... [[32mOK[0m in 0.34s]
[0m17:12:13.334840 [debug] [Thread-1 (]: Finished running node model.supercell.cleaned_usagelogs
[0m17:12:13.335996 [debug] [Thread-3 (]: Began running node model.supercell.dim_accounts
[0m17:12:13.336567 [debug] [Thread-4 (]: Began running node model.supercell.dim_resource
[0m17:12:13.337324 [info ] [Thread-3 (]: 2 of 5 START sql table model main.dim_accounts ................................. [RUN]
[0m17:12:13.337934 [debug] [Thread-2 (]: Began running node model.supercell.fact_bill_generation
[0m17:12:13.338681 [info ] [Thread-4 (]: 3 of 5 START sql table model main.dim_resource ................................. [RUN]
[0m17:12:13.339813 [debug] [Thread-3 (]: Acquiring new duckdb connection 'model.supercell.dim_accounts'
[0m17:12:13.340561 [info ] [Thread-2 (]: 4 of 5 START sql table model main.fact_bill_generation ......................... [RUN]
[0m17:12:13.341577 [debug] [Thread-4 (]: Acquiring new duckdb connection 'model.supercell.dim_resource'
[0m17:12:13.342398 [debug] [Thread-3 (]: Began compiling node model.supercell.dim_accounts
[0m17:12:13.343118 [debug] [Thread-2 (]: Acquiring new duckdb connection 'model.supercell.fact_bill_generation'
[0m17:12:13.343729 [debug] [Thread-4 (]: Began compiling node model.supercell.dim_resource
[0m17:12:13.348696 [debug] [Thread-3 (]: Writing injected SQL for node "model.supercell.dim_accounts"
[0m17:12:13.349420 [debug] [Thread-2 (]: Began compiling node model.supercell.fact_bill_generation
[0m17:12:13.352818 [debug] [Thread-4 (]: Writing injected SQL for node "model.supercell.dim_resource"
[0m17:12:13.355846 [debug] [Thread-2 (]: Writing injected SQL for node "model.supercell.fact_bill_generation"
[0m17:12:13.356444 [debug] [Thread-3 (]: Began executing node model.supercell.dim_accounts
[0m17:12:13.357211 [debug] [Thread-4 (]: Began executing node model.supercell.dim_resource
[0m17:12:13.359213 [debug] [Thread-3 (]: Writing runtime sql for node "model.supercell.dim_accounts"
[0m17:12:13.359684 [debug] [Thread-2 (]: Began executing node model.supercell.fact_bill_generation
[0m17:12:13.361561 [debug] [Thread-4 (]: Writing runtime sql for node "model.supercell.dim_resource"
[0m17:12:13.364401 [debug] [Thread-2 (]: Writing runtime sql for node "model.supercell.fact_bill_generation"
[0m17:12:13.364964 [debug] [Thread-3 (]: Using duckdb connection "model.supercell.dim_accounts"
[0m17:12:13.365461 [debug] [Thread-4 (]: Using duckdb connection "model.supercell.dim_resource"
[0m17:12:13.366003 [debug] [Thread-2 (]: Using duckdb connection "model.supercell.fact_bill_generation"
[0m17:12:13.366374 [debug] [Thread-3 (]: On model.supercell.dim_accounts: BEGIN
[0m17:12:13.366682 [debug] [Thread-4 (]: On model.supercell.dim_resource: BEGIN
[0m17:12:13.366996 [debug] [Thread-2 (]: On model.supercell.fact_bill_generation: BEGIN
[0m17:12:13.367428 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m17:12:13.367730 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m17:12:13.368036 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m17:12:13.368879 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m17:12:13.369254 [debug] [Thread-4 (]: Using duckdb connection "model.supercell.dim_resource"
[0m17:12:13.369495 [debug] [Thread-4 (]: On model.supercell.dim_resource: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.dim_resource"} */

  
    
    

    create  table
      "supercell"."main"."dim_resource__dbt_tmp"
  
    as (
      


select
    md5(concat(linked_account_id, '_', service_code, '_', instance_type, '_', region, '_', CAST(usage_start_date AS VARCHAR), '_', CAST(usage_end_date AS VARCHAR))) AS resource_id,
    linked_account_id as linked_account_id,
    region,
    service_code as product,
    instance_type as instance_type,
    pricing_model as pricing_model
from "supercell"."main"."cleaned_usagelogs"
    );
  
  
[0m17:12:13.369981 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m17:12:13.370388 [debug] [Thread-2 (]: Using duckdb connection "model.supercell.fact_bill_generation"
[0m17:12:13.371034 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m17:12:13.372117 [debug] [Thread-2 (]: On model.supercell.fact_bill_generation: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.fact_bill_generation"} */

  
    
    

    create  table
      "supercell"."main"."fact_bill_generation__dbt_tmp"
  
    as (
      


select
    md5(concat(linked_account_id, '_', service_code, '_', instance_type, '_', region, '_', CAST(usage_start_date AS VARCHAR), '_', CAST(usage_end_date AS VARCHAR))) AS resource_id,
    usage_start_date as start_date,
    usage_end_date as bill_date,
    usage_amount as bill_amount,
    operation
from "supercell"."main"."cleaned_usagelogs"
    );
  
  
[0m17:12:13.372917 [debug] [Thread-3 (]: Using duckdb connection "model.supercell.dim_accounts"
[0m17:12:13.374809 [debug] [Thread-3 (]: On model.supercell.dim_accounts: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.dim_accounts"} */

  
    
    

    create  table
      "supercell"."main"."dim_accounts__dbt_tmp"
  
    as (
      


select
    linked_account_id as linked_account_id,
    tag_keys as tag_keys,
    tag_values as tag_values
from "supercell"."main"."cleaned_usagelogs"
    );
  
  
[0m17:12:13.530372 [debug] [Thread-3 (]: SQL status: OK in 0.154 seconds
[0m17:12:13.533557 [debug] [Thread-3 (]: Using duckdb connection "model.supercell.dim_accounts"
[0m17:12:13.534219 [debug] [Thread-3 (]: On model.supercell.dim_accounts: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.dim_accounts"} */
alter table "supercell"."main"."dim_accounts" rename to "dim_accounts__dbt_backup"
[0m17:12:13.535312 [debug] [Thread-3 (]: SQL status: OK in 0.000 seconds
[0m17:12:13.538019 [debug] [Thread-3 (]: Using duckdb connection "model.supercell.dim_accounts"
[0m17:12:13.538628 [debug] [Thread-3 (]: On model.supercell.dim_accounts: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.dim_accounts"} */
alter table "supercell"."main"."dim_accounts__dbt_tmp" rename to "dim_accounts"
[0m17:12:13.539567 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m17:12:13.541375 [debug] [Thread-3 (]: On model.supercell.dim_accounts: COMMIT
[0m17:12:13.541804 [debug] [Thread-3 (]: Using duckdb connection "model.supercell.dim_accounts"
[0m17:12:13.542217 [debug] [Thread-2 (]: SQL status: OK in 0.168 seconds
[0m17:12:13.542520 [debug] [Thread-3 (]: On model.supercell.dim_accounts: COMMIT
[0m17:12:13.544593 [debug] [Thread-2 (]: Using duckdb connection "model.supercell.fact_bill_generation"
[0m17:12:13.545034 [debug] [Thread-2 (]: On model.supercell.fact_bill_generation: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.fact_bill_generation"} */
alter table "supercell"."main"."fact_bill_generation" rename to "fact_bill_generation__dbt_backup"
[0m17:12:13.545771 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m17:12:13.547686 [debug] [Thread-2 (]: Using duckdb connection "model.supercell.fact_bill_generation"
[0m17:12:13.547980 [debug] [Thread-2 (]: On model.supercell.fact_bill_generation: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.fact_bill_generation"} */
alter table "supercell"."main"."fact_bill_generation__dbt_tmp" rename to "fact_bill_generation"
[0m17:12:13.548638 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m17:12:13.549815 [debug] [Thread-2 (]: On model.supercell.fact_bill_generation: COMMIT
[0m17:12:13.550128 [debug] [Thread-2 (]: Using duckdb connection "model.supercell.fact_bill_generation"
[0m17:12:13.550377 [debug] [Thread-2 (]: On model.supercell.fact_bill_generation: COMMIT
[0m17:12:13.578821 [debug] [Thread-3 (]: SQL status: OK in 0.034 seconds
[0m17:12:13.580505 [debug] [Thread-3 (]: Using duckdb connection "model.supercell.dim_accounts"
[0m17:12:13.580818 [debug] [Thread-3 (]: On model.supercell.dim_accounts: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.dim_accounts"} */
drop table if exists "supercell"."main"."dim_accounts__dbt_backup" cascade
[0m17:12:13.584179 [debug] [Thread-2 (]: SQL status: OK in 0.034 seconds
[0m17:12:13.586614 [debug] [Thread-2 (]: Using duckdb connection "model.supercell.fact_bill_generation"
[0m17:12:13.586995 [debug] [Thread-3 (]: SQL status: OK in 0.006 seconds
[0m17:12:13.587324 [debug] [Thread-2 (]: On model.supercell.fact_bill_generation: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.fact_bill_generation"} */
drop table if exists "supercell"."main"."fact_bill_generation__dbt_backup" cascade
[0m17:12:13.588533 [debug] [Thread-3 (]: On model.supercell.dim_accounts: Close
[0m17:12:13.590447 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m17:12:13.591466 [debug] [Thread-2 (]: On model.supercell.fact_bill_generation: Close
[0m17:12:13.594070 [info ] [Thread-2 (]: 4 of 5 OK created sql table model main.fact_bill_generation .................... [[32mOK[0m in 0.25s]
[0m17:12:13.594578 [debug] [Thread-2 (]: Finished running node model.supercell.fact_bill_generation
[0m17:12:13.595300 [info ] [Thread-3 (]: 2 of 5 OK created sql table model main.dim_accounts ............................ [[32mOK[0m in 0.26s]
[0m17:12:13.596302 [debug] [Thread-3 (]: Finished running node model.supercell.dim_accounts
[0m17:12:13.616621 [debug] [Thread-4 (]: SQL status: OK in 0.247 seconds
[0m17:12:13.619444 [debug] [Thread-4 (]: Using duckdb connection "model.supercell.dim_resource"
[0m17:12:13.619747 [debug] [Thread-4 (]: On model.supercell.dim_resource: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.dim_resource"} */
alter table "supercell"."main"."dim_resource" rename to "dim_resource__dbt_backup"
[0m17:12:13.620289 [debug] [Thread-4 (]: SQL status: OK in 0.000 seconds
[0m17:12:13.621848 [debug] [Thread-4 (]: Using duckdb connection "model.supercell.dim_resource"
[0m17:12:13.622057 [debug] [Thread-4 (]: On model.supercell.dim_resource: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.dim_resource"} */
alter table "supercell"."main"."dim_resource__dbt_tmp" rename to "dim_resource"
[0m17:12:13.622527 [debug] [Thread-4 (]: SQL status: OK in 0.000 seconds
[0m17:12:13.623800 [debug] [Thread-4 (]: On model.supercell.dim_resource: COMMIT
[0m17:12:13.624030 [debug] [Thread-4 (]: Using duckdb connection "model.supercell.dim_resource"
[0m17:12:13.624251 [debug] [Thread-4 (]: On model.supercell.dim_resource: COMMIT
[0m17:12:13.628756 [debug] [Thread-4 (]: SQL status: OK in 0.004 seconds
[0m17:12:13.630130 [debug] [Thread-4 (]: Using duckdb connection "model.supercell.dim_resource"
[0m17:12:13.630346 [debug] [Thread-4 (]: On model.supercell.dim_resource: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.dim_resource"} */
drop table if exists "supercell"."main"."dim_resource__dbt_backup" cascade
[0m17:12:13.632131 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m17:12:13.632947 [debug] [Thread-4 (]: On model.supercell.dim_resource: Close
[0m17:12:13.633934 [info ] [Thread-4 (]: 3 of 5 OK created sql table model main.dim_resource ............................ [[32mOK[0m in 0.29s]
[0m17:12:13.634302 [debug] [Thread-4 (]: Finished running node model.supercell.dim_resource
[0m17:12:13.634982 [debug] [Thread-1 (]: Began running node model.supercell.total_cost
[0m17:12:13.635369 [info ] [Thread-1 (]: 5 of 5 START sql table model main.total_cost ................................... [RUN]
[0m17:12:13.635720 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.supercell.cleaned_usagelogs, now model.supercell.total_cost)
[0m17:12:13.635967 [debug] [Thread-1 (]: Began compiling node model.supercell.total_cost
[0m17:12:13.638539 [debug] [Thread-1 (]: Writing injected SQL for node "model.supercell.total_cost"
[0m17:12:13.639107 [debug] [Thread-1 (]: Began executing node model.supercell.total_cost
[0m17:12:13.641303 [debug] [Thread-1 (]: Writing runtime sql for node "model.supercell.total_cost"
[0m17:12:13.641699 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.total_cost"
[0m17:12:13.641909 [debug] [Thread-1 (]: On model.supercell.total_cost: BEGIN
[0m17:12:13.642082 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:12:13.642604 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:12:13.642803 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.total_cost"
[0m17:12:13.642999 [debug] [Thread-1 (]: On model.supercell.total_cost: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.total_cost"} */

  
    
    

    create  table
      "supercell"."main"."total_cost__dbt_tmp"
  
    as (
      

with base as (
    select
        fact_bill_generation.resource_id as resource_id,
        date_trunc('month', fact_bill_generation.bill_date) as month,
        fact_bill_generation.bill_amount as bill_amount,
        dim_resource.instance_type as instance_type,
        dim_resource.product as product,
        dim_resource.region as region,
        dim_resource.pricing_model as pricing_model
    from "supercell"."main"."fact_bill_generation" as fact_bill_generation
    left join "supercell"."main"."dim_resource" as dim_resource
        on fact_bill_generation.resource_id = dim_resource.resource_id
),

joined as (
    select
        base.resource_id,
        base.month,
        base.bill_amount,
        base.instance_type,
        base.product,
        base.region,
        base.pricing_model,
        dim_accounts.tag_keys as tag_keys,
        dim_accounts.tag_values as tag_values
    from base
    left join "supercell"."main"."dim_accounts" as dim_accounts
        on base.resource_id = dim_accounts.linked_account_id
)


select
    month,
    sum(bill_amount) as total_cost,
    instance_type,
    product,
    region,
    pricing_model,
    tag_keys,
    tag_values
from joined
group by
    month,
    instance_type,
    product,
    region,
    pricing_model
order by
    month,
    instance_type,
    product,
    region,
    pricing_model
    );
  
  
[0m17:12:13.643833 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.total_cost"} */

  
    
    

    create  table
      "supercell"."main"."total_cost__dbt_tmp"
  
    as (
      

with base as (
    select
        fact_bill_generation.resource_id as resource_id,
        date_trunc('month', fact_bill_generation.bill_date) as month,
        fact_bill_generation.bill_amount as bill_amount,
        dim_resource.instance_type as instance_type,
        dim_resource.product as product,
        dim_resource.region as region,
        dim_resource.pricing_model as pricing_model
    from "supercell"."main"."fact_bill_generation" as fact_bill_generation
    left join "supercell"."main"."dim_resource" as dim_resource
        on fact_bill_generation.resource_id = dim_resource.resource_id
),

joined as (
    select
        base.resource_id,
        base.month,
        base.bill_amount,
        base.instance_type,
        base.product,
        base.region,
        base.pricing_model,
        dim_accounts.tag_keys as tag_keys,
        dim_accounts.tag_values as tag_values
    from base
    left join "supercell"."main"."dim_accounts" as dim_accounts
        on base.resource_id = dim_accounts.linked_account_id
)


select
    month,
    sum(bill_amount) as total_cost,
    instance_type,
    product,
    region,
    pricing_model,
    tag_keys,
    tag_values
from joined
group by
    month,
    instance_type,
    product,
    region,
    pricing_model
order by
    month,
    instance_type,
    product,
    region,
    pricing_model
    );
  
  
[0m17:12:13.644089 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m17:12:13.644366 [debug] [Thread-1 (]: On model.supercell.total_cost: ROLLBACK
[0m17:12:13.646276 [debug] [Thread-1 (]: Failed to rollback 'model.supercell.total_cost'
[0m17:12:13.646495 [debug] [Thread-1 (]: On model.supercell.total_cost: Close
[0m17:12:13.647767 [debug] [Thread-1 (]: Runtime Error in model total_cost (models/supercell_models/metrics/total_cost.sql)
  Binder Error: column "tag_keys" must appear in the GROUP BY clause or must be part of an aggregate function.
  Either add it to the GROUP BY list, or use "ANY_VALUE(tag_keys)" if the exact value of "tag_keys" is not important.
  
  LINE 51:     tag_keys,
               ^
[0m17:12:13.648179 [error] [Thread-1 (]: 5 of 5 ERROR creating sql table model main.total_cost .......................... [[31mERROR[0m in 0.01s]
[0m17:12:13.648501 [debug] [Thread-1 (]: Finished running node model.supercell.total_cost
[0m17:12:13.648952 [debug] [Thread-7 (]: Marking all children of 'model.supercell.total_cost' to be skipped because of status 'error'.  Reason: Runtime Error in model total_cost (models/supercell_models/metrics/total_cost.sql)
  Binder Error: column "tag_keys" must appear in the GROUP BY clause or must be part of an aggregate function.
  Either add it to the GROUP BY list, or use "ANY_VALUE(tag_keys)" if the exact value of "tag_keys" is not important.
  
  LINE 51:     tag_keys,
               ^.
[0m17:12:13.650580 [debug] [MainThread]: Using duckdb connection "master"
[0m17:12:13.650928 [debug] [MainThread]: On master: BEGIN
[0m17:12:13.651226 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:12:13.651807 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m17:12:13.652115 [debug] [MainThread]: On master: COMMIT
[0m17:12:13.652418 [debug] [MainThread]: Using duckdb connection "master"
[0m17:12:13.652697 [debug] [MainThread]: On master: COMMIT
[0m17:12:13.653573 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:12:13.654119 [debug] [MainThread]: On master: Close
[0m17:12:13.654796 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:12:13.655113 [debug] [MainThread]: Connection 'model.supercell.total_cost' was properly closed.
[0m17:12:13.655398 [debug] [MainThread]: Connection 'model.supercell.dim_accounts' was properly closed.
[0m17:12:13.655646 [debug] [MainThread]: Connection 'model.supercell.dim_resource' was properly closed.
[0m17:12:13.655930 [debug] [MainThread]: Connection 'model.supercell.fact_bill_generation' was properly closed.
[0m17:12:13.656495 [info ] [MainThread]: 
[0m17:12:13.656923 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 0.73 seconds (0.73s).
[0m17:12:13.658311 [debug] [MainThread]: Command end result
[0m17:12:13.672573 [debug] [MainThread]: Wrote artifact WritableManifest to /home/harsha/data_actions/supercell_cloudops/target/manifest.json
[0m17:12:13.674591 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/harsha/data_actions/supercell_cloudops/target/semantic_manifest.json
[0m17:12:13.679091 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/harsha/data_actions/supercell_cloudops/target/run_results.json
[0m17:12:13.679378 [info ] [MainThread]: 
[0m17:12:13.679593 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m17:12:13.679760 [info ] [MainThread]: 
[0m17:12:13.679949 [error] [MainThread]:   Runtime Error in model total_cost (models/supercell_models/metrics/total_cost.sql)
  Binder Error: column "tag_keys" must appear in the GROUP BY clause or must be part of an aggregate function.
  Either add it to the GROUP BY list, or use "ANY_VALUE(tag_keys)" if the exact value of "tag_keys" is not important.
  
  LINE 51:     tag_keys,
               ^
[0m17:12:13.680156 [info ] [MainThread]: 
[0m17:12:13.680337 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
[0m17:12:13.680854 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.2024288, "process_in_blocks": "0", "process_kernel_time": 0.405857, "process_mem_max_rss": "386808", "process_out_blocks": "59216", "process_user_time": 4.060577}
[0m17:12:13.681175 [debug] [MainThread]: Command `dbt run` failed at 17:12:13.681101 after 1.20 seconds
[0m17:12:13.681388 [debug] [MainThread]: Flushing usage events


============================== 17:12:37.927466 | f7b6e054-0ff8-4dd7-8f54-85d1796186fe ==============================
[0m17:12:37.927466 [info ] [MainThread]: Running with dbt=1.9.4
[0m17:12:37.930584 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/harsha/data_actions/supercell_cloudops', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/home/harsha/data_actions/supercell_cloudops/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'False'}
[0m17:12:37.930977 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality

User config should be moved from the 'config' key in profiles.yml to the 'flags' key in dbt_project.yml.
[0m17:12:38.098174 [info ] [MainThread]: Registered adapter: duckdb=1.9.3
[0m17:12:38.139687 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m17:12:38.183005 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:12:38.183420 [debug] [MainThread]: Partial parsing: updated file: supercell://models/supercell_models/metrics/total_cost.sql
[0m17:12:38.342047 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.supercell.example
[0m17:12:38.383533 [debug] [MainThread]: Wrote artifact WritableManifest to /home/harsha/data_actions/supercell_cloudops/target/manifest.json
[0m17:12:38.385450 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/harsha/data_actions/supercell_cloudops/target/semantic_manifest.json
[0m17:12:38.397972 [info ] [MainThread]: Found 5 models, 428 macros
[0m17:12:38.399464 [info ] [MainThread]: 
[0m17:12:38.399774 [info ] [MainThread]: Concurrency: 4 threads (target='default')
[0m17:12:38.399971 [info ] [MainThread]: 
[0m17:12:38.400328 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m17:12:38.405923 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_supercell'
[0m17:12:38.433430 [debug] [ThreadPool]: Using duckdb connection "list_supercell"
[0m17:12:38.433796 [debug] [ThreadPool]: On list_supercell: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "connection_name": "list_supercell"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"supercell"'
    
  
  
[0m17:12:38.434005 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:12:38.444381 [debug] [ThreadPool]: SQL status: OK in 0.010 seconds
[0m17:12:38.445429 [debug] [ThreadPool]: On list_supercell: Close
[0m17:12:38.446119 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_supercell, now create_supercell_main)
[0m17:12:38.446469 [debug] [ThreadPool]: Creating schema "database: "supercell"
schema: "main"
"
[0m17:12:38.451676 [debug] [ThreadPool]: Using duckdb connection "create_supercell_main"
[0m17:12:38.452021 [debug] [ThreadPool]: On create_supercell_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "connection_name": "create_supercell_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='supercell'
        and type='sqlite'
    
  
[0m17:12:38.452246 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:12:38.453350 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m17:12:38.454448 [debug] [ThreadPool]: Using duckdb connection "create_supercell_main"
[0m17:12:38.454714 [debug] [ThreadPool]: On create_supercell_main: BEGIN
[0m17:12:38.455124 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:12:38.455360 [debug] [ThreadPool]: Using duckdb connection "create_supercell_main"
[0m17:12:38.455534 [debug] [ThreadPool]: On create_supercell_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "connection_name": "create_supercell_main"} */

    
    
        create schema if not exists "supercell"."main"
    
[0m17:12:38.455887 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:12:38.456470 [debug] [ThreadPool]: On create_supercell_main: COMMIT
[0m17:12:38.456700 [debug] [ThreadPool]: Using duckdb connection "create_supercell_main"
[0m17:12:38.456875 [debug] [ThreadPool]: On create_supercell_main: COMMIT
[0m17:12:38.457172 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:12:38.457377 [debug] [ThreadPool]: On create_supercell_main: Close
[0m17:12:38.458765 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_supercell_main, now list_supercell_main)
[0m17:12:38.464155 [debug] [ThreadPool]: Using duckdb connection "list_supercell_main"
[0m17:12:38.464572 [debug] [ThreadPool]: On list_supercell_main: BEGIN
[0m17:12:38.464864 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:12:38.465610 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m17:12:38.465858 [debug] [ThreadPool]: Using duckdb connection "list_supercell_main"
[0m17:12:38.466050 [debug] [ThreadPool]: On list_supercell_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "connection_name": "list_supercell_main"} */
select
      'supercell' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'supercell'
  
[0m17:12:38.475949 [debug] [ThreadPool]: SQL status: OK in 0.010 seconds
[0m17:12:38.477521 [debug] [ThreadPool]: On list_supercell_main: ROLLBACK
[0m17:12:38.478661 [debug] [ThreadPool]: Failed to rollback 'list_supercell_main'
[0m17:12:38.478950 [debug] [ThreadPool]: On list_supercell_main: Close
[0m17:12:38.480712 [debug] [MainThread]: Using duckdb connection "master"
[0m17:12:38.480930 [debug] [MainThread]: On master: BEGIN
[0m17:12:38.481108 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:12:38.481586 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:12:38.481796 [debug] [MainThread]: On master: COMMIT
[0m17:12:38.481977 [debug] [MainThread]: Using duckdb connection "master"
[0m17:12:38.482153 [debug] [MainThread]: On master: COMMIT
[0m17:12:38.482483 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:12:38.482673 [debug] [MainThread]: On master: Close
[0m17:12:38.485118 [debug] [Thread-1 (]: Began running node model.supercell.cleaned_usagelogs
[0m17:12:38.485681 [info ] [Thread-1 (]: 1 of 5 START sql table model main.cleaned_usagelogs ............................ [RUN]
[0m17:12:38.486145 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_supercell_main, now model.supercell.cleaned_usagelogs)
[0m17:12:38.486508 [debug] [Thread-1 (]: Began compiling node model.supercell.cleaned_usagelogs
[0m17:12:38.493813 [debug] [Thread-1 (]: Writing injected SQL for node "model.supercell.cleaned_usagelogs"
[0m17:12:38.494489 [debug] [Thread-1 (]: Began executing node model.supercell.cleaned_usagelogs
[0m17:12:38.514355 [debug] [Thread-1 (]: Writing runtime sql for node "model.supercell.cleaned_usagelogs"
[0m17:12:38.514871 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.cleaned_usagelogs"
[0m17:12:38.515099 [debug] [Thread-1 (]: On model.supercell.cleaned_usagelogs: BEGIN
[0m17:12:38.515309 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:12:38.515872 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:12:38.516073 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.cleaned_usagelogs"
[0m17:12:38.516285 [debug] [Thread-1 (]: On model.supercell.cleaned_usagelogs: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.cleaned_usagelogs"} */

  
    
    

    create  table
      "supercell"."main"."cleaned_usagelogs__dbt_tmp"
  
    as (
      


SELECT
    CAST("LinkedAccountId" AS VARCHAR) AS linked_account_id,
    CAST("bill/PayerAccountId" AS VARCHAR) AS payer_account_id,
    CAST("lineItem/UsageStartDate" AS TIMESTAMP) AS usage_start_date,
    CAST("lineItem/UsageEndDate" AS TIMESTAMP) AS usage_end_date,
    CAST("lineItem/UsageAmount" AS DECIMAL(18, 6)) AS usage_amount,
    CAST("lineItem/Operation" AS VARCHAR) AS operation,
    CAST("pricing/PricingModel" AS VARCHAR) AS pricing_model,
    CAST("resourceTags/TagKeys" AS VARCHAR) AS tag_keys,
    CAST("resourceTags/TagValues" AS VARCHAR) AS tag_values,
    CAST("product/Region" AS VARCHAR) AS region,
    CAST("product/ServiceCode" AS VARCHAR) AS service_code,
    CAST("product/InstanceType" AS VARCHAR) AS instance_type,
    CAST("amortized_cost" AS DECIMAL(18, 6)) AS amortized_cost,
    CAST("product/Description" AS VARCHAR) AS description
FROM supercell_usagelogs
    );
  
  
[0m17:12:38.802363 [debug] [Thread-1 (]: SQL status: OK in 0.286 seconds
[0m17:12:38.809053 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.cleaned_usagelogs"
[0m17:12:38.809678 [debug] [Thread-1 (]: On model.supercell.cleaned_usagelogs: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.cleaned_usagelogs"} */
alter table "supercell"."main"."cleaned_usagelogs" rename to "cleaned_usagelogs__dbt_backup"
[0m17:12:38.811112 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:12:38.816117 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.cleaned_usagelogs"
[0m17:12:38.816912 [debug] [Thread-1 (]: On model.supercell.cleaned_usagelogs: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.cleaned_usagelogs"} */
alter table "supercell"."main"."cleaned_usagelogs__dbt_tmp" rename to "cleaned_usagelogs"
[0m17:12:38.819061 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m17:12:38.832909 [debug] [Thread-1 (]: On model.supercell.cleaned_usagelogs: COMMIT
[0m17:12:38.833315 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.cleaned_usagelogs"
[0m17:12:38.833527 [debug] [Thread-1 (]: On model.supercell.cleaned_usagelogs: COMMIT
[0m17:12:38.845637 [debug] [Thread-1 (]: SQL status: OK in 0.012 seconds
[0m17:12:38.848835 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.cleaned_usagelogs"
[0m17:12:38.849081 [debug] [Thread-1 (]: On model.supercell.cleaned_usagelogs: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.cleaned_usagelogs"} */
drop table if exists "supercell"."main"."cleaned_usagelogs__dbt_backup" cascade
[0m17:12:38.851004 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m17:12:38.853057 [debug] [Thread-1 (]: On model.supercell.cleaned_usagelogs: Close
[0m17:12:38.859851 [info ] [Thread-1 (]: 1 of 5 OK created sql table model main.cleaned_usagelogs ....................... [[32mOK[0m in 0.37s]
[0m17:12:38.860332 [debug] [Thread-1 (]: Finished running node model.supercell.cleaned_usagelogs
[0m17:12:38.861116 [debug] [Thread-3 (]: Began running node model.supercell.dim_accounts
[0m17:12:38.861717 [debug] [Thread-4 (]: Began running node model.supercell.dim_resource
[0m17:12:38.862248 [info ] [Thread-3 (]: 2 of 5 START sql table model main.dim_accounts ................................. [RUN]
[0m17:12:38.862825 [debug] [Thread-2 (]: Began running node model.supercell.fact_bill_generation
[0m17:12:38.863316 [info ] [Thread-4 (]: 3 of 5 START sql table model main.dim_resource ................................. [RUN]
[0m17:12:38.863868 [debug] [Thread-3 (]: Acquiring new duckdb connection 'model.supercell.dim_accounts'
[0m17:12:38.864365 [info ] [Thread-2 (]: 4 of 5 START sql table model main.fact_bill_generation ......................... [RUN]
[0m17:12:38.864889 [debug] [Thread-4 (]: Acquiring new duckdb connection 'model.supercell.dim_resource'
[0m17:12:38.865283 [debug] [Thread-3 (]: Began compiling node model.supercell.dim_accounts
[0m17:12:38.865751 [debug] [Thread-2 (]: Acquiring new duckdb connection 'model.supercell.fact_bill_generation'
[0m17:12:38.866153 [debug] [Thread-4 (]: Began compiling node model.supercell.dim_resource
[0m17:12:38.869399 [debug] [Thread-3 (]: Writing injected SQL for node "model.supercell.dim_accounts"
[0m17:12:38.869896 [debug] [Thread-2 (]: Began compiling node model.supercell.fact_bill_generation
[0m17:12:38.873821 [debug] [Thread-4 (]: Writing injected SQL for node "model.supercell.dim_resource"
[0m17:12:38.877907 [debug] [Thread-2 (]: Writing injected SQL for node "model.supercell.fact_bill_generation"
[0m17:12:38.878971 [debug] [Thread-3 (]: Began executing node model.supercell.dim_accounts
[0m17:12:38.879393 [debug] [Thread-4 (]: Began executing node model.supercell.dim_resource
[0m17:12:38.881390 [debug] [Thread-3 (]: Writing runtime sql for node "model.supercell.dim_accounts"
[0m17:12:38.881758 [debug] [Thread-2 (]: Began executing node model.supercell.fact_bill_generation
[0m17:12:38.884569 [debug] [Thread-4 (]: Writing runtime sql for node "model.supercell.dim_resource"
[0m17:12:38.888112 [debug] [Thread-2 (]: Writing runtime sql for node "model.supercell.fact_bill_generation"
[0m17:12:38.889000 [debug] [Thread-3 (]: Using duckdb connection "model.supercell.dim_accounts"
[0m17:12:38.889413 [debug] [Thread-2 (]: Using duckdb connection "model.supercell.fact_bill_generation"
[0m17:12:38.889763 [debug] [Thread-4 (]: Using duckdb connection "model.supercell.dim_resource"
[0m17:12:38.890255 [debug] [Thread-3 (]: On model.supercell.dim_accounts: BEGIN
[0m17:12:38.890738 [debug] [Thread-2 (]: On model.supercell.fact_bill_generation: BEGIN
[0m17:12:38.891070 [debug] [Thread-4 (]: On model.supercell.dim_resource: BEGIN
[0m17:12:38.891508 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m17:12:38.892021 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m17:12:38.892383 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m17:12:38.893264 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m17:12:38.893499 [debug] [Thread-2 (]: Using duckdb connection "model.supercell.fact_bill_generation"
[0m17:12:38.893772 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m17:12:38.894149 [debug] [Thread-2 (]: On model.supercell.fact_bill_generation: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.fact_bill_generation"} */

  
    
    

    create  table
      "supercell"."main"."fact_bill_generation__dbt_tmp"
  
    as (
      


select
    md5(concat(linked_account_id, '_', service_code, '_', instance_type, '_', region, '_', CAST(usage_start_date AS VARCHAR), '_', CAST(usage_end_date AS VARCHAR))) AS resource_id,
    usage_start_date as start_date,
    usage_end_date as bill_date,
    usage_amount as bill_amount,
    operation
from "supercell"."main"."cleaned_usagelogs"
    );
  
  
[0m17:12:38.894424 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m17:12:38.894844 [debug] [Thread-4 (]: Using duckdb connection "model.supercell.dim_resource"
[0m17:12:38.895415 [debug] [Thread-3 (]: Using duckdb connection "model.supercell.dim_accounts"
[0m17:12:38.895938 [debug] [Thread-4 (]: On model.supercell.dim_resource: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.dim_resource"} */

  
    
    

    create  table
      "supercell"."main"."dim_resource__dbt_tmp"
  
    as (
      


select
    md5(concat(linked_account_id, '_', service_code, '_', instance_type, '_', region, '_', CAST(usage_start_date AS VARCHAR), '_', CAST(usage_end_date AS VARCHAR))) AS resource_id,
    linked_account_id as linked_account_id,
    region,
    service_code as product,
    instance_type as instance_type,
    pricing_model as pricing_model
from "supercell"."main"."cleaned_usagelogs"
    );
  
  
[0m17:12:38.897401 [debug] [Thread-3 (]: On model.supercell.dim_accounts: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.dim_accounts"} */

  
    
    

    create  table
      "supercell"."main"."dim_accounts__dbt_tmp"
  
    as (
      


select
    linked_account_id as linked_account_id,
    tag_keys as tag_keys,
    tag_values as tag_values
from "supercell"."main"."cleaned_usagelogs"
    );
  
  
[0m17:12:39.043901 [debug] [Thread-3 (]: SQL status: OK in 0.145 seconds
[0m17:12:39.047322 [debug] [Thread-3 (]: Using duckdb connection "model.supercell.dim_accounts"
[0m17:12:39.047840 [debug] [Thread-3 (]: On model.supercell.dim_accounts: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.dim_accounts"} */
alter table "supercell"."main"."dim_accounts" rename to "dim_accounts__dbt_backup"
[0m17:12:39.048768 [debug] [Thread-3 (]: SQL status: OK in 0.000 seconds
[0m17:12:39.051668 [debug] [Thread-3 (]: Using duckdb connection "model.supercell.dim_accounts"
[0m17:12:39.052250 [debug] [Thread-3 (]: On model.supercell.dim_accounts: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.dim_accounts"} */
alter table "supercell"."main"."dim_accounts__dbt_tmp" rename to "dim_accounts"
[0m17:12:39.053039 [debug] [Thread-3 (]: SQL status: OK in 0.000 seconds
[0m17:12:39.055056 [debug] [Thread-3 (]: On model.supercell.dim_accounts: COMMIT
[0m17:12:39.055741 [debug] [Thread-3 (]: Using duckdb connection "model.supercell.dim_accounts"
[0m17:12:39.056245 [debug] [Thread-3 (]: On model.supercell.dim_accounts: COMMIT
[0m17:12:39.065918 [debug] [Thread-3 (]: SQL status: OK in 0.009 seconds
[0m17:12:39.068126 [debug] [Thread-3 (]: Using duckdb connection "model.supercell.dim_accounts"
[0m17:12:39.068499 [debug] [Thread-3 (]: On model.supercell.dim_accounts: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.dim_accounts"} */
drop table if exists "supercell"."main"."dim_accounts__dbt_backup" cascade
[0m17:12:39.070225 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m17:12:39.071876 [debug] [Thread-3 (]: On model.supercell.dim_accounts: Close
[0m17:12:39.076887 [info ] [Thread-3 (]: 2 of 5 OK created sql table model main.dim_accounts ............................ [[32mOK[0m in 0.21s]
[0m17:12:39.077980 [debug] [Thread-3 (]: Finished running node model.supercell.dim_accounts
[0m17:12:39.103474 [debug] [Thread-2 (]: SQL status: OK in 0.208 seconds
[0m17:12:39.105978 [debug] [Thread-2 (]: Using duckdb connection "model.supercell.fact_bill_generation"
[0m17:12:39.106329 [debug] [Thread-2 (]: On model.supercell.fact_bill_generation: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.fact_bill_generation"} */
alter table "supercell"."main"."fact_bill_generation" rename to "fact_bill_generation__dbt_backup"
[0m17:12:39.107101 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m17:12:39.109685 [debug] [Thread-2 (]: Using duckdb connection "model.supercell.fact_bill_generation"
[0m17:12:39.110203 [debug] [Thread-2 (]: On model.supercell.fact_bill_generation: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.fact_bill_generation"} */
alter table "supercell"."main"."fact_bill_generation__dbt_tmp" rename to "fact_bill_generation"
[0m17:12:39.111160 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m17:12:39.112461 [debug] [Thread-2 (]: On model.supercell.fact_bill_generation: COMMIT
[0m17:12:39.112738 [debug] [Thread-2 (]: Using duckdb connection "model.supercell.fact_bill_generation"
[0m17:12:39.112957 [debug] [Thread-2 (]: On model.supercell.fact_bill_generation: COMMIT
[0m17:12:39.118547 [debug] [Thread-2 (]: SQL status: OK in 0.005 seconds
[0m17:12:39.122258 [debug] [Thread-2 (]: Using duckdb connection "model.supercell.fact_bill_generation"
[0m17:12:39.122742 [debug] [Thread-2 (]: On model.supercell.fact_bill_generation: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.fact_bill_generation"} */
drop table if exists "supercell"."main"."fact_bill_generation__dbt_backup" cascade
[0m17:12:39.125256 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m17:12:39.127725 [debug] [Thread-2 (]: On model.supercell.fact_bill_generation: Close
[0m17:12:39.129994 [info ] [Thread-2 (]: 4 of 5 OK created sql table model main.fact_bill_generation .................... [[32mOK[0m in 0.26s]
[0m17:12:39.130404 [debug] [Thread-2 (]: Finished running node model.supercell.fact_bill_generation
[0m17:12:39.191510 [debug] [Thread-4 (]: SQL status: OK in 0.293 seconds
[0m17:12:39.193618 [debug] [Thread-4 (]: Using duckdb connection "model.supercell.dim_resource"
[0m17:12:39.193955 [debug] [Thread-4 (]: On model.supercell.dim_resource: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.dim_resource"} */
alter table "supercell"."main"."dim_resource" rename to "dim_resource__dbt_backup"
[0m17:12:39.194599 [debug] [Thread-4 (]: SQL status: OK in 0.000 seconds
[0m17:12:39.196259 [debug] [Thread-4 (]: Using duckdb connection "model.supercell.dim_resource"
[0m17:12:39.196483 [debug] [Thread-4 (]: On model.supercell.dim_resource: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.dim_resource"} */
alter table "supercell"."main"."dim_resource__dbt_tmp" rename to "dim_resource"
[0m17:12:39.196901 [debug] [Thread-4 (]: SQL status: OK in 0.000 seconds
[0m17:12:39.197837 [debug] [Thread-4 (]: On model.supercell.dim_resource: COMMIT
[0m17:12:39.198047 [debug] [Thread-4 (]: Using duckdb connection "model.supercell.dim_resource"
[0m17:12:39.198246 [debug] [Thread-4 (]: On model.supercell.dim_resource: COMMIT
[0m17:12:39.203892 [debug] [Thread-4 (]: SQL status: OK in 0.005 seconds
[0m17:12:39.205502 [debug] [Thread-4 (]: Using duckdb connection "model.supercell.dim_resource"
[0m17:12:39.205775 [debug] [Thread-4 (]: On model.supercell.dim_resource: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.dim_resource"} */
drop table if exists "supercell"."main"."dim_resource__dbt_backup" cascade
[0m17:12:39.207430 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m17:12:39.208327 [debug] [Thread-4 (]: On model.supercell.dim_resource: Close
[0m17:12:39.211422 [info ] [Thread-4 (]: 3 of 5 OK created sql table model main.dim_resource ............................ [[32mOK[0m in 0.35s]
[0m17:12:39.211900 [debug] [Thread-4 (]: Finished running node model.supercell.dim_resource
[0m17:12:39.212882 [debug] [Thread-1 (]: Began running node model.supercell.total_cost
[0m17:12:39.213319 [info ] [Thread-1 (]: 5 of 5 START sql table model main.total_cost ................................... [RUN]
[0m17:12:39.213678 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.supercell.cleaned_usagelogs, now model.supercell.total_cost)
[0m17:12:39.213911 [debug] [Thread-1 (]: Began compiling node model.supercell.total_cost
[0m17:12:39.218106 [debug] [Thread-1 (]: Writing injected SQL for node "model.supercell.total_cost"
[0m17:12:39.219691 [debug] [Thread-1 (]: Began executing node model.supercell.total_cost
[0m17:12:39.225818 [debug] [Thread-1 (]: Writing runtime sql for node "model.supercell.total_cost"
[0m17:12:39.226848 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.total_cost"
[0m17:12:39.227256 [debug] [Thread-1 (]: On model.supercell.total_cost: BEGIN
[0m17:12:39.227503 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:12:39.228436 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:12:39.228783 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.total_cost"
[0m17:12:39.229039 [debug] [Thread-1 (]: On model.supercell.total_cost: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.total_cost"} */

  
    
    

    create  table
      "supercell"."main"."total_cost__dbt_tmp"
  
    as (
      

with base as (
    select
        fact_bill_generation.resource_id as resource_id,
        date_trunc('month', fact_bill_generation.bill_date) as month,
        fact_bill_generation.bill_amount as bill_amount,
        dim_resource.instance_type as instance_type,
        dim_resource.product as product,
        dim_resource.region as region,
        dim_resource.pricing_model as pricing_model
    from "supercell"."main"."fact_bill_generation" as fact_bill_generation
    left join "supercell"."main"."dim_resource" as dim_resource
        on fact_bill_generation.resource_id = dim_resource.resource_id
),

joined as (
    select
        base.resource_id,
        base.month,
        base.bill_amount,
        base.instance_type,
        base.product,
        base.region,
        base.pricing_model,
        dim_accounts.tag_keys as tag_keys,
        dim_accounts.tag_values as tag_values
    from base
    left join "supercell"."main"."dim_accounts" as dim_accounts
        on base.resource_id = dim_accounts.linked_account_id
)


select
    month,
    sum(bill_amount) as total_cost,
    instance_type,
    product,
    region,
    pricing_model,
    tag_keys,
    tag_values
from joined
group by
    month,
    instance_type,
    product,
    region,
    pricing_model,
    tag_keys,
    tag_values
order by
    month,
    instance_type,
    product,
    region,
    pricing_model,tag_keys,tag_values
    );
  
  
[0m17:12:39.604106 [debug] [Thread-1 (]: SQL status: OK in 0.375 seconds
[0m17:12:39.606869 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.total_cost"
[0m17:12:39.607290 [debug] [Thread-1 (]: On model.supercell.total_cost: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.total_cost"} */
alter table "supercell"."main"."total_cost" rename to "total_cost__dbt_backup"
[0m17:12:39.608548 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:12:39.611079 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.total_cost"
[0m17:12:39.611456 [debug] [Thread-1 (]: On model.supercell.total_cost: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.total_cost"} */
alter table "supercell"."main"."total_cost__dbt_tmp" rename to "total_cost"
[0m17:12:39.612145 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:12:39.613527 [debug] [Thread-1 (]: On model.supercell.total_cost: COMMIT
[0m17:12:39.613763 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.total_cost"
[0m17:12:39.613962 [debug] [Thread-1 (]: On model.supercell.total_cost: COMMIT
[0m17:12:39.617307 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m17:12:39.618468 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.total_cost"
[0m17:12:39.618673 [debug] [Thread-1 (]: On model.supercell.total_cost: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.total_cost"} */
drop table if exists "supercell"."main"."total_cost__dbt_backup" cascade
[0m17:12:39.620472 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m17:12:39.621354 [debug] [Thread-1 (]: On model.supercell.total_cost: Close
[0m17:12:39.626634 [info ] [Thread-1 (]: 5 of 5 OK created sql table model main.total_cost .............................. [[32mOK[0m in 0.41s]
[0m17:12:39.627004 [debug] [Thread-1 (]: Finished running node model.supercell.total_cost
[0m17:12:39.628480 [debug] [MainThread]: Using duckdb connection "master"
[0m17:12:39.628792 [debug] [MainThread]: On master: BEGIN
[0m17:12:39.628996 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:12:39.629541 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:12:39.630155 [debug] [MainThread]: On master: COMMIT
[0m17:12:39.630861 [debug] [MainThread]: Using duckdb connection "master"
[0m17:12:39.631127 [debug] [MainThread]: On master: COMMIT
[0m17:12:39.631704 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:12:39.632207 [debug] [MainThread]: On master: Close
[0m17:12:39.632884 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:12:39.633095 [debug] [MainThread]: Connection 'model.supercell.total_cost' was properly closed.
[0m17:12:39.633268 [debug] [MainThread]: Connection 'model.supercell.dim_accounts' was properly closed.
[0m17:12:39.633401 [debug] [MainThread]: Connection 'model.supercell.dim_resource' was properly closed.
[0m17:12:39.633528 [debug] [MainThread]: Connection 'model.supercell.fact_bill_generation' was properly closed.
[0m17:12:39.633750 [info ] [MainThread]: 
[0m17:12:39.633950 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 1.23 seconds (1.23s).
[0m17:12:39.634565 [debug] [MainThread]: Command end result
[0m17:12:39.689273 [debug] [MainThread]: Wrote artifact WritableManifest to /home/harsha/data_actions/supercell_cloudops/target/manifest.json
[0m17:12:39.690252 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/harsha/data_actions/supercell_cloudops/target/semantic_manifest.json
[0m17:12:39.693518 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/harsha/data_actions/supercell_cloudops/target/run_results.json
[0m17:12:39.693716 [info ] [MainThread]: 
[0m17:12:39.693946 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:12:39.694146 [info ] [MainThread]: 
[0m17:12:39.694345 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m17:12:39.695100 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.7996637, "process_in_blocks": "0", "process_kernel_time": 0.465334, "process_mem_max_rss": "345936", "process_out_blocks": "59752", "process_user_time": 5.679669}
[0m17:12:39.695455 [debug] [MainThread]: Command `dbt run` succeeded at 17:12:39.695387 after 1.80 seconds
[0m17:12:39.695693 [debug] [MainThread]: Flushing usage events


============================== 17:18:10.728077 | ea18c33d-e19e-4a6e-b9e8-70bd9ca605f1 ==============================
[0m17:18:10.728077 [info ] [MainThread]: Running with dbt=1.9.4
[0m17:18:10.730393 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/harsha/data_actions/supercell_cloudops', 'debug': 'False', 'warn_error': 'None', 'log_path': '/home/harsha/data_actions/supercell_cloudops/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'False'}
[0m17:18:10.730610 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality

User config should be moved from the 'config' key in profiles.yml to the 'flags' key in dbt_project.yml.
[0m17:18:10.882673 [info ] [MainThread]: Registered adapter: duckdb=1.9.3
[0m17:18:10.920367 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m17:18:10.959856 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:18:10.960249 [debug] [MainThread]: Partial parsing: updated file: supercell://models/supercell_models/metrics/total_cost.sql
[0m17:18:11.094417 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.supercell.example
[0m17:18:11.126106 [debug] [MainThread]: Wrote artifact WritableManifest to /home/harsha/data_actions/supercell_cloudops/target/manifest.json
[0m17:18:11.127121 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/harsha/data_actions/supercell_cloudops/target/semantic_manifest.json
[0m17:18:11.133762 [info ] [MainThread]: Found 5 models, 428 macros
[0m17:18:11.134916 [info ] [MainThread]: 
[0m17:18:11.135231 [info ] [MainThread]: Concurrency: 4 threads (target='default')
[0m17:18:11.135418 [info ] [MainThread]: 
[0m17:18:11.135707 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m17:18:11.140310 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_supercell'
[0m17:18:11.163830 [debug] [ThreadPool]: Using duckdb connection "list_supercell"
[0m17:18:11.164125 [debug] [ThreadPool]: On list_supercell: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "connection_name": "list_supercell"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"supercell"'
    
  
  
[0m17:18:11.164333 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:18:11.171942 [debug] [ThreadPool]: SQL status: OK in 0.008 seconds
[0m17:18:11.172779 [debug] [ThreadPool]: On list_supercell: Close
[0m17:18:11.173407 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_supercell, now create_supercell_main)
[0m17:18:11.173751 [debug] [ThreadPool]: Creating schema "database: "supercell"
schema: "main"
"
[0m17:18:11.177796 [debug] [ThreadPool]: Using duckdb connection "create_supercell_main"
[0m17:18:11.178040 [debug] [ThreadPool]: On create_supercell_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "connection_name": "create_supercell_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='supercell'
        and type='sqlite'
    
  
[0m17:18:11.178221 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:18:11.179041 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m17:18:11.179802 [debug] [ThreadPool]: Using duckdb connection "create_supercell_main"
[0m17:18:11.180002 [debug] [ThreadPool]: On create_supercell_main: BEGIN
[0m17:18:11.180295 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:18:11.180483 [debug] [ThreadPool]: Using duckdb connection "create_supercell_main"
[0m17:18:11.180624 [debug] [ThreadPool]: On create_supercell_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "connection_name": "create_supercell_main"} */

    
    
        create schema if not exists "supercell"."main"
    
[0m17:18:11.180892 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:18:11.181415 [debug] [ThreadPool]: On create_supercell_main: COMMIT
[0m17:18:11.181619 [debug] [ThreadPool]: Using duckdb connection "create_supercell_main"
[0m17:18:11.181776 [debug] [ThreadPool]: On create_supercell_main: COMMIT
[0m17:18:11.182021 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:18:11.182225 [debug] [ThreadPool]: On create_supercell_main: Close
[0m17:18:11.183433 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_supercell_main, now list_supercell_main)
[0m17:18:11.187254 [debug] [ThreadPool]: Using duckdb connection "list_supercell_main"
[0m17:18:11.187478 [debug] [ThreadPool]: On list_supercell_main: BEGIN
[0m17:18:11.187656 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:18:11.188200 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m17:18:11.188381 [debug] [ThreadPool]: Using duckdb connection "list_supercell_main"
[0m17:18:11.188538 [debug] [ThreadPool]: On list_supercell_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "connection_name": "list_supercell_main"} */
select
      'supercell' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'supercell'
  
[0m17:18:11.196514 [debug] [ThreadPool]: SQL status: OK in 0.008 seconds
[0m17:18:11.197543 [debug] [ThreadPool]: On list_supercell_main: ROLLBACK
[0m17:18:11.198230 [debug] [ThreadPool]: Failed to rollback 'list_supercell_main'
[0m17:18:11.198422 [debug] [ThreadPool]: On list_supercell_main: Close
[0m17:18:11.199683 [debug] [MainThread]: Using duckdb connection "master"
[0m17:18:11.199928 [debug] [MainThread]: On master: BEGIN
[0m17:18:11.200115 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:18:11.200510 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:18:11.200696 [debug] [MainThread]: On master: COMMIT
[0m17:18:11.200855 [debug] [MainThread]: Using duckdb connection "master"
[0m17:18:11.201003 [debug] [MainThread]: On master: COMMIT
[0m17:18:11.201272 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:18:11.201452 [debug] [MainThread]: On master: Close
[0m17:18:11.203195 [debug] [Thread-1 (]: Began running node model.supercell.cleaned_usagelogs
[0m17:18:11.203736 [info ] [Thread-1 (]: 1 of 5 START sql table model main.cleaned_usagelogs ............................ [RUN]
[0m17:18:11.204192 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_supercell_main, now model.supercell.cleaned_usagelogs)
[0m17:18:11.204586 [debug] [Thread-1 (]: Began compiling node model.supercell.cleaned_usagelogs
[0m17:18:11.211266 [debug] [Thread-1 (]: Writing injected SQL for node "model.supercell.cleaned_usagelogs"
[0m17:18:11.211745 [debug] [Thread-1 (]: Began executing node model.supercell.cleaned_usagelogs
[0m17:18:11.230023 [debug] [Thread-1 (]: Writing runtime sql for node "model.supercell.cleaned_usagelogs"
[0m17:18:11.230524 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.cleaned_usagelogs"
[0m17:18:11.230736 [debug] [Thread-1 (]: On model.supercell.cleaned_usagelogs: BEGIN
[0m17:18:11.230910 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:18:11.231529 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:18:11.231740 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.cleaned_usagelogs"
[0m17:18:11.231929 [debug] [Thread-1 (]: On model.supercell.cleaned_usagelogs: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.cleaned_usagelogs"} */

  
    
    

    create  table
      "supercell"."main"."cleaned_usagelogs__dbt_tmp"
  
    as (
      


SELECT
    CAST("LinkedAccountId" AS VARCHAR) AS linked_account_id,
    CAST("bill/PayerAccountId" AS VARCHAR) AS payer_account_id,
    CAST("lineItem/UsageStartDate" AS TIMESTAMP) AS usage_start_date,
    CAST("lineItem/UsageEndDate" AS TIMESTAMP) AS usage_end_date,
    CAST("lineItem/UsageAmount" AS DECIMAL(18, 6)) AS usage_amount,
    CAST("lineItem/Operation" AS VARCHAR) AS operation,
    CAST("pricing/PricingModel" AS VARCHAR) AS pricing_model,
    CAST("resourceTags/TagKeys" AS VARCHAR) AS tag_keys,
    CAST("resourceTags/TagValues" AS VARCHAR) AS tag_values,
    CAST("product/Region" AS VARCHAR) AS region,
    CAST("product/ServiceCode" AS VARCHAR) AS service_code,
    CAST("product/InstanceType" AS VARCHAR) AS instance_type,
    CAST("amortized_cost" AS DECIMAL(18, 6)) AS amortized_cost,
    CAST("product/Description" AS VARCHAR) AS description
FROM supercell_usagelogs
    );
  
  
[0m17:18:11.498278 [debug] [Thread-1 (]: SQL status: OK in 0.266 seconds
[0m17:18:11.502143 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.cleaned_usagelogs"
[0m17:18:11.502416 [debug] [Thread-1 (]: On model.supercell.cleaned_usagelogs: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.cleaned_usagelogs"} */
alter table "supercell"."main"."cleaned_usagelogs" rename to "cleaned_usagelogs__dbt_backup"
[0m17:18:11.502934 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:18:11.504427 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.cleaned_usagelogs"
[0m17:18:11.504646 [debug] [Thread-1 (]: On model.supercell.cleaned_usagelogs: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.cleaned_usagelogs"} */
alter table "supercell"."main"."cleaned_usagelogs__dbt_tmp" rename to "cleaned_usagelogs"
[0m17:18:11.505036 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:18:11.513848 [debug] [Thread-1 (]: On model.supercell.cleaned_usagelogs: COMMIT
[0m17:18:11.514151 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.cleaned_usagelogs"
[0m17:18:11.514343 [debug] [Thread-1 (]: On model.supercell.cleaned_usagelogs: COMMIT
[0m17:18:11.525640 [debug] [Thread-1 (]: SQL status: OK in 0.011 seconds
[0m17:18:11.528903 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.cleaned_usagelogs"
[0m17:18:11.529175 [debug] [Thread-1 (]: On model.supercell.cleaned_usagelogs: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.cleaned_usagelogs"} */
drop table if exists "supercell"."main"."cleaned_usagelogs__dbt_backup" cascade
[0m17:18:11.530831 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:18:11.532285 [debug] [Thread-1 (]: On model.supercell.cleaned_usagelogs: Close
[0m17:18:11.537257 [info ] [Thread-1 (]: 1 of 5 OK created sql table model main.cleaned_usagelogs ....................... [[32mOK[0m in 0.33s]
[0m17:18:11.537639 [debug] [Thread-1 (]: Finished running node model.supercell.cleaned_usagelogs
[0m17:18:11.539126 [debug] [Thread-3 (]: Began running node model.supercell.dim_accounts
[0m17:18:11.539662 [debug] [Thread-4 (]: Began running node model.supercell.dim_resource
[0m17:18:11.540629 [info ] [Thread-3 (]: 2 of 5 START sql table model main.dim_accounts ................................. [RUN]
[0m17:18:11.541602 [debug] [Thread-2 (]: Began running node model.supercell.fact_bill_generation
[0m17:18:11.542371 [info ] [Thread-4 (]: 3 of 5 START sql table model main.dim_resource ................................. [RUN]
[0m17:18:11.543490 [debug] [Thread-3 (]: Acquiring new duckdb connection 'model.supercell.dim_accounts'
[0m17:18:11.544329 [info ] [Thread-2 (]: 4 of 5 START sql table model main.fact_bill_generation ......................... [RUN]
[0m17:18:11.545074 [debug] [Thread-4 (]: Acquiring new duckdb connection 'model.supercell.dim_resource'
[0m17:18:11.545734 [debug] [Thread-3 (]: Began compiling node model.supercell.dim_accounts
[0m17:18:11.546455 [debug] [Thread-2 (]: Acquiring new duckdb connection 'model.supercell.fact_bill_generation'
[0m17:18:11.547041 [debug] [Thread-4 (]: Began compiling node model.supercell.dim_resource
[0m17:18:11.551067 [debug] [Thread-3 (]: Writing injected SQL for node "model.supercell.dim_accounts"
[0m17:18:11.551568 [debug] [Thread-2 (]: Began compiling node model.supercell.fact_bill_generation
[0m17:18:11.553772 [debug] [Thread-4 (]: Writing injected SQL for node "model.supercell.dim_resource"
[0m17:18:11.557056 [debug] [Thread-2 (]: Writing injected SQL for node "model.supercell.fact_bill_generation"
[0m17:18:11.558693 [debug] [Thread-3 (]: Began executing node model.supercell.dim_accounts
[0m17:18:11.562478 [debug] [Thread-3 (]: Writing runtime sql for node "model.supercell.dim_accounts"
[0m17:18:11.563093 [debug] [Thread-4 (]: Began executing node model.supercell.dim_resource
[0m17:18:11.564788 [debug] [Thread-4 (]: Writing runtime sql for node "model.supercell.dim_resource"
[0m17:18:11.565197 [debug] [Thread-2 (]: Began executing node model.supercell.fact_bill_generation
[0m17:18:11.567883 [debug] [Thread-2 (]: Writing runtime sql for node "model.supercell.fact_bill_generation"
[0m17:18:11.568816 [debug] [Thread-2 (]: Using duckdb connection "model.supercell.fact_bill_generation"
[0m17:18:11.569305 [debug] [Thread-4 (]: Using duckdb connection "model.supercell.dim_resource"
[0m17:18:11.569665 [debug] [Thread-3 (]: Using duckdb connection "model.supercell.dim_accounts"
[0m17:18:11.570057 [debug] [Thread-2 (]: On model.supercell.fact_bill_generation: BEGIN
[0m17:18:11.570420 [debug] [Thread-4 (]: On model.supercell.dim_resource: BEGIN
[0m17:18:11.570664 [debug] [Thread-3 (]: On model.supercell.dim_accounts: BEGIN
[0m17:18:11.571013 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m17:18:11.571340 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m17:18:11.571585 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m17:18:11.572532 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m17:18:11.572922 [debug] [Thread-3 (]: Using duckdb connection "model.supercell.dim_accounts"
[0m17:18:11.573243 [debug] [Thread-3 (]: On model.supercell.dim_accounts: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.dim_accounts"} */

  
    
    

    create  table
      "supercell"."main"."dim_accounts__dbt_tmp"
  
    as (
      


select
    linked_account_id as linked_account_id,
    tag_keys as tag_keys,
    tag_values as tag_values
from "supercell"."main"."cleaned_usagelogs"
    );
  
  
[0m17:18:11.573716 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m17:18:11.574451 [debug] [Thread-4 (]: Using duckdb connection "model.supercell.dim_resource"
[0m17:18:11.574914 [debug] [Thread-2 (]: SQL status: OK in 0.004 seconds
[0m17:18:11.575327 [debug] [Thread-4 (]: On model.supercell.dim_resource: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.dim_resource"} */

  
    
    

    create  table
      "supercell"."main"."dim_resource__dbt_tmp"
  
    as (
      


select
    md5(concat(linked_account_id, '_', service_code, '_', instance_type, '_', region, '_', CAST(usage_start_date AS VARCHAR), '_', CAST(usage_end_date AS VARCHAR))) AS resource_id,
    linked_account_id as linked_account_id,
    region,
    service_code as product,
    instance_type as instance_type,
    pricing_model as pricing_model
from "supercell"."main"."cleaned_usagelogs"
    );
  
  
[0m17:18:11.575818 [debug] [Thread-2 (]: Using duckdb connection "model.supercell.fact_bill_generation"
[0m17:18:11.577270 [debug] [Thread-2 (]: On model.supercell.fact_bill_generation: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.fact_bill_generation"} */

  
    
    

    create  table
      "supercell"."main"."fact_bill_generation__dbt_tmp"
  
    as (
      


select
    md5(concat(linked_account_id, '_', service_code, '_', instance_type, '_', region, '_', CAST(usage_start_date AS VARCHAR), '_', CAST(usage_end_date AS VARCHAR))) AS resource_id,
    usage_start_date as start_date,
    usage_end_date as bill_date,
    usage_amount as bill_amount,
    operation
from "supercell"."main"."cleaned_usagelogs"
    );
  
  
[0m17:18:11.689611 [debug] [Thread-3 (]: SQL status: OK in 0.115 seconds
[0m17:18:11.694099 [debug] [Thread-3 (]: Using duckdb connection "model.supercell.dim_accounts"
[0m17:18:11.694705 [debug] [Thread-3 (]: On model.supercell.dim_accounts: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.dim_accounts"} */
alter table "supercell"."main"."dim_accounts" rename to "dim_accounts__dbt_backup"
[0m17:18:11.695928 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m17:18:11.699197 [debug] [Thread-3 (]: Using duckdb connection "model.supercell.dim_accounts"
[0m17:18:11.699916 [debug] [Thread-3 (]: On model.supercell.dim_accounts: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.dim_accounts"} */
alter table "supercell"."main"."dim_accounts__dbt_tmp" rename to "dim_accounts"
[0m17:18:11.700971 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m17:18:11.703008 [debug] [Thread-3 (]: On model.supercell.dim_accounts: COMMIT
[0m17:18:11.703559 [debug] [Thread-3 (]: Using duckdb connection "model.supercell.dim_accounts"
[0m17:18:11.704009 [debug] [Thread-3 (]: On model.supercell.dim_accounts: COMMIT
[0m17:18:11.712724 [debug] [Thread-3 (]: SQL status: OK in 0.008 seconds
[0m17:18:11.715206 [debug] [Thread-3 (]: Using duckdb connection "model.supercell.dim_accounts"
[0m17:18:11.715666 [debug] [Thread-3 (]: On model.supercell.dim_accounts: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.dim_accounts"} */
drop table if exists "supercell"."main"."dim_accounts__dbt_backup" cascade
[0m17:18:11.717813 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m17:18:11.719462 [debug] [Thread-3 (]: On model.supercell.dim_accounts: Close
[0m17:18:11.724345 [info ] [Thread-3 (]: 2 of 5 OK created sql table model main.dim_accounts ............................ [[32mOK[0m in 0.18s]
[0m17:18:11.725151 [debug] [Thread-3 (]: Finished running node model.supercell.dim_accounts
[0m17:18:11.793426 [debug] [Thread-2 (]: SQL status: OK in 0.215 seconds
[0m17:18:11.795581 [debug] [Thread-2 (]: Using duckdb connection "model.supercell.fact_bill_generation"
[0m17:18:11.795915 [debug] [Thread-2 (]: On model.supercell.fact_bill_generation: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.fact_bill_generation"} */
alter table "supercell"."main"."fact_bill_generation" rename to "fact_bill_generation__dbt_backup"
[0m17:18:11.796567 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m17:18:11.798200 [debug] [Thread-2 (]: Using duckdb connection "model.supercell.fact_bill_generation"
[0m17:18:11.798446 [debug] [Thread-2 (]: On model.supercell.fact_bill_generation: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.fact_bill_generation"} */
alter table "supercell"."main"."fact_bill_generation__dbt_tmp" rename to "fact_bill_generation"
[0m17:18:11.798934 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m17:18:11.800041 [debug] [Thread-2 (]: On model.supercell.fact_bill_generation: COMMIT
[0m17:18:11.800314 [debug] [Thread-2 (]: Using duckdb connection "model.supercell.fact_bill_generation"
[0m17:18:11.800546 [debug] [Thread-2 (]: On model.supercell.fact_bill_generation: COMMIT
[0m17:18:11.808821 [debug] [Thread-2 (]: SQL status: OK in 0.008 seconds
[0m17:18:11.811413 [debug] [Thread-2 (]: Using duckdb connection "model.supercell.fact_bill_generation"
[0m17:18:11.811683 [debug] [Thread-2 (]: On model.supercell.fact_bill_generation: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.fact_bill_generation"} */
drop table if exists "supercell"."main"."fact_bill_generation__dbt_backup" cascade
[0m17:18:11.813289 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m17:18:11.814123 [debug] [Thread-2 (]: On model.supercell.fact_bill_generation: Close
[0m17:18:11.817421 [info ] [Thread-2 (]: 4 of 5 OK created sql table model main.fact_bill_generation .................... [[32mOK[0m in 0.27s]
[0m17:18:11.817802 [debug] [Thread-2 (]: Finished running node model.supercell.fact_bill_generation
[0m17:18:11.842560 [debug] [Thread-4 (]: SQL status: OK in 0.266 seconds
[0m17:18:11.844342 [debug] [Thread-4 (]: Using duckdb connection "model.supercell.dim_resource"
[0m17:18:11.844581 [debug] [Thread-4 (]: On model.supercell.dim_resource: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.dim_resource"} */
alter table "supercell"."main"."dim_resource" rename to "dim_resource__dbt_backup"
[0m17:18:11.845093 [debug] [Thread-4 (]: SQL status: OK in 0.000 seconds
[0m17:18:11.846674 [debug] [Thread-4 (]: Using duckdb connection "model.supercell.dim_resource"
[0m17:18:11.846887 [debug] [Thread-4 (]: On model.supercell.dim_resource: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.dim_resource"} */
alter table "supercell"."main"."dim_resource__dbt_tmp" rename to "dim_resource"
[0m17:18:11.847279 [debug] [Thread-4 (]: SQL status: OK in 0.000 seconds
[0m17:18:11.848264 [debug] [Thread-4 (]: On model.supercell.dim_resource: COMMIT
[0m17:18:11.848489 [debug] [Thread-4 (]: Using duckdb connection "model.supercell.dim_resource"
[0m17:18:11.848666 [debug] [Thread-4 (]: On model.supercell.dim_resource: COMMIT
[0m17:18:11.852804 [debug] [Thread-4 (]: SQL status: OK in 0.004 seconds
[0m17:18:11.853918 [debug] [Thread-4 (]: Using duckdb connection "model.supercell.dim_resource"
[0m17:18:11.854124 [debug] [Thread-4 (]: On model.supercell.dim_resource: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.dim_resource"} */
drop table if exists "supercell"."main"."dim_resource__dbt_backup" cascade
[0m17:18:11.855631 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m17:18:11.856413 [debug] [Thread-4 (]: On model.supercell.dim_resource: Close
[0m17:18:11.857875 [info ] [Thread-4 (]: 3 of 5 OK created sql table model main.dim_resource ............................ [[32mOK[0m in 0.31s]
[0m17:18:11.858246 [debug] [Thread-4 (]: Finished running node model.supercell.dim_resource
[0m17:18:11.858912 [debug] [Thread-1 (]: Began running node model.supercell.total_cost
[0m17:18:11.859702 [info ] [Thread-1 (]: 5 of 5 START sql table model main.total_cost ................................... [RUN]
[0m17:18:11.860154 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.supercell.cleaned_usagelogs, now model.supercell.total_cost)
[0m17:18:11.860455 [debug] [Thread-1 (]: Began compiling node model.supercell.total_cost
[0m17:18:11.863265 [debug] [Thread-1 (]: Writing injected SQL for node "model.supercell.total_cost"
[0m17:18:11.863879 [debug] [Thread-1 (]: Began executing node model.supercell.total_cost
[0m17:18:11.867259 [debug] [Thread-1 (]: Writing runtime sql for node "model.supercell.total_cost"
[0m17:18:11.867895 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.total_cost"
[0m17:18:11.868214 [debug] [Thread-1 (]: On model.supercell.total_cost: BEGIN
[0m17:18:11.868437 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:18:11.869361 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:18:11.869749 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.total_cost"
[0m17:18:11.869976 [debug] [Thread-1 (]: On model.supercell.total_cost: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.total_cost"} */

  
    
    

    create  table
      "supercell"."main"."total_cost__dbt_tmp"
  
    as (
      

with base as (
    select
        fact_bill_generation.resource_id as resource_id,
        date_trunc('month', fact_bill_generation.bill_date) as month,
        fact_bill_generation.bill_amount as bill_amount,
        dim_resource.instance_type as instance_type,
        dim_resource.product as product,
        dim_resource.region as region,
        dim_resource.pricing_model as pricing_model
        dim_resource.linked_account_id as linked_account_id
    from "supercell"."main"."fact_bill_generation" as fact_bill_generation
    left join "supercell"."main"."dim_resource" as dim_resource
        on fact_bill_generation.resource_id = dim_resource.resource_id
),

joined as (
    select
        base.resource_id,
        base.month,
        base.bill_amount,
        base.instance_type,
        base.product,
        base.region,
        base.pricing_model,
        dim_accounts.tag_keys as tag_keys,
        dim_accounts.tag_values as tag_values
    from base
    left join "supercell"."main"."dim_accounts" as dim_accounts
        on base.linked_account_id = dim_accounts.linked_account_id
)


select
    month,
    sum(bill_amount) as total_cost,
    instance_type,
    product,
    region,
    pricing_model,
    tag_keys,
    tag_values
from joined
group by
    month,
    instance_type,
    product,
    region,
    pricing_model,
    tag_keys,
    tag_values
order by
    month,
    instance_type,
    product,
    region,
    pricing_model,tag_keys,tag_values
    );
  
  
[0m17:18:11.870544 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.total_cost"} */

  
    
    

    create  table
      "supercell"."main"."total_cost__dbt_tmp"
  
    as (
      

with base as (
    select
        fact_bill_generation.resource_id as resource_id,
        date_trunc('month', fact_bill_generation.bill_date) as month,
        fact_bill_generation.bill_amount as bill_amount,
        dim_resource.instance_type as instance_type,
        dim_resource.product as product,
        dim_resource.region as region,
        dim_resource.pricing_model as pricing_model
        dim_resource.linked_account_id as linked_account_id
    from "supercell"."main"."fact_bill_generation" as fact_bill_generation
    left join "supercell"."main"."dim_resource" as dim_resource
        on fact_bill_generation.resource_id = dim_resource.resource_id
),

joined as (
    select
        base.resource_id,
        base.month,
        base.bill_amount,
        base.instance_type,
        base.product,
        base.region,
        base.pricing_model,
        dim_accounts.tag_keys as tag_keys,
        dim_accounts.tag_values as tag_values
    from base
    left join "supercell"."main"."dim_accounts" as dim_accounts
        on base.linked_account_id = dim_accounts.linked_account_id
)


select
    month,
    sum(bill_amount) as total_cost,
    instance_type,
    product,
    region,
    pricing_model,
    tag_keys,
    tag_values
from joined
group by
    month,
    instance_type,
    product,
    region,
    pricing_model,
    tag_keys,
    tag_values
order by
    month,
    instance_type,
    product,
    region,
    pricing_model,tag_keys,tag_values
    );
  
  
[0m17:18:11.870791 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m17:18:11.871147 [debug] [Thread-1 (]: On model.supercell.total_cost: ROLLBACK
[0m17:18:11.873435 [debug] [Thread-1 (]: Failed to rollback 'model.supercell.total_cost'
[0m17:18:11.873711 [debug] [Thread-1 (]: On model.supercell.total_cost: Close
[0m17:18:11.875054 [debug] [Thread-1 (]: Runtime Error in model total_cost (models/supercell_models/metrics/total_cost.sql)
  Parser Error: syntax error at or near "dim_resource"
[0m17:18:11.875496 [error] [Thread-1 (]: 5 of 5 ERROR creating sql table model main.total_cost .......................... [[31mERROR[0m in 0.02s]
[0m17:18:11.875813 [debug] [Thread-1 (]: Finished running node model.supercell.total_cost
[0m17:18:11.876267 [debug] [Thread-7 (]: Marking all children of 'model.supercell.total_cost' to be skipped because of status 'error'.  Reason: Runtime Error in model total_cost (models/supercell_models/metrics/total_cost.sql)
  Parser Error: syntax error at or near "dim_resource".
[0m17:18:11.878002 [debug] [MainThread]: Using duckdb connection "master"
[0m17:18:11.878274 [debug] [MainThread]: On master: BEGIN
[0m17:18:11.878488 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:18:11.879094 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m17:18:11.879317 [debug] [MainThread]: On master: COMMIT
[0m17:18:11.879510 [debug] [MainThread]: Using duckdb connection "master"
[0m17:18:11.879682 [debug] [MainThread]: On master: COMMIT
[0m17:18:11.880047 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:18:11.880258 [debug] [MainThread]: On master: Close
[0m17:18:11.880556 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:18:11.880749 [debug] [MainThread]: Connection 'model.supercell.total_cost' was properly closed.
[0m17:18:11.880916 [debug] [MainThread]: Connection 'model.supercell.dim_accounts' was properly closed.
[0m17:18:11.881068 [debug] [MainThread]: Connection 'model.supercell.dim_resource' was properly closed.
[0m17:18:11.881239 [debug] [MainThread]: Connection 'model.supercell.fact_bill_generation' was properly closed.
[0m17:18:11.881484 [info ] [MainThread]: 
[0m17:18:11.881714 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 0.75 seconds (0.75s).
[0m17:18:11.882390 [debug] [MainThread]: Command end result
[0m17:18:11.893342 [debug] [MainThread]: Wrote artifact WritableManifest to /home/harsha/data_actions/supercell_cloudops/target/manifest.json
[0m17:18:11.894458 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/harsha/data_actions/supercell_cloudops/target/semantic_manifest.json
[0m17:18:11.897966 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/harsha/data_actions/supercell_cloudops/target/run_results.json
[0m17:18:11.898190 [info ] [MainThread]: 
[0m17:18:11.898406 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m17:18:11.898579 [info ] [MainThread]: 
[0m17:18:11.898776 [error] [MainThread]:   Runtime Error in model total_cost (models/supercell_models/metrics/total_cost.sql)
  Parser Error: syntax error at or near "dim_resource"
[0m17:18:11.898933 [info ] [MainThread]: 
[0m17:18:11.899100 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
[0m17:18:11.899644 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.2041914, "process_in_blocks": "0", "process_kernel_time": 0.382622, "process_mem_max_rss": "345300", "process_out_blocks": "59720", "process_user_time": 4.098665}
[0m17:18:11.899916 [debug] [MainThread]: Command `dbt run` failed at 17:18:11.899861 after 1.20 seconds
[0m17:18:11.900160 [debug] [MainThread]: Flushing usage events


============================== 17:18:37.013673 | 2e29203a-20c2-4b2f-90d0-e169e1be2391 ==============================
[0m17:18:37.013673 [info ] [MainThread]: Running with dbt=1.9.4
[0m17:18:37.015788 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/harsha/data_actions/supercell_cloudops', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/harsha/data_actions/supercell_cloudops/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'False'}
[0m17:18:37.016013 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality

User config should be moved from the 'config' key in profiles.yml to the 'flags' key in dbt_project.yml.
[0m17:18:37.170593 [info ] [MainThread]: Registered adapter: duckdb=1.9.3
[0m17:18:37.207444 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m17:18:37.252796 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:18:37.253287 [debug] [MainThread]: Partial parsing: updated file: supercell://models/supercell_models/metrics/total_cost.sql
[0m17:18:37.416068 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.supercell.example
[0m17:18:37.450024 [debug] [MainThread]: Wrote artifact WritableManifest to /home/harsha/data_actions/supercell_cloudops/target/manifest.json
[0m17:18:37.450966 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/harsha/data_actions/supercell_cloudops/target/semantic_manifest.json
[0m17:18:37.457597 [info ] [MainThread]: Found 5 models, 428 macros
[0m17:18:37.458770 [info ] [MainThread]: 
[0m17:18:37.459090 [info ] [MainThread]: Concurrency: 4 threads (target='default')
[0m17:18:37.459287 [info ] [MainThread]: 
[0m17:18:37.459578 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m17:18:37.463573 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_supercell'
[0m17:18:37.486768 [debug] [ThreadPool]: Using duckdb connection "list_supercell"
[0m17:18:37.487046 [debug] [ThreadPool]: On list_supercell: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "connection_name": "list_supercell"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"supercell"'
    
  
  
[0m17:18:37.487245 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:18:37.495184 [debug] [ThreadPool]: SQL status: OK in 0.008 seconds
[0m17:18:37.496041 [debug] [ThreadPool]: On list_supercell: Close
[0m17:18:37.496605 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_supercell, now create_supercell_main)
[0m17:18:37.496990 [debug] [ThreadPool]: Creating schema "database: "supercell"
schema: "main"
"
[0m17:18:37.500883 [debug] [ThreadPool]: Using duckdb connection "create_supercell_main"
[0m17:18:37.501104 [debug] [ThreadPool]: On create_supercell_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "connection_name": "create_supercell_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='supercell'
        and type='sqlite'
    
  
[0m17:18:37.501319 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:18:37.501993 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m17:18:37.502751 [debug] [ThreadPool]: Using duckdb connection "create_supercell_main"
[0m17:18:37.502964 [debug] [ThreadPool]: On create_supercell_main: BEGIN
[0m17:18:37.503297 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:18:37.503490 [debug] [ThreadPool]: Using duckdb connection "create_supercell_main"
[0m17:18:37.503657 [debug] [ThreadPool]: On create_supercell_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "connection_name": "create_supercell_main"} */

    
    
        create schema if not exists "supercell"."main"
    
[0m17:18:37.503952 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:18:37.504485 [debug] [ThreadPool]: On create_supercell_main: COMMIT
[0m17:18:37.504705 [debug] [ThreadPool]: Using duckdb connection "create_supercell_main"
[0m17:18:37.504889 [debug] [ThreadPool]: On create_supercell_main: COMMIT
[0m17:18:37.505217 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:18:37.505412 [debug] [ThreadPool]: On create_supercell_main: Close
[0m17:18:37.506668 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_supercell_main, now list_supercell_main)
[0m17:18:37.511709 [debug] [ThreadPool]: Using duckdb connection "list_supercell_main"
[0m17:18:37.512051 [debug] [ThreadPool]: On list_supercell_main: BEGIN
[0m17:18:37.512360 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:18:37.513094 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m17:18:37.513409 [debug] [ThreadPool]: Using duckdb connection "list_supercell_main"
[0m17:18:37.513696 [debug] [ThreadPool]: On list_supercell_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "connection_name": "list_supercell_main"} */
select
      'supercell' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'supercell'
  
[0m17:18:37.525176 [debug] [ThreadPool]: SQL status: OK in 0.011 seconds
[0m17:18:37.526222 [debug] [ThreadPool]: On list_supercell_main: ROLLBACK
[0m17:18:37.526931 [debug] [ThreadPool]: Failed to rollback 'list_supercell_main'
[0m17:18:37.527162 [debug] [ThreadPool]: On list_supercell_main: Close
[0m17:18:37.528330 [debug] [MainThread]: Using duckdb connection "master"
[0m17:18:37.528515 [debug] [MainThread]: On master: BEGIN
[0m17:18:37.528671 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:18:37.529055 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:18:37.529263 [debug] [MainThread]: On master: COMMIT
[0m17:18:37.529423 [debug] [MainThread]: Using duckdb connection "master"
[0m17:18:37.529568 [debug] [MainThread]: On master: COMMIT
[0m17:18:37.529817 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:18:37.530022 [debug] [MainThread]: On master: Close
[0m17:18:37.531840 [debug] [Thread-1 (]: Began running node model.supercell.cleaned_usagelogs
[0m17:18:37.532400 [info ] [Thread-1 (]: 1 of 5 START sql table model main.cleaned_usagelogs ............................ [RUN]
[0m17:18:37.532858 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_supercell_main, now model.supercell.cleaned_usagelogs)
[0m17:18:37.533241 [debug] [Thread-1 (]: Began compiling node model.supercell.cleaned_usagelogs
[0m17:18:37.541109 [debug] [Thread-1 (]: Writing injected SQL for node "model.supercell.cleaned_usagelogs"
[0m17:18:37.541872 [debug] [Thread-1 (]: Began executing node model.supercell.cleaned_usagelogs
[0m17:18:37.563719 [debug] [Thread-1 (]: Writing runtime sql for node "model.supercell.cleaned_usagelogs"
[0m17:18:37.564221 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.cleaned_usagelogs"
[0m17:18:37.564446 [debug] [Thread-1 (]: On model.supercell.cleaned_usagelogs: BEGIN
[0m17:18:37.564655 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:18:37.565232 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:18:37.565432 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.cleaned_usagelogs"
[0m17:18:37.565615 [debug] [Thread-1 (]: On model.supercell.cleaned_usagelogs: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.cleaned_usagelogs"} */

  
    
    

    create  table
      "supercell"."main"."cleaned_usagelogs__dbt_tmp"
  
    as (
      


SELECT
    CAST("LinkedAccountId" AS VARCHAR) AS linked_account_id,
    CAST("bill/PayerAccountId" AS VARCHAR) AS payer_account_id,
    CAST("lineItem/UsageStartDate" AS TIMESTAMP) AS usage_start_date,
    CAST("lineItem/UsageEndDate" AS TIMESTAMP) AS usage_end_date,
    CAST("lineItem/UsageAmount" AS DECIMAL(18, 6)) AS usage_amount,
    CAST("lineItem/Operation" AS VARCHAR) AS operation,
    CAST("pricing/PricingModel" AS VARCHAR) AS pricing_model,
    CAST("resourceTags/TagKeys" AS VARCHAR) AS tag_keys,
    CAST("resourceTags/TagValues" AS VARCHAR) AS tag_values,
    CAST("product/Region" AS VARCHAR) AS region,
    CAST("product/ServiceCode" AS VARCHAR) AS service_code,
    CAST("product/InstanceType" AS VARCHAR) AS instance_type,
    CAST("amortized_cost" AS DECIMAL(18, 6)) AS amortized_cost,
    CAST("product/Description" AS VARCHAR) AS description
FROM supercell_usagelogs
    );
  
  
[0m17:18:37.847052 [debug] [Thread-1 (]: SQL status: OK in 0.281 seconds
[0m17:18:37.851050 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.cleaned_usagelogs"
[0m17:18:37.851325 [debug] [Thread-1 (]: On model.supercell.cleaned_usagelogs: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.cleaned_usagelogs"} */
alter table "supercell"."main"."cleaned_usagelogs" rename to "cleaned_usagelogs__dbt_backup"
[0m17:18:37.851845 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:18:37.853412 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.cleaned_usagelogs"
[0m17:18:37.853623 [debug] [Thread-1 (]: On model.supercell.cleaned_usagelogs: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.cleaned_usagelogs"} */
alter table "supercell"."main"."cleaned_usagelogs__dbt_tmp" rename to "cleaned_usagelogs"
[0m17:18:37.854015 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:18:37.862916 [debug] [Thread-1 (]: On model.supercell.cleaned_usagelogs: COMMIT
[0m17:18:37.863196 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.cleaned_usagelogs"
[0m17:18:37.863389 [debug] [Thread-1 (]: On model.supercell.cleaned_usagelogs: COMMIT
[0m17:18:37.874973 [debug] [Thread-1 (]: SQL status: OK in 0.011 seconds
[0m17:18:37.878131 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.cleaned_usagelogs"
[0m17:18:37.878418 [debug] [Thread-1 (]: On model.supercell.cleaned_usagelogs: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.cleaned_usagelogs"} */
drop table if exists "supercell"."main"."cleaned_usagelogs__dbt_backup" cascade
[0m17:18:37.880429 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m17:18:37.881836 [debug] [Thread-1 (]: On model.supercell.cleaned_usagelogs: Close
[0m17:18:37.886901 [info ] [Thread-1 (]: 1 of 5 OK created sql table model main.cleaned_usagelogs ....................... [[32mOK[0m in 0.35s]
[0m17:18:37.887294 [debug] [Thread-1 (]: Finished running node model.supercell.cleaned_usagelogs
[0m17:18:37.888182 [debug] [Thread-3 (]: Began running node model.supercell.dim_accounts
[0m17:18:37.888989 [debug] [Thread-4 (]: Began running node model.supercell.dim_resource
[0m17:18:37.889922 [info ] [Thread-3 (]: 2 of 5 START sql table model main.dim_accounts ................................. [RUN]
[0m17:18:37.890549 [debug] [Thread-2 (]: Began running node model.supercell.fact_bill_generation
[0m17:18:37.891174 [info ] [Thread-4 (]: 3 of 5 START sql table model main.dim_resource ................................. [RUN]
[0m17:18:37.892044 [debug] [Thread-3 (]: Acquiring new duckdb connection 'model.supercell.dim_accounts'
[0m17:18:37.892839 [info ] [Thread-2 (]: 4 of 5 START sql table model main.fact_bill_generation ......................... [RUN]
[0m17:18:37.893513 [debug] [Thread-4 (]: Acquiring new duckdb connection 'model.supercell.dim_resource'
[0m17:18:37.894014 [debug] [Thread-3 (]: Began compiling node model.supercell.dim_accounts
[0m17:18:37.894774 [debug] [Thread-2 (]: Acquiring new duckdb connection 'model.supercell.fact_bill_generation'
[0m17:18:37.895298 [debug] [Thread-4 (]: Began compiling node model.supercell.dim_resource
[0m17:18:37.900106 [debug] [Thread-3 (]: Writing injected SQL for node "model.supercell.dim_accounts"
[0m17:18:37.900671 [debug] [Thread-2 (]: Began compiling node model.supercell.fact_bill_generation
[0m17:18:37.902578 [debug] [Thread-4 (]: Writing injected SQL for node "model.supercell.dim_resource"
[0m17:18:37.905868 [debug] [Thread-2 (]: Writing injected SQL for node "model.supercell.fact_bill_generation"
[0m17:18:37.906573 [debug] [Thread-3 (]: Began executing node model.supercell.dim_accounts
[0m17:18:37.907246 [debug] [Thread-4 (]: Began executing node model.supercell.dim_resource
[0m17:18:37.910122 [debug] [Thread-3 (]: Writing runtime sql for node "model.supercell.dim_accounts"
[0m17:18:37.910587 [debug] [Thread-2 (]: Began executing node model.supercell.fact_bill_generation
[0m17:18:37.912370 [debug] [Thread-4 (]: Writing runtime sql for node "model.supercell.dim_resource"
[0m17:18:37.914614 [debug] [Thread-2 (]: Writing runtime sql for node "model.supercell.fact_bill_generation"
[0m17:18:37.915221 [debug] [Thread-3 (]: Using duckdb connection "model.supercell.dim_accounts"
[0m17:18:37.915659 [debug] [Thread-3 (]: On model.supercell.dim_accounts: BEGIN
[0m17:18:37.916007 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m17:18:37.916581 [debug] [Thread-2 (]: Using duckdb connection "model.supercell.fact_bill_generation"
[0m17:18:37.916842 [debug] [Thread-4 (]: Using duckdb connection "model.supercell.dim_resource"
[0m17:18:37.917094 [debug] [Thread-2 (]: On model.supercell.fact_bill_generation: BEGIN
[0m17:18:37.917393 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m17:18:37.917730 [debug] [Thread-4 (]: On model.supercell.dim_resource: BEGIN
[0m17:18:37.917934 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m17:18:37.918210 [debug] [Thread-3 (]: Using duckdb connection "model.supercell.dim_accounts"
[0m17:18:37.918525 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m17:18:37.918885 [debug] [Thread-3 (]: On model.supercell.dim_accounts: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.dim_accounts"} */

  
    
    

    create  table
      "supercell"."main"."dim_accounts__dbt_tmp"
  
    as (
      


select
    linked_account_id as linked_account_id,
    tag_keys as tag_keys,
    tag_values as tag_values
from "supercell"."main"."cleaned_usagelogs"
    );
  
  
[0m17:18:37.919258 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m17:18:37.919642 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m17:18:37.919895 [debug] [Thread-2 (]: Using duckdb connection "model.supercell.fact_bill_generation"
[0m17:18:37.920112 [debug] [Thread-4 (]: Using duckdb connection "model.supercell.dim_resource"
[0m17:18:37.920335 [debug] [Thread-2 (]: On model.supercell.fact_bill_generation: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.fact_bill_generation"} */

  
    
    

    create  table
      "supercell"."main"."fact_bill_generation__dbt_tmp"
  
    as (
      


select
    md5(concat(linked_account_id, '_', service_code, '_', instance_type, '_', region, '_', CAST(usage_start_date AS VARCHAR), '_', CAST(usage_end_date AS VARCHAR))) AS resource_id,
    usage_start_date as start_date,
    usage_end_date as bill_date,
    usage_amount as bill_amount,
    operation
from "supercell"."main"."cleaned_usagelogs"
    );
  
  
[0m17:18:37.920600 [debug] [Thread-4 (]: On model.supercell.dim_resource: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.dim_resource"} */

  
    
    

    create  table
      "supercell"."main"."dim_resource__dbt_tmp"
  
    as (
      


select
    md5(concat(linked_account_id, '_', service_code, '_', instance_type, '_', region, '_', CAST(usage_start_date AS VARCHAR), '_', CAST(usage_end_date AS VARCHAR))) AS resource_id,
    linked_account_id as linked_account_id,
    region,
    service_code as product,
    instance_type as instance_type,
    pricing_model as pricing_model
from "supercell"."main"."cleaned_usagelogs"
    );
  
  
[0m17:18:38.046321 [debug] [Thread-3 (]: SQL status: OK in 0.127 seconds
[0m17:18:38.048942 [debug] [Thread-3 (]: Using duckdb connection "model.supercell.dim_accounts"
[0m17:18:38.049352 [debug] [Thread-3 (]: On model.supercell.dim_accounts: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.dim_accounts"} */
alter table "supercell"."main"."dim_accounts" rename to "dim_accounts__dbt_backup"
[0m17:18:38.050170 [debug] [Thread-3 (]: SQL status: OK in 0.000 seconds
[0m17:18:38.052486 [debug] [Thread-3 (]: Using duckdb connection "model.supercell.dim_accounts"
[0m17:18:38.053156 [debug] [Thread-3 (]: On model.supercell.dim_accounts: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.dim_accounts"} */
alter table "supercell"."main"."dim_accounts__dbt_tmp" rename to "dim_accounts"
[0m17:18:38.054464 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m17:18:38.057598 [debug] [Thread-3 (]: On model.supercell.dim_accounts: COMMIT
[0m17:18:38.058329 [debug] [Thread-3 (]: Using duckdb connection "model.supercell.dim_accounts"
[0m17:18:38.058892 [debug] [Thread-3 (]: On model.supercell.dim_accounts: COMMIT
[0m17:18:38.069145 [debug] [Thread-3 (]: SQL status: OK in 0.009 seconds
[0m17:18:38.072811 [debug] [Thread-3 (]: Using duckdb connection "model.supercell.dim_accounts"
[0m17:18:38.073473 [debug] [Thread-3 (]: On model.supercell.dim_accounts: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.dim_accounts"} */
drop table if exists "supercell"."main"."dim_accounts__dbt_backup" cascade
[0m17:18:38.075815 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m17:18:38.077912 [debug] [Thread-3 (]: On model.supercell.dim_accounts: Close
[0m17:18:38.085570 [info ] [Thread-3 (]: 2 of 5 OK created sql table model main.dim_accounts ............................ [[32mOK[0m in 0.19s]
[0m17:18:38.086861 [debug] [Thread-3 (]: Finished running node model.supercell.dim_accounts
[0m17:18:38.145288 [debug] [Thread-2 (]: SQL status: OK in 0.224 seconds
[0m17:18:38.149610 [debug] [Thread-2 (]: Using duckdb connection "model.supercell.fact_bill_generation"
[0m17:18:38.150337 [debug] [Thread-2 (]: On model.supercell.fact_bill_generation: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.fact_bill_generation"} */
alter table "supercell"."main"."fact_bill_generation" rename to "fact_bill_generation__dbt_backup"
[0m17:18:38.151702 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m17:18:38.155705 [debug] [Thread-2 (]: Using duckdb connection "model.supercell.fact_bill_generation"
[0m17:18:38.156419 [debug] [Thread-2 (]: On model.supercell.fact_bill_generation: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.fact_bill_generation"} */
alter table "supercell"."main"."fact_bill_generation__dbt_tmp" rename to "fact_bill_generation"
[0m17:18:38.157684 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m17:18:38.160467 [debug] [Thread-2 (]: On model.supercell.fact_bill_generation: COMMIT
[0m17:18:38.161124 [debug] [Thread-2 (]: Using duckdb connection "model.supercell.fact_bill_generation"
[0m17:18:38.161729 [debug] [Thread-2 (]: On model.supercell.fact_bill_generation: COMMIT
[0m17:18:38.181947 [debug] [Thread-2 (]: SQL status: OK in 0.020 seconds
[0m17:18:38.187080 [debug] [Thread-2 (]: Using duckdb connection "model.supercell.fact_bill_generation"
[0m17:18:38.187536 [debug] [Thread-2 (]: On model.supercell.fact_bill_generation: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.fact_bill_generation"} */
drop table if exists "supercell"."main"."fact_bill_generation__dbt_backup" cascade
[0m17:18:38.189912 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m17:18:38.192209 [debug] [Thread-2 (]: On model.supercell.fact_bill_generation: Close
[0m17:18:38.200415 [info ] [Thread-2 (]: 4 of 5 OK created sql table model main.fact_bill_generation .................... [[32mOK[0m in 0.31s]
[0m17:18:38.201579 [debug] [Thread-2 (]: Finished running node model.supercell.fact_bill_generation
[0m17:18:38.261408 [debug] [Thread-4 (]: SQL status: OK in 0.340 seconds
[0m17:18:38.264351 [debug] [Thread-4 (]: Using duckdb connection "model.supercell.dim_resource"
[0m17:18:38.264799 [debug] [Thread-4 (]: On model.supercell.dim_resource: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.dim_resource"} */
alter table "supercell"."main"."dim_resource" rename to "dim_resource__dbt_backup"
[0m17:18:38.265644 [debug] [Thread-4 (]: SQL status: OK in 0.000 seconds
[0m17:18:38.268470 [debug] [Thread-4 (]: Using duckdb connection "model.supercell.dim_resource"
[0m17:18:38.268872 [debug] [Thread-4 (]: On model.supercell.dim_resource: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.dim_resource"} */
alter table "supercell"."main"."dim_resource__dbt_tmp" rename to "dim_resource"
[0m17:18:38.269568 [debug] [Thread-4 (]: SQL status: OK in 0.000 seconds
[0m17:18:38.271317 [debug] [Thread-4 (]: On model.supercell.dim_resource: COMMIT
[0m17:18:38.271743 [debug] [Thread-4 (]: Using duckdb connection "model.supercell.dim_resource"
[0m17:18:38.272093 [debug] [Thread-4 (]: On model.supercell.dim_resource: COMMIT
[0m17:18:38.277617 [debug] [Thread-4 (]: SQL status: OK in 0.005 seconds
[0m17:18:38.279870 [debug] [Thread-4 (]: Using duckdb connection "model.supercell.dim_resource"
[0m17:18:38.280296 [debug] [Thread-4 (]: On model.supercell.dim_resource: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.dim_resource"} */
drop table if exists "supercell"."main"."dim_resource__dbt_backup" cascade
[0m17:18:38.282414 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m17:18:38.283880 [debug] [Thread-4 (]: On model.supercell.dim_resource: Close
[0m17:18:38.285698 [info ] [Thread-4 (]: 3 of 5 OK created sql table model main.dim_resource ............................ [[32mOK[0m in 0.39s]
[0m17:18:38.286319 [debug] [Thread-4 (]: Finished running node model.supercell.dim_resource
[0m17:18:38.287495 [debug] [Thread-1 (]: Began running node model.supercell.total_cost
[0m17:18:38.288151 [info ] [Thread-1 (]: 5 of 5 START sql table model main.total_cost ................................... [RUN]
[0m17:18:38.288831 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.supercell.cleaned_usagelogs, now model.supercell.total_cost)
[0m17:18:38.289369 [debug] [Thread-1 (]: Began compiling node model.supercell.total_cost
[0m17:18:38.293373 [debug] [Thread-1 (]: Writing injected SQL for node "model.supercell.total_cost"
[0m17:18:38.294321 [debug] [Thread-1 (]: Began executing node model.supercell.total_cost
[0m17:18:38.298187 [debug] [Thread-1 (]: Writing runtime sql for node "model.supercell.total_cost"
[0m17:18:38.299024 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.total_cost"
[0m17:18:38.299471 [debug] [Thread-1 (]: On model.supercell.total_cost: BEGIN
[0m17:18:38.299806 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:18:38.300589 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:18:38.300973 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.total_cost"
[0m17:18:38.301376 [debug] [Thread-1 (]: On model.supercell.total_cost: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.total_cost"} */

  
    
    

    create  table
      "supercell"."main"."total_cost__dbt_tmp"
  
    as (
      

with base as (
    select
        fact_bill_generation.resource_id as resource_id,
        date_trunc('month', fact_bill_generation.bill_date) as month,
        fact_bill_generation.bill_amount as bill_amount,
        dim_resource.instance_type as instance_type,
        dim_resource.product as product,
        dim_resource.region as region,
        dim_resource.pricing_model as pricing_model,
        dim_resource.linked_account_id as linked_account_id
    from "supercell"."main"."fact_bill_generation" as fact_bill_generation
    left join "supercell"."main"."dim_resource" as dim_resource
        on fact_bill_generation.resource_id = dim_resource.resource_id
),

joined as (
    select
        base.resource_id,
        base.month,
        base.bill_amount,
        base.instance_type,
        base.product,
        base.region,
        base.pricing_model,
        dim_accounts.tag_keys as tag_keys,
        dim_accounts.tag_values as tag_values
    from base
    left join "supercell"."main"."dim_accounts" as dim_accounts
        on base.linked_account_id = dim_accounts.linked_account_id
)


select
    month,
    sum(bill_amount) as total_cost,
    instance_type,
    product,
    region,
    pricing_model,
    tag_keys,
    tag_values
from joined
group by
    month,
    instance_type,
    product,
    region,
    pricing_model,
    tag_keys,
    tag_values
order by
    month,
    instance_type,
    product,
    region,
    pricing_model,tag_keys,tag_values
    );
  
  
[0m17:19:38.728865 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/harsha/data_actions/supercell_cloudops/target/run_results.json
[0m17:19:38.737335 [debug] [MainThread]: DuckDB adapter: cancelling query on connection model.supercell.total_cost. Details: Connection(type='duckdb', name='model.supercell.total_cost', state=<ConnectionState.OPEN: 'open'>, transaction_open=True, _handle=<dbt.adapters.duckdb.environments.local.DuckDBConnectionWrapper object at 0x7b81ec114cb0>, _credentials=DuckDBCredentials(database='supercell', schema='main', path='/home/harsha/data_actions/supercell_cloudops/supercell.duckdb', config_options=None, extensions=None, settings={}, secrets=[], external_root='.', use_credential_provider=None, attach=None, filesystems=None, remote=None, plugins=None, disable_transactions=False, keep_open=True, module_paths=None, retries=None))
[0m17:19:38.741239 [debug] [MainThread]: DuckDB adapter: query cancelled on connection model.supercell.total_cost
[0m17:19:38.744107 [error] [MainThread]: CANCEL query model.supercell.total_cost ........................................ [[31mCANCEL[0m]
[0m17:19:38.746935 [error] [MainThread]: CANCEL query model.supercell.dim_accounts ...................................... [[31mCANCEL[0m]
[0m17:19:38.755363 [error] [MainThread]: CANCEL query model.supercell.dim_resource ...................................... [[31mCANCEL[0m]
[0m17:19:38.752320 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.total_cost"} */

  
    
    

    create  table
      "supercell"."main"."total_cost__dbt_tmp"
  
    as (
      

with base as (
    select
        fact_bill_generation.resource_id as resource_id,
        date_trunc('month', fact_bill_generation.bill_date) as month,
        fact_bill_generation.bill_amount as bill_amount,
        dim_resource.instance_type as instance_type,
        dim_resource.product as product,
        dim_resource.region as region,
        dim_resource.pricing_model as pricing_model,
        dim_resource.linked_account_id as linked_account_id
    from "supercell"."main"."fact_bill_generation" as fact_bill_generation
    left join "supercell"."main"."dim_resource" as dim_resource
        on fact_bill_generation.resource_id = dim_resource.resource_id
),

joined as (
    select
        base.resource_id,
        base.month,
        base.bill_amount,
        base.instance_type,
        base.product,
        base.region,
        base.pricing_model,
        dim_accounts.tag_keys as tag_keys,
        dim_accounts.tag_values as tag_values
    from base
    left join "supercell"."main"."dim_accounts" as dim_accounts
        on base.linked_account_id = dim_accounts.linked_account_id
)


select
    month,
    sum(bill_amount) as total_cost,
    instance_type,
    product,
    region,
    pricing_model,
    tag_keys,
    tag_values
from joined
group by
    month,
    instance_type,
    product,
    region,
    pricing_model,
    tag_keys,
    tag_values
order by
    month,
    instance_type,
    product,
    region,
    pricing_model,tag_keys,tag_values
    );
  
  
[0m17:19:38.759781 [error] [MainThread]: CANCEL query model.supercell.fact_bill_generation .............................. [[31mCANCEL[0m]
[0m17:19:38.764379 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m17:19:38.770334 [debug] [Thread-1 (]: On model.supercell.total_cost: ROLLBACK
[0m17:19:38.799927 [debug] [Thread-1 (]: Failed to rollback 'model.supercell.total_cost'
[0m17:19:38.801207 [debug] [Thread-1 (]: On model.supercell.total_cost: Close
[0m17:19:38.815302 [debug] [Thread-1 (]: Runtime Error in model total_cost (models/supercell_models/metrics/total_cost.sql)
  INTERRUPT Error: Interrupted!
[0m17:19:38.816475 [error] [Thread-1 (]: 5 of 5 ERROR creating sql table model main.total_cost .......................... [[31mERROR[0m in 60.53s]
[0m17:19:38.817376 [debug] [Thread-1 (]: Finished running node model.supercell.total_cost
[0m17:19:38.818462 [info ] [MainThread]: 
[0m17:19:38.821973 [info ] [MainThread]: [33mExited because of keyboard interrupt[0m
[0m17:19:38.825025 [info ] [MainThread]: 
[0m17:19:38.828473 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m17:19:38.831065 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:19:38.833429 [debug] [MainThread]: Connection 'model.supercell.total_cost' was properly closed.
[0m17:19:38.835732 [debug] [MainThread]: Connection 'model.supercell.dim_accounts' was properly closed.
[0m17:19:38.838053 [debug] [MainThread]: Connection 'model.supercell.dim_resource' was properly closed.
[0m17:19:38.840539 [debug] [MainThread]: Connection 'model.supercell.fact_bill_generation' was properly closed.
[0m17:19:38.843705 [info ] [MainThread]: 
[0m17:19:38.846695 [info ] [MainThread]: Finished running 4 table models in 0 hours 1 minutes and 1.38 seconds (61.38s).
[0m17:19:38.850511 [error] [MainThread]: Encountered an error:

[0m17:19:38.866596 [error] [MainThread]: Traceback (most recent call last):
  File "/home/harsha/data_actions/supercell_cloudops/supercell_env/lib/python3.12/site-packages/dbt/cli/requires.py", line 153, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "/home/harsha/data_actions/supercell_cloudops/supercell_env/lib/python3.12/site-packages/dbt/cli/requires.py", line 103, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/harsha/data_actions/supercell_cloudops/supercell_env/lib/python3.12/site-packages/dbt/cli/requires.py", line 235, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/harsha/data_actions/supercell_cloudops/supercell_env/lib/python3.12/site-packages/dbt/cli/requires.py", line 264, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/harsha/data_actions/supercell_cloudops/supercell_env/lib/python3.12/site-packages/dbt/cli/requires.py", line 311, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/harsha/data_actions/supercell_cloudops/supercell_env/lib/python3.12/site-packages/dbt/cli/requires.py", line 328, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/harsha/data_actions/supercell_cloudops/supercell_env/lib/python3.12/site-packages/dbt/cli/main.py", line 578, in run
    results = task.run()
              ^^^^^^^^^^
  File "/home/harsha/data_actions/supercell_cloudops/supercell_env/lib/python3.12/site-packages/dbt/task/runnable.py", line 590, in run
    result = self.execute_with_hooks(selected_uids)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/harsha/data_actions/supercell_cloudops/supercell_env/lib/python3.12/site-packages/dbt/task/runnable.py", line 532, in execute_with_hooks
    res = self.execute_nodes()
          ^^^^^^^^^^^^^^^^^^^^
  File "/home/harsha/data_actions/supercell_cloudops/supercell_env/lib/python3.12/site-packages/dbt/task/runnable.py", line 413, in execute_nodes
    self.run_queue(pool)
  File "/home/harsha/data_actions/supercell_cloudops/supercell_env/lib/python3.12/site-packages/dbt/task/runnable.py", line 340, in run_queue
    self.job_queue.join()
  File "/home/harsha/data_actions/supercell_cloudops/supercell_env/lib/python3.12/site-packages/dbt/graph/queue.py", line 206, in join
    self.inner.join()
  File "/usr/lib/python3.12/queue.py", line 90, in join
    self.all_tasks_done.wait()
  File "/usr/lib/python3.12/threading.py", line 355, in wait
    waiter.acquire()
KeyboardInterrupt

[0m17:19:38.874557 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 61.891155, "process_in_blocks": "0", "process_kernel_time": 0.517758, "process_mem_max_rss": "354000", "process_out_blocks": "58856", "process_user_time": 305.74426}
[0m17:19:38.878612 [debug] [MainThread]: Command `dbt run` failed at 17:19:38.877750 after 61.90 seconds
[0m17:19:38.881401 [debug] [MainThread]: Flushing usage events


============================== 17:19:48.913664 | 3d6aeb04-9e8f-4964-872e-fe8777857ee3 ==============================
[0m17:19:48.913664 [info ] [MainThread]: Running with dbt=1.9.4
[0m17:19:48.926626 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/harsha/data_actions/supercell_cloudops/logs', 'profiles_dir': '/home/harsha/data_actions/supercell_cloudops', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'invocation_command': 'dbt debug', 'send_anonymous_usage_stats': 'False'}
[0m17:19:48.928364 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality

User config should be moved from the 'config' key in profiles.yml to the 'flags' key in dbt_project.yml.
[0m17:19:48.950680 [info ] [MainThread]: dbt version: 1.9.4
[0m17:19:48.951404 [info ] [MainThread]: python version: 3.12.3
[0m17:19:48.951920 [info ] [MainThread]: python path: /home/harsha/data_actions/supercell_cloudops/supercell_env/bin/python3
[0m17:19:48.952395 [info ] [MainThread]: os info: Linux-6.11.0-24-generic-x86_64-with-glibc2.39
[0m17:19:49.102044 [info ] [MainThread]: Using profiles dir at /home/harsha/data_actions/supercell_cloudops
[0m17:19:49.102783 [info ] [MainThread]: Using profiles.yml file at /home/harsha/data_actions/supercell_cloudops/profiles.yml
[0m17:19:49.103290 [info ] [MainThread]: Using dbt_project.yml file at /home/harsha/data_actions/supercell_cloudops/dbt_project.yml
[0m17:19:49.106530 [info ] [MainThread]: adapter type: duckdb
[0m17:19:49.107184 [info ] [MainThread]: adapter version: 1.9.3
[0m17:19:49.259836 [info ] [MainThread]: Configuration:
[0m17:19:49.260539 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m17:19:49.261012 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m17:19:49.261460 [info ] [MainThread]: Required dependencies:
[0m17:19:49.261973 [debug] [MainThread]: Executing "git --help"
[0m17:19:49.265414 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--config-env=<name>=<envvar>] <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m17:19:49.266224 [debug] [MainThread]: STDERR: "b''"
[0m17:19:49.266734 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m17:19:49.267257 [info ] [MainThread]: Connection:
[0m17:19:49.267728 [info ] [MainThread]:   database: supercell
[0m17:19:49.268180 [info ] [MainThread]:   schema: main
[0m17:19:49.268588 [info ] [MainThread]:   path: /home/harsha/data_actions/supercell_cloudops/supercell.duckdb
[0m17:19:49.268971 [info ] [MainThread]:   config_options: None
[0m17:19:49.269361 [info ] [MainThread]:   extensions: None
[0m17:19:49.269754 [info ] [MainThread]:   settings: {}
[0m17:19:49.270146 [info ] [MainThread]:   external_root: .
[0m17:19:49.270518 [info ] [MainThread]:   use_credential_provider: None
[0m17:19:49.270921 [info ] [MainThread]:   attach: None
[0m17:19:49.271306 [info ] [MainThread]:   filesystems: None
[0m17:19:49.271683 [info ] [MainThread]:   remote: None
[0m17:19:49.272047 [info ] [MainThread]:   plugins: None
[0m17:19:49.272421 [info ] [MainThread]:   disable_transactions: False
[0m17:19:49.273007 [info ] [MainThread]: Registered adapter: duckdb=1.9.3
[0m17:19:49.356427 [debug] [MainThread]: Acquiring new duckdb connection 'debug'
[0m17:19:49.383532 [debug] [MainThread]: Using duckdb connection "debug"
[0m17:19:49.384180 [debug] [MainThread]: On debug: select 1 as id
[0m17:19:49.384627 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:19:49.401704 [debug] [MainThread]: SQL status: OK in 0.017 seconds
[0m17:19:49.403251 [debug] [MainThread]: On debug: Close
[0m17:19:49.403914 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m17:19:49.404504 [info ] [MainThread]: [32mAll checks passed![0m
[0m17:19:49.406131 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 0.57940656, "process_in_blocks": "616", "process_kernel_time": 0.2774, "process_mem_max_rss": "134392", "process_out_blocks": "24", "process_user_time": 3.208069}
[0m17:19:49.406971 [debug] [MainThread]: Command `dbt debug` succeeded at 17:19:49.406806 after 0.58 seconds
[0m17:19:49.407501 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m17:19:49.407974 [debug] [MainThread]: Flushing usage events


============================== 17:31:46.985339 | 18e3647b-6967-41d2-bfdb-2c900169e1e5 ==============================
[0m17:31:46.985339 [info ] [MainThread]: Running with dbt=1.9.4
[0m17:31:46.987360 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/harsha/data_actions/supercell_cloudops', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/harsha/data_actions/supercell_cloudops/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'False'}
[0m17:31:46.987606 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality

User config should be moved from the 'config' key in profiles.yml to the 'flags' key in dbt_project.yml.
[0m17:31:47.151715 [info ] [MainThread]: Registered adapter: duckdb=1.9.3
[0m17:31:47.190038 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m17:31:47.231989 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:31:47.232419 [debug] [MainThread]: Partial parsing: updated file: supercell://models/supercell_models/metrics/total_cost.sql
[0m17:31:47.374301 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.supercell.example
[0m17:31:47.406270 [debug] [MainThread]: Wrote artifact WritableManifest to /home/harsha/data_actions/supercell_cloudops/target/manifest.json
[0m17:31:47.407380 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/harsha/data_actions/supercell_cloudops/target/semantic_manifest.json
[0m17:31:47.414767 [info ] [MainThread]: Found 5 models, 428 macros
[0m17:31:47.416097 [info ] [MainThread]: 
[0m17:31:47.416593 [info ] [MainThread]: Concurrency: 4 threads (target='default')
[0m17:31:47.416797 [info ] [MainThread]: 
[0m17:31:47.417153 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m17:31:47.420913 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_supercell'
[0m17:31:47.445811 [debug] [ThreadPool]: Using duckdb connection "list_supercell"
[0m17:31:47.446095 [debug] [ThreadPool]: On list_supercell: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "connection_name": "list_supercell"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"supercell"'
    
  
  
[0m17:31:47.446328 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:31:47.454194 [debug] [ThreadPool]: SQL status: OK in 0.008 seconds
[0m17:31:47.455091 [debug] [ThreadPool]: On list_supercell: Close
[0m17:31:47.455579 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_supercell, now create_supercell_main)
[0m17:31:47.455922 [debug] [ThreadPool]: Creating schema "database: "supercell"
schema: "main"
"
[0m17:31:47.459951 [debug] [ThreadPool]: Using duckdb connection "create_supercell_main"
[0m17:31:47.460194 [debug] [ThreadPool]: On create_supercell_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "connection_name": "create_supercell_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='supercell'
        and type='sqlite'
    
  
[0m17:31:47.460358 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:31:47.460998 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m17:31:47.461761 [debug] [ThreadPool]: Using duckdb connection "create_supercell_main"
[0m17:31:47.461932 [debug] [ThreadPool]: On create_supercell_main: BEGIN
[0m17:31:47.462226 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:31:47.462423 [debug] [ThreadPool]: Using duckdb connection "create_supercell_main"
[0m17:31:47.462591 [debug] [ThreadPool]: On create_supercell_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "connection_name": "create_supercell_main"} */

    
    
        create schema if not exists "supercell"."main"
    
[0m17:31:47.462887 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:31:47.463376 [debug] [ThreadPool]: On create_supercell_main: COMMIT
[0m17:31:47.463591 [debug] [ThreadPool]: Using duckdb connection "create_supercell_main"
[0m17:31:47.463752 [debug] [ThreadPool]: On create_supercell_main: COMMIT
[0m17:31:47.464253 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:31:47.464453 [debug] [ThreadPool]: On create_supercell_main: Close
[0m17:31:47.465514 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_supercell_main, now list_supercell_main)
[0m17:31:47.471022 [debug] [ThreadPool]: Using duckdb connection "list_supercell_main"
[0m17:31:47.472197 [debug] [ThreadPool]: On list_supercell_main: BEGIN
[0m17:31:47.472783 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:31:47.474221 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m17:31:47.474594 [debug] [ThreadPool]: Using duckdb connection "list_supercell_main"
[0m17:31:47.474764 [debug] [ThreadPool]: On list_supercell_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "connection_name": "list_supercell_main"} */
select
      'supercell' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'supercell'
  
[0m17:31:47.482853 [debug] [ThreadPool]: SQL status: OK in 0.008 seconds
[0m17:31:47.483831 [debug] [ThreadPool]: On list_supercell_main: ROLLBACK
[0m17:31:47.484496 [debug] [ThreadPool]: Failed to rollback 'list_supercell_main'
[0m17:31:47.484696 [debug] [ThreadPool]: On list_supercell_main: Close
[0m17:31:47.485966 [debug] [MainThread]: Using duckdb connection "master"
[0m17:31:47.486191 [debug] [MainThread]: On master: BEGIN
[0m17:31:47.486358 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:31:47.486770 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:31:47.486953 [debug] [MainThread]: On master: COMMIT
[0m17:31:47.487109 [debug] [MainThread]: Using duckdb connection "master"
[0m17:31:47.487289 [debug] [MainThread]: On master: COMMIT
[0m17:31:47.487557 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:31:47.487776 [debug] [MainThread]: On master: Close
[0m17:31:47.489767 [debug] [Thread-1 (]: Began running node model.supercell.cleaned_usagelogs
[0m17:31:47.490336 [info ] [Thread-1 (]: 1 of 5 START sql table model main.cleaned_usagelogs ............................ [RUN]
[0m17:31:47.490695 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_supercell_main, now model.supercell.cleaned_usagelogs)
[0m17:31:47.490937 [debug] [Thread-1 (]: Began compiling node model.supercell.cleaned_usagelogs
[0m17:31:47.495830 [debug] [Thread-1 (]: Writing injected SQL for node "model.supercell.cleaned_usagelogs"
[0m17:31:47.496837 [debug] [Thread-1 (]: Began executing node model.supercell.cleaned_usagelogs
[0m17:31:47.515998 [debug] [Thread-1 (]: Writing runtime sql for node "model.supercell.cleaned_usagelogs"
[0m17:31:47.516546 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.cleaned_usagelogs"
[0m17:31:47.516826 [debug] [Thread-1 (]: On model.supercell.cleaned_usagelogs: BEGIN
[0m17:31:47.517016 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:31:47.517598 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:31:47.517813 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.cleaned_usagelogs"
[0m17:31:47.518009 [debug] [Thread-1 (]: On model.supercell.cleaned_usagelogs: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.cleaned_usagelogs"} */

  
    
    

    create  table
      "supercell"."main"."cleaned_usagelogs__dbt_tmp"
  
    as (
      


SELECT
    CAST("LinkedAccountId" AS VARCHAR) AS linked_account_id,
    CAST("bill/PayerAccountId" AS VARCHAR) AS payer_account_id,
    CAST("lineItem/UsageStartDate" AS TIMESTAMP) AS usage_start_date,
    CAST("lineItem/UsageEndDate" AS TIMESTAMP) AS usage_end_date,
    CAST("lineItem/UsageAmount" AS DECIMAL(18, 6)) AS usage_amount,
    CAST("lineItem/Operation" AS VARCHAR) AS operation,
    CAST("pricing/PricingModel" AS VARCHAR) AS pricing_model,
    CAST("resourceTags/TagKeys" AS VARCHAR) AS tag_keys,
    CAST("resourceTags/TagValues" AS VARCHAR) AS tag_values,
    CAST("product/Region" AS VARCHAR) AS region,
    CAST("product/ServiceCode" AS VARCHAR) AS service_code,
    CAST("product/InstanceType" AS VARCHAR) AS instance_type,
    CAST("amortized_cost" AS DECIMAL(18, 6)) AS amortized_cost,
    CAST("product/Description" AS VARCHAR) AS description
FROM supercell_usagelogs
    );
  
  
[0m17:31:47.786346 [debug] [Thread-1 (]: SQL status: OK in 0.268 seconds
[0m17:31:47.790194 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.cleaned_usagelogs"
[0m17:31:47.790436 [debug] [Thread-1 (]: On model.supercell.cleaned_usagelogs: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.cleaned_usagelogs"} */
alter table "supercell"."main"."cleaned_usagelogs" rename to "cleaned_usagelogs__dbt_backup"
[0m17:31:47.790962 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:31:47.792487 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.cleaned_usagelogs"
[0m17:31:47.792702 [debug] [Thread-1 (]: On model.supercell.cleaned_usagelogs: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.cleaned_usagelogs"} */
alter table "supercell"."main"."cleaned_usagelogs__dbt_tmp" rename to "cleaned_usagelogs"
[0m17:31:47.793094 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:31:47.802468 [debug] [Thread-1 (]: On model.supercell.cleaned_usagelogs: COMMIT
[0m17:31:47.802769 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.cleaned_usagelogs"
[0m17:31:47.802974 [debug] [Thread-1 (]: On model.supercell.cleaned_usagelogs: COMMIT
[0m17:31:47.828248 [debug] [Thread-1 (]: SQL status: OK in 0.025 seconds
[0m17:31:47.831677 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.cleaned_usagelogs"
[0m17:31:47.831977 [debug] [Thread-1 (]: On model.supercell.cleaned_usagelogs: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.cleaned_usagelogs"} */
drop table if exists "supercell"."main"."cleaned_usagelogs__dbt_backup" cascade
[0m17:31:47.833891 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m17:31:47.835382 [debug] [Thread-1 (]: On model.supercell.cleaned_usagelogs: Close
[0m17:31:47.839741 [info ] [Thread-1 (]: 1 of 5 OK created sql table model main.cleaned_usagelogs ....................... [[32mOK[0m in 0.35s]
[0m17:31:47.840117 [debug] [Thread-1 (]: Finished running node model.supercell.cleaned_usagelogs
[0m17:31:47.841175 [debug] [Thread-3 (]: Began running node model.supercell.dim_accounts
[0m17:31:47.841866 [info ] [Thread-3 (]: 2 of 5 START sql table model main.dim_accounts ................................. [RUN]
[0m17:31:47.842486 [debug] [Thread-4 (]: Began running node model.supercell.dim_resource
[0m17:31:47.843131 [debug] [Thread-3 (]: Acquiring new duckdb connection 'model.supercell.dim_accounts'
[0m17:31:47.843802 [debug] [Thread-2 (]: Began running node model.supercell.fact_bill_generation
[0m17:31:47.844490 [info ] [Thread-4 (]: 3 of 5 START sql table model main.dim_resource ................................. [RUN]
[0m17:31:47.844902 [debug] [Thread-3 (]: Began compiling node model.supercell.dim_accounts
[0m17:31:47.845597 [info ] [Thread-2 (]: 4 of 5 START sql table model main.fact_bill_generation ......................... [RUN]
[0m17:31:47.846681 [debug] [Thread-4 (]: Acquiring new duckdb connection 'model.supercell.dim_resource'
[0m17:31:47.852301 [debug] [Thread-3 (]: Writing injected SQL for node "model.supercell.dim_accounts"
[0m17:31:47.853694 [debug] [Thread-2 (]: Acquiring new duckdb connection 'model.supercell.fact_bill_generation'
[0m17:31:47.854240 [debug] [Thread-4 (]: Began compiling node model.supercell.dim_resource
[0m17:31:47.854787 [debug] [Thread-2 (]: Began compiling node model.supercell.fact_bill_generation
[0m17:31:47.855390 [debug] [Thread-3 (]: Began executing node model.supercell.dim_accounts
[0m17:31:47.858015 [debug] [Thread-4 (]: Writing injected SQL for node "model.supercell.dim_resource"
[0m17:31:47.860440 [debug] [Thread-2 (]: Writing injected SQL for node "model.supercell.fact_bill_generation"
[0m17:31:47.863091 [debug] [Thread-3 (]: Writing runtime sql for node "model.supercell.dim_accounts"
[0m17:31:47.864059 [debug] [Thread-2 (]: Began executing node model.supercell.fact_bill_generation
[0m17:31:47.864630 [debug] [Thread-4 (]: Began executing node model.supercell.dim_resource
[0m17:31:47.867218 [debug] [Thread-2 (]: Writing runtime sql for node "model.supercell.fact_bill_generation"
[0m17:31:47.868980 [debug] [Thread-4 (]: Writing runtime sql for node "model.supercell.dim_resource"
[0m17:31:47.869475 [debug] [Thread-3 (]: Using duckdb connection "model.supercell.dim_accounts"
[0m17:31:47.870116 [debug] [Thread-2 (]: Using duckdb connection "model.supercell.fact_bill_generation"
[0m17:31:47.870592 [debug] [Thread-4 (]: Using duckdb connection "model.supercell.dim_resource"
[0m17:31:47.870900 [debug] [Thread-3 (]: On model.supercell.dim_accounts: BEGIN
[0m17:31:47.871358 [debug] [Thread-2 (]: On model.supercell.fact_bill_generation: BEGIN
[0m17:31:47.871680 [debug] [Thread-4 (]: On model.supercell.dim_resource: BEGIN
[0m17:31:47.871992 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m17:31:47.872476 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m17:31:47.872785 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m17:31:47.873651 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m17:31:47.874031 [debug] [Thread-3 (]: Using duckdb connection "model.supercell.dim_accounts"
[0m17:31:47.874414 [debug] [Thread-3 (]: On model.supercell.dim_accounts: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.dim_accounts"} */

  
    
    

    create  table
      "supercell"."main"."dim_accounts__dbt_tmp"
  
    as (
      


select
    linked_account_id as linked_account_id,
    tag_keys as tag_keys,
    tag_values as tag_values
from "supercell"."main"."cleaned_usagelogs"
    );
  
  
[0m17:31:47.874987 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m17:31:47.875337 [debug] [Thread-4 (]: Using duckdb connection "model.supercell.dim_resource"
[0m17:31:47.875707 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m17:31:47.876064 [debug] [Thread-4 (]: On model.supercell.dim_resource: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.dim_resource"} */

  
    
    

    create  table
      "supercell"."main"."dim_resource__dbt_tmp"
  
    as (
      


select
    md5(concat(linked_account_id, '_', service_code, '_', instance_type, '_', region, '_', CAST(usage_start_date AS VARCHAR), '_', CAST(usage_end_date AS VARCHAR))) AS resource_id,
    linked_account_id as linked_account_id,
    region,
    service_code as product,
    instance_type as instance_type,
    pricing_model as pricing_model
from "supercell"."main"."cleaned_usagelogs"
    );
  
  
[0m17:31:47.876445 [debug] [Thread-2 (]: Using duckdb connection "model.supercell.fact_bill_generation"
[0m17:31:47.876954 [debug] [Thread-2 (]: On model.supercell.fact_bill_generation: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.fact_bill_generation"} */

  
    
    

    create  table
      "supercell"."main"."fact_bill_generation__dbt_tmp"
  
    as (
      


select
    md5(concat(linked_account_id, '_', service_code, '_', instance_type, '_', region, '_', CAST(usage_start_date AS VARCHAR), '_', CAST(usage_end_date AS VARCHAR))) AS resource_id,
    usage_start_date as start_date,
    usage_end_date as bill_date,
    usage_amount as bill_amount,
    operation
from "supercell"."main"."cleaned_usagelogs"
    );
  
  
[0m17:31:47.984796 [debug] [Thread-3 (]: SQL status: OK in 0.110 seconds
[0m17:31:47.987170 [debug] [Thread-3 (]: Using duckdb connection "model.supercell.dim_accounts"
[0m17:31:47.987541 [debug] [Thread-3 (]: On model.supercell.dim_accounts: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.dim_accounts"} */
alter table "supercell"."main"."dim_accounts" rename to "dim_accounts__dbt_backup"
[0m17:31:47.988274 [debug] [Thread-3 (]: SQL status: OK in 0.000 seconds
[0m17:31:47.990390 [debug] [Thread-3 (]: Using duckdb connection "model.supercell.dim_accounts"
[0m17:31:47.990856 [debug] [Thread-3 (]: On model.supercell.dim_accounts: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.dim_accounts"} */
alter table "supercell"."main"."dim_accounts__dbt_tmp" rename to "dim_accounts"
[0m17:31:47.992015 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m17:31:47.993394 [debug] [Thread-3 (]: On model.supercell.dim_accounts: COMMIT
[0m17:31:47.993717 [debug] [Thread-3 (]: Using duckdb connection "model.supercell.dim_accounts"
[0m17:31:47.993948 [debug] [Thread-3 (]: On model.supercell.dim_accounts: COMMIT
[0m17:31:48.012823 [debug] [Thread-3 (]: SQL status: OK in 0.018 seconds
[0m17:31:48.016121 [debug] [Thread-3 (]: Using duckdb connection "model.supercell.dim_accounts"
[0m17:31:48.016767 [debug] [Thread-3 (]: On model.supercell.dim_accounts: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.dim_accounts"} */
drop table if exists "supercell"."main"."dim_accounts__dbt_backup" cascade
[0m17:31:48.018938 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m17:31:48.020618 [debug] [Thread-3 (]: On model.supercell.dim_accounts: Close
[0m17:31:48.025861 [info ] [Thread-3 (]: 2 of 5 OK created sql table model main.dim_accounts ............................ [[32mOK[0m in 0.18s]
[0m17:31:48.026718 [debug] [Thread-3 (]: Finished running node model.supercell.dim_accounts
[0m17:31:48.067643 [debug] [Thread-2 (]: SQL status: OK in 0.190 seconds
[0m17:31:48.070367 [debug] [Thread-2 (]: Using duckdb connection "model.supercell.fact_bill_generation"
[0m17:31:48.070793 [debug] [Thread-2 (]: On model.supercell.fact_bill_generation: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.fact_bill_generation"} */
alter table "supercell"."main"."fact_bill_generation" rename to "fact_bill_generation__dbt_backup"
[0m17:31:48.071834 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m17:31:48.074387 [debug] [Thread-2 (]: Using duckdb connection "model.supercell.fact_bill_generation"
[0m17:31:48.074808 [debug] [Thread-2 (]: On model.supercell.fact_bill_generation: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.fact_bill_generation"} */
alter table "supercell"."main"."fact_bill_generation__dbt_tmp" rename to "fact_bill_generation"
[0m17:31:48.075629 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m17:31:48.077275 [debug] [Thread-2 (]: On model.supercell.fact_bill_generation: COMMIT
[0m17:31:48.077671 [debug] [Thread-2 (]: Using duckdb connection "model.supercell.fact_bill_generation"
[0m17:31:48.078005 [debug] [Thread-2 (]: On model.supercell.fact_bill_generation: COMMIT
[0m17:31:48.117151 [debug] [Thread-2 (]: SQL status: OK in 0.039 seconds
[0m17:31:48.119721 [debug] [Thread-2 (]: Using duckdb connection "model.supercell.fact_bill_generation"
[0m17:31:48.119999 [debug] [Thread-2 (]: On model.supercell.fact_bill_generation: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.fact_bill_generation"} */
drop table if exists "supercell"."main"."fact_bill_generation__dbt_backup" cascade
[0m17:31:48.121520 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m17:31:48.122441 [debug] [Thread-2 (]: On model.supercell.fact_bill_generation: Close
[0m17:31:48.126787 [info ] [Thread-2 (]: 4 of 5 OK created sql table model main.fact_bill_generation .................... [[32mOK[0m in 0.27s]
[0m17:31:48.127181 [debug] [Thread-2 (]: Finished running node model.supercell.fact_bill_generation
[0m17:31:48.136033 [debug] [Thread-4 (]: SQL status: OK in 0.259 seconds
[0m17:31:48.137799 [debug] [Thread-4 (]: Using duckdb connection "model.supercell.dim_resource"
[0m17:31:48.138042 [debug] [Thread-4 (]: On model.supercell.dim_resource: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.dim_resource"} */
alter table "supercell"."main"."dim_resource" rename to "dim_resource__dbt_backup"
[0m17:31:48.138630 [debug] [Thread-4 (]: SQL status: OK in 0.000 seconds
[0m17:31:48.140228 [debug] [Thread-4 (]: Using duckdb connection "model.supercell.dim_resource"
[0m17:31:48.140436 [debug] [Thread-4 (]: On model.supercell.dim_resource: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.dim_resource"} */
alter table "supercell"."main"."dim_resource__dbt_tmp" rename to "dim_resource"
[0m17:31:48.140913 [debug] [Thread-4 (]: SQL status: OK in 0.000 seconds
[0m17:31:48.141859 [debug] [Thread-4 (]: On model.supercell.dim_resource: COMMIT
[0m17:31:48.142091 [debug] [Thread-4 (]: Using duckdb connection "model.supercell.dim_resource"
[0m17:31:48.142317 [debug] [Thread-4 (]: On model.supercell.dim_resource: COMMIT
[0m17:31:48.152161 [debug] [Thread-4 (]: SQL status: OK in 0.009 seconds
[0m17:31:48.153734 [debug] [Thread-4 (]: Using duckdb connection "model.supercell.dim_resource"
[0m17:31:48.154003 [debug] [Thread-4 (]: On model.supercell.dim_resource: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.dim_resource"} */
drop table if exists "supercell"."main"."dim_resource__dbt_backup" cascade
[0m17:31:48.155947 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m17:31:48.156877 [debug] [Thread-4 (]: On model.supercell.dim_resource: Close
[0m17:31:48.157751 [info ] [Thread-4 (]: 3 of 5 OK created sql table model main.dim_resource ............................ [[32mOK[0m in 0.31s]
[0m17:31:48.158084 [debug] [Thread-4 (]: Finished running node model.supercell.dim_resource
[0m17:31:48.158958 [debug] [Thread-1 (]: Began running node model.supercell.total_cost
[0m17:31:48.159413 [info ] [Thread-1 (]: 5 of 5 START sql table model main.total_cost ................................... [RUN]
[0m17:31:48.159728 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.supercell.cleaned_usagelogs, now model.supercell.total_cost)
[0m17:31:48.159944 [debug] [Thread-1 (]: Began compiling node model.supercell.total_cost
[0m17:31:48.162429 [debug] [Thread-1 (]: Writing injected SQL for node "model.supercell.total_cost"
[0m17:31:48.163566 [debug] [Thread-1 (]: Began executing node model.supercell.total_cost
[0m17:31:48.167180 [debug] [Thread-1 (]: Writing runtime sql for node "model.supercell.total_cost"
[0m17:31:48.168236 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.total_cost"
[0m17:31:48.168613 [debug] [Thread-1 (]: On model.supercell.total_cost: BEGIN
[0m17:31:48.168846 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:31:48.169453 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:31:48.169702 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.total_cost"
[0m17:31:48.169937 [debug] [Thread-1 (]: On model.supercell.total_cost: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.total_cost"} */

  
    
    

    create  table
      "supercell"."main"."total_cost__dbt_tmp"
  
    as (
      

with base as (
    select
        fact_bill_generation.resource_id,
        date_trunc('month', fact_bill_generation.bill_date) as month,
        fact_bill_generation.bill_amount,
        dim_resource.instance_type,
        dim_resource.product,
        dim_resource.region,
        dim_resource.pricing_model
    from "supercell"."main"."fact_bill_generation" as fact_bill_generation
    left join "supercell"."main"."dim_resource" as dim_resource
        on fact_bill_generation.resource_id = dim_resource.resource_id
    -- filter to recent records to speed up
    where fact_bill_generation.bill_date >= current_date - interval '6 months'
),
joined as (
    select
        base.*,
        dim_accounts.linked_account_id  -- only if needed
    from base
    left join "supercell"."main"."dim_accounts" as dim_accounts
        on dim_resource.linked_account_id = dim_accounts.linked_account_id
)

select
    month,
    sum(bill_amount) as total_cost,
    instance_type,
    product,
    region,
    pricing_model
from joined
group by
    month,
    instance_type,
    product,
    region,
    pricing_model
order by
    month,
    instance_type,
    product,
    region,
    pricing_model
    );
  
  
[0m17:31:48.171606 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.total_cost"} */

  
    
    

    create  table
      "supercell"."main"."total_cost__dbt_tmp"
  
    as (
      

with base as (
    select
        fact_bill_generation.resource_id,
        date_trunc('month', fact_bill_generation.bill_date) as month,
        fact_bill_generation.bill_amount,
        dim_resource.instance_type,
        dim_resource.product,
        dim_resource.region,
        dim_resource.pricing_model
    from "supercell"."main"."fact_bill_generation" as fact_bill_generation
    left join "supercell"."main"."dim_resource" as dim_resource
        on fact_bill_generation.resource_id = dim_resource.resource_id
    -- filter to recent records to speed up
    where fact_bill_generation.bill_date >= current_date - interval '6 months'
),
joined as (
    select
        base.*,
        dim_accounts.linked_account_id  -- only if needed
    from base
    left join "supercell"."main"."dim_accounts" as dim_accounts
        on dim_resource.linked_account_id = dim_accounts.linked_account_id
)

select
    month,
    sum(bill_amount) as total_cost,
    instance_type,
    product,
    region,
    pricing_model
from joined
group by
    month,
    instance_type,
    product,
    region,
    pricing_model
order by
    month,
    instance_type,
    product,
    region,
    pricing_model
    );
  
  
[0m17:31:48.171944 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m17:31:48.172294 [debug] [Thread-1 (]: On model.supercell.total_cost: ROLLBACK
[0m17:31:48.174491 [debug] [Thread-1 (]: Failed to rollback 'model.supercell.total_cost'
[0m17:31:48.174811 [debug] [Thread-1 (]: On model.supercell.total_cost: Close
[0m17:31:48.176300 [debug] [Thread-1 (]: Runtime Error in model total_cost (models/supercell_models/metrics/total_cost.sql)
  Binder Error: Referenced table "dim_resource" not found!
  Candidate tables: "dim_accounts"
  
  LINE 34:         on dim_resource.linked_account_id = dim_accounts.linked_accoun...
                      ^
[0m17:31:48.176784 [error] [Thread-1 (]: 5 of 5 ERROR creating sql table model main.total_cost .......................... [[31mERROR[0m in 0.02s]
[0m17:31:48.177151 [debug] [Thread-1 (]: Finished running node model.supercell.total_cost
[0m17:31:48.177560 [debug] [Thread-7 (]: Marking all children of 'model.supercell.total_cost' to be skipped because of status 'error'.  Reason: Runtime Error in model total_cost (models/supercell_models/metrics/total_cost.sql)
  Binder Error: Referenced table "dim_resource" not found!
  Candidate tables: "dim_accounts"
  
  LINE 34:         on dim_resource.linked_account_id = dim_accounts.linked_accoun...
                      ^.
[0m17:31:48.179046 [debug] [MainThread]: Using duckdb connection "master"
[0m17:31:48.179291 [debug] [MainThread]: On master: BEGIN
[0m17:31:48.179469 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:31:48.179934 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:31:48.180139 [debug] [MainThread]: On master: COMMIT
[0m17:31:48.180317 [debug] [MainThread]: Using duckdb connection "master"
[0m17:31:48.180481 [debug] [MainThread]: On master: COMMIT
[0m17:31:48.180950 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:31:48.181270 [debug] [MainThread]: On master: Close
[0m17:31:48.181592 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:31:48.181756 [debug] [MainThread]: Connection 'model.supercell.total_cost' was properly closed.
[0m17:31:48.181885 [debug] [MainThread]: Connection 'model.supercell.dim_accounts' was properly closed.
[0m17:31:48.182008 [debug] [MainThread]: Connection 'model.supercell.dim_resource' was properly closed.
[0m17:31:48.182129 [debug] [MainThread]: Connection 'model.supercell.fact_bill_generation' was properly closed.
[0m17:31:48.182400 [info ] [MainThread]: 
[0m17:31:48.182591 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 0.77 seconds (0.77s).
[0m17:31:48.183182 [debug] [MainThread]: Command end result
[0m17:31:48.193416 [debug] [MainThread]: Wrote artifact WritableManifest to /home/harsha/data_actions/supercell_cloudops/target/manifest.json
[0m17:31:48.194465 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/harsha/data_actions/supercell_cloudops/target/semantic_manifest.json
[0m17:31:48.197901 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/harsha/data_actions/supercell_cloudops/target/run_results.json
[0m17:31:48.198131 [info ] [MainThread]: 
[0m17:31:48.198377 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m17:31:48.198550 [info ] [MainThread]: 
[0m17:31:48.198746 [error] [MainThread]:   Runtime Error in model total_cost (models/supercell_models/metrics/total_cost.sql)
  Binder Error: Referenced table "dim_resource" not found!
  Candidate tables: "dim_accounts"
  
  LINE 34:         on dim_resource.linked_account_id = dim_accounts.linked_accoun...
                      ^
[0m17:31:48.198912 [info ] [MainThread]: 
[0m17:31:48.199082 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
[0m17:31:48.199634 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.2464887, "process_in_blocks": "208", "process_kernel_time": 0.372104, "process_mem_max_rss": "360084", "process_out_blocks": "59208", "process_user_time": 4.15517}
[0m17:31:48.199916 [debug] [MainThread]: Command `dbt run` failed at 17:31:48.199859 after 1.25 seconds
[0m17:31:48.200114 [debug] [MainThread]: Flushing usage events


============================== 17:32:53.522421 | efa8980c-a646-441c-99ed-737b7fbadbb9 ==============================
[0m17:32:53.522421 [info ] [MainThread]: Running with dbt=1.9.4
[0m17:32:53.525479 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/harsha/data_actions/supercell_cloudops', 'debug': 'False', 'version_check': 'True', 'log_path': '/home/harsha/data_actions/supercell_cloudops/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'False'}
[0m17:32:53.525903 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality

User config should be moved from the 'config' key in profiles.yml to the 'flags' key in dbt_project.yml.
[0m17:32:53.683897 [info ] [MainThread]: Registered adapter: duckdb=1.9.3
[0m17:32:53.722309 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m17:32:53.762454 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:32:53.762877 [debug] [MainThread]: Partial parsing: updated file: supercell://models/supercell_models/metrics/total_cost.sql
[0m17:32:53.898342 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.supercell.example
[0m17:32:53.930194 [debug] [MainThread]: Wrote artifact WritableManifest to /home/harsha/data_actions/supercell_cloudops/target/manifest.json
[0m17:32:53.931185 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/harsha/data_actions/supercell_cloudops/target/semantic_manifest.json
[0m17:32:53.938308 [info ] [MainThread]: Found 5 models, 428 macros
[0m17:32:53.939476 [info ] [MainThread]: 
[0m17:32:53.939790 [info ] [MainThread]: Concurrency: 4 threads (target='default')
[0m17:32:53.939961 [info ] [MainThread]: 
[0m17:32:53.940284 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m17:32:53.943687 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_supercell'
[0m17:32:53.964763 [debug] [ThreadPool]: Using duckdb connection "list_supercell"
[0m17:32:53.965070 [debug] [ThreadPool]: On list_supercell: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "connection_name": "list_supercell"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"supercell"'
    
  
  
[0m17:32:53.965285 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:32:53.973251 [debug] [ThreadPool]: SQL status: OK in 0.008 seconds
[0m17:32:53.974209 [debug] [ThreadPool]: On list_supercell: Close
[0m17:32:53.974864 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_supercell, now create_supercell_main)
[0m17:32:53.975181 [debug] [ThreadPool]: Creating schema "database: "supercell"
schema: "main"
"
[0m17:32:53.979075 [debug] [ThreadPool]: Using duckdb connection "create_supercell_main"
[0m17:32:53.979296 [debug] [ThreadPool]: On create_supercell_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "connection_name": "create_supercell_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='supercell'
        and type='sqlite'
    
  
[0m17:32:53.979459 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:32:53.980043 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m17:32:53.980764 [debug] [ThreadPool]: Using duckdb connection "create_supercell_main"
[0m17:32:53.980940 [debug] [ThreadPool]: On create_supercell_main: BEGIN
[0m17:32:53.981223 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:32:53.981418 [debug] [ThreadPool]: Using duckdb connection "create_supercell_main"
[0m17:32:53.981558 [debug] [ThreadPool]: On create_supercell_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "connection_name": "create_supercell_main"} */

    
    
        create schema if not exists "supercell"."main"
    
[0m17:32:53.981812 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:32:53.982300 [debug] [ThreadPool]: On create_supercell_main: COMMIT
[0m17:32:53.982520 [debug] [ThreadPool]: Using duckdb connection "create_supercell_main"
[0m17:32:53.982702 [debug] [ThreadPool]: On create_supercell_main: COMMIT
[0m17:32:53.982973 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:32:53.983159 [debug] [ThreadPool]: On create_supercell_main: Close
[0m17:32:53.984488 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_supercell_main, now list_supercell_main)
[0m17:32:53.988851 [debug] [ThreadPool]: Using duckdb connection "list_supercell_main"
[0m17:32:53.989094 [debug] [ThreadPool]: On list_supercell_main: BEGIN
[0m17:32:53.989279 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:32:53.989775 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:32:53.989983 [debug] [ThreadPool]: Using duckdb connection "list_supercell_main"
[0m17:32:53.990184 [debug] [ThreadPool]: On list_supercell_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "connection_name": "list_supercell_main"} */
select
      'supercell' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'supercell'
  
[0m17:32:53.998166 [debug] [ThreadPool]: SQL status: OK in 0.008 seconds
[0m17:32:53.999005 [debug] [ThreadPool]: On list_supercell_main: ROLLBACK
[0m17:32:53.999646 [debug] [ThreadPool]: Failed to rollback 'list_supercell_main'
[0m17:32:53.999859 [debug] [ThreadPool]: On list_supercell_main: Close
[0m17:32:54.001182 [debug] [MainThread]: Using duckdb connection "master"
[0m17:32:54.001426 [debug] [MainThread]: On master: BEGIN
[0m17:32:54.001603 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:32:54.002079 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:32:54.002303 [debug] [MainThread]: On master: COMMIT
[0m17:32:54.002470 [debug] [MainThread]: Using duckdb connection "master"
[0m17:32:54.002619 [debug] [MainThread]: On master: COMMIT
[0m17:32:54.002869 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:32:54.003062 [debug] [MainThread]: On master: Close
[0m17:32:54.004968 [debug] [Thread-1 (]: Began running node model.supercell.cleaned_usagelogs
[0m17:32:54.005510 [info ] [Thread-1 (]: 1 of 5 START sql table model main.cleaned_usagelogs ............................ [RUN]
[0m17:32:54.005969 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_supercell_main, now model.supercell.cleaned_usagelogs)
[0m17:32:54.006357 [debug] [Thread-1 (]: Began compiling node model.supercell.cleaned_usagelogs
[0m17:32:54.014166 [debug] [Thread-1 (]: Writing injected SQL for node "model.supercell.cleaned_usagelogs"
[0m17:32:54.014674 [debug] [Thread-1 (]: Began executing node model.supercell.cleaned_usagelogs
[0m17:32:54.033566 [debug] [Thread-1 (]: Writing runtime sql for node "model.supercell.cleaned_usagelogs"
[0m17:32:54.034095 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.cleaned_usagelogs"
[0m17:32:54.034390 [debug] [Thread-1 (]: On model.supercell.cleaned_usagelogs: BEGIN
[0m17:32:54.034593 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:32:54.035207 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:32:54.035418 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.cleaned_usagelogs"
[0m17:32:54.035603 [debug] [Thread-1 (]: On model.supercell.cleaned_usagelogs: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.cleaned_usagelogs"} */

  
    
    

    create  table
      "supercell"."main"."cleaned_usagelogs__dbt_tmp"
  
    as (
      


SELECT
    CAST("LinkedAccountId" AS VARCHAR) AS linked_account_id,
    CAST("bill/PayerAccountId" AS VARCHAR) AS payer_account_id,
    CAST("lineItem/UsageStartDate" AS TIMESTAMP) AS usage_start_date,
    CAST("lineItem/UsageEndDate" AS TIMESTAMP) AS usage_end_date,
    CAST("lineItem/UsageAmount" AS DECIMAL(18, 6)) AS usage_amount,
    CAST("lineItem/Operation" AS VARCHAR) AS operation,
    CAST("pricing/PricingModel" AS VARCHAR) AS pricing_model,
    CAST("resourceTags/TagKeys" AS VARCHAR) AS tag_keys,
    CAST("resourceTags/TagValues" AS VARCHAR) AS tag_values,
    CAST("product/Region" AS VARCHAR) AS region,
    CAST("product/ServiceCode" AS VARCHAR) AS service_code,
    CAST("product/InstanceType" AS VARCHAR) AS instance_type,
    CAST("amortized_cost" AS DECIMAL(18, 6)) AS amortized_cost,
    CAST("product/Description" AS VARCHAR) AS description
FROM supercell_usagelogs
    );
  
  
[0m17:32:54.311367 [debug] [Thread-1 (]: SQL status: OK in 0.275 seconds
[0m17:32:54.315205 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.cleaned_usagelogs"
[0m17:32:54.315474 [debug] [Thread-1 (]: On model.supercell.cleaned_usagelogs: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.cleaned_usagelogs"} */
alter table "supercell"."main"."cleaned_usagelogs" rename to "cleaned_usagelogs__dbt_backup"
[0m17:32:54.315992 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:32:54.317565 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.cleaned_usagelogs"
[0m17:32:54.317800 [debug] [Thread-1 (]: On model.supercell.cleaned_usagelogs: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.cleaned_usagelogs"} */
alter table "supercell"."main"."cleaned_usagelogs__dbt_tmp" rename to "cleaned_usagelogs"
[0m17:32:54.318288 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:32:54.327769 [debug] [Thread-1 (]: On model.supercell.cleaned_usagelogs: COMMIT
[0m17:32:54.328047 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.cleaned_usagelogs"
[0m17:32:54.328251 [debug] [Thread-1 (]: On model.supercell.cleaned_usagelogs: COMMIT
[0m17:32:54.355698 [debug] [Thread-1 (]: SQL status: OK in 0.027 seconds
[0m17:32:54.358778 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.cleaned_usagelogs"
[0m17:32:54.359040 [debug] [Thread-1 (]: On model.supercell.cleaned_usagelogs: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.cleaned_usagelogs"} */
drop table if exists "supercell"."main"."cleaned_usagelogs__dbt_backup" cascade
[0m17:32:54.361080 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m17:32:54.362549 [debug] [Thread-1 (]: On model.supercell.cleaned_usagelogs: Close
[0m17:32:54.367847 [info ] [Thread-1 (]: 1 of 5 OK created sql table model main.cleaned_usagelogs ....................... [[32mOK[0m in 0.36s]
[0m17:32:54.368331 [debug] [Thread-1 (]: Finished running node model.supercell.cleaned_usagelogs
[0m17:32:54.369242 [debug] [Thread-3 (]: Began running node model.supercell.dim_accounts
[0m17:32:54.369942 [info ] [Thread-3 (]: 2 of 5 START sql table model main.dim_accounts ................................. [RUN]
[0m17:32:54.370549 [debug] [Thread-4 (]: Began running node model.supercell.dim_resource
[0m17:32:54.371145 [debug] [Thread-3 (]: Acquiring new duckdb connection 'model.supercell.dim_accounts'
[0m17:32:54.371633 [debug] [Thread-2 (]: Began running node model.supercell.fact_bill_generation
[0m17:32:54.372480 [info ] [Thread-4 (]: 3 of 5 START sql table model main.dim_resource ................................. [RUN]
[0m17:32:54.373206 [debug] [Thread-3 (]: Began compiling node model.supercell.dim_accounts
[0m17:32:54.373844 [info ] [Thread-2 (]: 4 of 5 START sql table model main.fact_bill_generation ......................... [RUN]
[0m17:32:54.374713 [debug] [Thread-4 (]: Acquiring new duckdb connection 'model.supercell.dim_resource'
[0m17:32:54.380523 [debug] [Thread-3 (]: Writing injected SQL for node "model.supercell.dim_accounts"
[0m17:32:54.381441 [debug] [Thread-2 (]: Acquiring new duckdb connection 'model.supercell.fact_bill_generation'
[0m17:32:54.382092 [debug] [Thread-4 (]: Began compiling node model.supercell.dim_resource
[0m17:32:54.383018 [debug] [Thread-2 (]: Began compiling node model.supercell.fact_bill_generation
[0m17:32:54.386064 [debug] [Thread-4 (]: Writing injected SQL for node "model.supercell.dim_resource"
[0m17:32:54.386528 [debug] [Thread-3 (]: Began executing node model.supercell.dim_accounts
[0m17:32:54.388948 [debug] [Thread-2 (]: Writing injected SQL for node "model.supercell.fact_bill_generation"
[0m17:32:54.391490 [debug] [Thread-3 (]: Writing runtime sql for node "model.supercell.dim_accounts"
[0m17:32:54.391911 [debug] [Thread-4 (]: Began executing node model.supercell.dim_resource
[0m17:32:54.392211 [debug] [Thread-2 (]: Began executing node model.supercell.fact_bill_generation
[0m17:32:54.392834 [debug] [Thread-3 (]: Using duckdb connection "model.supercell.dim_accounts"
[0m17:32:54.394866 [debug] [Thread-4 (]: Writing runtime sql for node "model.supercell.dim_resource"
[0m17:32:54.396667 [debug] [Thread-2 (]: Writing runtime sql for node "model.supercell.fact_bill_generation"
[0m17:32:54.397164 [debug] [Thread-3 (]: On model.supercell.dim_accounts: BEGIN
[0m17:32:54.397765 [debug] [Thread-4 (]: Using duckdb connection "model.supercell.dim_resource"
[0m17:32:54.398207 [debug] [Thread-2 (]: Using duckdb connection "model.supercell.fact_bill_generation"
[0m17:32:54.398601 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m17:32:54.399043 [debug] [Thread-4 (]: On model.supercell.dim_resource: BEGIN
[0m17:32:54.399367 [debug] [Thread-2 (]: On model.supercell.fact_bill_generation: BEGIN
[0m17:32:54.399894 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m17:32:54.400213 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m17:32:54.400732 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m17:32:54.401454 [debug] [Thread-3 (]: Using duckdb connection "model.supercell.dim_accounts"
[0m17:32:54.402055 [debug] [Thread-3 (]: On model.supercell.dim_accounts: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.dim_accounts"} */

  
    
    

    create  table
      "supercell"."main"."dim_accounts__dbt_tmp"
  
    as (
      


select
    linked_account_id as linked_account_id,
    tag_keys as tag_keys,
    tag_values as tag_values
from "supercell"."main"."cleaned_usagelogs"
    );
  
  
[0m17:32:54.402541 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m17:32:54.402984 [debug] [Thread-4 (]: SQL status: OK in 0.003 seconds
[0m17:32:54.403253 [debug] [Thread-2 (]: Using duckdb connection "model.supercell.fact_bill_generation"
[0m17:32:54.403629 [debug] [Thread-4 (]: Using duckdb connection "model.supercell.dim_resource"
[0m17:32:54.404177 [debug] [Thread-2 (]: On model.supercell.fact_bill_generation: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.fact_bill_generation"} */

  
    
    

    create  table
      "supercell"."main"."fact_bill_generation__dbt_tmp"
  
    as (
      


select
    md5(concat(linked_account_id, '_', service_code, '_', instance_type, '_', region, '_', CAST(usage_start_date AS VARCHAR), '_', CAST(usage_end_date AS VARCHAR))) AS resource_id,
    usage_start_date as start_date,
    usage_end_date as bill_date,
    usage_amount as bill_amount,
    operation
from "supercell"."main"."cleaned_usagelogs"
    );
  
  
[0m17:32:54.405037 [debug] [Thread-4 (]: On model.supercell.dim_resource: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.dim_resource"} */

  
    
    

    create  table
      "supercell"."main"."dim_resource__dbt_tmp"
  
    as (
      


select
    md5(concat(linked_account_id, '_', service_code, '_', instance_type, '_', region, '_', CAST(usage_start_date AS VARCHAR), '_', CAST(usage_end_date AS VARCHAR))) AS resource_id,
    linked_account_id as linked_account_id,
    region,
    service_code as product,
    instance_type as instance_type,
    pricing_model as pricing_model
from "supercell"."main"."cleaned_usagelogs"
    );
  
  
[0m17:32:54.502527 [debug] [Thread-3 (]: SQL status: OK in 0.100 seconds
[0m17:32:54.505879 [debug] [Thread-3 (]: Using duckdb connection "model.supercell.dim_accounts"
[0m17:32:54.506457 [debug] [Thread-3 (]: On model.supercell.dim_accounts: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.dim_accounts"} */
alter table "supercell"."main"."dim_accounts" rename to "dim_accounts__dbt_backup"
[0m17:32:54.507600 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m17:32:54.510797 [debug] [Thread-3 (]: Using duckdb connection "model.supercell.dim_accounts"
[0m17:32:54.511323 [debug] [Thread-3 (]: On model.supercell.dim_accounts: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.dim_accounts"} */
alter table "supercell"."main"."dim_accounts__dbt_tmp" rename to "dim_accounts"
[0m17:32:54.512364 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m17:32:54.514277 [debug] [Thread-3 (]: On model.supercell.dim_accounts: COMMIT
[0m17:32:54.514787 [debug] [Thread-3 (]: Using duckdb connection "model.supercell.dim_accounts"
[0m17:32:54.515175 [debug] [Thread-3 (]: On model.supercell.dim_accounts: COMMIT
[0m17:32:54.536495 [debug] [Thread-3 (]: SQL status: OK in 0.021 seconds
[0m17:32:54.539124 [debug] [Thread-3 (]: Using duckdb connection "model.supercell.dim_accounts"
[0m17:32:54.539621 [debug] [Thread-3 (]: On model.supercell.dim_accounts: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.dim_accounts"} */
drop table if exists "supercell"."main"."dim_accounts__dbt_backup" cascade
[0m17:32:54.544950 [debug] [Thread-3 (]: SQL status: OK in 0.005 seconds
[0m17:32:54.546716 [debug] [Thread-3 (]: On model.supercell.dim_accounts: Close
[0m17:32:54.552195 [info ] [Thread-3 (]: 2 of 5 OK created sql table model main.dim_accounts ............................ [[32mOK[0m in 0.18s]
[0m17:32:54.552971 [debug] [Thread-3 (]: Finished running node model.supercell.dim_accounts
[0m17:32:54.581854 [debug] [Thread-2 (]: SQL status: OK in 0.176 seconds
[0m17:32:54.584117 [debug] [Thread-2 (]: Using duckdb connection "model.supercell.fact_bill_generation"
[0m17:32:54.584547 [debug] [Thread-2 (]: On model.supercell.fact_bill_generation: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.fact_bill_generation"} */
alter table "supercell"."main"."fact_bill_generation" rename to "fact_bill_generation__dbt_backup"
[0m17:32:54.585463 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m17:32:54.587415 [debug] [Thread-2 (]: Using duckdb connection "model.supercell.fact_bill_generation"
[0m17:32:54.587697 [debug] [Thread-2 (]: On model.supercell.fact_bill_generation: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.fact_bill_generation"} */
alter table "supercell"."main"."fact_bill_generation__dbt_tmp" rename to "fact_bill_generation"
[0m17:32:54.588399 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m17:32:54.589697 [debug] [Thread-2 (]: On model.supercell.fact_bill_generation: COMMIT
[0m17:32:54.589970 [debug] [Thread-2 (]: Using duckdb connection "model.supercell.fact_bill_generation"
[0m17:32:54.590193 [debug] [Thread-2 (]: On model.supercell.fact_bill_generation: COMMIT
[0m17:32:54.625624 [debug] [Thread-2 (]: SQL status: OK in 0.035 seconds
[0m17:32:54.628524 [debug] [Thread-2 (]: Using duckdb connection "model.supercell.fact_bill_generation"
[0m17:32:54.628825 [debug] [Thread-2 (]: On model.supercell.fact_bill_generation: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.fact_bill_generation"} */
drop table if exists "supercell"."main"."fact_bill_generation__dbt_backup" cascade
[0m17:32:54.630606 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m17:32:54.631588 [debug] [Thread-2 (]: On model.supercell.fact_bill_generation: Close
[0m17:32:54.635793 [info ] [Thread-2 (]: 4 of 5 OK created sql table model main.fact_bill_generation .................... [[32mOK[0m in 0.25s]
[0m17:32:54.636265 [debug] [Thread-2 (]: Finished running node model.supercell.fact_bill_generation
[0m17:32:54.677352 [debug] [Thread-4 (]: SQL status: OK in 0.271 seconds
[0m17:32:54.679069 [debug] [Thread-4 (]: Using duckdb connection "model.supercell.dim_resource"
[0m17:32:54.679346 [debug] [Thread-4 (]: On model.supercell.dim_resource: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.dim_resource"} */
alter table "supercell"."main"."dim_resource" rename to "dim_resource__dbt_backup"
[0m17:32:54.679925 [debug] [Thread-4 (]: SQL status: OK in 0.000 seconds
[0m17:32:54.681511 [debug] [Thread-4 (]: Using duckdb connection "model.supercell.dim_resource"
[0m17:32:54.681730 [debug] [Thread-4 (]: On model.supercell.dim_resource: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.dim_resource"} */
alter table "supercell"."main"."dim_resource__dbt_tmp" rename to "dim_resource"
[0m17:32:54.682123 [debug] [Thread-4 (]: SQL status: OK in 0.000 seconds
[0m17:32:54.683068 [debug] [Thread-4 (]: On model.supercell.dim_resource: COMMIT
[0m17:32:54.683301 [debug] [Thread-4 (]: Using duckdb connection "model.supercell.dim_resource"
[0m17:32:54.683495 [debug] [Thread-4 (]: On model.supercell.dim_resource: COMMIT
[0m17:32:54.691601 [debug] [Thread-4 (]: SQL status: OK in 0.008 seconds
[0m17:32:54.693111 [debug] [Thread-4 (]: Using duckdb connection "model.supercell.dim_resource"
[0m17:32:54.693390 [debug] [Thread-4 (]: On model.supercell.dim_resource: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.dim_resource"} */
drop table if exists "supercell"."main"."dim_resource__dbt_backup" cascade
[0m17:32:54.696573 [debug] [Thread-4 (]: SQL status: OK in 0.003 seconds
[0m17:32:54.697456 [debug] [Thread-4 (]: On model.supercell.dim_resource: Close
[0m17:32:54.699392 [info ] [Thread-4 (]: 3 of 5 OK created sql table model main.dim_resource ............................ [[32mOK[0m in 0.32s]
[0m17:32:54.699724 [debug] [Thread-4 (]: Finished running node model.supercell.dim_resource
[0m17:32:54.700379 [debug] [Thread-1 (]: Began running node model.supercell.total_cost
[0m17:32:54.700780 [info ] [Thread-1 (]: 5 of 5 START sql table model main.total_cost ................................... [RUN]
[0m17:32:54.701310 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.supercell.cleaned_usagelogs, now model.supercell.total_cost)
[0m17:32:54.701702 [debug] [Thread-1 (]: Began compiling node model.supercell.total_cost
[0m17:32:54.704919 [debug] [Thread-1 (]: Writing injected SQL for node "model.supercell.total_cost"
[0m17:32:54.706516 [debug] [Thread-1 (]: Began executing node model.supercell.total_cost
[0m17:32:54.710994 [debug] [Thread-1 (]: Writing runtime sql for node "model.supercell.total_cost"
[0m17:32:54.712880 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.total_cost"
[0m17:32:54.713384 [debug] [Thread-1 (]: On model.supercell.total_cost: BEGIN
[0m17:32:54.713579 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:32:54.714231 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:32:54.714520 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.total_cost"
[0m17:32:54.714729 [debug] [Thread-1 (]: On model.supercell.total_cost: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.total_cost"} */

  
    
    

    create  table
      "supercell"."main"."total_cost__dbt_tmp"
  
    as (
      

with base as (
    select
        fact_bill_generation.resource_id,
        date_trunc('month', fact_bill_generation.bill_date) as month,
        fact_bill_generation.bill_amount,
        dim_resource.instance_type,
        dim_resource.product,
        dim_resource.region,
        dim_resource.pricing_model
        dim_resource.linked_account_id
    from "supercell"."main"."fact_bill_generation" as fact_bill_generation
    left join "supercell"."main"."dim_resource" as dim_resource
        on fact_bill_generation.resource_id = dim_resource.resource_id
    -- filter to recent records to speed up
    where fact_bill_generation.bill_date >= current_date - interval '6 months'
),
joined as (
    select
        base.*,
        dim_accounts.linked_account_id  -- only if needed
    from base
    left join "supercell"."main"."dim_accounts" as dim_accounts
        on base.linked_account_id = dim_accounts.linked_account_id
)

select
    month,
    sum(bill_amount) as total_cost,
    instance_type,
    product,
    region,
    pricing_model
from joined
group by
    month,
    instance_type,
    product,
    region,
    pricing_model
order by
    month,
    instance_type,
    product,
    region,
    pricing_model
    );
  
  
[0m17:32:54.715219 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.total_cost"} */

  
    
    

    create  table
      "supercell"."main"."total_cost__dbt_tmp"
  
    as (
      

with base as (
    select
        fact_bill_generation.resource_id,
        date_trunc('month', fact_bill_generation.bill_date) as month,
        fact_bill_generation.bill_amount,
        dim_resource.instance_type,
        dim_resource.product,
        dim_resource.region,
        dim_resource.pricing_model
        dim_resource.linked_account_id
    from "supercell"."main"."fact_bill_generation" as fact_bill_generation
    left join "supercell"."main"."dim_resource" as dim_resource
        on fact_bill_generation.resource_id = dim_resource.resource_id
    -- filter to recent records to speed up
    where fact_bill_generation.bill_date >= current_date - interval '6 months'
),
joined as (
    select
        base.*,
        dim_accounts.linked_account_id  -- only if needed
    from base
    left join "supercell"."main"."dim_accounts" as dim_accounts
        on base.linked_account_id = dim_accounts.linked_account_id
)

select
    month,
    sum(bill_amount) as total_cost,
    instance_type,
    product,
    region,
    pricing_model
from joined
group by
    month,
    instance_type,
    product,
    region,
    pricing_model
order by
    month,
    instance_type,
    product,
    region,
    pricing_model
    );
  
  
[0m17:32:54.715467 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m17:32:54.715736 [debug] [Thread-1 (]: On model.supercell.total_cost: ROLLBACK
[0m17:32:54.718354 [debug] [Thread-1 (]: Failed to rollback 'model.supercell.total_cost'
[0m17:32:54.719193 [debug] [Thread-1 (]: On model.supercell.total_cost: Close
[0m17:32:54.720875 [debug] [Thread-1 (]: Runtime Error in model total_cost (models/supercell_models/metrics/total_cost.sql)
  Parser Error: syntax error at or near "."
[0m17:32:54.721346 [error] [Thread-1 (]: 5 of 5 ERROR creating sql table model main.total_cost .......................... [[31mERROR[0m in 0.02s]
[0m17:32:54.721709 [debug] [Thread-1 (]: Finished running node model.supercell.total_cost
[0m17:32:54.722207 [debug] [Thread-7 (]: Marking all children of 'model.supercell.total_cost' to be skipped because of status 'error'.  Reason: Runtime Error in model total_cost (models/supercell_models/metrics/total_cost.sql)
  Parser Error: syntax error at or near ".".
[0m17:32:54.724060 [debug] [MainThread]: Using duckdb connection "master"
[0m17:32:54.724430 [debug] [MainThread]: On master: BEGIN
[0m17:32:54.724726 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:32:54.725383 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m17:32:54.725708 [debug] [MainThread]: On master: COMMIT
[0m17:32:54.725996 [debug] [MainThread]: Using duckdb connection "master"
[0m17:32:54.726334 [debug] [MainThread]: On master: COMMIT
[0m17:32:54.726666 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:32:54.726856 [debug] [MainThread]: On master: Close
[0m17:32:54.727107 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:32:54.727292 [debug] [MainThread]: Connection 'model.supercell.total_cost' was properly closed.
[0m17:32:54.727447 [debug] [MainThread]: Connection 'model.supercell.dim_accounts' was properly closed.
[0m17:32:54.727587 [debug] [MainThread]: Connection 'model.supercell.dim_resource' was properly closed.
[0m17:32:54.727739 [debug] [MainThread]: Connection 'model.supercell.fact_bill_generation' was properly closed.
[0m17:32:54.727962 [info ] [MainThread]: 
[0m17:32:54.728180 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 0.79 seconds (0.79s).
[0m17:32:54.728757 [debug] [MainThread]: Command end result
[0m17:32:54.738918 [debug] [MainThread]: Wrote artifact WritableManifest to /home/harsha/data_actions/supercell_cloudops/target/manifest.json
[0m17:32:54.740044 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/harsha/data_actions/supercell_cloudops/target/semantic_manifest.json
[0m17:32:54.743704 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/harsha/data_actions/supercell_cloudops/target/run_results.json
[0m17:32:54.743928 [info ] [MainThread]: 
[0m17:32:54.744161 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m17:32:54.744351 [info ] [MainThread]: 
[0m17:32:54.744563 [error] [MainThread]:   Runtime Error in model total_cost (models/supercell_models/metrics/total_cost.sql)
  Parser Error: syntax error at or near "."
[0m17:32:54.744741 [info ] [MainThread]: 
[0m17:32:54.744929 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
[0m17:32:54.745483 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.2536982, "process_in_blocks": "0", "process_kernel_time": 0.371982, "process_mem_max_rss": "359216", "process_out_blocks": "59208", "process_user_time": 3.966484}
[0m17:32:54.745770 [debug] [MainThread]: Command `dbt run` failed at 17:32:54.745714 after 1.25 seconds
[0m17:32:54.746035 [debug] [MainThread]: Flushing usage events


============================== 17:33:13.423847 | 44360f61-e4db-4d62-95f0-4d95899b9448 ==============================
[0m17:33:13.423847 [info ] [MainThread]: Running with dbt=1.9.4
[0m17:33:13.426112 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/harsha/data_actions/supercell_cloudops/logs', 'debug': 'False', 'profiles_dir': '/home/harsha/data_actions/supercell_cloudops', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'False'}
[0m17:33:13.426373 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality

User config should be moved from the 'config' key in profiles.yml to the 'flags' key in dbt_project.yml.
[0m17:33:13.587852 [info ] [MainThread]: Registered adapter: duckdb=1.9.3
[0m17:33:13.627699 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m17:33:13.670258 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:33:13.670674 [debug] [MainThread]: Partial parsing: updated file: supercell://models/supercell_models/metrics/total_cost.sql
[0m17:33:13.814428 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.supercell.example
[0m17:33:13.847775 [debug] [MainThread]: Wrote artifact WritableManifest to /home/harsha/data_actions/supercell_cloudops/target/manifest.json
[0m17:33:13.848882 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/harsha/data_actions/supercell_cloudops/target/semantic_manifest.json
[0m17:33:13.855726 [info ] [MainThread]: Found 5 models, 428 macros
[0m17:33:13.856925 [info ] [MainThread]: 
[0m17:33:13.857273 [info ] [MainThread]: Concurrency: 4 threads (target='default')
[0m17:33:13.857464 [info ] [MainThread]: 
[0m17:33:13.857777 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m17:33:13.861705 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_supercell'
[0m17:33:13.884556 [debug] [ThreadPool]: Using duckdb connection "list_supercell"
[0m17:33:13.884863 [debug] [ThreadPool]: On list_supercell: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "connection_name": "list_supercell"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"supercell"'
    
  
  
[0m17:33:13.885059 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:33:13.892636 [debug] [ThreadPool]: SQL status: OK in 0.008 seconds
[0m17:33:13.893499 [debug] [ThreadPool]: On list_supercell: Close
[0m17:33:13.894093 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_supercell, now create_supercell_main)
[0m17:33:13.894410 [debug] [ThreadPool]: Creating schema "database: "supercell"
schema: "main"
"
[0m17:33:13.898544 [debug] [ThreadPool]: Using duckdb connection "create_supercell_main"
[0m17:33:13.898783 [debug] [ThreadPool]: On create_supercell_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "connection_name": "create_supercell_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='supercell'
        and type='sqlite'
    
  
[0m17:33:13.898968 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:33:13.899664 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m17:33:13.900477 [debug] [ThreadPool]: Using duckdb connection "create_supercell_main"
[0m17:33:13.900669 [debug] [ThreadPool]: On create_supercell_main: BEGIN
[0m17:33:13.900975 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:33:13.901162 [debug] [ThreadPool]: Using duckdb connection "create_supercell_main"
[0m17:33:13.901323 [debug] [ThreadPool]: On create_supercell_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "connection_name": "create_supercell_main"} */

    
    
        create schema if not exists "supercell"."main"
    
[0m17:33:13.901623 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:33:13.902141 [debug] [ThreadPool]: On create_supercell_main: COMMIT
[0m17:33:13.902330 [debug] [ThreadPool]: Using duckdb connection "create_supercell_main"
[0m17:33:13.902484 [debug] [ThreadPool]: On create_supercell_main: COMMIT
[0m17:33:13.902743 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:33:13.902948 [debug] [ThreadPool]: On create_supercell_main: Close
[0m17:33:13.904071 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_supercell_main, now list_supercell_main)
[0m17:33:13.909158 [debug] [ThreadPool]: Using duckdb connection "list_supercell_main"
[0m17:33:13.909531 [debug] [ThreadPool]: On list_supercell_main: BEGIN
[0m17:33:13.909819 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:33:13.910523 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m17:33:13.910835 [debug] [ThreadPool]: Using duckdb connection "list_supercell_main"
[0m17:33:13.911129 [debug] [ThreadPool]: On list_supercell_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "connection_name": "list_supercell_main"} */
select
      'supercell' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'supercell'
  
[0m17:33:13.931068 [debug] [ThreadPool]: SQL status: OK in 0.020 seconds
[0m17:33:13.932663 [debug] [ThreadPool]: On list_supercell_main: ROLLBACK
[0m17:33:13.933683 [debug] [ThreadPool]: Failed to rollback 'list_supercell_main'
[0m17:33:13.934018 [debug] [ThreadPool]: On list_supercell_main: Close
[0m17:33:13.935431 [debug] [MainThread]: Using duckdb connection "master"
[0m17:33:13.935651 [debug] [MainThread]: On master: BEGIN
[0m17:33:13.935832 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:33:13.936283 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:33:13.936505 [debug] [MainThread]: On master: COMMIT
[0m17:33:13.936701 [debug] [MainThread]: Using duckdb connection "master"
[0m17:33:13.936877 [debug] [MainThread]: On master: COMMIT
[0m17:33:13.937167 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:33:13.937366 [debug] [MainThread]: On master: Close
[0m17:33:13.939155 [debug] [Thread-1 (]: Began running node model.supercell.cleaned_usagelogs
[0m17:33:13.939692 [info ] [Thread-1 (]: 1 of 5 START sql table model main.cleaned_usagelogs ............................ [RUN]
[0m17:33:13.940159 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_supercell_main, now model.supercell.cleaned_usagelogs)
[0m17:33:13.940472 [debug] [Thread-1 (]: Began compiling node model.supercell.cleaned_usagelogs
[0m17:33:13.946044 [debug] [Thread-1 (]: Writing injected SQL for node "model.supercell.cleaned_usagelogs"
[0m17:33:13.947086 [debug] [Thread-1 (]: Began executing node model.supercell.cleaned_usagelogs
[0m17:33:13.967174 [debug] [Thread-1 (]: Writing runtime sql for node "model.supercell.cleaned_usagelogs"
[0m17:33:13.967714 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.cleaned_usagelogs"
[0m17:33:13.967968 [debug] [Thread-1 (]: On model.supercell.cleaned_usagelogs: BEGIN
[0m17:33:13.968178 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:33:13.968772 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:33:13.968993 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.cleaned_usagelogs"
[0m17:33:13.969205 [debug] [Thread-1 (]: On model.supercell.cleaned_usagelogs: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.cleaned_usagelogs"} */

  
    
    

    create  table
      "supercell"."main"."cleaned_usagelogs__dbt_tmp"
  
    as (
      


SELECT
    CAST("LinkedAccountId" AS VARCHAR) AS linked_account_id,
    CAST("bill/PayerAccountId" AS VARCHAR) AS payer_account_id,
    CAST("lineItem/UsageStartDate" AS TIMESTAMP) AS usage_start_date,
    CAST("lineItem/UsageEndDate" AS TIMESTAMP) AS usage_end_date,
    CAST("lineItem/UsageAmount" AS DECIMAL(18, 6)) AS usage_amount,
    CAST("lineItem/Operation" AS VARCHAR) AS operation,
    CAST("pricing/PricingModel" AS VARCHAR) AS pricing_model,
    CAST("resourceTags/TagKeys" AS VARCHAR) AS tag_keys,
    CAST("resourceTags/TagValues" AS VARCHAR) AS tag_values,
    CAST("product/Region" AS VARCHAR) AS region,
    CAST("product/ServiceCode" AS VARCHAR) AS service_code,
    CAST("product/InstanceType" AS VARCHAR) AS instance_type,
    CAST("amortized_cost" AS DECIMAL(18, 6)) AS amortized_cost,
    CAST("product/Description" AS VARCHAR) AS description
FROM supercell_usagelogs
    );
  
  
[0m17:33:14.236086 [debug] [Thread-1 (]: SQL status: OK in 0.267 seconds
[0m17:33:14.239972 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.cleaned_usagelogs"
[0m17:33:14.240240 [debug] [Thread-1 (]: On model.supercell.cleaned_usagelogs: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.cleaned_usagelogs"} */
alter table "supercell"."main"."cleaned_usagelogs" rename to "cleaned_usagelogs__dbt_backup"
[0m17:33:14.240790 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:33:14.242322 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.cleaned_usagelogs"
[0m17:33:14.242554 [debug] [Thread-1 (]: On model.supercell.cleaned_usagelogs: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.cleaned_usagelogs"} */
alter table "supercell"."main"."cleaned_usagelogs__dbt_tmp" rename to "cleaned_usagelogs"
[0m17:33:14.243005 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:33:14.252404 [debug] [Thread-1 (]: On model.supercell.cleaned_usagelogs: COMMIT
[0m17:33:14.252731 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.cleaned_usagelogs"
[0m17:33:14.252935 [debug] [Thread-1 (]: On model.supercell.cleaned_usagelogs: COMMIT
[0m17:33:14.275929 [debug] [Thread-1 (]: SQL status: OK in 0.023 seconds
[0m17:33:14.279030 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.cleaned_usagelogs"
[0m17:33:14.279337 [debug] [Thread-1 (]: On model.supercell.cleaned_usagelogs: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.cleaned_usagelogs"} */
drop table if exists "supercell"."main"."cleaned_usagelogs__dbt_backup" cascade
[0m17:33:14.281438 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m17:33:14.282898 [debug] [Thread-1 (]: On model.supercell.cleaned_usagelogs: Close
[0m17:33:14.287857 [info ] [Thread-1 (]: 1 of 5 OK created sql table model main.cleaned_usagelogs ....................... [[32mOK[0m in 0.35s]
[0m17:33:14.288227 [debug] [Thread-1 (]: Finished running node model.supercell.cleaned_usagelogs
[0m17:33:14.289093 [debug] [Thread-3 (]: Began running node model.supercell.dim_accounts
[0m17:33:14.289721 [debug] [Thread-4 (]: Began running node model.supercell.dim_resource
[0m17:33:14.290408 [info ] [Thread-3 (]: 2 of 5 START sql table model main.dim_accounts ................................. [RUN]
[0m17:33:14.291091 [debug] [Thread-2 (]: Began running node model.supercell.fact_bill_generation
[0m17:33:14.291666 [info ] [Thread-4 (]: 3 of 5 START sql table model main.dim_resource ................................. [RUN]
[0m17:33:14.292497 [debug] [Thread-3 (]: Acquiring new duckdb connection 'model.supercell.dim_accounts'
[0m17:33:14.293305 [info ] [Thread-2 (]: 4 of 5 START sql table model main.fact_bill_generation ......................... [RUN]
[0m17:33:14.294106 [debug] [Thread-4 (]: Acquiring new duckdb connection 'model.supercell.dim_resource'
[0m17:33:14.294937 [debug] [Thread-3 (]: Began compiling node model.supercell.dim_accounts
[0m17:33:14.295758 [debug] [Thread-2 (]: Acquiring new duckdb connection 'model.supercell.fact_bill_generation'
[0m17:33:14.296573 [debug] [Thread-4 (]: Began compiling node model.supercell.dim_resource
[0m17:33:14.300580 [debug] [Thread-3 (]: Writing injected SQL for node "model.supercell.dim_accounts"
[0m17:33:14.301081 [debug] [Thread-2 (]: Began compiling node model.supercell.fact_bill_generation
[0m17:33:14.303694 [debug] [Thread-4 (]: Writing injected SQL for node "model.supercell.dim_resource"
[0m17:33:14.304335 [debug] [Thread-3 (]: Began executing node model.supercell.dim_accounts
[0m17:33:14.306656 [debug] [Thread-2 (]: Writing injected SQL for node "model.supercell.fact_bill_generation"
[0m17:33:14.308614 [debug] [Thread-3 (]: Writing runtime sql for node "model.supercell.dim_accounts"
[0m17:33:14.309133 [debug] [Thread-4 (]: Began executing node model.supercell.dim_resource
[0m17:33:14.309828 [debug] [Thread-2 (]: Began executing node model.supercell.fact_bill_generation
[0m17:33:14.313057 [debug] [Thread-4 (]: Writing runtime sql for node "model.supercell.dim_resource"
[0m17:33:14.313898 [debug] [Thread-3 (]: Using duckdb connection "model.supercell.dim_accounts"
[0m17:33:14.316547 [debug] [Thread-2 (]: Writing runtime sql for node "model.supercell.fact_bill_generation"
[0m17:33:14.317286 [debug] [Thread-3 (]: On model.supercell.dim_accounts: BEGIN
[0m17:33:14.317681 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m17:33:14.318008 [debug] [Thread-4 (]: Using duckdb connection "model.supercell.dim_resource"
[0m17:33:14.318636 [debug] [Thread-2 (]: Using duckdb connection "model.supercell.fact_bill_generation"
[0m17:33:14.318880 [debug] [Thread-4 (]: On model.supercell.dim_resource: BEGIN
[0m17:33:14.319172 [debug] [Thread-2 (]: On model.supercell.fact_bill_generation: BEGIN
[0m17:33:14.319456 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m17:33:14.319745 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m17:33:14.319983 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m17:33:14.320369 [debug] [Thread-3 (]: Using duckdb connection "model.supercell.dim_accounts"
[0m17:33:14.320734 [debug] [Thread-3 (]: On model.supercell.dim_accounts: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.dim_accounts"} */

  
    
    

    create  table
      "supercell"."main"."dim_accounts__dbt_tmp"
  
    as (
      


select
    linked_account_id as linked_account_id,
    tag_keys as tag_keys,
    tag_values as tag_values
from "supercell"."main"."cleaned_usagelogs"
    );
  
  
[0m17:33:14.320982 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m17:33:14.321237 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m17:33:14.321528 [debug] [Thread-4 (]: Using duckdb connection "model.supercell.dim_resource"
[0m17:33:14.321794 [debug] [Thread-2 (]: Using duckdb connection "model.supercell.fact_bill_generation"
[0m17:33:14.322183 [debug] [Thread-4 (]: On model.supercell.dim_resource: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.dim_resource"} */

  
    
    

    create  table
      "supercell"."main"."dim_resource__dbt_tmp"
  
    as (
      


select
    md5(concat(linked_account_id, '_', service_code, '_', instance_type, '_', region, '_', CAST(usage_start_date AS VARCHAR), '_', CAST(usage_end_date AS VARCHAR))) AS resource_id,
    linked_account_id as linked_account_id,
    region,
    service_code as product,
    instance_type as instance_type,
    pricing_model as pricing_model
from "supercell"."main"."cleaned_usagelogs"
    );
  
  
[0m17:33:14.322482 [debug] [Thread-2 (]: On model.supercell.fact_bill_generation: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.fact_bill_generation"} */

  
    
    

    create  table
      "supercell"."main"."fact_bill_generation__dbt_tmp"
  
    as (
      


select
    md5(concat(linked_account_id, '_', service_code, '_', instance_type, '_', region, '_', CAST(usage_start_date AS VARCHAR), '_', CAST(usage_end_date AS VARCHAR))) AS resource_id,
    usage_start_date as start_date,
    usage_end_date as bill_date,
    usage_amount as bill_amount,
    operation
from "supercell"."main"."cleaned_usagelogs"
    );
  
  
[0m17:33:14.422516 [debug] [Thread-3 (]: SQL status: OK in 0.101 seconds
[0m17:33:14.426196 [debug] [Thread-3 (]: Using duckdb connection "model.supercell.dim_accounts"
[0m17:33:14.426829 [debug] [Thread-3 (]: On model.supercell.dim_accounts: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.dim_accounts"} */
alter table "supercell"."main"."dim_accounts" rename to "dim_accounts__dbt_backup"
[0m17:33:14.427894 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m17:33:14.431719 [debug] [Thread-3 (]: Using duckdb connection "model.supercell.dim_accounts"
[0m17:33:14.432520 [debug] [Thread-3 (]: On model.supercell.dim_accounts: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.dim_accounts"} */
alter table "supercell"."main"."dim_accounts__dbt_tmp" rename to "dim_accounts"
[0m17:33:14.433651 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m17:33:14.435900 [debug] [Thread-3 (]: On model.supercell.dim_accounts: COMMIT
[0m17:33:14.436478 [debug] [Thread-3 (]: Using duckdb connection "model.supercell.dim_accounts"
[0m17:33:14.436958 [debug] [Thread-3 (]: On model.supercell.dim_accounts: COMMIT
[0m17:33:14.454984 [debug] [Thread-3 (]: SQL status: OK in 0.017 seconds
[0m17:33:14.457915 [debug] [Thread-3 (]: Using duckdb connection "model.supercell.dim_accounts"
[0m17:33:14.458539 [debug] [Thread-3 (]: On model.supercell.dim_accounts: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.dim_accounts"} */
drop table if exists "supercell"."main"."dim_accounts__dbt_backup" cascade
[0m17:33:14.461203 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m17:33:14.463824 [debug] [Thread-3 (]: On model.supercell.dim_accounts: Close
[0m17:33:14.469190 [info ] [Thread-3 (]: 2 of 5 OK created sql table model main.dim_accounts ............................ [[32mOK[0m in 0.18s]
[0m17:33:14.470021 [debug] [Thread-3 (]: Finished running node model.supercell.dim_accounts
[0m17:33:14.520219 [debug] [Thread-2 (]: SQL status: OK in 0.197 seconds
[0m17:33:14.522892 [debug] [Thread-2 (]: Using duckdb connection "model.supercell.fact_bill_generation"
[0m17:33:14.523323 [debug] [Thread-2 (]: On model.supercell.fact_bill_generation: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.fact_bill_generation"} */
alter table "supercell"."main"."fact_bill_generation" rename to "fact_bill_generation__dbt_backup"
[0m17:33:14.524129 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m17:33:14.526467 [debug] [Thread-2 (]: Using duckdb connection "model.supercell.fact_bill_generation"
[0m17:33:14.526839 [debug] [Thread-2 (]: On model.supercell.fact_bill_generation: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.fact_bill_generation"} */
alter table "supercell"."main"."fact_bill_generation__dbt_tmp" rename to "fact_bill_generation"
[0m17:33:14.527547 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m17:33:14.529284 [debug] [Thread-2 (]: On model.supercell.fact_bill_generation: COMMIT
[0m17:33:14.529710 [debug] [Thread-2 (]: Using duckdb connection "model.supercell.fact_bill_generation"
[0m17:33:14.530043 [debug] [Thread-2 (]: On model.supercell.fact_bill_generation: COMMIT
[0m17:33:14.573323 [debug] [Thread-4 (]: SQL status: OK in 0.250 seconds
[0m17:33:14.576038 [debug] [Thread-4 (]: Using duckdb connection "model.supercell.dim_resource"
[0m17:33:14.576344 [debug] [Thread-4 (]: On model.supercell.dim_resource: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.dim_resource"} */
alter table "supercell"."main"."dim_resource" rename to "dim_resource__dbt_backup"
[0m17:33:14.576793 [debug] [Thread-2 (]: SQL status: OK in 0.046 seconds
[0m17:33:14.578347 [debug] [Thread-2 (]: Using duckdb connection "model.supercell.fact_bill_generation"
[0m17:33:14.578595 [debug] [Thread-2 (]: On model.supercell.fact_bill_generation: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.fact_bill_generation"} */
drop table if exists "supercell"."main"."fact_bill_generation__dbt_backup" cascade
[0m17:33:14.578908 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m17:33:14.580569 [debug] [Thread-4 (]: Using duckdb connection "model.supercell.dim_resource"
[0m17:33:14.580840 [debug] [Thread-4 (]: On model.supercell.dim_resource: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.dim_resource"} */
alter table "supercell"."main"."dim_resource__dbt_tmp" rename to "dim_resource"
[0m17:33:14.581513 [debug] [Thread-4 (]: SQL status: OK in 0.000 seconds
[0m17:33:14.582561 [debug] [Thread-4 (]: On model.supercell.dim_resource: COMMIT
[0m17:33:14.582797 [debug] [Thread-4 (]: Using duckdb connection "model.supercell.dim_resource"
[0m17:33:14.582970 [debug] [Thread-4 (]: On model.supercell.dim_resource: COMMIT
[0m17:33:14.583306 [debug] [Thread-2 (]: SQL status: OK in 0.004 seconds
[0m17:33:14.584576 [debug] [Thread-2 (]: On model.supercell.fact_bill_generation: Close
[0m17:33:14.590522 [info ] [Thread-2 (]: 4 of 5 OK created sql table model main.fact_bill_generation .................... [[32mOK[0m in 0.29s]
[0m17:33:14.590956 [debug] [Thread-2 (]: Finished running node model.supercell.fact_bill_generation
[0m17:33:14.591676 [debug] [Thread-4 (]: SQL status: OK in 0.008 seconds
[0m17:33:14.593391 [debug] [Thread-4 (]: Using duckdb connection "model.supercell.dim_resource"
[0m17:33:14.593659 [debug] [Thread-4 (]: On model.supercell.dim_resource: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.dim_resource"} */
drop table if exists "supercell"."main"."dim_resource__dbt_backup" cascade
[0m17:33:14.596106 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m17:33:14.598766 [debug] [Thread-4 (]: On model.supercell.dim_resource: Close
[0m17:33:14.599644 [info ] [Thread-4 (]: 3 of 5 OK created sql table model main.dim_resource ............................ [[32mOK[0m in 0.31s]
[0m17:33:14.600002 [debug] [Thread-4 (]: Finished running node model.supercell.dim_resource
[0m17:33:14.600726 [debug] [Thread-1 (]: Began running node model.supercell.total_cost
[0m17:33:14.601032 [info ] [Thread-1 (]: 5 of 5 START sql table model main.total_cost ................................... [RUN]
[0m17:33:14.601354 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.supercell.cleaned_usagelogs, now model.supercell.total_cost)
[0m17:33:14.601553 [debug] [Thread-1 (]: Began compiling node model.supercell.total_cost
[0m17:33:14.603587 [debug] [Thread-1 (]: Writing injected SQL for node "model.supercell.total_cost"
[0m17:33:14.604031 [debug] [Thread-1 (]: Began executing node model.supercell.total_cost
[0m17:33:14.606587 [debug] [Thread-1 (]: Writing runtime sql for node "model.supercell.total_cost"
[0m17:33:14.607291 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.total_cost"
[0m17:33:14.607671 [debug] [Thread-1 (]: On model.supercell.total_cost: BEGIN
[0m17:33:14.608019 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:33:14.608775 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:33:14.609157 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.total_cost"
[0m17:33:14.609558 [debug] [Thread-1 (]: On model.supercell.total_cost: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.total_cost"} */

  
    
    

    create  table
      "supercell"."main"."total_cost__dbt_tmp"
  
    as (
      

with base as (
    select
        fact_bill_generation.resource_id,
        date_trunc('month', fact_bill_generation.bill_date) as month,
        fact_bill_generation.bill_amount,
        dim_resource.instance_type,
        dim_resource.product,
        dim_resource.region,
        dim_resource.pricing_model,
        dim_resource.linked_account_id
    from "supercell"."main"."fact_bill_generation" as fact_bill_generation
    left join "supercell"."main"."dim_resource" as dim_resource
        on fact_bill_generation.resource_id = dim_resource.resource_id
    -- filter to recent records to speed up
    where fact_bill_generation.bill_date >= current_date - interval '6 months'
),
joined as (
    select
        base.*,
        dim_accounts.linked_account_id  -- only if needed
    from base
    left join "supercell"."main"."dim_accounts" as dim_accounts
        on base.linked_account_id = dim_accounts.linked_account_id
)

select
    month,
    sum(bill_amount) as total_cost,
    instance_type,
    product,
    region,
    pricing_model
from joined
group by
    month,
    instance_type,
    product,
    region,
    pricing_model
order by
    month,
    instance_type,
    product,
    region,
    pricing_model
    );
  
  
[0m17:33:14.636873 [debug] [Thread-1 (]: SQL status: OK in 0.027 seconds
[0m17:33:14.638701 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.total_cost"
[0m17:33:14.638973 [debug] [Thread-1 (]: On model.supercell.total_cost: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.total_cost"} */
alter table "supercell"."main"."total_cost" rename to "total_cost__dbt_backup"
[0m17:33:14.639483 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:33:14.640914 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.total_cost"
[0m17:33:14.641170 [debug] [Thread-1 (]: On model.supercell.total_cost: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.total_cost"} */
alter table "supercell"."main"."total_cost__dbt_tmp" rename to "total_cost"
[0m17:33:14.641588 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:33:14.642597 [debug] [Thread-1 (]: On model.supercell.total_cost: COMMIT
[0m17:33:14.642814 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.total_cost"
[0m17:33:14.643007 [debug] [Thread-1 (]: On model.supercell.total_cost: COMMIT
[0m17:33:14.647013 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m17:33:14.648589 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.total_cost"
[0m17:33:14.648838 [debug] [Thread-1 (]: On model.supercell.total_cost: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.total_cost"} */
drop table if exists "supercell"."main"."total_cost__dbt_backup" cascade
[0m17:33:14.650567 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:33:14.651448 [debug] [Thread-1 (]: On model.supercell.total_cost: Close
[0m17:33:14.653257 [info ] [Thread-1 (]: 5 of 5 OK created sql table model main.total_cost .............................. [[32mOK[0m in 0.05s]
[0m17:33:14.653610 [debug] [Thread-1 (]: Finished running node model.supercell.total_cost
[0m17:33:14.654656 [debug] [MainThread]: Using duckdb connection "master"
[0m17:33:14.654955 [debug] [MainThread]: On master: BEGIN
[0m17:33:14.655178 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:33:14.655692 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m17:33:14.655924 [debug] [MainThread]: On master: COMMIT
[0m17:33:14.656126 [debug] [MainThread]: Using duckdb connection "master"
[0m17:33:14.656322 [debug] [MainThread]: On master: COMMIT
[0m17:33:14.656630 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:33:14.656831 [debug] [MainThread]: On master: Close
[0m17:33:14.657289 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:33:14.657514 [debug] [MainThread]: Connection 'model.supercell.total_cost' was properly closed.
[0m17:33:14.657682 [debug] [MainThread]: Connection 'model.supercell.dim_accounts' was properly closed.
[0m17:33:14.657852 [debug] [MainThread]: Connection 'model.supercell.dim_resource' was properly closed.
[0m17:33:14.658010 [debug] [MainThread]: Connection 'model.supercell.fact_bill_generation' was properly closed.
[0m17:33:14.658262 [info ] [MainThread]: 
[0m17:33:14.658475 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 0.80 seconds (0.80s).
[0m17:33:14.659258 [debug] [MainThread]: Command end result
[0m17:33:14.712977 [debug] [MainThread]: Wrote artifact WritableManifest to /home/harsha/data_actions/supercell_cloudops/target/manifest.json
[0m17:33:14.714093 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/harsha/data_actions/supercell_cloudops/target/semantic_manifest.json
[0m17:33:14.717626 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/harsha/data_actions/supercell_cloudops/target/run_results.json
[0m17:33:14.717839 [info ] [MainThread]: 
[0m17:33:14.718058 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:33:14.718256 [info ] [MainThread]: 
[0m17:33:14.718448 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m17:33:14.719058 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.327881, "process_in_blocks": "256", "process_kernel_time": 0.350816, "process_mem_max_rss": "360420", "process_out_blocks": "59736", "process_user_time": 4.218789}
[0m17:33:14.719422 [debug] [MainThread]: Command `dbt run` succeeded at 17:33:14.719355 after 1.33 seconds
[0m17:33:14.719640 [debug] [MainThread]: Flushing usage events


============================== 17:33:48.732770 | 2d2d37d8-a369-441a-a717-0a71c9d01575 ==============================
[0m17:33:48.732770 [info ] [MainThread]: Running with dbt=1.9.4
[0m17:33:48.735127 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/harsha/data_actions/supercell_cloudops/logs', 'debug': 'False', 'profiles_dir': '/home/harsha/data_actions/supercell_cloudops', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'False'}
[0m17:33:48.735355 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality

User config should be moved from the 'config' key in profiles.yml to the 'flags' key in dbt_project.yml.
[0m17:33:48.900057 [info ] [MainThread]: Registered adapter: duckdb=1.9.3
[0m17:33:48.937947 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m17:33:48.977206 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:33:48.977602 [debug] [MainThread]: Partial parsing: updated file: supercell://models/supercell_models/metrics/total_cost.sql
[0m17:33:49.111749 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.supercell.example
[0m17:33:49.143725 [debug] [MainThread]: Wrote artifact WritableManifest to /home/harsha/data_actions/supercell_cloudops/target/manifest.json
[0m17:33:49.144741 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/harsha/data_actions/supercell_cloudops/target/semantic_manifest.json
[0m17:33:49.151643 [info ] [MainThread]: Found 5 models, 428 macros
[0m17:33:49.152774 [info ] [MainThread]: 
[0m17:33:49.153078 [info ] [MainThread]: Concurrency: 4 threads (target='default')
[0m17:33:49.153282 [info ] [MainThread]: 
[0m17:33:49.153578 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m17:33:49.157131 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_supercell'
[0m17:33:49.179891 [debug] [ThreadPool]: Using duckdb connection "list_supercell"
[0m17:33:49.180188 [debug] [ThreadPool]: On list_supercell: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "connection_name": "list_supercell"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"supercell"'
    
  
  
[0m17:33:49.180364 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:33:49.188329 [debug] [ThreadPool]: SQL status: OK in 0.008 seconds
[0m17:33:49.189258 [debug] [ThreadPool]: On list_supercell: Close
[0m17:33:49.189737 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_supercell, now create_supercell_main)
[0m17:33:49.190033 [debug] [ThreadPool]: Creating schema "database: "supercell"
schema: "main"
"
[0m17:33:49.193952 [debug] [ThreadPool]: Using duckdb connection "create_supercell_main"
[0m17:33:49.194183 [debug] [ThreadPool]: On create_supercell_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "connection_name": "create_supercell_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='supercell'
        and type='sqlite'
    
  
[0m17:33:49.194390 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:33:49.195110 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m17:33:49.195895 [debug] [ThreadPool]: Using duckdb connection "create_supercell_main"
[0m17:33:49.196080 [debug] [ThreadPool]: On create_supercell_main: BEGIN
[0m17:33:49.196387 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:33:49.196544 [debug] [ThreadPool]: Using duckdb connection "create_supercell_main"
[0m17:33:49.196682 [debug] [ThreadPool]: On create_supercell_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "connection_name": "create_supercell_main"} */

    
    
        create schema if not exists "supercell"."main"
    
[0m17:33:49.196951 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:33:49.197457 [debug] [ThreadPool]: On create_supercell_main: COMMIT
[0m17:33:49.197632 [debug] [ThreadPool]: Using duckdb connection "create_supercell_main"
[0m17:33:49.197787 [debug] [ThreadPool]: On create_supercell_main: COMMIT
[0m17:33:49.198242 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:33:49.198481 [debug] [ThreadPool]: On create_supercell_main: Close
[0m17:33:49.199513 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_supercell_main, now list_supercell_main)
[0m17:33:49.204684 [debug] [ThreadPool]: Using duckdb connection "list_supercell_main"
[0m17:33:49.205057 [debug] [ThreadPool]: On list_supercell_main: BEGIN
[0m17:33:49.205357 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:33:49.206024 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m17:33:49.206355 [debug] [ThreadPool]: Using duckdb connection "list_supercell_main"
[0m17:33:49.206651 [debug] [ThreadPool]: On list_supercell_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "connection_name": "list_supercell_main"} */
select
      'supercell' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'supercell'
  
[0m17:33:49.225576 [debug] [ThreadPool]: SQL status: OK in 0.019 seconds
[0m17:33:49.227009 [debug] [ThreadPool]: On list_supercell_main: ROLLBACK
[0m17:33:49.227980 [debug] [ThreadPool]: Failed to rollback 'list_supercell_main'
[0m17:33:49.228326 [debug] [ThreadPool]: On list_supercell_main: Close
[0m17:33:49.229739 [debug] [MainThread]: Using duckdb connection "master"
[0m17:33:49.229931 [debug] [MainThread]: On master: BEGIN
[0m17:33:49.230080 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:33:49.230489 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:33:49.230672 [debug] [MainThread]: On master: COMMIT
[0m17:33:49.230831 [debug] [MainThread]: Using duckdb connection "master"
[0m17:33:49.230989 [debug] [MainThread]: On master: COMMIT
[0m17:33:49.231293 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:33:49.231495 [debug] [MainThread]: On master: Close
[0m17:33:49.233400 [debug] [Thread-1 (]: Began running node model.supercell.cleaned_usagelogs
[0m17:33:49.233985 [info ] [Thread-1 (]: 1 of 5 START sql table model main.cleaned_usagelogs ............................ [RUN]
[0m17:33:49.234498 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_supercell_main, now model.supercell.cleaned_usagelogs)
[0m17:33:49.234907 [debug] [Thread-1 (]: Began compiling node model.supercell.cleaned_usagelogs
[0m17:33:49.241772 [debug] [Thread-1 (]: Writing injected SQL for node "model.supercell.cleaned_usagelogs"
[0m17:33:49.242304 [debug] [Thread-1 (]: Began executing node model.supercell.cleaned_usagelogs
[0m17:33:49.260771 [debug] [Thread-1 (]: Writing runtime sql for node "model.supercell.cleaned_usagelogs"
[0m17:33:49.261269 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.cleaned_usagelogs"
[0m17:33:49.261519 [debug] [Thread-1 (]: On model.supercell.cleaned_usagelogs: BEGIN
[0m17:33:49.261692 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:33:49.262246 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:33:49.262476 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.cleaned_usagelogs"
[0m17:33:49.262663 [debug] [Thread-1 (]: On model.supercell.cleaned_usagelogs: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.cleaned_usagelogs"} */

  
    
    

    create  table
      "supercell"."main"."cleaned_usagelogs__dbt_tmp"
  
    as (
      


SELECT
    CAST("LinkedAccountId" AS VARCHAR) AS linked_account_id,
    CAST("bill/PayerAccountId" AS VARCHAR) AS payer_account_id,
    CAST("lineItem/UsageStartDate" AS TIMESTAMP) AS usage_start_date,
    CAST("lineItem/UsageEndDate" AS TIMESTAMP) AS usage_end_date,
    CAST("lineItem/UsageAmount" AS DECIMAL(18, 6)) AS usage_amount,
    CAST("lineItem/Operation" AS VARCHAR) AS operation,
    CAST("pricing/PricingModel" AS VARCHAR) AS pricing_model,
    CAST("resourceTags/TagKeys" AS VARCHAR) AS tag_keys,
    CAST("resourceTags/TagValues" AS VARCHAR) AS tag_values,
    CAST("product/Region" AS VARCHAR) AS region,
    CAST("product/ServiceCode" AS VARCHAR) AS service_code,
    CAST("product/InstanceType" AS VARCHAR) AS instance_type,
    CAST("amortized_cost" AS DECIMAL(18, 6)) AS amortized_cost,
    CAST("product/Description" AS VARCHAR) AS description
FROM supercell_usagelogs
    );
  
  
[0m17:33:49.526520 [debug] [Thread-1 (]: SQL status: OK in 0.264 seconds
[0m17:33:49.530286 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.cleaned_usagelogs"
[0m17:33:49.530551 [debug] [Thread-1 (]: On model.supercell.cleaned_usagelogs: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.cleaned_usagelogs"} */
alter table "supercell"."main"."cleaned_usagelogs" rename to "cleaned_usagelogs__dbt_backup"
[0m17:33:49.531075 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:33:49.533176 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.cleaned_usagelogs"
[0m17:33:49.533450 [debug] [Thread-1 (]: On model.supercell.cleaned_usagelogs: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.cleaned_usagelogs"} */
alter table "supercell"."main"."cleaned_usagelogs__dbt_tmp" rename to "cleaned_usagelogs"
[0m17:33:49.533994 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:33:49.543601 [debug] [Thread-1 (]: On model.supercell.cleaned_usagelogs: COMMIT
[0m17:33:49.543926 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.cleaned_usagelogs"
[0m17:33:49.544144 [debug] [Thread-1 (]: On model.supercell.cleaned_usagelogs: COMMIT
[0m17:33:49.568263 [debug] [Thread-1 (]: SQL status: OK in 0.024 seconds
[0m17:33:49.571778 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.cleaned_usagelogs"
[0m17:33:49.572076 [debug] [Thread-1 (]: On model.supercell.cleaned_usagelogs: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.cleaned_usagelogs"} */
drop table if exists "supercell"."main"."cleaned_usagelogs__dbt_backup" cascade
[0m17:33:49.574345 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m17:33:49.576372 [debug] [Thread-1 (]: On model.supercell.cleaned_usagelogs: Close
[0m17:33:49.580694 [info ] [Thread-1 (]: 1 of 5 OK created sql table model main.cleaned_usagelogs ....................... [[32mOK[0m in 0.35s]
[0m17:33:49.581084 [debug] [Thread-1 (]: Finished running node model.supercell.cleaned_usagelogs
[0m17:33:49.582012 [debug] [Thread-3 (]: Began running node model.supercell.dim_accounts
[0m17:33:49.582705 [debug] [Thread-4 (]: Began running node model.supercell.dim_resource
[0m17:33:49.583350 [debug] [Thread-2 (]: Began running node model.supercell.fact_bill_generation
[0m17:33:49.584011 [info ] [Thread-3 (]: 2 of 5 START sql table model main.dim_accounts ................................. [RUN]
[0m17:33:49.584653 [info ] [Thread-4 (]: 3 of 5 START sql table model main.dim_resource ................................. [RUN]
[0m17:33:49.585244 [info ] [Thread-2 (]: 4 of 5 START sql table model main.fact_bill_generation ......................... [RUN]
[0m17:33:49.586161 [debug] [Thread-3 (]: Acquiring new duckdb connection 'model.supercell.dim_accounts'
[0m17:33:49.586865 [debug] [Thread-4 (]: Acquiring new duckdb connection 'model.supercell.dim_resource'
[0m17:33:49.587401 [debug] [Thread-2 (]: Acquiring new duckdb connection 'model.supercell.fact_bill_generation'
[0m17:33:49.587904 [debug] [Thread-3 (]: Began compiling node model.supercell.dim_accounts
[0m17:33:49.588490 [debug] [Thread-4 (]: Began compiling node model.supercell.dim_resource
[0m17:33:49.589056 [debug] [Thread-2 (]: Began compiling node model.supercell.fact_bill_generation
[0m17:33:49.593942 [debug] [Thread-3 (]: Writing injected SQL for node "model.supercell.dim_accounts"
[0m17:33:49.597186 [debug] [Thread-4 (]: Writing injected SQL for node "model.supercell.dim_resource"
[0m17:33:49.599278 [debug] [Thread-2 (]: Writing injected SQL for node "model.supercell.fact_bill_generation"
[0m17:33:49.600280 [debug] [Thread-4 (]: Began executing node model.supercell.dim_resource
[0m17:33:49.600855 [debug] [Thread-3 (]: Began executing node model.supercell.dim_accounts
[0m17:33:49.603367 [debug] [Thread-4 (]: Writing runtime sql for node "model.supercell.dim_resource"
[0m17:33:49.603669 [debug] [Thread-2 (]: Began executing node model.supercell.fact_bill_generation
[0m17:33:49.606132 [debug] [Thread-3 (]: Writing runtime sql for node "model.supercell.dim_accounts"
[0m17:33:49.608145 [debug] [Thread-2 (]: Writing runtime sql for node "model.supercell.fact_bill_generation"
[0m17:33:49.608534 [debug] [Thread-4 (]: Using duckdb connection "model.supercell.dim_resource"
[0m17:33:49.609211 [debug] [Thread-3 (]: Using duckdb connection "model.supercell.dim_accounts"
[0m17:33:49.609562 [debug] [Thread-4 (]: On model.supercell.dim_resource: BEGIN
[0m17:33:49.609816 [debug] [Thread-2 (]: Using duckdb connection "model.supercell.fact_bill_generation"
[0m17:33:49.610121 [debug] [Thread-3 (]: On model.supercell.dim_accounts: BEGIN
[0m17:33:49.610436 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m17:33:49.610650 [debug] [Thread-2 (]: On model.supercell.fact_bill_generation: BEGIN
[0m17:33:49.610947 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m17:33:49.611418 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m17:33:49.611684 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m17:33:49.612209 [debug] [Thread-4 (]: Using duckdb connection "model.supercell.dim_resource"
[0m17:33:49.612428 [debug] [Thread-4 (]: On model.supercell.dim_resource: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.dim_resource"} */

  
    
    

    create  table
      "supercell"."main"."dim_resource__dbt_tmp"
  
    as (
      


select
    md5(concat(linked_account_id, '_', service_code, '_', instance_type, '_', region, '_', CAST(usage_start_date AS VARCHAR), '_', CAST(usage_end_date AS VARCHAR))) AS resource_id,
    linked_account_id as linked_account_id,
    region,
    service_code as product,
    instance_type as instance_type,
    pricing_model as pricing_model
from "supercell"."main"."cleaned_usagelogs"
    );
  
  
[0m17:33:49.612653 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m17:33:49.613064 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m17:33:49.613497 [debug] [Thread-2 (]: Using duckdb connection "model.supercell.fact_bill_generation"
[0m17:33:49.614406 [debug] [Thread-3 (]: Using duckdb connection "model.supercell.dim_accounts"
[0m17:33:49.615556 [debug] [Thread-2 (]: On model.supercell.fact_bill_generation: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.fact_bill_generation"} */

  
    
    

    create  table
      "supercell"."main"."fact_bill_generation__dbt_tmp"
  
    as (
      


select
    md5(concat(linked_account_id, '_', service_code, '_', instance_type, '_', region, '_', CAST(usage_start_date AS VARCHAR), '_', CAST(usage_end_date AS VARCHAR))) AS resource_id,
    usage_start_date as start_date,
    usage_end_date as bill_date,
    usage_amount as bill_amount,
    operation
from "supercell"."main"."cleaned_usagelogs"
    );
  
  
[0m17:33:49.616414 [debug] [Thread-3 (]: On model.supercell.dim_accounts: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.dim_accounts"} */

  
    
    

    create  table
      "supercell"."main"."dim_accounts__dbt_tmp"
  
    as (
      


select
    linked_account_id as linked_account_id,
    tag_keys as tag_keys,
    tag_values as tag_values
from "supercell"."main"."cleaned_usagelogs"
    );
  
  
[0m17:33:49.748540 [debug] [Thread-3 (]: SQL status: OK in 0.131 seconds
[0m17:33:49.751668 [debug] [Thread-3 (]: Using duckdb connection "model.supercell.dim_accounts"
[0m17:33:49.752424 [debug] [Thread-3 (]: On model.supercell.dim_accounts: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.dim_accounts"} */
alter table "supercell"."main"."dim_accounts" rename to "dim_accounts__dbt_backup"
[0m17:33:49.753617 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m17:33:49.757253 [debug] [Thread-3 (]: Using duckdb connection "model.supercell.dim_accounts"
[0m17:33:49.757975 [debug] [Thread-3 (]: On model.supercell.dim_accounts: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.dim_accounts"} */
alter table "supercell"."main"."dim_accounts__dbt_tmp" rename to "dim_accounts"
[0m17:33:49.759143 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m17:33:49.761226 [debug] [Thread-3 (]: On model.supercell.dim_accounts: COMMIT
[0m17:33:49.761771 [debug] [Thread-3 (]: Using duckdb connection "model.supercell.dim_accounts"
[0m17:33:49.762203 [debug] [Thread-3 (]: On model.supercell.dim_accounts: COMMIT
[0m17:33:49.800137 [debug] [Thread-3 (]: SQL status: OK in 0.037 seconds
[0m17:33:49.801873 [debug] [Thread-3 (]: Using duckdb connection "model.supercell.dim_accounts"
[0m17:33:49.802192 [debug] [Thread-3 (]: On model.supercell.dim_accounts: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.dim_accounts"} */
drop table if exists "supercell"."main"."dim_accounts__dbt_backup" cascade
[0m17:33:49.804222 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m17:33:49.805201 [debug] [Thread-3 (]: On model.supercell.dim_accounts: Close
[0m17:33:49.811683 [info ] [Thread-3 (]: 2 of 5 OK created sql table model main.dim_accounts ............................ [[32mOK[0m in 0.23s]
[0m17:33:49.812508 [debug] [Thread-3 (]: Finished running node model.supercell.dim_accounts
[0m17:33:49.813896 [debug] [Thread-2 (]: SQL status: OK in 0.197 seconds
[0m17:33:49.817851 [debug] [Thread-2 (]: Using duckdb connection "model.supercell.fact_bill_generation"
[0m17:33:49.818406 [debug] [Thread-2 (]: On model.supercell.fact_bill_generation: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.fact_bill_generation"} */
alter table "supercell"."main"."fact_bill_generation" rename to "fact_bill_generation__dbt_backup"
[0m17:33:49.819916 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m17:33:49.822846 [debug] [Thread-2 (]: Using duckdb connection "model.supercell.fact_bill_generation"
[0m17:33:49.823269 [debug] [Thread-2 (]: On model.supercell.fact_bill_generation: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.fact_bill_generation"} */
alter table "supercell"."main"."fact_bill_generation__dbt_tmp" rename to "fact_bill_generation"
[0m17:33:49.824067 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m17:33:49.825719 [debug] [Thread-2 (]: On model.supercell.fact_bill_generation: COMMIT
[0m17:33:49.826110 [debug] [Thread-2 (]: Using duckdb connection "model.supercell.fact_bill_generation"
[0m17:33:49.826471 [debug] [Thread-2 (]: On model.supercell.fact_bill_generation: COMMIT
[0m17:33:49.852324 [debug] [Thread-2 (]: SQL status: OK in 0.025 seconds
[0m17:33:49.854917 [debug] [Thread-2 (]: Using duckdb connection "model.supercell.fact_bill_generation"
[0m17:33:49.855194 [debug] [Thread-2 (]: On model.supercell.fact_bill_generation: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.fact_bill_generation"} */
drop table if exists "supercell"."main"."fact_bill_generation__dbt_backup" cascade
[0m17:33:49.856977 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m17:33:49.857887 [debug] [Thread-2 (]: On model.supercell.fact_bill_generation: Close
[0m17:33:49.859598 [info ] [Thread-2 (]: 4 of 5 OK created sql table model main.fact_bill_generation .................... [[32mOK[0m in 0.27s]
[0m17:33:49.859955 [debug] [Thread-2 (]: Finished running node model.supercell.fact_bill_generation
[0m17:33:49.867239 [debug] [Thread-4 (]: SQL status: OK in 0.254 seconds
[0m17:33:49.869414 [debug] [Thread-4 (]: Using duckdb connection "model.supercell.dim_resource"
[0m17:33:49.869663 [debug] [Thread-4 (]: On model.supercell.dim_resource: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.dim_resource"} */
alter table "supercell"."main"."dim_resource" rename to "dim_resource__dbt_backup"
[0m17:33:49.870177 [debug] [Thread-4 (]: SQL status: OK in 0.000 seconds
[0m17:33:49.871747 [debug] [Thread-4 (]: Using duckdb connection "model.supercell.dim_resource"
[0m17:33:49.871960 [debug] [Thread-4 (]: On model.supercell.dim_resource: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.dim_resource"} */
alter table "supercell"."main"."dim_resource__dbt_tmp" rename to "dim_resource"
[0m17:33:49.872353 [debug] [Thread-4 (]: SQL status: OK in 0.000 seconds
[0m17:33:49.873292 [debug] [Thread-4 (]: On model.supercell.dim_resource: COMMIT
[0m17:33:49.873514 [debug] [Thread-4 (]: Using duckdb connection "model.supercell.dim_resource"
[0m17:33:49.873686 [debug] [Thread-4 (]: On model.supercell.dim_resource: COMMIT
[0m17:33:49.881400 [debug] [Thread-4 (]: SQL status: OK in 0.007 seconds
[0m17:33:49.882635 [debug] [Thread-4 (]: Using duckdb connection "model.supercell.dim_resource"
[0m17:33:49.882884 [debug] [Thread-4 (]: On model.supercell.dim_resource: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.dim_resource"} */
drop table if exists "supercell"."main"."dim_resource__dbt_backup" cascade
[0m17:33:49.884590 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m17:33:49.885424 [debug] [Thread-4 (]: On model.supercell.dim_resource: Close
[0m17:33:49.886184 [info ] [Thread-4 (]: 3 of 5 OK created sql table model main.dim_resource ............................ [[32mOK[0m in 0.30s]
[0m17:33:49.886534 [debug] [Thread-4 (]: Finished running node model.supercell.dim_resource
[0m17:33:49.887468 [debug] [Thread-1 (]: Began running node model.supercell.total_cost
[0m17:33:49.887860 [info ] [Thread-1 (]: 5 of 5 START sql table model main.total_cost ................................... [RUN]
[0m17:33:49.888222 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.supercell.cleaned_usagelogs, now model.supercell.total_cost)
[0m17:33:49.888493 [debug] [Thread-1 (]: Began compiling node model.supercell.total_cost
[0m17:33:49.892935 [debug] [Thread-1 (]: Writing injected SQL for node "model.supercell.total_cost"
[0m17:33:49.894037 [debug] [Thread-1 (]: Began executing node model.supercell.total_cost
[0m17:33:49.897919 [debug] [Thread-1 (]: Writing runtime sql for node "model.supercell.total_cost"
[0m17:33:49.898747 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.total_cost"
[0m17:33:49.899203 [debug] [Thread-1 (]: On model.supercell.total_cost: BEGIN
[0m17:33:49.899570 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:33:49.900306 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:33:49.900674 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.total_cost"
[0m17:33:49.901056 [debug] [Thread-1 (]: On model.supercell.total_cost: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.total_cost"} */

  
    
    

    create  table
      "supercell"."main"."total_cost__dbt_tmp"
  
    as (
      

with base as (
    select
        fact_bill_generation.resource_id,
        date_trunc('month', fact_bill_generation.bill_date) as month,
        fact_bill_generation.bill_amount,
        dim_resource.instance_type,
        dim_resource.product,
        dim_resource.region,
        dim_resource.pricing_model,
        dim_resource.linked_account_id
    from "supercell"."main"."fact_bill_generation" as fact_bill_generation
    left join "supercell"."main"."dim_resource" as dim_resource
        on fact_bill_generation.resource_id = dim_resource.resource_id
    -- filter to recent records to speed up
    where fact_bill_generation.bill_date >= current_date - interval '6 months'
),
joined as (
    select
        base.*,
        dim_accounts.linked_account_id,  -- only if needed
        dim_accounts.tag_keys
    from base
    left join "supercell"."main"."dim_accounts" as dim_accounts
        on base.linked_account_id = dim_accounts.linked_account_id
)

select
    month,
    sum(bill_amount) as total_cost,
    instance_type,
    product,
    region,
    pricing_model
from joined
group by
    month,
    instance_type,
    product,
    region,
    pricing_model
order by
    month,
    instance_type,
    product,
    region,
    pricing_model
    );
  
  
[0m17:33:49.928273 [debug] [Thread-1 (]: SQL status: OK in 0.027 seconds
[0m17:33:49.930749 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.total_cost"
[0m17:33:49.931122 [debug] [Thread-1 (]: On model.supercell.total_cost: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.total_cost"} */
alter table "supercell"."main"."total_cost" rename to "total_cost__dbt_backup"
[0m17:33:49.931844 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:33:49.934594 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.total_cost"
[0m17:33:49.934954 [debug] [Thread-1 (]: On model.supercell.total_cost: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.total_cost"} */
alter table "supercell"."main"."total_cost__dbt_tmp" rename to "total_cost"
[0m17:33:49.935591 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:33:49.936738 [debug] [Thread-1 (]: On model.supercell.total_cost: COMMIT
[0m17:33:49.936980 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.total_cost"
[0m17:33:49.937198 [debug] [Thread-1 (]: On model.supercell.total_cost: COMMIT
[0m17:33:49.939191 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m17:33:49.940452 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.total_cost"
[0m17:33:49.940677 [debug] [Thread-1 (]: On model.supercell.total_cost: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.total_cost"} */
drop table if exists "supercell"."main"."total_cost__dbt_backup" cascade
[0m17:33:49.942476 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m17:33:49.943278 [debug] [Thread-1 (]: On model.supercell.total_cost: Close
[0m17:33:49.945398 [info ] [Thread-1 (]: 5 of 5 OK created sql table model main.total_cost .............................. [[32mOK[0m in 0.06s]
[0m17:33:49.945723 [debug] [Thread-1 (]: Finished running node model.supercell.total_cost
[0m17:33:49.947084 [debug] [MainThread]: Using duckdb connection "master"
[0m17:33:49.947404 [debug] [MainThread]: On master: BEGIN
[0m17:33:49.947613 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:33:49.948269 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m17:33:49.948738 [debug] [MainThread]: On master: COMMIT
[0m17:33:49.949087 [debug] [MainThread]: Using duckdb connection "master"
[0m17:33:49.949398 [debug] [MainThread]: On master: COMMIT
[0m17:33:49.950231 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m17:33:49.950543 [debug] [MainThread]: On master: Close
[0m17:33:49.950973 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:33:49.951193 [debug] [MainThread]: Connection 'model.supercell.total_cost' was properly closed.
[0m17:33:49.951356 [debug] [MainThread]: Connection 'model.supercell.dim_accounts' was properly closed.
[0m17:33:49.951504 [debug] [MainThread]: Connection 'model.supercell.dim_resource' was properly closed.
[0m17:33:49.951652 [debug] [MainThread]: Connection 'model.supercell.fact_bill_generation' was properly closed.
[0m17:33:49.952097 [info ] [MainThread]: 
[0m17:33:49.952448 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 0.80 seconds (0.80s).
[0m17:33:49.953247 [debug] [MainThread]: Command end result
[0m17:33:50.007465 [debug] [MainThread]: Wrote artifact WritableManifest to /home/harsha/data_actions/supercell_cloudops/target/manifest.json
[0m17:33:50.008480 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/harsha/data_actions/supercell_cloudops/target/semantic_manifest.json
[0m17:33:50.011853 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/harsha/data_actions/supercell_cloudops/target/run_results.json
[0m17:33:50.012078 [info ] [MainThread]: 
[0m17:33:50.012303 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:33:50.012481 [info ] [MainThread]: 
[0m17:33:50.012679 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m17:33:50.013315 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.3130516, "process_in_blocks": "0", "process_kernel_time": 0.400555, "process_mem_max_rss": "378668", "process_out_blocks": "59216", "process_user_time": 4.289244}
[0m17:33:50.013649 [debug] [MainThread]: Command `dbt run` succeeded at 17:33:50.013585 after 1.31 seconds
[0m17:33:50.013859 [debug] [MainThread]: Flushing usage events


============================== 17:34:08.047315 | 295fc7c5-d2e9-48ae-aea8-416820d04d3c ==============================
[0m17:34:08.047315 [info ] [MainThread]: Running with dbt=1.9.4
[0m17:34:08.050032 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/harsha/data_actions/supercell_cloudops', 'debug': 'False', 'warn_error': 'None', 'log_path': '/home/harsha/data_actions/supercell_cloudops/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'False'}
[0m17:34:08.050479 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality

User config should be moved from the 'config' key in profiles.yml to the 'flags' key in dbt_project.yml.
[0m17:34:08.210020 [info ] [MainThread]: Registered adapter: duckdb=1.9.3
[0m17:34:08.249139 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m17:34:08.289451 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:34:08.289839 [debug] [MainThread]: Partial parsing: updated file: supercell://models/supercell_models/metrics/total_cost.sql
[0m17:34:08.428681 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.supercell.example
[0m17:34:08.462369 [debug] [MainThread]: Wrote artifact WritableManifest to /home/harsha/data_actions/supercell_cloudops/target/manifest.json
[0m17:34:08.463518 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/harsha/data_actions/supercell_cloudops/target/semantic_manifest.json
[0m17:34:08.470670 [info ] [MainThread]: Found 5 models, 428 macros
[0m17:34:08.471968 [info ] [MainThread]: 
[0m17:34:08.472310 [info ] [MainThread]: Concurrency: 4 threads (target='default')
[0m17:34:08.472521 [info ] [MainThread]: 
[0m17:34:08.472836 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m17:34:08.477533 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_supercell'
[0m17:34:08.500332 [debug] [ThreadPool]: Using duckdb connection "list_supercell"
[0m17:34:08.500625 [debug] [ThreadPool]: On list_supercell: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "connection_name": "list_supercell"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"supercell"'
    
  
  
[0m17:34:08.500807 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:34:08.508782 [debug] [ThreadPool]: SQL status: OK in 0.008 seconds
[0m17:34:08.509856 [debug] [ThreadPool]: On list_supercell: Close
[0m17:34:08.510365 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_supercell, now create_supercell_main)
[0m17:34:08.510658 [debug] [ThreadPool]: Creating schema "database: "supercell"
schema: "main"
"
[0m17:34:08.514569 [debug] [ThreadPool]: Using duckdb connection "create_supercell_main"
[0m17:34:08.514805 [debug] [ThreadPool]: On create_supercell_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "connection_name": "create_supercell_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='supercell'
        and type='sqlite'
    
  
[0m17:34:08.514985 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:34:08.515686 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m17:34:08.516515 [debug] [ThreadPool]: Using duckdb connection "create_supercell_main"
[0m17:34:08.516716 [debug] [ThreadPool]: On create_supercell_main: BEGIN
[0m17:34:08.517160 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:34:08.517336 [debug] [ThreadPool]: Using duckdb connection "create_supercell_main"
[0m17:34:08.517486 [debug] [ThreadPool]: On create_supercell_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "connection_name": "create_supercell_main"} */

    
    
        create schema if not exists "supercell"."main"
    
[0m17:34:08.517773 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:34:08.518302 [debug] [ThreadPool]: On create_supercell_main: COMMIT
[0m17:34:08.518504 [debug] [ThreadPool]: Using duckdb connection "create_supercell_main"
[0m17:34:08.518672 [debug] [ThreadPool]: On create_supercell_main: COMMIT
[0m17:34:08.519073 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:34:08.519297 [debug] [ThreadPool]: On create_supercell_main: Close
[0m17:34:08.520233 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_supercell_main, now list_supercell_main)
[0m17:34:08.523502 [debug] [ThreadPool]: Using duckdb connection "list_supercell_main"
[0m17:34:08.523719 [debug] [ThreadPool]: On list_supercell_main: BEGIN
[0m17:34:08.523886 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:34:08.524253 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:34:08.524447 [debug] [ThreadPool]: Using duckdb connection "list_supercell_main"
[0m17:34:08.524613 [debug] [ThreadPool]: On list_supercell_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "connection_name": "list_supercell_main"} */
select
      'supercell' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'supercell'
  
[0m17:34:08.533060 [debug] [ThreadPool]: SQL status: OK in 0.008 seconds
[0m17:34:08.534083 [debug] [ThreadPool]: On list_supercell_main: ROLLBACK
[0m17:34:08.534758 [debug] [ThreadPool]: Failed to rollback 'list_supercell_main'
[0m17:34:08.535010 [debug] [ThreadPool]: On list_supercell_main: Close
[0m17:34:08.536118 [debug] [MainThread]: Using duckdb connection "master"
[0m17:34:08.536360 [debug] [MainThread]: On master: BEGIN
[0m17:34:08.536527 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:34:08.536909 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:34:08.537112 [debug] [MainThread]: On master: COMMIT
[0m17:34:08.537291 [debug] [MainThread]: Using duckdb connection "master"
[0m17:34:08.537443 [debug] [MainThread]: On master: COMMIT
[0m17:34:08.537700 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:34:08.537891 [debug] [MainThread]: On master: Close
[0m17:34:08.539637 [debug] [Thread-1 (]: Began running node model.supercell.cleaned_usagelogs
[0m17:34:08.540211 [info ] [Thread-1 (]: 1 of 5 START sql table model main.cleaned_usagelogs ............................ [RUN]
[0m17:34:08.540663 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_supercell_main, now model.supercell.cleaned_usagelogs)
[0m17:34:08.541043 [debug] [Thread-1 (]: Began compiling node model.supercell.cleaned_usagelogs
[0m17:34:08.548474 [debug] [Thread-1 (]: Writing injected SQL for node "model.supercell.cleaned_usagelogs"
[0m17:34:08.549187 [debug] [Thread-1 (]: Began executing node model.supercell.cleaned_usagelogs
[0m17:34:08.575910 [debug] [Thread-1 (]: Writing runtime sql for node "model.supercell.cleaned_usagelogs"
[0m17:34:08.576459 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.cleaned_usagelogs"
[0m17:34:08.576711 [debug] [Thread-1 (]: On model.supercell.cleaned_usagelogs: BEGIN
[0m17:34:08.576887 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:34:08.577489 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:34:08.577702 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.cleaned_usagelogs"
[0m17:34:08.577888 [debug] [Thread-1 (]: On model.supercell.cleaned_usagelogs: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.cleaned_usagelogs"} */

  
    
    

    create  table
      "supercell"."main"."cleaned_usagelogs__dbt_tmp"
  
    as (
      


SELECT
    CAST("LinkedAccountId" AS VARCHAR) AS linked_account_id,
    CAST("bill/PayerAccountId" AS VARCHAR) AS payer_account_id,
    CAST("lineItem/UsageStartDate" AS TIMESTAMP) AS usage_start_date,
    CAST("lineItem/UsageEndDate" AS TIMESTAMP) AS usage_end_date,
    CAST("lineItem/UsageAmount" AS DECIMAL(18, 6)) AS usage_amount,
    CAST("lineItem/Operation" AS VARCHAR) AS operation,
    CAST("pricing/PricingModel" AS VARCHAR) AS pricing_model,
    CAST("resourceTags/TagKeys" AS VARCHAR) AS tag_keys,
    CAST("resourceTags/TagValues" AS VARCHAR) AS tag_values,
    CAST("product/Region" AS VARCHAR) AS region,
    CAST("product/ServiceCode" AS VARCHAR) AS service_code,
    CAST("product/InstanceType" AS VARCHAR) AS instance_type,
    CAST("amortized_cost" AS DECIMAL(18, 6)) AS amortized_cost,
    CAST("product/Description" AS VARCHAR) AS description
FROM supercell_usagelogs
    );
  
  
[0m17:34:08.839074 [debug] [Thread-1 (]: SQL status: OK in 0.261 seconds
[0m17:34:08.843282 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.cleaned_usagelogs"
[0m17:34:08.843623 [debug] [Thread-1 (]: On model.supercell.cleaned_usagelogs: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.cleaned_usagelogs"} */
alter table "supercell"."main"."cleaned_usagelogs" rename to "cleaned_usagelogs__dbt_backup"
[0m17:34:08.844324 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:34:08.846233 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.cleaned_usagelogs"
[0m17:34:08.846501 [debug] [Thread-1 (]: On model.supercell.cleaned_usagelogs: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.cleaned_usagelogs"} */
alter table "supercell"."main"."cleaned_usagelogs__dbt_tmp" rename to "cleaned_usagelogs"
[0m17:34:08.846998 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:34:08.857112 [debug] [Thread-1 (]: On model.supercell.cleaned_usagelogs: COMMIT
[0m17:34:08.857523 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.cleaned_usagelogs"
[0m17:34:08.857750 [debug] [Thread-1 (]: On model.supercell.cleaned_usagelogs: COMMIT
[0m17:34:08.879500 [debug] [Thread-1 (]: SQL status: OK in 0.021 seconds
[0m17:34:08.882992 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.cleaned_usagelogs"
[0m17:34:08.883281 [debug] [Thread-1 (]: On model.supercell.cleaned_usagelogs: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.cleaned_usagelogs"} */
drop table if exists "supercell"."main"."cleaned_usagelogs__dbt_backup" cascade
[0m17:34:08.884973 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:34:08.886570 [debug] [Thread-1 (]: On model.supercell.cleaned_usagelogs: Close
[0m17:34:08.894436 [info ] [Thread-1 (]: 1 of 5 OK created sql table model main.cleaned_usagelogs ....................... [[32mOK[0m in 0.35s]
[0m17:34:08.895204 [debug] [Thread-1 (]: Finished running node model.supercell.cleaned_usagelogs
[0m17:34:08.896095 [debug] [Thread-3 (]: Began running node model.supercell.dim_accounts
[0m17:34:08.896624 [debug] [Thread-4 (]: Began running node model.supercell.dim_resource
[0m17:34:08.897084 [debug] [Thread-2 (]: Began running node model.supercell.fact_bill_generation
[0m17:34:08.897688 [info ] [Thread-3 (]: 2 of 5 START sql table model main.dim_accounts ................................. [RUN]
[0m17:34:08.898336 [info ] [Thread-4 (]: 3 of 5 START sql table model main.dim_resource ................................. [RUN]
[0m17:34:08.898965 [info ] [Thread-2 (]: 4 of 5 START sql table model main.fact_bill_generation ......................... [RUN]
[0m17:34:08.899686 [debug] [Thread-3 (]: Acquiring new duckdb connection 'model.supercell.dim_accounts'
[0m17:34:08.900191 [debug] [Thread-4 (]: Acquiring new duckdb connection 'model.supercell.dim_resource'
[0m17:34:08.900868 [debug] [Thread-2 (]: Acquiring new duckdb connection 'model.supercell.fact_bill_generation'
[0m17:34:08.901422 [debug] [Thread-3 (]: Began compiling node model.supercell.dim_accounts
[0m17:34:08.901848 [debug] [Thread-4 (]: Began compiling node model.supercell.dim_resource
[0m17:34:08.902257 [debug] [Thread-2 (]: Began compiling node model.supercell.fact_bill_generation
[0m17:34:08.907197 [debug] [Thread-3 (]: Writing injected SQL for node "model.supercell.dim_accounts"
[0m17:34:08.909489 [debug] [Thread-4 (]: Writing injected SQL for node "model.supercell.dim_resource"
[0m17:34:08.911139 [debug] [Thread-2 (]: Writing injected SQL for node "model.supercell.fact_bill_generation"
[0m17:34:08.911902 [debug] [Thread-3 (]: Began executing node model.supercell.dim_accounts
[0m17:34:08.915042 [debug] [Thread-3 (]: Writing runtime sql for node "model.supercell.dim_accounts"
[0m17:34:08.915913 [debug] [Thread-3 (]: Using duckdb connection "model.supercell.dim_accounts"
[0m17:34:08.916312 [debug] [Thread-3 (]: On model.supercell.dim_accounts: BEGIN
[0m17:34:08.916586 [debug] [Thread-4 (]: Began executing node model.supercell.dim_resource
[0m17:34:08.916985 [debug] [Thread-2 (]: Began executing node model.supercell.fact_bill_generation
[0m17:34:08.917382 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m17:34:08.919143 [debug] [Thread-4 (]: Writing runtime sql for node "model.supercell.dim_resource"
[0m17:34:08.921937 [debug] [Thread-2 (]: Writing runtime sql for node "model.supercell.fact_bill_generation"
[0m17:34:08.922870 [debug] [Thread-4 (]: Using duckdb connection "model.supercell.dim_resource"
[0m17:34:08.923212 [debug] [Thread-3 (]: SQL status: OK in 0.006 seconds
[0m17:34:08.923451 [debug] [Thread-4 (]: On model.supercell.dim_resource: BEGIN
[0m17:34:08.923873 [debug] [Thread-2 (]: Using duckdb connection "model.supercell.fact_bill_generation"
[0m17:34:08.924217 [debug] [Thread-3 (]: Using duckdb connection "model.supercell.dim_accounts"
[0m17:34:08.924443 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m17:34:08.924744 [debug] [Thread-2 (]: On model.supercell.fact_bill_generation: BEGIN
[0m17:34:08.925122 [debug] [Thread-3 (]: On model.supercell.dim_accounts: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.dim_accounts"} */

  
    
    

    create  table
      "supercell"."main"."dim_accounts__dbt_tmp"
  
    as (
      


select
    linked_account_id as linked_account_id,
    tag_keys as tag_keys,
    tag_values as tag_values
from "supercell"."main"."cleaned_usagelogs"
    );
  
  
[0m17:34:08.925574 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m17:34:08.926206 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m17:34:08.926660 [debug] [Thread-4 (]: Using duckdb connection "model.supercell.dim_resource"
[0m17:34:08.926961 [debug] [Thread-4 (]: On model.supercell.dim_resource: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.dim_resource"} */

  
    
    

    create  table
      "supercell"."main"."dim_resource__dbt_tmp"
  
    as (
      


select
    md5(concat(linked_account_id, '_', service_code, '_', instance_type, '_', region, '_', CAST(usage_start_date AS VARCHAR), '_', CAST(usage_end_date AS VARCHAR))) AS resource_id,
    linked_account_id as linked_account_id,
    region,
    service_code as product,
    instance_type as instance_type,
    pricing_model as pricing_model
from "supercell"."main"."cleaned_usagelogs"
    );
  
  
[0m17:34:08.927899 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m17:34:08.929004 [debug] [Thread-2 (]: Using duckdb connection "model.supercell.fact_bill_generation"
[0m17:34:08.930503 [debug] [Thread-2 (]: On model.supercell.fact_bill_generation: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.fact_bill_generation"} */

  
    
    

    create  table
      "supercell"."main"."fact_bill_generation__dbt_tmp"
  
    as (
      


select
    md5(concat(linked_account_id, '_', service_code, '_', instance_type, '_', region, '_', CAST(usage_start_date AS VARCHAR), '_', CAST(usage_end_date AS VARCHAR))) AS resource_id,
    usage_start_date as start_date,
    usage_end_date as bill_date,
    usage_amount as bill_amount,
    operation
from "supercell"."main"."cleaned_usagelogs"
    );
  
  
[0m17:34:09.027927 [debug] [Thread-3 (]: SQL status: OK in 0.102 seconds
[0m17:34:09.030784 [debug] [Thread-3 (]: Using duckdb connection "model.supercell.dim_accounts"
[0m17:34:09.031167 [debug] [Thread-3 (]: On model.supercell.dim_accounts: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.dim_accounts"} */
alter table "supercell"."main"."dim_accounts" rename to "dim_accounts__dbt_backup"
[0m17:34:09.031851 [debug] [Thread-3 (]: SQL status: OK in 0.000 seconds
[0m17:34:09.034000 [debug] [Thread-3 (]: Using duckdb connection "model.supercell.dim_accounts"
[0m17:34:09.034350 [debug] [Thread-3 (]: On model.supercell.dim_accounts: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.dim_accounts"} */
alter table "supercell"."main"."dim_accounts__dbt_tmp" rename to "dim_accounts"
[0m17:34:09.035071 [debug] [Thread-3 (]: SQL status: OK in 0.000 seconds
[0m17:34:09.036507 [debug] [Thread-3 (]: On model.supercell.dim_accounts: COMMIT
[0m17:34:09.036866 [debug] [Thread-3 (]: Using duckdb connection "model.supercell.dim_accounts"
[0m17:34:09.037133 [debug] [Thread-3 (]: On model.supercell.dim_accounts: COMMIT
[0m17:34:09.048219 [debug] [Thread-3 (]: SQL status: OK in 0.011 seconds
[0m17:34:09.050060 [debug] [Thread-3 (]: Using duckdb connection "model.supercell.dim_accounts"
[0m17:34:09.050433 [debug] [Thread-3 (]: On model.supercell.dim_accounts: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.dim_accounts"} */
drop table if exists "supercell"."main"."dim_accounts__dbt_backup" cascade
[0m17:34:09.052326 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m17:34:09.053558 [debug] [Thread-3 (]: On model.supercell.dim_accounts: Close
[0m17:34:09.057236 [info ] [Thread-3 (]: 2 of 5 OK created sql table model main.dim_accounts ............................ [[32mOK[0m in 0.16s]
[0m17:34:09.058010 [debug] [Thread-3 (]: Finished running node model.supercell.dim_accounts
[0m17:34:09.134154 [debug] [Thread-2 (]: SQL status: OK in 0.202 seconds
[0m17:34:09.136858 [debug] [Thread-2 (]: Using duckdb connection "model.supercell.fact_bill_generation"
[0m17:34:09.137295 [debug] [Thread-2 (]: On model.supercell.fact_bill_generation: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.fact_bill_generation"} */
alter table "supercell"."main"."fact_bill_generation" rename to "fact_bill_generation__dbt_backup"
[0m17:34:09.138107 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m17:34:09.140366 [debug] [Thread-2 (]: Using duckdb connection "model.supercell.fact_bill_generation"
[0m17:34:09.140735 [debug] [Thread-2 (]: On model.supercell.fact_bill_generation: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.fact_bill_generation"} */
alter table "supercell"."main"."fact_bill_generation__dbt_tmp" rename to "fact_bill_generation"
[0m17:34:09.141413 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m17:34:09.143089 [debug] [Thread-2 (]: On model.supercell.fact_bill_generation: COMMIT
[0m17:34:09.143500 [debug] [Thread-2 (]: Using duckdb connection "model.supercell.fact_bill_generation"
[0m17:34:09.143833 [debug] [Thread-2 (]: On model.supercell.fact_bill_generation: COMMIT
[0m17:34:09.174255 [debug] [Thread-2 (]: SQL status: OK in 0.030 seconds
[0m17:34:09.174739 [debug] [Thread-4 (]: SQL status: OK in 0.247 seconds
[0m17:34:09.177569 [debug] [Thread-2 (]: Using duckdb connection "model.supercell.fact_bill_generation"
[0m17:34:09.179338 [debug] [Thread-4 (]: Using duckdb connection "model.supercell.dim_resource"
[0m17:34:09.179776 [debug] [Thread-2 (]: On model.supercell.fact_bill_generation: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.fact_bill_generation"} */
drop table if exists "supercell"."main"."fact_bill_generation__dbt_backup" cascade
[0m17:34:09.180256 [debug] [Thread-4 (]: On model.supercell.dim_resource: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.dim_resource"} */
alter table "supercell"."main"."dim_resource" rename to "dim_resource__dbt_backup"
[0m17:34:09.181234 [debug] [Thread-4 (]: SQL status: OK in 0.000 seconds
[0m17:34:09.182621 [debug] [Thread-4 (]: Using duckdb connection "model.supercell.dim_resource"
[0m17:34:09.182852 [debug] [Thread-4 (]: On model.supercell.dim_resource: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.dim_resource"} */
alter table "supercell"."main"."dim_resource__dbt_tmp" rename to "dim_resource"
[0m17:34:09.183221 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m17:34:09.184076 [debug] [Thread-2 (]: On model.supercell.fact_bill_generation: Close
[0m17:34:09.184394 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m17:34:09.185508 [debug] [Thread-4 (]: On model.supercell.dim_resource: COMMIT
[0m17:34:09.185769 [debug] [Thread-4 (]: Using duckdb connection "model.supercell.dim_resource"
[0m17:34:09.185996 [debug] [Thread-4 (]: On model.supercell.dim_resource: COMMIT
[0m17:34:09.189341 [info ] [Thread-2 (]: 4 of 5 OK created sql table model main.fact_bill_generation .................... [[32mOK[0m in 0.29s]
[0m17:34:09.189723 [debug] [Thread-2 (]: Finished running node model.supercell.fact_bill_generation
[0m17:34:09.190420 [debug] [Thread-4 (]: SQL status: OK in 0.004 seconds
[0m17:34:09.192154 [debug] [Thread-4 (]: Using duckdb connection "model.supercell.dim_resource"
[0m17:34:09.192449 [debug] [Thread-4 (]: On model.supercell.dim_resource: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.dim_resource"} */
drop table if exists "supercell"."main"."dim_resource__dbt_backup" cascade
[0m17:34:09.194724 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m17:34:09.196030 [debug] [Thread-4 (]: On model.supercell.dim_resource: Close
[0m17:34:09.197283 [info ] [Thread-4 (]: 3 of 5 OK created sql table model main.dim_resource ............................ [[32mOK[0m in 0.30s]
[0m17:34:09.197650 [debug] [Thread-4 (]: Finished running node model.supercell.dim_resource
[0m17:34:09.198530 [debug] [Thread-1 (]: Began running node model.supercell.total_cost
[0m17:34:09.198912 [info ] [Thread-1 (]: 5 of 5 START sql table model main.total_cost ................................... [RUN]
[0m17:34:09.199262 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.supercell.cleaned_usagelogs, now model.supercell.total_cost)
[0m17:34:09.199496 [debug] [Thread-1 (]: Began compiling node model.supercell.total_cost
[0m17:34:09.201610 [debug] [Thread-1 (]: Writing injected SQL for node "model.supercell.total_cost"
[0m17:34:09.202003 [debug] [Thread-1 (]: Began executing node model.supercell.total_cost
[0m17:34:09.204017 [debug] [Thread-1 (]: Writing runtime sql for node "model.supercell.total_cost"
[0m17:34:09.204434 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.total_cost"
[0m17:34:09.204669 [debug] [Thread-1 (]: On model.supercell.total_cost: BEGIN
[0m17:34:09.204881 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:34:09.205448 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:34:09.205669 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.total_cost"
[0m17:34:09.205886 [debug] [Thread-1 (]: On model.supercell.total_cost: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.total_cost"} */

  
    
    

    create  table
      "supercell"."main"."total_cost__dbt_tmp"
  
    as (
      

with base as (
    select
        fact_bill_generation.resource_id,
        date_trunc('month', fact_bill_generation.bill_date) as month,
        fact_bill_generation.bill_amount,
        dim_resource.instance_type,
        dim_resource.product,
        dim_resource.region,
        dim_resource.pricing_model,
        dim_resource.linked_account_id
    from "supercell"."main"."fact_bill_generation" as fact_bill_generation
    left join "supercell"."main"."dim_resource" as dim_resource
        on fact_bill_generation.resource_id = dim_resource.resource_id
    -- filter to recent records to speed up
    where fact_bill_generation.bill_date >= current_date - interval '6 months'
),
joined as (
    select
        base.*,
        dim_accounts.linked_account_id,  -- only if needed
        dim_accounts.tag_keys,
        dim_accounts.tag_values
    from base
    left join "supercell"."main"."dim_accounts" as dim_accounts
        on base.linked_account_id = dim_accounts.linked_account_id
)

select
    month,
    sum(bill_amount) as total_cost,
    instance_type,
    product,
    region,
    pricing_model
from joined
group by
    month,
    instance_type,
    product,
    region,
    pricing_model
order by
    month,
    instance_type,
    product,
    region,
    pricing_model
    );
  
  
[0m17:34:09.233288 [debug] [Thread-1 (]: SQL status: OK in 0.027 seconds
[0m17:34:09.236213 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.total_cost"
[0m17:34:09.236663 [debug] [Thread-1 (]: On model.supercell.total_cost: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.total_cost"} */
alter table "supercell"."main"."total_cost" rename to "total_cost__dbt_backup"
[0m17:34:09.237591 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:34:09.240054 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.total_cost"
[0m17:34:09.240544 [debug] [Thread-1 (]: On model.supercell.total_cost: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.total_cost"} */
alter table "supercell"."main"."total_cost__dbt_tmp" rename to "total_cost"
[0m17:34:09.241280 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:34:09.242841 [debug] [Thread-1 (]: On model.supercell.total_cost: COMMIT
[0m17:34:09.243361 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.total_cost"
[0m17:34:09.243753 [debug] [Thread-1 (]: On model.supercell.total_cost: COMMIT
[0m17:34:09.245997 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m17:34:09.247511 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.total_cost"
[0m17:34:09.247723 [debug] [Thread-1 (]: On model.supercell.total_cost: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.total_cost"} */
drop table if exists "supercell"."main"."total_cost__dbt_backup" cascade
[0m17:34:09.249294 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:34:09.250085 [debug] [Thread-1 (]: On model.supercell.total_cost: Close
[0m17:34:09.252191 [info ] [Thread-1 (]: 5 of 5 OK created sql table model main.total_cost .............................. [[32mOK[0m in 0.05s]
[0m17:34:09.252554 [debug] [Thread-1 (]: Finished running node model.supercell.total_cost
[0m17:34:09.253832 [debug] [MainThread]: Using duckdb connection "master"
[0m17:34:09.254146 [debug] [MainThread]: On master: BEGIN
[0m17:34:09.254363 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:34:09.254889 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:34:09.255118 [debug] [MainThread]: On master: COMMIT
[0m17:34:09.255328 [debug] [MainThread]: Using duckdb connection "master"
[0m17:34:09.255502 [debug] [MainThread]: On master: COMMIT
[0m17:34:09.255885 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:34:09.256123 [debug] [MainThread]: On master: Close
[0m17:34:09.256618 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:34:09.256833 [debug] [MainThread]: Connection 'model.supercell.total_cost' was properly closed.
[0m17:34:09.256996 [debug] [MainThread]: Connection 'model.supercell.dim_accounts' was properly closed.
[0m17:34:09.257175 [debug] [MainThread]: Connection 'model.supercell.dim_resource' was properly closed.
[0m17:34:09.257331 [debug] [MainThread]: Connection 'model.supercell.fact_bill_generation' was properly closed.
[0m17:34:09.257572 [info ] [MainThread]: 
[0m17:34:09.257783 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 0.78 seconds (0.78s).
[0m17:34:09.258726 [debug] [MainThread]: Command end result
[0m17:34:09.316049 [debug] [MainThread]: Wrote artifact WritableManifest to /home/harsha/data_actions/supercell_cloudops/target/manifest.json
[0m17:34:09.317170 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/harsha/data_actions/supercell_cloudops/target/semantic_manifest.json
[0m17:34:09.320869 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/harsha/data_actions/supercell_cloudops/target/run_results.json
[0m17:34:09.321146 [info ] [MainThread]: 
[0m17:34:09.321403 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:34:09.321596 [info ] [MainThread]: 
[0m17:34:09.321793 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m17:34:09.322442 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.306746, "process_in_blocks": "0", "process_kernel_time": 0.352258, "process_mem_max_rss": "339800", "process_out_blocks": "59744", "process_user_time": 4.176065}
[0m17:34:09.322785 [debug] [MainThread]: Command `dbt run` succeeded at 17:34:09.322719 after 1.31 seconds
[0m17:34:09.322999 [debug] [MainThread]: Flushing usage events


============================== 17:34:48.287606 | d4133217-90e6-47b8-b7aa-cc776d22251f ==============================
[0m17:34:48.287606 [info ] [MainThread]: Running with dbt=1.9.4
[0m17:34:48.290593 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/harsha/data_actions/supercell_cloudops', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/harsha/data_actions/supercell_cloudops/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'False'}
[0m17:34:48.290958 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality

User config should be moved from the 'config' key in profiles.yml to the 'flags' key in dbt_project.yml.
[0m17:34:48.445876 [info ] [MainThread]: Registered adapter: duckdb=1.9.3
[0m17:34:48.483525 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m17:34:48.523464 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:34:48.523864 [debug] [MainThread]: Partial parsing: updated file: supercell://models/supercell_models/metrics/total_cost.sql
[0m17:34:48.666697 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.supercell.example
[0m17:34:48.699394 [debug] [MainThread]: Wrote artifact WritableManifest to /home/harsha/data_actions/supercell_cloudops/target/manifest.json
[0m17:34:48.700420 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/harsha/data_actions/supercell_cloudops/target/semantic_manifest.json
[0m17:34:48.708142 [info ] [MainThread]: Found 5 models, 428 macros
[0m17:34:48.709328 [info ] [MainThread]: 
[0m17:34:48.709654 [info ] [MainThread]: Concurrency: 4 threads (target='default')
[0m17:34:48.709837 [info ] [MainThread]: 
[0m17:34:48.710164 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m17:34:48.714031 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_supercell'
[0m17:34:48.737537 [debug] [ThreadPool]: Using duckdb connection "list_supercell"
[0m17:34:48.737839 [debug] [ThreadPool]: On list_supercell: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "connection_name": "list_supercell"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"supercell"'
    
  
  
[0m17:34:48.738015 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:34:48.745967 [debug] [ThreadPool]: SQL status: OK in 0.008 seconds
[0m17:34:48.746842 [debug] [ThreadPool]: On list_supercell: Close
[0m17:34:48.747435 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_supercell, now create_supercell_main)
[0m17:34:48.747737 [debug] [ThreadPool]: Creating schema "database: "supercell"
schema: "main"
"
[0m17:34:48.751982 [debug] [ThreadPool]: Using duckdb connection "create_supercell_main"
[0m17:34:48.752242 [debug] [ThreadPool]: On create_supercell_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "connection_name": "create_supercell_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='supercell'
        and type='sqlite'
    
  
[0m17:34:48.752405 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:34:48.753138 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m17:34:48.753959 [debug] [ThreadPool]: Using duckdb connection "create_supercell_main"
[0m17:34:48.754146 [debug] [ThreadPool]: On create_supercell_main: BEGIN
[0m17:34:48.754463 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:34:48.754625 [debug] [ThreadPool]: Using duckdb connection "create_supercell_main"
[0m17:34:48.754762 [debug] [ThreadPool]: On create_supercell_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "connection_name": "create_supercell_main"} */

    
    
        create schema if not exists "supercell"."main"
    
[0m17:34:48.755018 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:34:48.755522 [debug] [ThreadPool]: On create_supercell_main: COMMIT
[0m17:34:48.755707 [debug] [ThreadPool]: Using duckdb connection "create_supercell_main"
[0m17:34:48.755859 [debug] [ThreadPool]: On create_supercell_main: COMMIT
[0m17:34:48.756097 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:34:48.756279 [debug] [ThreadPool]: On create_supercell_main: Close
[0m17:34:48.757511 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_supercell_main, now list_supercell_main)
[0m17:34:48.762483 [debug] [ThreadPool]: Using duckdb connection "list_supercell_main"
[0m17:34:48.762838 [debug] [ThreadPool]: On list_supercell_main: BEGIN
[0m17:34:48.763144 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:34:48.763766 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m17:34:48.764067 [debug] [ThreadPool]: Using duckdb connection "list_supercell_main"
[0m17:34:48.764373 [debug] [ThreadPool]: On list_supercell_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "connection_name": "list_supercell_main"} */
select
      'supercell' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'supercell'
  
[0m17:34:48.773223 [debug] [ThreadPool]: SQL status: OK in 0.008 seconds
[0m17:34:48.774182 [debug] [ThreadPool]: On list_supercell_main: ROLLBACK
[0m17:34:48.774847 [debug] [ThreadPool]: Failed to rollback 'list_supercell_main'
[0m17:34:48.775066 [debug] [ThreadPool]: On list_supercell_main: Close
[0m17:34:48.776429 [debug] [MainThread]: Using duckdb connection "master"
[0m17:34:48.776650 [debug] [MainThread]: On master: BEGIN
[0m17:34:48.776808 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:34:48.777170 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:34:48.777377 [debug] [MainThread]: On master: COMMIT
[0m17:34:48.777532 [debug] [MainThread]: Using duckdb connection "master"
[0m17:34:48.777672 [debug] [MainThread]: On master: COMMIT
[0m17:34:48.777900 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:34:48.778079 [debug] [MainThread]: On master: Close
[0m17:34:48.779938 [debug] [Thread-1 (]: Began running node model.supercell.cleaned_usagelogs
[0m17:34:48.780499 [info ] [Thread-1 (]: 1 of 5 START sql table model main.cleaned_usagelogs ............................ [RUN]
[0m17:34:48.780959 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_supercell_main, now model.supercell.cleaned_usagelogs)
[0m17:34:48.781397 [debug] [Thread-1 (]: Began compiling node model.supercell.cleaned_usagelogs
[0m17:34:48.789240 [debug] [Thread-1 (]: Writing injected SQL for node "model.supercell.cleaned_usagelogs"
[0m17:34:48.789928 [debug] [Thread-1 (]: Began executing node model.supercell.cleaned_usagelogs
[0m17:34:48.808576 [debug] [Thread-1 (]: Writing runtime sql for node "model.supercell.cleaned_usagelogs"
[0m17:34:48.809082 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.cleaned_usagelogs"
[0m17:34:48.809332 [debug] [Thread-1 (]: On model.supercell.cleaned_usagelogs: BEGIN
[0m17:34:48.809559 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:34:48.810187 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:34:48.810402 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.cleaned_usagelogs"
[0m17:34:48.810609 [debug] [Thread-1 (]: On model.supercell.cleaned_usagelogs: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.cleaned_usagelogs"} */

  
    
    

    create  table
      "supercell"."main"."cleaned_usagelogs__dbt_tmp"
  
    as (
      


SELECT
    CAST("LinkedAccountId" AS VARCHAR) AS linked_account_id,
    CAST("bill/PayerAccountId" AS VARCHAR) AS payer_account_id,
    CAST("lineItem/UsageStartDate" AS TIMESTAMP) AS usage_start_date,
    CAST("lineItem/UsageEndDate" AS TIMESTAMP) AS usage_end_date,
    CAST("lineItem/UsageAmount" AS DECIMAL(18, 6)) AS usage_amount,
    CAST("lineItem/Operation" AS VARCHAR) AS operation,
    CAST("pricing/PricingModel" AS VARCHAR) AS pricing_model,
    CAST("resourceTags/TagKeys" AS VARCHAR) AS tag_keys,
    CAST("resourceTags/TagValues" AS VARCHAR) AS tag_values,
    CAST("product/Region" AS VARCHAR) AS region,
    CAST("product/ServiceCode" AS VARCHAR) AS service_code,
    CAST("product/InstanceType" AS VARCHAR) AS instance_type,
    CAST("amortized_cost" AS DECIMAL(18, 6)) AS amortized_cost,
    CAST("product/Description" AS VARCHAR) AS description
FROM supercell_usagelogs
    );
  
  
[0m17:34:49.086246 [debug] [Thread-1 (]: SQL status: OK in 0.275 seconds
[0m17:34:49.091989 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.cleaned_usagelogs"
[0m17:34:49.092455 [debug] [Thread-1 (]: On model.supercell.cleaned_usagelogs: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.cleaned_usagelogs"} */
alter table "supercell"."main"."cleaned_usagelogs" rename to "cleaned_usagelogs__dbt_backup"
[0m17:34:49.093309 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:34:49.095852 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.cleaned_usagelogs"
[0m17:34:49.096131 [debug] [Thread-1 (]: On model.supercell.cleaned_usagelogs: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.cleaned_usagelogs"} */
alter table "supercell"."main"."cleaned_usagelogs__dbt_tmp" rename to "cleaned_usagelogs"
[0m17:34:49.096756 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:34:49.107128 [debug] [Thread-1 (]: On model.supercell.cleaned_usagelogs: COMMIT
[0m17:34:49.107487 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.cleaned_usagelogs"
[0m17:34:49.107708 [debug] [Thread-1 (]: On model.supercell.cleaned_usagelogs: COMMIT
[0m17:34:49.119959 [debug] [Thread-1 (]: SQL status: OK in 0.012 seconds
[0m17:34:49.124987 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.cleaned_usagelogs"
[0m17:34:49.125746 [debug] [Thread-1 (]: On model.supercell.cleaned_usagelogs: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.cleaned_usagelogs"} */
drop table if exists "supercell"."main"."cleaned_usagelogs__dbt_backup" cascade
[0m17:34:49.128193 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m17:34:49.130661 [debug] [Thread-1 (]: On model.supercell.cleaned_usagelogs: Close
[0m17:34:49.138086 [info ] [Thread-1 (]: 1 of 5 OK created sql table model main.cleaned_usagelogs ....................... [[32mOK[0m in 0.36s]
[0m17:34:49.138587 [debug] [Thread-1 (]: Finished running node model.supercell.cleaned_usagelogs
[0m17:34:49.139413 [debug] [Thread-3 (]: Began running node model.supercell.dim_accounts
[0m17:34:49.140039 [debug] [Thread-4 (]: Began running node model.supercell.dim_resource
[0m17:34:49.140667 [debug] [Thread-2 (]: Began running node model.supercell.fact_bill_generation
[0m17:34:49.141495 [info ] [Thread-3 (]: 2 of 5 START sql table model main.dim_accounts ................................. [RUN]
[0m17:34:49.142431 [info ] [Thread-4 (]: 3 of 5 START sql table model main.dim_resource ................................. [RUN]
[0m17:34:49.143267 [info ] [Thread-2 (]: 4 of 5 START sql table model main.fact_bill_generation ......................... [RUN]
[0m17:34:49.144074 [debug] [Thread-3 (]: Acquiring new duckdb connection 'model.supercell.dim_accounts'
[0m17:34:49.144624 [debug] [Thread-4 (]: Acquiring new duckdb connection 'model.supercell.dim_resource'
[0m17:34:49.145348 [debug] [Thread-2 (]: Acquiring new duckdb connection 'model.supercell.fact_bill_generation'
[0m17:34:49.146108 [debug] [Thread-3 (]: Began compiling node model.supercell.dim_accounts
[0m17:34:49.146712 [debug] [Thread-4 (]: Began compiling node model.supercell.dim_resource
[0m17:34:49.147101 [debug] [Thread-2 (]: Began compiling node model.supercell.fact_bill_generation
[0m17:34:49.151694 [debug] [Thread-3 (]: Writing injected SQL for node "model.supercell.dim_accounts"
[0m17:34:49.154892 [debug] [Thread-4 (]: Writing injected SQL for node "model.supercell.dim_resource"
[0m17:34:49.157511 [debug] [Thread-2 (]: Writing injected SQL for node "model.supercell.fact_bill_generation"
[0m17:34:49.158532 [debug] [Thread-4 (]: Began executing node model.supercell.dim_resource
[0m17:34:49.158892 [debug] [Thread-2 (]: Began executing node model.supercell.fact_bill_generation
[0m17:34:49.159348 [debug] [Thread-3 (]: Began executing node model.supercell.dim_accounts
[0m17:34:49.161632 [debug] [Thread-4 (]: Writing runtime sql for node "model.supercell.dim_resource"
[0m17:34:49.164279 [debug] [Thread-2 (]: Writing runtime sql for node "model.supercell.fact_bill_generation"
[0m17:34:49.166580 [debug] [Thread-3 (]: Writing runtime sql for node "model.supercell.dim_accounts"
[0m17:34:49.167407 [debug] [Thread-4 (]: Using duckdb connection "model.supercell.dim_resource"
[0m17:34:49.167967 [debug] [Thread-2 (]: Using duckdb connection "model.supercell.fact_bill_generation"
[0m17:34:49.168336 [debug] [Thread-4 (]: On model.supercell.dim_resource: BEGIN
[0m17:34:49.168721 [debug] [Thread-3 (]: Using duckdb connection "model.supercell.dim_accounts"
[0m17:34:49.169169 [debug] [Thread-2 (]: On model.supercell.fact_bill_generation: BEGIN
[0m17:34:49.169579 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m17:34:49.169925 [debug] [Thread-3 (]: On model.supercell.dim_accounts: BEGIN
[0m17:34:49.170220 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m17:34:49.170740 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m17:34:49.171194 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m17:34:49.171687 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m17:34:49.172082 [debug] [Thread-4 (]: Using duckdb connection "model.supercell.dim_resource"
[0m17:34:49.172499 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m17:34:49.172923 [debug] [Thread-2 (]: Using duckdb connection "model.supercell.fact_bill_generation"
[0m17:34:49.173290 [debug] [Thread-4 (]: On model.supercell.dim_resource: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.dim_resource"} */

  
    
    

    create  table
      "supercell"."main"."dim_resource__dbt_tmp"
  
    as (
      


select
    md5(concat(linked_account_id, '_', service_code, '_', instance_type, '_', region, '_', CAST(usage_start_date AS VARCHAR), '_', CAST(usage_end_date AS VARCHAR))) AS resource_id,
    linked_account_id as linked_account_id,
    region,
    service_code as product,
    instance_type as instance_type,
    pricing_model as pricing_model
from "supercell"."main"."cleaned_usagelogs"
    );
  
  
[0m17:34:49.173581 [debug] [Thread-3 (]: Using duckdb connection "model.supercell.dim_accounts"
[0m17:34:49.173997 [debug] [Thread-2 (]: On model.supercell.fact_bill_generation: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.fact_bill_generation"} */

  
    
    

    create  table
      "supercell"."main"."fact_bill_generation__dbt_tmp"
  
    as (
      


select
    md5(concat(linked_account_id, '_', service_code, '_', instance_type, '_', region, '_', CAST(usage_start_date AS VARCHAR), '_', CAST(usage_end_date AS VARCHAR))) AS resource_id,
    usage_start_date as start_date,
    usage_end_date as bill_date,
    usage_amount as bill_amount,
    operation
from "supercell"."main"."cleaned_usagelogs"
    );
  
  
[0m17:34:49.174525 [debug] [Thread-3 (]: On model.supercell.dim_accounts: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.dim_accounts"} */

  
    
    

    create  table
      "supercell"."main"."dim_accounts__dbt_tmp"
  
    as (
      


select
    linked_account_id as linked_account_id,
    tag_keys as tag_keys,
    tag_values as tag_values
from "supercell"."main"."cleaned_usagelogs"
    );
  
  
[0m17:34:49.351166 [debug] [Thread-3 (]: SQL status: OK in 0.176 seconds
[0m17:34:49.354755 [debug] [Thread-3 (]: Using duckdb connection "model.supercell.dim_accounts"
[0m17:34:49.355432 [debug] [Thread-3 (]: On model.supercell.dim_accounts: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.dim_accounts"} */
alter table "supercell"."main"."dim_accounts" rename to "dim_accounts__dbt_backup"
[0m17:34:49.356714 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m17:34:49.359873 [debug] [Thread-3 (]: Using duckdb connection "model.supercell.dim_accounts"
[0m17:34:49.360424 [debug] [Thread-3 (]: On model.supercell.dim_accounts: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.dim_accounts"} */
alter table "supercell"."main"."dim_accounts__dbt_tmp" rename to "dim_accounts"
[0m17:34:49.361378 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m17:34:49.363310 [debug] [Thread-3 (]: On model.supercell.dim_accounts: COMMIT
[0m17:34:49.363908 [debug] [Thread-3 (]: Using duckdb connection "model.supercell.dim_accounts"
[0m17:34:49.364477 [debug] [Thread-3 (]: On model.supercell.dim_accounts: COMMIT
[0m17:34:49.377479 [debug] [Thread-3 (]: SQL status: OK in 0.012 seconds
[0m17:34:49.380040 [debug] [Thread-3 (]: Using duckdb connection "model.supercell.dim_accounts"
[0m17:34:49.380556 [debug] [Thread-3 (]: On model.supercell.dim_accounts: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.dim_accounts"} */
drop table if exists "supercell"."main"."dim_accounts__dbt_backup" cascade
[0m17:34:49.383475 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m17:34:49.385322 [debug] [Thread-3 (]: On model.supercell.dim_accounts: Close
[0m17:34:49.392482 [info ] [Thread-3 (]: 2 of 5 OK created sql table model main.dim_accounts ............................ [[32mOK[0m in 0.25s]
[0m17:34:49.393337 [debug] [Thread-3 (]: Finished running node model.supercell.dim_accounts
[0m17:34:49.402341 [debug] [Thread-2 (]: SQL status: OK in 0.227 seconds
[0m17:34:49.404439 [debug] [Thread-2 (]: Using duckdb connection "model.supercell.fact_bill_generation"
[0m17:34:49.404722 [debug] [Thread-2 (]: On model.supercell.fact_bill_generation: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.fact_bill_generation"} */
alter table "supercell"."main"."fact_bill_generation" rename to "fact_bill_generation__dbt_backup"
[0m17:34:49.405431 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m17:34:49.407154 [debug] [Thread-2 (]: Using duckdb connection "model.supercell.fact_bill_generation"
[0m17:34:49.407406 [debug] [Thread-2 (]: On model.supercell.fact_bill_generation: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.fact_bill_generation"} */
alter table "supercell"."main"."fact_bill_generation__dbt_tmp" rename to "fact_bill_generation"
[0m17:34:49.408009 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m17:34:49.409266 [debug] [Thread-2 (]: On model.supercell.fact_bill_generation: COMMIT
[0m17:34:49.409526 [debug] [Thread-2 (]: Using duckdb connection "model.supercell.fact_bill_generation"
[0m17:34:49.409733 [debug] [Thread-2 (]: On model.supercell.fact_bill_generation: COMMIT
[0m17:34:49.413317 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m17:34:49.416144 [debug] [Thread-2 (]: Using duckdb connection "model.supercell.fact_bill_generation"
[0m17:34:49.416488 [debug] [Thread-2 (]: On model.supercell.fact_bill_generation: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.fact_bill_generation"} */
drop table if exists "supercell"."main"."fact_bill_generation__dbt_backup" cascade
[0m17:34:49.418243 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m17:34:49.419224 [debug] [Thread-2 (]: On model.supercell.fact_bill_generation: Close
[0m17:34:49.420729 [info ] [Thread-2 (]: 4 of 5 OK created sql table model main.fact_bill_generation .................... [[32mOK[0m in 0.28s]
[0m17:34:49.421110 [debug] [Thread-2 (]: Finished running node model.supercell.fact_bill_generation
[0m17:34:49.471800 [debug] [Thread-4 (]: SQL status: OK in 0.297 seconds
[0m17:34:49.473772 [debug] [Thread-4 (]: Using duckdb connection "model.supercell.dim_resource"
[0m17:34:49.474042 [debug] [Thread-4 (]: On model.supercell.dim_resource: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.dim_resource"} */
alter table "supercell"."main"."dim_resource" rename to "dim_resource__dbt_backup"
[0m17:34:49.474606 [debug] [Thread-4 (]: SQL status: OK in 0.000 seconds
[0m17:34:49.476318 [debug] [Thread-4 (]: Using duckdb connection "model.supercell.dim_resource"
[0m17:34:49.476561 [debug] [Thread-4 (]: On model.supercell.dim_resource: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.dim_resource"} */
alter table "supercell"."main"."dim_resource__dbt_tmp" rename to "dim_resource"
[0m17:34:49.476970 [debug] [Thread-4 (]: SQL status: OK in 0.000 seconds
[0m17:34:49.477980 [debug] [Thread-4 (]: On model.supercell.dim_resource: COMMIT
[0m17:34:49.478237 [debug] [Thread-4 (]: Using duckdb connection "model.supercell.dim_resource"
[0m17:34:49.478443 [debug] [Thread-4 (]: On model.supercell.dim_resource: COMMIT
[0m17:34:49.483602 [debug] [Thread-4 (]: SQL status: OK in 0.005 seconds
[0m17:34:49.485137 [debug] [Thread-4 (]: Using duckdb connection "model.supercell.dim_resource"
[0m17:34:49.485400 [debug] [Thread-4 (]: On model.supercell.dim_resource: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.dim_resource"} */
drop table if exists "supercell"."main"."dim_resource__dbt_backup" cascade
[0m17:34:49.486971 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m17:34:49.487888 [debug] [Thread-4 (]: On model.supercell.dim_resource: Close
[0m17:34:49.489184 [info ] [Thread-4 (]: 3 of 5 OK created sql table model main.dim_resource ............................ [[32mOK[0m in 0.34s]
[0m17:34:49.489552 [debug] [Thread-4 (]: Finished running node model.supercell.dim_resource
[0m17:34:49.490288 [debug] [Thread-1 (]: Began running node model.supercell.total_cost
[0m17:34:49.490664 [info ] [Thread-1 (]: 5 of 5 START sql table model main.total_cost ................................... [RUN]
[0m17:34:49.490998 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.supercell.cleaned_usagelogs, now model.supercell.total_cost)
[0m17:34:49.491279 [debug] [Thread-1 (]: Began compiling node model.supercell.total_cost
[0m17:34:49.493985 [debug] [Thread-1 (]: Writing injected SQL for node "model.supercell.total_cost"
[0m17:34:49.494711 [debug] [Thread-1 (]: Began executing node model.supercell.total_cost
[0m17:34:49.497815 [debug] [Thread-1 (]: Writing runtime sql for node "model.supercell.total_cost"
[0m17:34:49.498504 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.total_cost"
[0m17:34:49.498822 [debug] [Thread-1 (]: On model.supercell.total_cost: BEGIN
[0m17:34:49.499043 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:34:49.500021 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:34:49.500431 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.total_cost"
[0m17:34:49.500694 [debug] [Thread-1 (]: On model.supercell.total_cost: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.total_cost"} */

  
    
    

    create  table
      "supercell"."main"."total_cost__dbt_tmp"
  
    as (
      

with base as (
    select
        fact_bill_generation.resource_id,
        date_trunc('month', fact_bill_generation.bill_date) as month,
        fact_bill_generation.bill_amount,
        dim_resource.instance_type,
        dim_resource.product,
        dim_resource.region,
        dim_resource.pricing_model,
        dim_resource.linked_account_id
    from "supercell"."main"."fact_bill_generation" as fact_bill_generation
    left join "supercell"."main"."dim_resource" as dim_resource
        on fact_bill_generation.resource_id = dim_resource.resource_id
    -- filter to recent records to speed up
    where fact_bill_generation.bill_date >= current_date - interval '6 months'
),
joined as (
    select
        base.*,
        dim_accounts.linked_account_id,  -- only if needed
        dim_accounts.tag_keys as tag_keys,
        dim_accounts.tag_values as tag_values
    from base
    left join "supercell"."main"."dim_accounts" as dim_accounts
        on base.linked_account_id = dim_accounts.linked_account_id
)

select
    month,
    sum(bill_amount) as total_cost,
    instance_type,
    product,
    region,
    pricing_model,
    tag_keys,
    tag_values
from joined
group by
    month,
    instance_type,
    product,
    region,
    pricing_model
order by
    month,
    instance_type,
    product,
    region,
    pricing_model
    );
  
  
[0m17:34:49.502432 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.total_cost"} */

  
    
    

    create  table
      "supercell"."main"."total_cost__dbt_tmp"
  
    as (
      

with base as (
    select
        fact_bill_generation.resource_id,
        date_trunc('month', fact_bill_generation.bill_date) as month,
        fact_bill_generation.bill_amount,
        dim_resource.instance_type,
        dim_resource.product,
        dim_resource.region,
        dim_resource.pricing_model,
        dim_resource.linked_account_id
    from "supercell"."main"."fact_bill_generation" as fact_bill_generation
    left join "supercell"."main"."dim_resource" as dim_resource
        on fact_bill_generation.resource_id = dim_resource.resource_id
    -- filter to recent records to speed up
    where fact_bill_generation.bill_date >= current_date - interval '6 months'
),
joined as (
    select
        base.*,
        dim_accounts.linked_account_id,  -- only if needed
        dim_accounts.tag_keys as tag_keys,
        dim_accounts.tag_values as tag_values
    from base
    left join "supercell"."main"."dim_accounts" as dim_accounts
        on base.linked_account_id = dim_accounts.linked_account_id
)

select
    month,
    sum(bill_amount) as total_cost,
    instance_type,
    product,
    region,
    pricing_model,
    tag_keys,
    tag_values
from joined
group by
    month,
    instance_type,
    product,
    region,
    pricing_model
order by
    month,
    instance_type,
    product,
    region,
    pricing_model
    );
  
  
[0m17:34:49.502878 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m17:34:49.503332 [debug] [Thread-1 (]: On model.supercell.total_cost: ROLLBACK
[0m17:34:49.505842 [debug] [Thread-1 (]: Failed to rollback 'model.supercell.total_cost'
[0m17:34:49.506201 [debug] [Thread-1 (]: On model.supercell.total_cost: Close
[0m17:34:49.508309 [debug] [Thread-1 (]: Runtime Error in model total_cost (models/supercell_models/metrics/total_cost.sql)
  Binder Error: column "tag_keys" must appear in the GROUP BY clause or must be part of an aggregate function.
  Either add it to the GROUP BY list, or use "ANY_VALUE(tag_keys)" if the exact value of "tag_keys" is not important.
  
  LINE 47:     tag_keys,
               ^
[0m17:34:49.508864 [error] [Thread-1 (]: 5 of 5 ERROR creating sql table model main.total_cost .......................... [[31mERROR[0m in 0.02s]
[0m17:34:49.509259 [debug] [Thread-1 (]: Finished running node model.supercell.total_cost
[0m17:34:49.509774 [debug] [Thread-7 (]: Marking all children of 'model.supercell.total_cost' to be skipped because of status 'error'.  Reason: Runtime Error in model total_cost (models/supercell_models/metrics/total_cost.sql)
  Binder Error: column "tag_keys" must appear in the GROUP BY clause or must be part of an aggregate function.
  Either add it to the GROUP BY list, or use "ANY_VALUE(tag_keys)" if the exact value of "tag_keys" is not important.
  
  LINE 47:     tag_keys,
               ^.
[0m17:34:49.514099 [debug] [MainThread]: Using duckdb connection "master"
[0m17:34:49.514712 [debug] [MainThread]: On master: BEGIN
[0m17:34:49.515123 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:34:49.517475 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m17:34:49.518369 [debug] [MainThread]: On master: COMMIT
[0m17:34:49.518852 [debug] [MainThread]: Using duckdb connection "master"
[0m17:34:49.519237 [debug] [MainThread]: On master: COMMIT
[0m17:34:49.520252 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m17:34:49.520753 [debug] [MainThread]: On master: Close
[0m17:34:49.521421 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:34:49.521788 [debug] [MainThread]: Connection 'model.supercell.total_cost' was properly closed.
[0m17:34:49.522072 [debug] [MainThread]: Connection 'model.supercell.dim_accounts' was properly closed.
[0m17:34:49.522401 [debug] [MainThread]: Connection 'model.supercell.dim_resource' was properly closed.
[0m17:34:49.522686 [debug] [MainThread]: Connection 'model.supercell.fact_bill_generation' was properly closed.
[0m17:34:49.523123 [info ] [MainThread]: 
[0m17:34:49.523597 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 0.81 seconds (0.81s).
[0m17:34:49.525077 [debug] [MainThread]: Command end result
[0m17:34:49.542378 [debug] [MainThread]: Wrote artifact WritableManifest to /home/harsha/data_actions/supercell_cloudops/target/manifest.json
[0m17:34:49.543892 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/harsha/data_actions/supercell_cloudops/target/semantic_manifest.json
[0m17:34:49.549885 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/harsha/data_actions/supercell_cloudops/target/run_results.json
[0m17:34:49.550197 [info ] [MainThread]: 
[0m17:34:49.550440 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m17:34:49.550637 [info ] [MainThread]: 
[0m17:34:49.550867 [error] [MainThread]:   Runtime Error in model total_cost (models/supercell_models/metrics/total_cost.sql)
  Binder Error: column "tag_keys" must appear in the GROUP BY clause or must be part of an aggregate function.
  Either add it to the GROUP BY list, or use "ANY_VALUE(tag_keys)" if the exact value of "tag_keys" is not important.
  
  LINE 47:     tag_keys,
               ^
[0m17:34:49.551051 [info ] [MainThread]: 
[0m17:34:49.551252 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
[0m17:34:49.551844 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.2953808, "process_in_blocks": "0", "process_kernel_time": 0.352001, "process_mem_max_rss": "367244", "process_out_blocks": "59728", "process_user_time": 4.344676}
[0m17:34:49.552194 [debug] [MainThread]: Command `dbt run` failed at 17:34:49.552110 after 1.30 seconds
[0m17:34:49.552429 [debug] [MainThread]: Flushing usage events


============================== 17:35:07.119889 | a0caecf8-7da4-45d6-b39e-80c5684f8c32 ==============================
[0m17:35:07.119889 [info ] [MainThread]: Running with dbt=1.9.4
[0m17:35:07.123012 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/harsha/data_actions/supercell_cloudops', 'debug': 'False', 'warn_error': 'None', 'log_path': '/home/harsha/data_actions/supercell_cloudops/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'False'}
[0m17:35:07.123399 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality

User config should be moved from the 'config' key in profiles.yml to the 'flags' key in dbt_project.yml.
[0m17:35:07.346225 [info ] [MainThread]: Registered adapter: duckdb=1.9.3
[0m17:35:07.386000 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m17:35:07.430490 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:35:07.430927 [debug] [MainThread]: Partial parsing: updated file: supercell://models/supercell_models/metrics/total_cost.sql
[0m17:35:07.584389 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.supercell.example
[0m17:35:07.619005 [debug] [MainThread]: Wrote artifact WritableManifest to /home/harsha/data_actions/supercell_cloudops/target/manifest.json
[0m17:35:07.620051 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/harsha/data_actions/supercell_cloudops/target/semantic_manifest.json
[0m17:35:07.627519 [info ] [MainThread]: Found 5 models, 428 macros
[0m17:35:07.628868 [info ] [MainThread]: 
[0m17:35:07.629316 [info ] [MainThread]: Concurrency: 4 threads (target='default')
[0m17:35:07.629516 [info ] [MainThread]: 
[0m17:35:07.629840 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m17:35:07.633676 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_supercell'
[0m17:35:07.659627 [debug] [ThreadPool]: Using duckdb connection "list_supercell"
[0m17:35:07.659974 [debug] [ThreadPool]: On list_supercell: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "connection_name": "list_supercell"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"supercell"'
    
  
  
[0m17:35:07.660198 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:35:07.669322 [debug] [ThreadPool]: SQL status: OK in 0.009 seconds
[0m17:35:07.670421 [debug] [ThreadPool]: On list_supercell: Close
[0m17:35:07.671045 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_supercell, now create_supercell_main)
[0m17:35:07.671403 [debug] [ThreadPool]: Creating schema "database: "supercell"
schema: "main"
"
[0m17:35:07.676228 [debug] [ThreadPool]: Using duckdb connection "create_supercell_main"
[0m17:35:07.676713 [debug] [ThreadPool]: On create_supercell_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "connection_name": "create_supercell_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='supercell'
        and type='sqlite'
    
  
[0m17:35:07.676924 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:35:07.677934 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m17:35:07.678965 [debug] [ThreadPool]: Using duckdb connection "create_supercell_main"
[0m17:35:07.679227 [debug] [ThreadPool]: On create_supercell_main: BEGIN
[0m17:35:07.679618 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:35:07.679818 [debug] [ThreadPool]: Using duckdb connection "create_supercell_main"
[0m17:35:07.679981 [debug] [ThreadPool]: On create_supercell_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "connection_name": "create_supercell_main"} */

    
    
        create schema if not exists "supercell"."main"
    
[0m17:35:07.680367 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:35:07.680962 [debug] [ThreadPool]: On create_supercell_main: COMMIT
[0m17:35:07.681184 [debug] [ThreadPool]: Using duckdb connection "create_supercell_main"
[0m17:35:07.681360 [debug] [ThreadPool]: On create_supercell_main: COMMIT
[0m17:35:07.681659 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:35:07.681854 [debug] [ThreadPool]: On create_supercell_main: Close
[0m17:35:07.682944 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_supercell_main, now list_supercell_main)
[0m17:35:07.686858 [debug] [ThreadPool]: Using duckdb connection "list_supercell_main"
[0m17:35:07.687129 [debug] [ThreadPool]: On list_supercell_main: BEGIN
[0m17:35:07.687316 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:35:07.687965 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m17:35:07.688197 [debug] [ThreadPool]: Using duckdb connection "list_supercell_main"
[0m17:35:07.688377 [debug] [ThreadPool]: On list_supercell_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "connection_name": "list_supercell_main"} */
select
      'supercell' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'supercell'
  
[0m17:35:07.697337 [debug] [ThreadPool]: SQL status: OK in 0.009 seconds
[0m17:35:07.698433 [debug] [ThreadPool]: On list_supercell_main: ROLLBACK
[0m17:35:07.699177 [debug] [ThreadPool]: Failed to rollback 'list_supercell_main'
[0m17:35:07.699407 [debug] [ThreadPool]: On list_supercell_main: Close
[0m17:35:07.700572 [debug] [MainThread]: Using duckdb connection "master"
[0m17:35:07.700799 [debug] [MainThread]: On master: BEGIN
[0m17:35:07.700978 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:35:07.701393 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:35:07.701613 [debug] [MainThread]: On master: COMMIT
[0m17:35:07.701804 [debug] [MainThread]: Using duckdb connection "master"
[0m17:35:07.701974 [debug] [MainThread]: On master: COMMIT
[0m17:35:07.702252 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:35:07.702446 [debug] [MainThread]: On master: Close
[0m17:35:07.704425 [debug] [Thread-1 (]: Began running node model.supercell.cleaned_usagelogs
[0m17:35:07.704981 [info ] [Thread-1 (]: 1 of 5 START sql table model main.cleaned_usagelogs ............................ [RUN]
[0m17:35:07.705439 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_supercell_main, now model.supercell.cleaned_usagelogs)
[0m17:35:07.705793 [debug] [Thread-1 (]: Began compiling node model.supercell.cleaned_usagelogs
[0m17:35:07.713509 [debug] [Thread-1 (]: Writing injected SQL for node "model.supercell.cleaned_usagelogs"
[0m17:35:07.714218 [debug] [Thread-1 (]: Began executing node model.supercell.cleaned_usagelogs
[0m17:35:07.738349 [debug] [Thread-1 (]: Writing runtime sql for node "model.supercell.cleaned_usagelogs"
[0m17:35:07.738887 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.cleaned_usagelogs"
[0m17:35:07.739150 [debug] [Thread-1 (]: On model.supercell.cleaned_usagelogs: BEGIN
[0m17:35:07.739350 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:35:07.739957 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:35:07.740198 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.cleaned_usagelogs"
[0m17:35:07.740414 [debug] [Thread-1 (]: On model.supercell.cleaned_usagelogs: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.cleaned_usagelogs"} */

  
    
    

    create  table
      "supercell"."main"."cleaned_usagelogs__dbt_tmp"
  
    as (
      


SELECT
    CAST("LinkedAccountId" AS VARCHAR) AS linked_account_id,
    CAST("bill/PayerAccountId" AS VARCHAR) AS payer_account_id,
    CAST("lineItem/UsageStartDate" AS TIMESTAMP) AS usage_start_date,
    CAST("lineItem/UsageEndDate" AS TIMESTAMP) AS usage_end_date,
    CAST("lineItem/UsageAmount" AS DECIMAL(18, 6)) AS usage_amount,
    CAST("lineItem/Operation" AS VARCHAR) AS operation,
    CAST("pricing/PricingModel" AS VARCHAR) AS pricing_model,
    CAST("resourceTags/TagKeys" AS VARCHAR) AS tag_keys,
    CAST("resourceTags/TagValues" AS VARCHAR) AS tag_values,
    CAST("product/Region" AS VARCHAR) AS region,
    CAST("product/ServiceCode" AS VARCHAR) AS service_code,
    CAST("product/InstanceType" AS VARCHAR) AS instance_type,
    CAST("amortized_cost" AS DECIMAL(18, 6)) AS amortized_cost,
    CAST("product/Description" AS VARCHAR) AS description
FROM supercell_usagelogs
    );
  
  
[0m17:35:08.038258 [debug] [Thread-1 (]: SQL status: OK in 0.297 seconds
[0m17:35:08.042786 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.cleaned_usagelogs"
[0m17:35:08.043169 [debug] [Thread-1 (]: On model.supercell.cleaned_usagelogs: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.cleaned_usagelogs"} */
alter table "supercell"."main"."cleaned_usagelogs" rename to "cleaned_usagelogs__dbt_backup"
[0m17:35:08.043851 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:35:08.045813 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.cleaned_usagelogs"
[0m17:35:08.046093 [debug] [Thread-1 (]: On model.supercell.cleaned_usagelogs: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.cleaned_usagelogs"} */
alter table "supercell"."main"."cleaned_usagelogs__dbt_tmp" rename to "cleaned_usagelogs"
[0m17:35:08.046649 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:35:08.057428 [debug] [Thread-1 (]: On model.supercell.cleaned_usagelogs: COMMIT
[0m17:35:08.057821 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.cleaned_usagelogs"
[0m17:35:08.058043 [debug] [Thread-1 (]: On model.supercell.cleaned_usagelogs: COMMIT
[0m17:35:08.069777 [debug] [Thread-1 (]: SQL status: OK in 0.011 seconds
[0m17:35:08.073438 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.cleaned_usagelogs"
[0m17:35:08.073779 [debug] [Thread-1 (]: On model.supercell.cleaned_usagelogs: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.cleaned_usagelogs"} */
drop table if exists "supercell"."main"."cleaned_usagelogs__dbt_backup" cascade
[0m17:35:08.075867 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m17:35:08.077853 [debug] [Thread-1 (]: On model.supercell.cleaned_usagelogs: Close
[0m17:35:08.083605 [info ] [Thread-1 (]: 1 of 5 OK created sql table model main.cleaned_usagelogs ....................... [[32mOK[0m in 0.38s]
[0m17:35:08.084104 [debug] [Thread-1 (]: Finished running node model.supercell.cleaned_usagelogs
[0m17:35:08.085142 [debug] [Thread-3 (]: Began running node model.supercell.dim_accounts
[0m17:35:08.085708 [debug] [Thread-4 (]: Began running node model.supercell.dim_resource
[0m17:35:08.086431 [debug] [Thread-2 (]: Began running node model.supercell.fact_bill_generation
[0m17:35:08.087152 [info ] [Thread-3 (]: 2 of 5 START sql table model main.dim_accounts ................................. [RUN]
[0m17:35:08.087845 [info ] [Thread-4 (]: 3 of 5 START sql table model main.dim_resource ................................. [RUN]
[0m17:35:08.088509 [info ] [Thread-2 (]: 4 of 5 START sql table model main.fact_bill_generation ......................... [RUN]
[0m17:35:08.089525 [debug] [Thread-3 (]: Acquiring new duckdb connection 'model.supercell.dim_accounts'
[0m17:35:08.090285 [debug] [Thread-4 (]: Acquiring new duckdb connection 'model.supercell.dim_resource'
[0m17:35:08.090976 [debug] [Thread-2 (]: Acquiring new duckdb connection 'model.supercell.fact_bill_generation'
[0m17:35:08.091940 [debug] [Thread-3 (]: Began compiling node model.supercell.dim_accounts
[0m17:35:08.092671 [debug] [Thread-4 (]: Began compiling node model.supercell.dim_resource
[0m17:35:08.093291 [debug] [Thread-2 (]: Began compiling node model.supercell.fact_bill_generation
[0m17:35:08.098790 [debug] [Thread-3 (]: Writing injected SQL for node "model.supercell.dim_accounts"
[0m17:35:08.101996 [debug] [Thread-4 (]: Writing injected SQL for node "model.supercell.dim_resource"
[0m17:35:08.104668 [debug] [Thread-2 (]: Writing injected SQL for node "model.supercell.fact_bill_generation"
[0m17:35:08.105370 [debug] [Thread-3 (]: Began executing node model.supercell.dim_accounts
[0m17:35:08.107622 [debug] [Thread-3 (]: Writing runtime sql for node "model.supercell.dim_accounts"
[0m17:35:08.108331 [debug] [Thread-3 (]: Using duckdb connection "model.supercell.dim_accounts"
[0m17:35:08.108804 [debug] [Thread-3 (]: On model.supercell.dim_accounts: BEGIN
[0m17:35:08.109420 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m17:35:08.109946 [debug] [Thread-2 (]: Began executing node model.supercell.fact_bill_generation
[0m17:35:08.110609 [debug] [Thread-4 (]: Began executing node model.supercell.dim_resource
[0m17:35:08.113623 [debug] [Thread-2 (]: Writing runtime sql for node "model.supercell.fact_bill_generation"
[0m17:35:08.114203 [debug] [Thread-3 (]: SQL status: OK in 0.005 seconds
[0m17:35:08.117140 [debug] [Thread-4 (]: Writing runtime sql for node "model.supercell.dim_resource"
[0m17:35:08.117796 [debug] [Thread-3 (]: Using duckdb connection "model.supercell.dim_accounts"
[0m17:35:08.118331 [debug] [Thread-2 (]: Using duckdb connection "model.supercell.fact_bill_generation"
[0m17:35:08.118688 [debug] [Thread-3 (]: On model.supercell.dim_accounts: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.dim_accounts"} */

  
    
    

    create  table
      "supercell"."main"."dim_accounts__dbt_tmp"
  
    as (
      


select
    linked_account_id as linked_account_id,
    tag_keys as tag_keys,
    tag_values as tag_values
from "supercell"."main"."cleaned_usagelogs"
    );
  
  
[0m17:35:08.119085 [debug] [Thread-2 (]: On model.supercell.fact_bill_generation: BEGIN
[0m17:35:08.119568 [debug] [Thread-4 (]: Using duckdb connection "model.supercell.dim_resource"
[0m17:35:08.120027 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m17:35:08.120519 [debug] [Thread-4 (]: On model.supercell.dim_resource: BEGIN
[0m17:35:08.121186 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m17:35:08.122250 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m17:35:08.123233 [debug] [Thread-2 (]: Using duckdb connection "model.supercell.fact_bill_generation"
[0m17:35:08.124223 [debug] [Thread-4 (]: SQL status: OK in 0.003 seconds
[0m17:35:08.125111 [debug] [Thread-2 (]: On model.supercell.fact_bill_generation: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.fact_bill_generation"} */

  
    
    

    create  table
      "supercell"."main"."fact_bill_generation__dbt_tmp"
  
    as (
      


select
    md5(concat(linked_account_id, '_', service_code, '_', instance_type, '_', region, '_', CAST(usage_start_date AS VARCHAR), '_', CAST(usage_end_date AS VARCHAR))) AS resource_id,
    usage_start_date as start_date,
    usage_end_date as bill_date,
    usage_amount as bill_amount,
    operation
from "supercell"."main"."cleaned_usagelogs"
    );
  
  
[0m17:35:08.126112 [debug] [Thread-4 (]: Using duckdb connection "model.supercell.dim_resource"
[0m17:35:08.127380 [debug] [Thread-4 (]: On model.supercell.dim_resource: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.dim_resource"} */

  
    
    

    create  table
      "supercell"."main"."dim_resource__dbt_tmp"
  
    as (
      


select
    md5(concat(linked_account_id, '_', service_code, '_', instance_type, '_', region, '_', CAST(usage_start_date AS VARCHAR), '_', CAST(usage_end_date AS VARCHAR))) AS resource_id,
    linked_account_id as linked_account_id,
    region,
    service_code as product,
    instance_type as instance_type,
    pricing_model as pricing_model
from "supercell"."main"."cleaned_usagelogs"
    );
  
  
[0m17:35:08.243530 [debug] [Thread-3 (]: SQL status: OK in 0.123 seconds
[0m17:35:08.248417 [debug] [Thread-3 (]: Using duckdb connection "model.supercell.dim_accounts"
[0m17:35:08.249430 [debug] [Thread-3 (]: On model.supercell.dim_accounts: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.dim_accounts"} */
alter table "supercell"."main"."dim_accounts" rename to "dim_accounts__dbt_backup"
[0m17:35:08.250947 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m17:35:08.255417 [debug] [Thread-3 (]: Using duckdb connection "model.supercell.dim_accounts"
[0m17:35:08.256295 [debug] [Thread-3 (]: On model.supercell.dim_accounts: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.dim_accounts"} */
alter table "supercell"."main"."dim_accounts__dbt_tmp" rename to "dim_accounts"
[0m17:35:08.257778 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m17:35:08.260742 [debug] [Thread-3 (]: On model.supercell.dim_accounts: COMMIT
[0m17:35:08.261572 [debug] [Thread-3 (]: Using duckdb connection "model.supercell.dim_accounts"
[0m17:35:08.262192 [debug] [Thread-3 (]: On model.supercell.dim_accounts: COMMIT
[0m17:35:08.266456 [debug] [Thread-3 (]: SQL status: OK in 0.004 seconds
[0m17:35:08.269589 [debug] [Thread-3 (]: Using duckdb connection "model.supercell.dim_accounts"
[0m17:35:08.270318 [debug] [Thread-3 (]: On model.supercell.dim_accounts: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.dim_accounts"} */
drop table if exists "supercell"."main"."dim_accounts__dbt_backup" cascade
[0m17:35:08.272364 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m17:35:08.274549 [debug] [Thread-3 (]: On model.supercell.dim_accounts: Close
[0m17:35:08.279119 [info ] [Thread-3 (]: 2 of 5 OK created sql table model main.dim_accounts ............................ [[32mOK[0m in 0.19s]
[0m17:35:08.280221 [debug] [Thread-3 (]: Finished running node model.supercell.dim_accounts
[0m17:35:08.332341 [debug] [Thread-2 (]: SQL status: OK in 0.205 seconds
[0m17:35:08.334448 [debug] [Thread-2 (]: Using duckdb connection "model.supercell.fact_bill_generation"
[0m17:35:08.334745 [debug] [Thread-2 (]: On model.supercell.fact_bill_generation: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.fact_bill_generation"} */
alter table "supercell"."main"."fact_bill_generation" rename to "fact_bill_generation__dbt_backup"
[0m17:35:08.335353 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m17:35:08.337126 [debug] [Thread-2 (]: Using duckdb connection "model.supercell.fact_bill_generation"
[0m17:35:08.337418 [debug] [Thread-2 (]: On model.supercell.fact_bill_generation: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.fact_bill_generation"} */
alter table "supercell"."main"."fact_bill_generation__dbt_tmp" rename to "fact_bill_generation"
[0m17:35:08.337996 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m17:35:08.339273 [debug] [Thread-2 (]: On model.supercell.fact_bill_generation: COMMIT
[0m17:35:08.339571 [debug] [Thread-2 (]: Using duckdb connection "model.supercell.fact_bill_generation"
[0m17:35:08.339786 [debug] [Thread-2 (]: On model.supercell.fact_bill_generation: COMMIT
[0m17:35:08.351798 [debug] [Thread-2 (]: SQL status: OK in 0.012 seconds
[0m17:35:08.354411 [debug] [Thread-2 (]: Using duckdb connection "model.supercell.fact_bill_generation"
[0m17:35:08.354702 [debug] [Thread-2 (]: On model.supercell.fact_bill_generation: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.fact_bill_generation"} */
drop table if exists "supercell"."main"."fact_bill_generation__dbt_backup" cascade
[0m17:35:08.356413 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m17:35:08.357410 [debug] [Thread-2 (]: On model.supercell.fact_bill_generation: Close
[0m17:35:08.361883 [info ] [Thread-2 (]: 4 of 5 OK created sql table model main.fact_bill_generation .................... [[32mOK[0m in 0.27s]
[0m17:35:08.362379 [debug] [Thread-2 (]: Finished running node model.supercell.fact_bill_generation
[0m17:35:08.418401 [debug] [Thread-4 (]: SQL status: OK in 0.290 seconds
[0m17:35:08.420154 [debug] [Thread-4 (]: Using duckdb connection "model.supercell.dim_resource"
[0m17:35:08.420439 [debug] [Thread-4 (]: On model.supercell.dim_resource: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.dim_resource"} */
alter table "supercell"."main"."dim_resource" rename to "dim_resource__dbt_backup"
[0m17:35:08.420946 [debug] [Thread-4 (]: SQL status: OK in 0.000 seconds
[0m17:35:08.422665 [debug] [Thread-4 (]: Using duckdb connection "model.supercell.dim_resource"
[0m17:35:08.422883 [debug] [Thread-4 (]: On model.supercell.dim_resource: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.dim_resource"} */
alter table "supercell"."main"."dim_resource__dbt_tmp" rename to "dim_resource"
[0m17:35:08.423314 [debug] [Thread-4 (]: SQL status: OK in 0.000 seconds
[0m17:35:08.424294 [debug] [Thread-4 (]: On model.supercell.dim_resource: COMMIT
[0m17:35:08.424511 [debug] [Thread-4 (]: Using duckdb connection "model.supercell.dim_resource"
[0m17:35:08.424691 [debug] [Thread-4 (]: On model.supercell.dim_resource: COMMIT
[0m17:35:08.430036 [debug] [Thread-4 (]: SQL status: OK in 0.005 seconds
[0m17:35:08.431497 [debug] [Thread-4 (]: Using duckdb connection "model.supercell.dim_resource"
[0m17:35:08.431727 [debug] [Thread-4 (]: On model.supercell.dim_resource: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.dim_resource"} */
drop table if exists "supercell"."main"."dim_resource__dbt_backup" cascade
[0m17:35:08.433486 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m17:35:08.434333 [debug] [Thread-4 (]: On model.supercell.dim_resource: Close
[0m17:35:08.436869 [info ] [Thread-4 (]: 3 of 5 OK created sql table model main.dim_resource ............................ [[32mOK[0m in 0.35s]
[0m17:35:08.437214 [debug] [Thread-4 (]: Finished running node model.supercell.dim_resource
[0m17:35:08.437973 [debug] [Thread-1 (]: Began running node model.supercell.total_cost
[0m17:35:08.438346 [info ] [Thread-1 (]: 5 of 5 START sql table model main.total_cost ................................... [RUN]
[0m17:35:08.438660 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.supercell.cleaned_usagelogs, now model.supercell.total_cost)
[0m17:35:08.438869 [debug] [Thread-1 (]: Began compiling node model.supercell.total_cost
[0m17:35:08.441217 [debug] [Thread-1 (]: Writing injected SQL for node "model.supercell.total_cost"
[0m17:35:08.441982 [debug] [Thread-1 (]: Began executing node model.supercell.total_cost
[0m17:35:08.445385 [debug] [Thread-1 (]: Writing runtime sql for node "model.supercell.total_cost"
[0m17:35:08.446464 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.total_cost"
[0m17:35:08.446759 [debug] [Thread-1 (]: On model.supercell.total_cost: BEGIN
[0m17:35:08.446944 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:35:08.447513 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:35:08.447750 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.total_cost"
[0m17:35:08.447973 [debug] [Thread-1 (]: On model.supercell.total_cost: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.total_cost"} */

  
    
    

    create  table
      "supercell"."main"."total_cost__dbt_tmp"
  
    as (
      

with base as (
    select
        fact_bill_generation.resource_id,
        date_trunc('month', fact_bill_generation.bill_date) as month,
        fact_bill_generation.bill_amount,
        dim_resource.instance_type,
        dim_resource.product,
        dim_resource.region,
        dim_resource.pricing_model,
        dim_resource.linked_account_id
    from "supercell"."main"."fact_bill_generation" as fact_bill_generation
    left join "supercell"."main"."dim_resource" as dim_resource
        on fact_bill_generation.resource_id = dim_resource.resource_id
    -- filter to recent records to speed up
    where fact_bill_generation.bill_date >= current_date - interval '6 months'
),
joined as (
    select
        base.*,
        dim_accounts.linked_account_id,  -- only if needed
        dim_accounts.tag_keys as tag_keys,
        dim_accounts.tag_values as tag_values
    from base
    left join "supercell"."main"."dim_accounts" as dim_accounts
        on base.linked_account_id = dim_accounts.linked_account_id
)

select
    month,
    sum(bill_amount) as total_cost,
    instance_type,
    product,
    region,
    pricing_model,
    tag_keys,
    tag_values
from joined
group by
    month,
    instance_type,
    product,
    region,
    pricing_model,
    tag_keys,
    tag_values
order by
    month,
    instance_type,
    product,
    region,
    pricing_model,
    tag_keys,
    tag_values
    );
  
  
[0m17:35:08.475641 [debug] [Thread-1 (]: SQL status: OK in 0.027 seconds
[0m17:35:08.477825 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.total_cost"
[0m17:35:08.478141 [debug] [Thread-1 (]: On model.supercell.total_cost: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.total_cost"} */
alter table "supercell"."main"."total_cost" rename to "total_cost__dbt_backup"
[0m17:35:08.478730 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:35:08.480370 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.total_cost"
[0m17:35:08.480572 [debug] [Thread-1 (]: On model.supercell.total_cost: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.total_cost"} */
alter table "supercell"."main"."total_cost__dbt_tmp" rename to "total_cost"
[0m17:35:08.480956 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:35:08.481983 [debug] [Thread-1 (]: On model.supercell.total_cost: COMMIT
[0m17:35:08.482221 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.total_cost"
[0m17:35:08.482411 [debug] [Thread-1 (]: On model.supercell.total_cost: COMMIT
[0m17:35:08.484045 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:35:08.485240 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.total_cost"
[0m17:35:08.485451 [debug] [Thread-1 (]: On model.supercell.total_cost: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.total_cost"} */
drop table if exists "supercell"."main"."total_cost__dbt_backup" cascade
[0m17:35:08.486886 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:35:08.487642 [debug] [Thread-1 (]: On model.supercell.total_cost: Close
[0m17:35:08.489857 [info ] [Thread-1 (]: 5 of 5 OK created sql table model main.total_cost .............................. [[32mOK[0m in 0.05s]
[0m17:35:08.490209 [debug] [Thread-1 (]: Finished running node model.supercell.total_cost
[0m17:35:08.491479 [debug] [MainThread]: Using duckdb connection "master"
[0m17:35:08.491790 [debug] [MainThread]: On master: BEGIN
[0m17:35:08.492021 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:35:08.493102 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m17:35:08.493535 [debug] [MainThread]: On master: COMMIT
[0m17:35:08.493744 [debug] [MainThread]: Using duckdb connection "master"
[0m17:35:08.493917 [debug] [MainThread]: On master: COMMIT
[0m17:35:08.494393 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:35:08.494638 [debug] [MainThread]: On master: Close
[0m17:35:08.495053 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:35:08.495347 [debug] [MainThread]: Connection 'model.supercell.total_cost' was properly closed.
[0m17:35:08.495539 [debug] [MainThread]: Connection 'model.supercell.dim_accounts' was properly closed.
[0m17:35:08.495708 [debug] [MainThread]: Connection 'model.supercell.dim_resource' was properly closed.
[0m17:35:08.495882 [debug] [MainThread]: Connection 'model.supercell.fact_bill_generation' was properly closed.
[0m17:35:08.496238 [info ] [MainThread]: 
[0m17:35:08.496500 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 0.87 seconds (0.87s).
[0m17:35:08.497109 [debug] [MainThread]: Command end result
[0m17:35:08.551425 [debug] [MainThread]: Wrote artifact WritableManifest to /home/harsha/data_actions/supercell_cloudops/target/manifest.json
[0m17:35:08.552391 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/harsha/data_actions/supercell_cloudops/target/semantic_manifest.json
[0m17:35:08.555608 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/harsha/data_actions/supercell_cloudops/target/run_results.json
[0m17:35:08.555807 [info ] [MainThread]: 
[0m17:35:08.556010 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:35:08.556199 [info ] [MainThread]: 
[0m17:35:08.556392 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m17:35:08.556999 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.4715357, "process_in_blocks": "0", "process_kernel_time": 0.40341, "process_mem_max_rss": "344964", "process_out_blocks": "59240", "process_user_time": 4.498273}
[0m17:35:08.557335 [debug] [MainThread]: Command `dbt run` succeeded at 17:35:08.557262 after 1.47 seconds
[0m17:35:08.557540 [debug] [MainThread]: Flushing usage events


============================== 17:36:15.522316 | a6b4afbd-2ab6-4de7-bdf9-adfa72681771 ==============================
[0m17:36:15.522316 [info ] [MainThread]: Running with dbt=1.9.4
[0m17:36:15.524363 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/harsha/data_actions/supercell_cloudops', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/harsha/data_actions/supercell_cloudops/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'False'}
[0m17:36:15.524594 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality

User config should be moved from the 'config' key in profiles.yml to the 'flags' key in dbt_project.yml.
[0m17:36:15.676778 [info ] [MainThread]: Registered adapter: duckdb=1.9.3
[0m17:36:15.714692 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m17:36:15.753998 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:36:15.754394 [debug] [MainThread]: Partial parsing: updated file: supercell://models/supercell_models/metrics/total_cost.sql
[0m17:36:15.888836 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.supercell.example
[0m17:36:15.921417 [debug] [MainThread]: Wrote artifact WritableManifest to /home/harsha/data_actions/supercell_cloudops/target/manifest.json
[0m17:36:15.922458 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/harsha/data_actions/supercell_cloudops/target/semantic_manifest.json
[0m17:36:15.929547 [info ] [MainThread]: Found 5 models, 428 macros
[0m17:36:15.930898 [info ] [MainThread]: 
[0m17:36:15.931310 [info ] [MainThread]: Concurrency: 4 threads (target='default')
[0m17:36:15.931524 [info ] [MainThread]: 
[0m17:36:15.931856 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m17:36:15.935695 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_supercell'
[0m17:36:15.955538 [debug] [ThreadPool]: Using duckdb connection "list_supercell"
[0m17:36:15.955841 [debug] [ThreadPool]: On list_supercell: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "connection_name": "list_supercell"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"supercell"'
    
  
  
[0m17:36:15.956024 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:36:15.964743 [debug] [ThreadPool]: SQL status: OK in 0.009 seconds
[0m17:36:15.965715 [debug] [ThreadPool]: On list_supercell: Close
[0m17:36:15.966371 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_supercell, now create_supercell_main)
[0m17:36:15.966678 [debug] [ThreadPool]: Creating schema "database: "supercell"
schema: "main"
"
[0m17:36:15.970515 [debug] [ThreadPool]: Using duckdb connection "create_supercell_main"
[0m17:36:15.970739 [debug] [ThreadPool]: On create_supercell_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "connection_name": "create_supercell_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='supercell'
        and type='sqlite'
    
  
[0m17:36:15.970904 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:36:15.971525 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m17:36:15.972247 [debug] [ThreadPool]: Using duckdb connection "create_supercell_main"
[0m17:36:15.972454 [debug] [ThreadPool]: On create_supercell_main: BEGIN
[0m17:36:15.972734 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:36:15.972909 [debug] [ThreadPool]: Using duckdb connection "create_supercell_main"
[0m17:36:15.973047 [debug] [ThreadPool]: On create_supercell_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "connection_name": "create_supercell_main"} */

    
    
        create schema if not exists "supercell"."main"
    
[0m17:36:15.973359 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:36:15.973833 [debug] [ThreadPool]: On create_supercell_main: COMMIT
[0m17:36:15.974009 [debug] [ThreadPool]: Using duckdb connection "create_supercell_main"
[0m17:36:15.974162 [debug] [ThreadPool]: On create_supercell_main: COMMIT
[0m17:36:15.974422 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:36:15.974605 [debug] [ThreadPool]: On create_supercell_main: Close
[0m17:36:15.975786 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_supercell_main, now list_supercell_main)
[0m17:36:15.981022 [debug] [ThreadPool]: Using duckdb connection "list_supercell_main"
[0m17:36:15.981445 [debug] [ThreadPool]: On list_supercell_main: BEGIN
[0m17:36:15.981730 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:36:15.982403 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m17:36:15.982717 [debug] [ThreadPool]: Using duckdb connection "list_supercell_main"
[0m17:36:15.983002 [debug] [ThreadPool]: On list_supercell_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "connection_name": "list_supercell_main"} */
select
      'supercell' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'supercell'
  
[0m17:36:15.993519 [debug] [ThreadPool]: SQL status: OK in 0.010 seconds
[0m17:36:15.994375 [debug] [ThreadPool]: On list_supercell_main: ROLLBACK
[0m17:36:15.995073 [debug] [ThreadPool]: Failed to rollback 'list_supercell_main'
[0m17:36:15.995291 [debug] [ThreadPool]: On list_supercell_main: Close
[0m17:36:15.997130 [debug] [MainThread]: Using duckdb connection "master"
[0m17:36:15.997561 [debug] [MainThread]: On master: BEGIN
[0m17:36:15.997853 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:36:15.998508 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m17:36:15.998825 [debug] [MainThread]: On master: COMMIT
[0m17:36:15.999106 [debug] [MainThread]: Using duckdb connection "master"
[0m17:36:15.999423 [debug] [MainThread]: On master: COMMIT
[0m17:36:15.999736 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:36:15.999921 [debug] [MainThread]: On master: Close
[0m17:36:16.001657 [debug] [Thread-1 (]: Began running node model.supercell.cleaned_usagelogs
[0m17:36:16.002211 [info ] [Thread-1 (]: 1 of 5 START sql table model main.cleaned_usagelogs ............................ [RUN]
[0m17:36:16.002669 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_supercell_main, now model.supercell.cleaned_usagelogs)
[0m17:36:16.003031 [debug] [Thread-1 (]: Began compiling node model.supercell.cleaned_usagelogs
[0m17:36:16.010453 [debug] [Thread-1 (]: Writing injected SQL for node "model.supercell.cleaned_usagelogs"
[0m17:36:16.011132 [debug] [Thread-1 (]: Began executing node model.supercell.cleaned_usagelogs
[0m17:36:16.030223 [debug] [Thread-1 (]: Writing runtime sql for node "model.supercell.cleaned_usagelogs"
[0m17:36:16.030795 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.cleaned_usagelogs"
[0m17:36:16.031056 [debug] [Thread-1 (]: On model.supercell.cleaned_usagelogs: BEGIN
[0m17:36:16.031240 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:36:16.031837 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:36:16.032038 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.cleaned_usagelogs"
[0m17:36:16.032229 [debug] [Thread-1 (]: On model.supercell.cleaned_usagelogs: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.cleaned_usagelogs"} */

  
    
    

    create  table
      "supercell"."main"."cleaned_usagelogs__dbt_tmp"
  
    as (
      


SELECT
    CAST("LinkedAccountId" AS VARCHAR) AS linked_account_id,
    CAST("bill/PayerAccountId" AS VARCHAR) AS payer_account_id,
    CAST("lineItem/UsageStartDate" AS TIMESTAMP) AS usage_start_date,
    CAST("lineItem/UsageEndDate" AS TIMESTAMP) AS usage_end_date,
    CAST("lineItem/UsageAmount" AS DECIMAL(18, 6)) AS usage_amount,
    CAST("lineItem/Operation" AS VARCHAR) AS operation,
    CAST("pricing/PricingModel" AS VARCHAR) AS pricing_model,
    CAST("resourceTags/TagKeys" AS VARCHAR) AS tag_keys,
    CAST("resourceTags/TagValues" AS VARCHAR) AS tag_values,
    CAST("product/Region" AS VARCHAR) AS region,
    CAST("product/ServiceCode" AS VARCHAR) AS service_code,
    CAST("product/InstanceType" AS VARCHAR) AS instance_type,
    CAST("amortized_cost" AS DECIMAL(18, 6)) AS amortized_cost,
    CAST("product/Description" AS VARCHAR) AS description
FROM supercell_usagelogs
    );
  
  
[0m17:36:16.299443 [debug] [Thread-1 (]: SQL status: OK in 0.267 seconds
[0m17:36:16.303271 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.cleaned_usagelogs"
[0m17:36:16.303549 [debug] [Thread-1 (]: On model.supercell.cleaned_usagelogs: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.cleaned_usagelogs"} */
alter table "supercell"."main"."cleaned_usagelogs" rename to "cleaned_usagelogs__dbt_backup"
[0m17:36:16.304116 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:36:16.305729 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.cleaned_usagelogs"
[0m17:36:16.305950 [debug] [Thread-1 (]: On model.supercell.cleaned_usagelogs: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.cleaned_usagelogs"} */
alter table "supercell"."main"."cleaned_usagelogs__dbt_tmp" rename to "cleaned_usagelogs"
[0m17:36:16.306388 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:36:16.315695 [debug] [Thread-1 (]: On model.supercell.cleaned_usagelogs: COMMIT
[0m17:36:16.316007 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.cleaned_usagelogs"
[0m17:36:16.316244 [debug] [Thread-1 (]: On model.supercell.cleaned_usagelogs: COMMIT
[0m17:36:16.327397 [debug] [Thread-1 (]: SQL status: OK in 0.011 seconds
[0m17:36:16.330668 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.cleaned_usagelogs"
[0m17:36:16.331006 [debug] [Thread-1 (]: On model.supercell.cleaned_usagelogs: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.cleaned_usagelogs"} */
drop table if exists "supercell"."main"."cleaned_usagelogs__dbt_backup" cascade
[0m17:36:16.333371 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m17:36:16.334919 [debug] [Thread-1 (]: On model.supercell.cleaned_usagelogs: Close
[0m17:36:16.339309 [info ] [Thread-1 (]: 1 of 5 OK created sql table model main.cleaned_usagelogs ....................... [[32mOK[0m in 0.34s]
[0m17:36:16.339734 [debug] [Thread-1 (]: Finished running node model.supercell.cleaned_usagelogs
[0m17:36:16.340706 [debug] [Thread-3 (]: Began running node model.supercell.dim_accounts
[0m17:36:16.341312 [debug] [Thread-4 (]: Began running node model.supercell.dim_resource
[0m17:36:16.342067 [info ] [Thread-3 (]: 2 of 5 START sql table model main.dim_accounts ................................. [RUN]
[0m17:36:16.342751 [info ] [Thread-4 (]: 3 of 5 START sql table model main.dim_resource ................................. [RUN]
[0m17:36:16.343294 [debug] [Thread-2 (]: Began running node model.supercell.fact_bill_generation
[0m17:36:16.344164 [debug] [Thread-3 (]: Acquiring new duckdb connection 'model.supercell.dim_accounts'
[0m17:36:16.345174 [debug] [Thread-4 (]: Acquiring new duckdb connection 'model.supercell.dim_resource'
[0m17:36:16.345851 [info ] [Thread-2 (]: 4 of 5 START sql table model main.fact_bill_generation ......................... [RUN]
[0m17:36:16.346664 [debug] [Thread-3 (]: Began compiling node model.supercell.dim_accounts
[0m17:36:16.347497 [debug] [Thread-4 (]: Began compiling node model.supercell.dim_resource
[0m17:36:16.348466 [debug] [Thread-2 (]: Acquiring new duckdb connection 'model.supercell.fact_bill_generation'
[0m17:36:16.353281 [debug] [Thread-3 (]: Writing injected SQL for node "model.supercell.dim_accounts"
[0m17:36:16.356837 [debug] [Thread-4 (]: Writing injected SQL for node "model.supercell.dim_resource"
[0m17:36:16.357522 [debug] [Thread-2 (]: Began compiling node model.supercell.fact_bill_generation
[0m17:36:16.358372 [debug] [Thread-3 (]: Began executing node model.supercell.dim_accounts
[0m17:36:16.358873 [debug] [Thread-4 (]: Began executing node model.supercell.dim_resource
[0m17:36:16.362025 [debug] [Thread-2 (]: Writing injected SQL for node "model.supercell.fact_bill_generation"
[0m17:36:16.364919 [debug] [Thread-3 (]: Writing runtime sql for node "model.supercell.dim_accounts"
[0m17:36:16.366780 [debug] [Thread-4 (]: Writing runtime sql for node "model.supercell.dim_resource"
[0m17:36:16.367602 [debug] [Thread-2 (]: Began executing node model.supercell.fact_bill_generation
[0m17:36:16.368154 [debug] [Thread-3 (]: Using duckdb connection "model.supercell.dim_accounts"
[0m17:36:16.370289 [debug] [Thread-2 (]: Writing runtime sql for node "model.supercell.fact_bill_generation"
[0m17:36:16.370715 [debug] [Thread-4 (]: Using duckdb connection "model.supercell.dim_resource"
[0m17:36:16.371038 [debug] [Thread-3 (]: On model.supercell.dim_accounts: BEGIN
[0m17:36:16.371554 [debug] [Thread-2 (]: Using duckdb connection "model.supercell.fact_bill_generation"
[0m17:36:16.371862 [debug] [Thread-4 (]: On model.supercell.dim_resource: BEGIN
[0m17:36:16.372168 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m17:36:16.372595 [debug] [Thread-2 (]: On model.supercell.fact_bill_generation: BEGIN
[0m17:36:16.372890 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m17:36:16.373397 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m17:36:16.373864 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m17:36:16.374659 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m17:36:16.375062 [debug] [Thread-3 (]: Using duckdb connection "model.supercell.dim_accounts"
[0m17:36:16.375691 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m17:36:16.376087 [debug] [Thread-4 (]: Using duckdb connection "model.supercell.dim_resource"
[0m17:36:16.376515 [debug] [Thread-3 (]: On model.supercell.dim_accounts: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.dim_accounts"} */

  
    
    

    create  table
      "supercell"."main"."dim_accounts__dbt_tmp"
  
    as (
      


select
    linked_account_id as linked_account_id,
    tag_keys as tag_keys,
    tag_values as tag_values
from "supercell"."main"."cleaned_usagelogs"
    );
  
  
[0m17:36:16.376910 [debug] [Thread-2 (]: Using duckdb connection "model.supercell.fact_bill_generation"
[0m17:36:16.377216 [debug] [Thread-4 (]: On model.supercell.dim_resource: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.dim_resource"} */

  
    
    

    create  table
      "supercell"."main"."dim_resource__dbt_tmp"
  
    as (
      


select
    md5(concat(linked_account_id, '_', service_code, '_', instance_type, '_', region, '_', CAST(usage_start_date AS VARCHAR), '_', CAST(usage_end_date AS VARCHAR))) AS resource_id,
    linked_account_id as linked_account_id,
    region,
    service_code as product,
    instance_type as instance_type,
    pricing_model as pricing_model
from "supercell"."main"."cleaned_usagelogs"
    );
  
  
[0m17:36:16.378954 [debug] [Thread-2 (]: On model.supercell.fact_bill_generation: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.fact_bill_generation"} */

  
    
    

    create  table
      "supercell"."main"."fact_bill_generation__dbt_tmp"
  
    as (
      


select
    md5(concat(linked_account_id, '_', service_code, '_', instance_type, '_', region, '_', CAST(usage_start_date AS VARCHAR), '_', CAST(usage_end_date AS VARCHAR))) AS resource_id,
    usage_start_date as start_date,
    usage_end_date as bill_date,
    usage_amount as bill_amount,
    operation
from "supercell"."main"."cleaned_usagelogs"
    );
  
  
[0m17:36:16.489824 [debug] [Thread-3 (]: SQL status: OK in 0.112 seconds
[0m17:36:16.493682 [debug] [Thread-3 (]: Using duckdb connection "model.supercell.dim_accounts"
[0m17:36:16.494331 [debug] [Thread-3 (]: On model.supercell.dim_accounts: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.dim_accounts"} */
alter table "supercell"."main"."dim_accounts" rename to "dim_accounts__dbt_backup"
[0m17:36:16.495444 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m17:36:16.498877 [debug] [Thread-3 (]: Using duckdb connection "model.supercell.dim_accounts"
[0m17:36:16.499597 [debug] [Thread-3 (]: On model.supercell.dim_accounts: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.dim_accounts"} */
alter table "supercell"."main"."dim_accounts__dbt_tmp" rename to "dim_accounts"
[0m17:36:16.500673 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m17:36:16.502586 [debug] [Thread-3 (]: On model.supercell.dim_accounts: COMMIT
[0m17:36:16.503088 [debug] [Thread-3 (]: Using duckdb connection "model.supercell.dim_accounts"
[0m17:36:16.503540 [debug] [Thread-3 (]: On model.supercell.dim_accounts: COMMIT
[0m17:36:16.516256 [debug] [Thread-3 (]: SQL status: OK in 0.012 seconds
[0m17:36:16.519668 [debug] [Thread-3 (]: Using duckdb connection "model.supercell.dim_accounts"
[0m17:36:16.520056 [debug] [Thread-3 (]: On model.supercell.dim_accounts: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.dim_accounts"} */
drop table if exists "supercell"."main"."dim_accounts__dbt_backup" cascade
[0m17:36:16.521897 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m17:36:16.523494 [debug] [Thread-3 (]: On model.supercell.dim_accounts: Close
[0m17:36:16.528924 [info ] [Thread-3 (]: 2 of 5 OK created sql table model main.dim_accounts ............................ [[32mOK[0m in 0.18s]
[0m17:36:16.529772 [debug] [Thread-3 (]: Finished running node model.supercell.dim_accounts
[0m17:36:16.549312 [debug] [Thread-2 (]: SQL status: OK in 0.169 seconds
[0m17:36:16.551426 [debug] [Thread-2 (]: Using duckdb connection "model.supercell.fact_bill_generation"
[0m17:36:16.551730 [debug] [Thread-2 (]: On model.supercell.fact_bill_generation: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.fact_bill_generation"} */
alter table "supercell"."main"."fact_bill_generation" rename to "fact_bill_generation__dbt_backup"
[0m17:36:16.552345 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m17:36:16.554031 [debug] [Thread-2 (]: Using duckdb connection "model.supercell.fact_bill_generation"
[0m17:36:16.554289 [debug] [Thread-2 (]: On model.supercell.fact_bill_generation: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.fact_bill_generation"} */
alter table "supercell"."main"."fact_bill_generation__dbt_tmp" rename to "fact_bill_generation"
[0m17:36:16.554736 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m17:36:16.555872 [debug] [Thread-2 (]: On model.supercell.fact_bill_generation: COMMIT
[0m17:36:16.556124 [debug] [Thread-2 (]: Using duckdb connection "model.supercell.fact_bill_generation"
[0m17:36:16.556347 [debug] [Thread-2 (]: On model.supercell.fact_bill_generation: COMMIT
[0m17:36:16.564578 [debug] [Thread-2 (]: SQL status: OK in 0.008 seconds
[0m17:36:16.567552 [debug] [Thread-2 (]: Using duckdb connection "model.supercell.fact_bill_generation"
[0m17:36:16.567843 [debug] [Thread-2 (]: On model.supercell.fact_bill_generation: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.fact_bill_generation"} */
drop table if exists "supercell"."main"."fact_bill_generation__dbt_backup" cascade
[0m17:36:16.569387 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m17:36:16.570387 [debug] [Thread-2 (]: On model.supercell.fact_bill_generation: Close
[0m17:36:16.572787 [info ] [Thread-2 (]: 4 of 5 OK created sql table model main.fact_bill_generation .................... [[32mOK[0m in 0.22s]
[0m17:36:16.573210 [debug] [Thread-2 (]: Finished running node model.supercell.fact_bill_generation
[0m17:36:16.647157 [debug] [Thread-4 (]: SQL status: OK in 0.267 seconds
[0m17:36:16.649197 [debug] [Thread-4 (]: Using duckdb connection "model.supercell.dim_resource"
[0m17:36:16.649499 [debug] [Thread-4 (]: On model.supercell.dim_resource: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.dim_resource"} */
alter table "supercell"."main"."dim_resource" rename to "dim_resource__dbt_backup"
[0m17:36:16.650146 [debug] [Thread-4 (]: SQL status: OK in 0.000 seconds
[0m17:36:16.651764 [debug] [Thread-4 (]: Using duckdb connection "model.supercell.dim_resource"
[0m17:36:16.651987 [debug] [Thread-4 (]: On model.supercell.dim_resource: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.dim_resource"} */
alter table "supercell"."main"."dim_resource__dbt_tmp" rename to "dim_resource"
[0m17:36:16.652388 [debug] [Thread-4 (]: SQL status: OK in 0.000 seconds
[0m17:36:16.653314 [debug] [Thread-4 (]: On model.supercell.dim_resource: COMMIT
[0m17:36:16.653527 [debug] [Thread-4 (]: Using duckdb connection "model.supercell.dim_resource"
[0m17:36:16.653731 [debug] [Thread-4 (]: On model.supercell.dim_resource: COMMIT
[0m17:36:16.658460 [debug] [Thread-4 (]: SQL status: OK in 0.004 seconds
[0m17:36:16.659692 [debug] [Thread-4 (]: Using duckdb connection "model.supercell.dim_resource"
[0m17:36:16.659907 [debug] [Thread-4 (]: On model.supercell.dim_resource: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.dim_resource"} */
drop table if exists "supercell"."main"."dim_resource__dbt_backup" cascade
[0m17:36:16.661463 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m17:36:16.662358 [debug] [Thread-4 (]: On model.supercell.dim_resource: Close
[0m17:36:16.664984 [info ] [Thread-4 (]: 3 of 5 OK created sql table model main.dim_resource ............................ [[32mOK[0m in 0.32s]
[0m17:36:16.665506 [debug] [Thread-4 (]: Finished running node model.supercell.dim_resource
[0m17:36:16.666078 [debug] [Thread-1 (]: Began running node model.supercell.total_cost
[0m17:36:16.667006 [info ] [Thread-1 (]: 5 of 5 START sql table model main.total_cost ................................... [RUN]
[0m17:36:16.667511 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.supercell.cleaned_usagelogs, now model.supercell.total_cost)
[0m17:36:16.667796 [debug] [Thread-1 (]: Began compiling node model.supercell.total_cost
[0m17:36:16.670214 [debug] [Thread-1 (]: Writing injected SQL for node "model.supercell.total_cost"
[0m17:36:16.670913 [debug] [Thread-1 (]: Began executing node model.supercell.total_cost
[0m17:36:16.673452 [debug] [Thread-1 (]: Writing runtime sql for node "model.supercell.total_cost"
[0m17:36:16.674458 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.total_cost"
[0m17:36:16.674763 [debug] [Thread-1 (]: On model.supercell.total_cost: BEGIN
[0m17:36:16.674995 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:36:16.675626 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:36:16.675875 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.total_cost"
[0m17:36:16.676104 [debug] [Thread-1 (]: On model.supercell.total_cost: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.total_cost"} */

  
    
    

    create  table
      "supercell"."main"."total_cost__dbt_tmp"
  
    as (
      

with base as (
    select
        fact_bill_generation.resource_id,
        date_trunc('month', fact_bill_generation.bill_date) as month,
        fact_bill_generation.bill_amount,
        dim_resource.instance_type,
        dim_resource.product,
        dim_resource.region,
        dim_resource.pricing_model,
        dim_resource.linked_account_id
    from "supercell"."main"."fact_bill_generation" as fact_bill_generation
    left join "supercell"."main"."dim_resource" as dim_resource
        on fact_bill_generation.resource_id = dim_resource.resource_id
    -- filter to recent records to speed up
    where fact_bill_generation.bill_date >= current_date - interval '6 months'
),
joined as (
    select
        base.*,
        dim_accounts.linked_account_id,  -- only if needed
        -- dim_accounts.tag_keys as tag_keys,
        -- dim_accounts.tag_values as tag_values
    from base
    left join "supercell"."main"."dim_accounts" as dim_accounts
        on base.linked_account_id = dim_accounts.linked_account_id
)

select
    month,
    sum(bill_amount) as total_cost,
    instance_type,
    product,
    region,
    pricing_model,
    -- tag_keys,
    -- tag_values
from joined
group by
    month,
    instance_type,
    product,
    region,
    pricing_model,
    tag_keys,
    tag_values
order by
    month,
    instance_type,
    product,
    region,
    pricing_model,
    -- tag_keys,
    -- tag_values
    );
  
  
[0m17:36:16.676649 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.total_cost"} */

  
    
    

    create  table
      "supercell"."main"."total_cost__dbt_tmp"
  
    as (
      

with base as (
    select
        fact_bill_generation.resource_id,
        date_trunc('month', fact_bill_generation.bill_date) as month,
        fact_bill_generation.bill_amount,
        dim_resource.instance_type,
        dim_resource.product,
        dim_resource.region,
        dim_resource.pricing_model,
        dim_resource.linked_account_id
    from "supercell"."main"."fact_bill_generation" as fact_bill_generation
    left join "supercell"."main"."dim_resource" as dim_resource
        on fact_bill_generation.resource_id = dim_resource.resource_id
    -- filter to recent records to speed up
    where fact_bill_generation.bill_date >= current_date - interval '6 months'
),
joined as (
    select
        base.*,
        dim_accounts.linked_account_id,  -- only if needed
        -- dim_accounts.tag_keys as tag_keys,
        -- dim_accounts.tag_values as tag_values
    from base
    left join "supercell"."main"."dim_accounts" as dim_accounts
        on base.linked_account_id = dim_accounts.linked_account_id
)

select
    month,
    sum(bill_amount) as total_cost,
    instance_type,
    product,
    region,
    pricing_model,
    -- tag_keys,
    -- tag_values
from joined
group by
    month,
    instance_type,
    product,
    region,
    pricing_model,
    tag_keys,
    tag_values
order by
    month,
    instance_type,
    product,
    region,
    pricing_model,
    -- tag_keys,
    -- tag_values
    );
  
  
[0m17:36:16.676931 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m17:36:16.677258 [debug] [Thread-1 (]: On model.supercell.total_cost: ROLLBACK
[0m17:36:16.679650 [debug] [Thread-1 (]: Failed to rollback 'model.supercell.total_cost'
[0m17:36:16.680341 [debug] [Thread-1 (]: On model.supercell.total_cost: Close
[0m17:36:16.682309 [debug] [Thread-1 (]: Runtime Error in model total_cost (models/supercell_models/metrics/total_cost.sql)
  Parser Error: syntax error at or near ")"
[0m17:36:16.682825 [error] [Thread-1 (]: 5 of 5 ERROR creating sql table model main.total_cost .......................... [[31mERROR[0m in 0.02s]
[0m17:36:16.683188 [debug] [Thread-1 (]: Finished running node model.supercell.total_cost
[0m17:36:16.683693 [debug] [Thread-7 (]: Marking all children of 'model.supercell.total_cost' to be skipped because of status 'error'.  Reason: Runtime Error in model total_cost (models/supercell_models/metrics/total_cost.sql)
  Parser Error: syntax error at or near ")".
[0m17:36:16.685843 [debug] [MainThread]: Using duckdb connection "master"
[0m17:36:16.686288 [debug] [MainThread]: On master: BEGIN
[0m17:36:16.686570 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:36:16.687204 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m17:36:16.687485 [debug] [MainThread]: On master: COMMIT
[0m17:36:16.687755 [debug] [MainThread]: Using duckdb connection "master"
[0m17:36:16.687993 [debug] [MainThread]: On master: COMMIT
[0m17:36:16.688377 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:36:16.688580 [debug] [MainThread]: On master: Close
[0m17:36:16.688901 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:36:16.689087 [debug] [MainThread]: Connection 'model.supercell.total_cost' was properly closed.
[0m17:36:16.689258 [debug] [MainThread]: Connection 'model.supercell.dim_accounts' was properly closed.
[0m17:36:16.689423 [debug] [MainThread]: Connection 'model.supercell.dim_resource' was properly closed.
[0m17:36:16.689569 [debug] [MainThread]: Connection 'model.supercell.fact_bill_generation' was properly closed.
[0m17:36:16.689796 [info ] [MainThread]: 
[0m17:36:16.690030 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 0.76 seconds (0.76s).
[0m17:36:16.690806 [debug] [MainThread]: Command end result
[0m17:36:16.701314 [debug] [MainThread]: Wrote artifact WritableManifest to /home/harsha/data_actions/supercell_cloudops/target/manifest.json
[0m17:36:16.702462 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/harsha/data_actions/supercell_cloudops/target/semantic_manifest.json
[0m17:36:16.706203 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/harsha/data_actions/supercell_cloudops/target/run_results.json
[0m17:36:16.706436 [info ] [MainThread]: 
[0m17:36:16.706662 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m17:36:16.706853 [info ] [MainThread]: 
[0m17:36:16.707076 [error] [MainThread]:   Runtime Error in model total_cost (models/supercell_models/metrics/total_cost.sql)
  Parser Error: syntax error at or near ")"
[0m17:36:16.707275 [info ] [MainThread]: 
[0m17:36:16.707467 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
[0m17:36:16.708062 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.2160517, "process_in_blocks": "0", "process_kernel_time": 0.355519, "process_mem_max_rss": "360384", "process_out_blocks": "59712", "process_user_time": 3.995596}
[0m17:36:16.708527 [debug] [MainThread]: Command `dbt run` failed at 17:36:16.708435 after 1.22 seconds
[0m17:36:16.708914 [debug] [MainThread]: Flushing usage events


============================== 17:36:36.431817 | 258d43f1-5be8-4cb6-8969-9a5d00e83b19 ==============================
[0m17:36:36.431817 [info ] [MainThread]: Running with dbt=1.9.4
[0m17:36:36.435051 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/harsha/data_actions/supercell_cloudops', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/harsha/data_actions/supercell_cloudops/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'invocation_command': 'dbt run', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'False'}
[0m17:36:36.435524 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality

User config should be moved from the 'config' key in profiles.yml to the 'flags' key in dbt_project.yml.
[0m17:36:36.596205 [info ] [MainThread]: Registered adapter: duckdb=1.9.3
[0m17:36:36.633364 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m17:36:36.672946 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:36:36.673340 [debug] [MainThread]: Partial parsing: updated file: supercell://models/supercell_models/metrics/total_cost.sql
[0m17:36:36.810488 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.supercell.example
[0m17:36:36.842395 [debug] [MainThread]: Wrote artifact WritableManifest to /home/harsha/data_actions/supercell_cloudops/target/manifest.json
[0m17:36:36.843447 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/harsha/data_actions/supercell_cloudops/target/semantic_manifest.json
[0m17:36:36.850233 [info ] [MainThread]: Found 5 models, 428 macros
[0m17:36:36.851376 [info ] [MainThread]: 
[0m17:36:36.851682 [info ] [MainThread]: Concurrency: 4 threads (target='default')
[0m17:36:36.851865 [info ] [MainThread]: 
[0m17:36:36.852181 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m17:36:36.855992 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_supercell'
[0m17:36:36.879982 [debug] [ThreadPool]: Using duckdb connection "list_supercell"
[0m17:36:36.880291 [debug] [ThreadPool]: On list_supercell: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "connection_name": "list_supercell"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"supercell"'
    
  
  
[0m17:36:36.880479 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:36:36.888725 [debug] [ThreadPool]: SQL status: OK in 0.008 seconds
[0m17:36:36.889630 [debug] [ThreadPool]: On list_supercell: Close
[0m17:36:36.890201 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_supercell, now create_supercell_main)
[0m17:36:36.890503 [debug] [ThreadPool]: Creating schema "database: "supercell"
schema: "main"
"
[0m17:36:36.894622 [debug] [ThreadPool]: Using duckdb connection "create_supercell_main"
[0m17:36:36.894887 [debug] [ThreadPool]: On create_supercell_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "connection_name": "create_supercell_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='supercell'
        and type='sqlite'
    
  
[0m17:36:36.895067 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:36:36.895796 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m17:36:36.896602 [debug] [ThreadPool]: Using duckdb connection "create_supercell_main"
[0m17:36:36.896793 [debug] [ThreadPool]: On create_supercell_main: BEGIN
[0m17:36:36.897078 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:36:36.897269 [debug] [ThreadPool]: Using duckdb connection "create_supercell_main"
[0m17:36:36.897433 [debug] [ThreadPool]: On create_supercell_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "connection_name": "create_supercell_main"} */

    
    
        create schema if not exists "supercell"."main"
    
[0m17:36:36.897734 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:36:36.898330 [debug] [ThreadPool]: On create_supercell_main: COMMIT
[0m17:36:36.898525 [debug] [ThreadPool]: Using duckdb connection "create_supercell_main"
[0m17:36:36.898682 [debug] [ThreadPool]: On create_supercell_main: COMMIT
[0m17:36:36.898957 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:36:36.899129 [debug] [ThreadPool]: On create_supercell_main: Close
[0m17:36:36.900065 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_supercell_main, now list_supercell_main)
[0m17:36:36.903312 [debug] [ThreadPool]: Using duckdb connection "list_supercell_main"
[0m17:36:36.903510 [debug] [ThreadPool]: On list_supercell_main: BEGIN
[0m17:36:36.903664 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:36:36.904019 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:36:36.904227 [debug] [ThreadPool]: Using duckdb connection "list_supercell_main"
[0m17:36:36.904380 [debug] [ThreadPool]: On list_supercell_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "connection_name": "list_supercell_main"} */
select
      'supercell' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'supercell'
  
[0m17:36:36.912461 [debug] [ThreadPool]: SQL status: OK in 0.008 seconds
[0m17:36:36.913435 [debug] [ThreadPool]: On list_supercell_main: ROLLBACK
[0m17:36:36.914072 [debug] [ThreadPool]: Failed to rollback 'list_supercell_main'
[0m17:36:36.914304 [debug] [ThreadPool]: On list_supercell_main: Close
[0m17:36:36.915349 [debug] [MainThread]: Using duckdb connection "master"
[0m17:36:36.915539 [debug] [MainThread]: On master: BEGIN
[0m17:36:36.915700 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:36:36.916210 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:36:36.916421 [debug] [MainThread]: On master: COMMIT
[0m17:36:36.916634 [debug] [MainThread]: Using duckdb connection "master"
[0m17:36:36.916798 [debug] [MainThread]: On master: COMMIT
[0m17:36:36.917085 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:36:36.917279 [debug] [MainThread]: On master: Close
[0m17:36:36.919006 [debug] [Thread-1 (]: Began running node model.supercell.cleaned_usagelogs
[0m17:36:36.919551 [info ] [Thread-1 (]: 1 of 5 START sql table model main.cleaned_usagelogs ............................ [RUN]
[0m17:36:36.920010 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_supercell_main, now model.supercell.cleaned_usagelogs)
[0m17:36:36.920403 [debug] [Thread-1 (]: Began compiling node model.supercell.cleaned_usagelogs
[0m17:36:36.928321 [debug] [Thread-1 (]: Writing injected SQL for node "model.supercell.cleaned_usagelogs"
[0m17:36:36.929003 [debug] [Thread-1 (]: Began executing node model.supercell.cleaned_usagelogs
[0m17:36:36.950981 [debug] [Thread-1 (]: Writing runtime sql for node "model.supercell.cleaned_usagelogs"
[0m17:36:36.951502 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.cleaned_usagelogs"
[0m17:36:36.951753 [debug] [Thread-1 (]: On model.supercell.cleaned_usagelogs: BEGIN
[0m17:36:36.951929 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:36:36.952515 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:36:36.952717 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.cleaned_usagelogs"
[0m17:36:36.952898 [debug] [Thread-1 (]: On model.supercell.cleaned_usagelogs: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.cleaned_usagelogs"} */

  
    
    

    create  table
      "supercell"."main"."cleaned_usagelogs__dbt_tmp"
  
    as (
      


SELECT
    CAST("LinkedAccountId" AS VARCHAR) AS linked_account_id,
    CAST("bill/PayerAccountId" AS VARCHAR) AS payer_account_id,
    CAST("lineItem/UsageStartDate" AS TIMESTAMP) AS usage_start_date,
    CAST("lineItem/UsageEndDate" AS TIMESTAMP) AS usage_end_date,
    CAST("lineItem/UsageAmount" AS DECIMAL(18, 6)) AS usage_amount,
    CAST("lineItem/Operation" AS VARCHAR) AS operation,
    CAST("pricing/PricingModel" AS VARCHAR) AS pricing_model,
    CAST("resourceTags/TagKeys" AS VARCHAR) AS tag_keys,
    CAST("resourceTags/TagValues" AS VARCHAR) AS tag_values,
    CAST("product/Region" AS VARCHAR) AS region,
    CAST("product/ServiceCode" AS VARCHAR) AS service_code,
    CAST("product/InstanceType" AS VARCHAR) AS instance_type,
    CAST("amortized_cost" AS DECIMAL(18, 6)) AS amortized_cost,
    CAST("product/Description" AS VARCHAR) AS description
FROM supercell_usagelogs
    );
  
  
[0m17:36:37.283818 [debug] [Thread-1 (]: SQL status: OK in 0.331 seconds
[0m17:36:37.289483 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.cleaned_usagelogs"
[0m17:36:37.289871 [debug] [Thread-1 (]: On model.supercell.cleaned_usagelogs: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.cleaned_usagelogs"} */
alter table "supercell"."main"."cleaned_usagelogs" rename to "cleaned_usagelogs__dbt_backup"
[0m17:36:37.290590 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:36:37.293003 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.cleaned_usagelogs"
[0m17:36:37.293395 [debug] [Thread-1 (]: On model.supercell.cleaned_usagelogs: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.cleaned_usagelogs"} */
alter table "supercell"."main"."cleaned_usagelogs__dbt_tmp" rename to "cleaned_usagelogs"
[0m17:36:37.294043 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:36:37.308961 [debug] [Thread-1 (]: On model.supercell.cleaned_usagelogs: COMMIT
[0m17:36:37.309472 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.cleaned_usagelogs"
[0m17:36:37.309816 [debug] [Thread-1 (]: On model.supercell.cleaned_usagelogs: COMMIT
[0m17:36:37.323151 [debug] [Thread-1 (]: SQL status: OK in 0.013 seconds
[0m17:36:37.328257 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.cleaned_usagelogs"
[0m17:36:37.328707 [debug] [Thread-1 (]: On model.supercell.cleaned_usagelogs: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.cleaned_usagelogs"} */
drop table if exists "supercell"."main"."cleaned_usagelogs__dbt_backup" cascade
[0m17:36:37.331006 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m17:36:37.333425 [debug] [Thread-1 (]: On model.supercell.cleaned_usagelogs: Close
[0m17:36:37.340790 [info ] [Thread-1 (]: 1 of 5 OK created sql table model main.cleaned_usagelogs ....................... [[32mOK[0m in 0.42s]
[0m17:36:37.341608 [debug] [Thread-1 (]: Finished running node model.supercell.cleaned_usagelogs
[0m17:36:37.343655 [debug] [Thread-3 (]: Began running node model.supercell.dim_accounts
[0m17:36:37.344812 [debug] [Thread-4 (]: Began running node model.supercell.dim_resource
[0m17:36:37.346018 [debug] [Thread-2 (]: Began running node model.supercell.fact_bill_generation
[0m17:36:37.347250 [info ] [Thread-3 (]: 2 of 5 START sql table model main.dim_accounts ................................. [RUN]
[0m17:36:37.348336 [info ] [Thread-4 (]: 3 of 5 START sql table model main.dim_resource ................................. [RUN]
[0m17:36:37.349813 [info ] [Thread-2 (]: 4 of 5 START sql table model main.fact_bill_generation ......................... [RUN]
[0m17:36:37.351192 [debug] [Thread-3 (]: Acquiring new duckdb connection 'model.supercell.dim_accounts'
[0m17:36:37.352404 [debug] [Thread-4 (]: Acquiring new duckdb connection 'model.supercell.dim_resource'
[0m17:36:37.353441 [debug] [Thread-2 (]: Acquiring new duckdb connection 'model.supercell.fact_bill_generation'
[0m17:36:37.354255 [debug] [Thread-3 (]: Began compiling node model.supercell.dim_accounts
[0m17:36:37.355088 [debug] [Thread-4 (]: Began compiling node model.supercell.dim_resource
[0m17:36:37.355861 [debug] [Thread-2 (]: Began compiling node model.supercell.fact_bill_generation
[0m17:36:37.361980 [debug] [Thread-3 (]: Writing injected SQL for node "model.supercell.dim_accounts"
[0m17:36:37.365491 [debug] [Thread-4 (]: Writing injected SQL for node "model.supercell.dim_resource"
[0m17:36:37.368388 [debug] [Thread-2 (]: Writing injected SQL for node "model.supercell.fact_bill_generation"
[0m17:36:37.369344 [debug] [Thread-3 (]: Began executing node model.supercell.dim_accounts
[0m17:36:37.369810 [debug] [Thread-4 (]: Began executing node model.supercell.dim_resource
[0m17:36:37.372634 [debug] [Thread-3 (]: Writing runtime sql for node "model.supercell.dim_accounts"
[0m17:36:37.375407 [debug] [Thread-4 (]: Writing runtime sql for node "model.supercell.dim_resource"
[0m17:36:37.376040 [debug] [Thread-2 (]: Began executing node model.supercell.fact_bill_generation
[0m17:36:37.377007 [debug] [Thread-3 (]: Using duckdb connection "model.supercell.dim_accounts"
[0m17:36:37.380271 [debug] [Thread-2 (]: Writing runtime sql for node "model.supercell.fact_bill_generation"
[0m17:36:37.380858 [debug] [Thread-3 (]: On model.supercell.dim_accounts: BEGIN
[0m17:36:37.381384 [debug] [Thread-4 (]: Using duckdb connection "model.supercell.dim_resource"
[0m17:36:37.382121 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m17:36:37.382636 [debug] [Thread-4 (]: On model.supercell.dim_resource: BEGIN
[0m17:36:37.383664 [debug] [Thread-2 (]: Using duckdb connection "model.supercell.fact_bill_generation"
[0m17:36:37.384322 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m17:36:37.384940 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m17:36:37.385434 [debug] [Thread-2 (]: On model.supercell.fact_bill_generation: BEGIN
[0m17:36:37.386207 [debug] [Thread-3 (]: Using duckdb connection "model.supercell.dim_accounts"
[0m17:36:37.386742 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m17:36:37.387442 [debug] [Thread-4 (]: SQL status: OK in 0.003 seconds
[0m17:36:37.387989 [debug] [Thread-3 (]: On model.supercell.dim_accounts: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.dim_accounts"} */

  
    
    

    create  table
      "supercell"."main"."dim_accounts__dbt_tmp"
  
    as (
      


select
    linked_account_id as linked_account_id,
    tag_keys as tag_keys,
    tag_values as tag_values
from "supercell"."main"."cleaned_usagelogs"
    );
  
  
[0m17:36:37.388748 [debug] [Thread-4 (]: Using duckdb connection "model.supercell.dim_resource"
[0m17:36:37.389516 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m17:36:37.390177 [debug] [Thread-4 (]: On model.supercell.dim_resource: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.dim_resource"} */

  
    
    

    create  table
      "supercell"."main"."dim_resource__dbt_tmp"
  
    as (
      


select
    md5(concat(linked_account_id, '_', service_code, '_', instance_type, '_', region, '_', CAST(usage_start_date AS VARCHAR), '_', CAST(usage_end_date AS VARCHAR))) AS resource_id,
    linked_account_id as linked_account_id,
    region,
    service_code as product,
    instance_type as instance_type,
    pricing_model as pricing_model
from "supercell"."main"."cleaned_usagelogs"
    );
  
  
[0m17:36:37.391207 [debug] [Thread-2 (]: Using duckdb connection "model.supercell.fact_bill_generation"
[0m17:36:37.393601 [debug] [Thread-2 (]: On model.supercell.fact_bill_generation: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.fact_bill_generation"} */

  
    
    

    create  table
      "supercell"."main"."fact_bill_generation__dbt_tmp"
  
    as (
      


select
    md5(concat(linked_account_id, '_', service_code, '_', instance_type, '_', region, '_', CAST(usage_start_date AS VARCHAR), '_', CAST(usage_end_date AS VARCHAR))) AS resource_id,
    usage_start_date as start_date,
    usage_end_date as bill_date,
    usage_amount as bill_amount,
    operation
from "supercell"."main"."cleaned_usagelogs"
    );
  
  
[0m17:36:37.576982 [debug] [Thread-3 (]: SQL status: OK in 0.187 seconds
[0m17:36:37.583955 [debug] [Thread-3 (]: Using duckdb connection "model.supercell.dim_accounts"
[0m17:36:37.584913 [debug] [Thread-3 (]: On model.supercell.dim_accounts: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.dim_accounts"} */
alter table "supercell"."main"."dim_accounts" rename to "dim_accounts__dbt_backup"
[0m17:36:37.586469 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m17:36:37.592693 [debug] [Thread-3 (]: Using duckdb connection "model.supercell.dim_accounts"
[0m17:36:37.594071 [debug] [Thread-3 (]: On model.supercell.dim_accounts: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.dim_accounts"} */
alter table "supercell"."main"."dim_accounts__dbt_tmp" rename to "dim_accounts"
[0m17:36:37.595776 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m17:36:37.600023 [debug] [Thread-3 (]: On model.supercell.dim_accounts: COMMIT
[0m17:36:37.600984 [debug] [Thread-3 (]: Using duckdb connection "model.supercell.dim_accounts"
[0m17:36:37.601667 [debug] [Thread-3 (]: On model.supercell.dim_accounts: COMMIT
[0m17:36:37.611860 [debug] [Thread-3 (]: SQL status: OK in 0.009 seconds
[0m17:36:37.618792 [debug] [Thread-3 (]: Using duckdb connection "model.supercell.dim_accounts"
[0m17:36:37.620194 [debug] [Thread-3 (]: On model.supercell.dim_accounts: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.dim_accounts"} */
drop table if exists "supercell"."main"."dim_accounts__dbt_backup" cascade
[0m17:36:37.623739 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m17:36:37.627801 [debug] [Thread-3 (]: On model.supercell.dim_accounts: Close
[0m17:36:37.636017 [info ] [Thread-3 (]: 2 of 5 OK created sql table model main.dim_accounts ............................ [[32mOK[0m in 0.28s]
[0m17:36:37.638118 [debug] [Thread-3 (]: Finished running node model.supercell.dim_accounts
[0m17:36:37.795905 [debug] [Thread-2 (]: SQL status: OK in 0.397 seconds
[0m17:36:37.804262 [debug] [Thread-2 (]: Using duckdb connection "model.supercell.fact_bill_generation"
[0m17:36:37.805699 [debug] [Thread-2 (]: On model.supercell.fact_bill_generation: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.fact_bill_generation"} */
alter table "supercell"."main"."fact_bill_generation" rename to "fact_bill_generation__dbt_backup"
[0m17:36:37.808172 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m17:36:37.813144 [debug] [Thread-2 (]: Using duckdb connection "model.supercell.fact_bill_generation"
[0m17:36:37.813786 [debug] [Thread-2 (]: On model.supercell.fact_bill_generation: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.fact_bill_generation"} */
alter table "supercell"."main"."fact_bill_generation__dbt_tmp" rename to "fact_bill_generation"
[0m17:36:37.814936 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m17:36:37.817678 [debug] [Thread-2 (]: On model.supercell.fact_bill_generation: COMMIT
[0m17:36:37.818317 [debug] [Thread-2 (]: Using duckdb connection "model.supercell.fact_bill_generation"
[0m17:36:37.818836 [debug] [Thread-2 (]: On model.supercell.fact_bill_generation: COMMIT
[0m17:36:37.834072 [debug] [Thread-2 (]: SQL status: OK in 0.014 seconds
[0m17:36:37.840894 [debug] [Thread-2 (]: Using duckdb connection "model.supercell.fact_bill_generation"
[0m17:36:37.841561 [debug] [Thread-2 (]: On model.supercell.fact_bill_generation: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.fact_bill_generation"} */
drop table if exists "supercell"."main"."fact_bill_generation__dbt_backup" cascade
[0m17:36:37.844733 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m17:36:37.848931 [debug] [Thread-2 (]: On model.supercell.fact_bill_generation: Close
[0m17:36:37.866550 [info ] [Thread-2 (]: 4 of 5 OK created sql table model main.fact_bill_generation .................... [[32mOK[0m in 0.51s]
[0m17:36:37.867638 [debug] [Thread-2 (]: Finished running node model.supercell.fact_bill_generation
[0m17:36:37.971858 [debug] [Thread-4 (]: SQL status: OK in 0.579 seconds
[0m17:36:37.975796 [debug] [Thread-4 (]: Using duckdb connection "model.supercell.dim_resource"
[0m17:36:37.976440 [debug] [Thread-4 (]: On model.supercell.dim_resource: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.dim_resource"} */
alter table "supercell"."main"."dim_resource" rename to "dim_resource__dbt_backup"
[0m17:36:37.977651 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m17:36:37.981804 [debug] [Thread-4 (]: Using duckdb connection "model.supercell.dim_resource"
[0m17:36:37.982398 [debug] [Thread-4 (]: On model.supercell.dim_resource: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.dim_resource"} */
alter table "supercell"."main"."dim_resource__dbt_tmp" rename to "dim_resource"
[0m17:36:37.983386 [debug] [Thread-4 (]: SQL status: OK in 0.000 seconds
[0m17:36:37.985809 [debug] [Thread-4 (]: On model.supercell.dim_resource: COMMIT
[0m17:36:37.986396 [debug] [Thread-4 (]: Using duckdb connection "model.supercell.dim_resource"
[0m17:36:37.986909 [debug] [Thread-4 (]: On model.supercell.dim_resource: COMMIT
[0m17:36:37.993685 [debug] [Thread-4 (]: SQL status: OK in 0.006 seconds
[0m17:36:37.996876 [debug] [Thread-4 (]: Using duckdb connection "model.supercell.dim_resource"
[0m17:36:37.997476 [debug] [Thread-4 (]: On model.supercell.dim_resource: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.dim_resource"} */
drop table if exists "supercell"."main"."dim_resource__dbt_backup" cascade
[0m17:36:38.000433 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m17:36:38.002656 [debug] [Thread-4 (]: On model.supercell.dim_resource: Close
[0m17:36:38.006756 [info ] [Thread-4 (]: 3 of 5 OK created sql table model main.dim_resource ............................ [[32mOK[0m in 0.65s]
[0m17:36:38.007639 [debug] [Thread-4 (]: Finished running node model.supercell.dim_resource
[0m17:36:38.009344 [debug] [Thread-1 (]: Began running node model.supercell.total_cost
[0m17:36:38.010438 [info ] [Thread-1 (]: 5 of 5 START sql table model main.total_cost ................................... [RUN]
[0m17:36:38.011460 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.supercell.cleaned_usagelogs, now model.supercell.total_cost)
[0m17:36:38.012234 [debug] [Thread-1 (]: Began compiling node model.supercell.total_cost
[0m17:36:38.017471 [debug] [Thread-1 (]: Writing injected SQL for node "model.supercell.total_cost"
[0m17:36:38.018710 [debug] [Thread-1 (]: Began executing node model.supercell.total_cost
[0m17:36:38.023770 [debug] [Thread-1 (]: Writing runtime sql for node "model.supercell.total_cost"
[0m17:36:38.024854 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.total_cost"
[0m17:36:38.025476 [debug] [Thread-1 (]: On model.supercell.total_cost: BEGIN
[0m17:36:38.025974 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:36:38.027155 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:36:38.027751 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.total_cost"
[0m17:36:38.028347 [debug] [Thread-1 (]: On model.supercell.total_cost: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.total_cost"} */

  
    
    

    create  table
      "supercell"."main"."total_cost__dbt_tmp"
  
    as (
      

with base as (
    select
        fact_bill_generation.resource_id,
        date_trunc('month', fact_bill_generation.bill_date) as month,
        fact_bill_generation.bill_amount,
        dim_resource.instance_type,
        dim_resource.product,
        dim_resource.region,
        dim_resource.pricing_model,
        dim_resource.linked_account_id
    from "supercell"."main"."fact_bill_generation" as fact_bill_generation
    left join "supercell"."main"."dim_resource" as dim_resource
        on fact_bill_generation.resource_id = dim_resource.resource_id
    -- filter to recent records to speed up
    where fact_bill_generation.bill_date >= current_date - interval '6 months'
),
joined as (
    select
        base.*,
        dim_accounts.linked_account_id  -- only if needed
        -- dim_accounts.tag_keys as tag_keys,
        -- dim_accounts.tag_values as tag_values
    from base
    left join "supercell"."main"."dim_accounts" as dim_accounts
        on base.linked_account_id = dim_accounts.linked_account_id
)

select
    month,
    sum(bill_amount) as total_cost,
    instance_type,
    product,
    region,
    pricing_model
    -- tag_keys,
    -- tag_values
from joined
group by
    month,
    instance_type,
    product,
    region,
    pricing_model
order by
    month,
    instance_type,
    product,
    region,
    pricing_model
    -- tag_keys,
    -- tag_values
    );
  
  
[0m17:36:38.085187 [debug] [Thread-1 (]: SQL status: OK in 0.056 seconds
[0m17:36:38.089179 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.total_cost"
[0m17:36:38.089787 [debug] [Thread-1 (]: On model.supercell.total_cost: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.total_cost"} */
alter table "supercell"."main"."total_cost" rename to "total_cost__dbt_backup"
[0m17:36:38.090841 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:36:38.094800 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.total_cost"
[0m17:36:38.095408 [debug] [Thread-1 (]: On model.supercell.total_cost: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.total_cost"} */
alter table "supercell"."main"."total_cost__dbt_tmp" rename to "total_cost"
[0m17:36:38.096487 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:36:38.099273 [debug] [Thread-1 (]: On model.supercell.total_cost: COMMIT
[0m17:36:38.099849 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.total_cost"
[0m17:36:38.100339 [debug] [Thread-1 (]: On model.supercell.total_cost: COMMIT
[0m17:36:38.103749 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m17:36:38.106788 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.total_cost"
[0m17:36:38.107367 [debug] [Thread-1 (]: On model.supercell.total_cost: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.total_cost"} */
drop table if exists "supercell"."main"."total_cost__dbt_backup" cascade
[0m17:36:38.110494 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m17:36:38.114445 [debug] [Thread-1 (]: On model.supercell.total_cost: Close
[0m17:36:38.118964 [info ] [Thread-1 (]: 5 of 5 OK created sql table model main.total_cost .............................. [[32mOK[0m in 0.11s]
[0m17:36:38.119841 [debug] [Thread-1 (]: Finished running node model.supercell.total_cost
[0m17:36:38.123059 [debug] [MainThread]: Using duckdb connection "master"
[0m17:36:38.123714 [debug] [MainThread]: On master: BEGIN
[0m17:36:38.124188 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:36:38.125229 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m17:36:38.125763 [debug] [MainThread]: On master: COMMIT
[0m17:36:38.126232 [debug] [MainThread]: Using duckdb connection "master"
[0m17:36:38.126778 [debug] [MainThread]: On master: COMMIT
[0m17:36:38.127672 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:36:38.128176 [debug] [MainThread]: On master: Close
[0m17:36:38.128896 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:36:38.129346 [debug] [MainThread]: Connection 'model.supercell.total_cost' was properly closed.
[0m17:36:38.129737 [debug] [MainThread]: Connection 'model.supercell.dim_accounts' was properly closed.
[0m17:36:38.130099 [debug] [MainThread]: Connection 'model.supercell.dim_resource' was properly closed.
[0m17:36:38.130500 [debug] [MainThread]: Connection 'model.supercell.fact_bill_generation' was properly closed.
[0m17:36:38.131074 [info ] [MainThread]: 
[0m17:36:38.131600 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 1.28 seconds (1.28s).
[0m17:36:38.133229 [debug] [MainThread]: Command end result
[0m17:36:38.225993 [debug] [MainThread]: Wrote artifact WritableManifest to /home/harsha/data_actions/supercell_cloudops/target/manifest.json
[0m17:36:38.228227 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/harsha/data_actions/supercell_cloudops/target/semantic_manifest.json
[0m17:36:38.236752 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/harsha/data_actions/supercell_cloudops/target/run_results.json
[0m17:36:38.237339 [info ] [MainThread]: 
[0m17:36:38.237889 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:36:38.238340 [info ] [MainThread]: 
[0m17:36:38.238801 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m17:36:38.240024 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.8407081, "process_in_blocks": "0", "process_kernel_time": 0.570587, "process_mem_max_rss": "339112", "process_out_blocks": "59736", "process_user_time": 6.560256}
[0m17:36:38.240788 [debug] [MainThread]: Command `dbt run` succeeded at 17:36:38.240633 after 1.84 seconds
[0m17:36:38.241311 [debug] [MainThread]: Flushing usage events


============================== 17:37:01.783563 | 70c525e7-ff55-4bba-9705-876ac57719ad ==============================
[0m17:37:01.783563 [info ] [MainThread]: Running with dbt=1.9.4
[0m17:37:01.786729 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/harsha/data_actions/supercell_cloudops/logs', 'version_check': 'True', 'profiles_dir': '/home/harsha/data_actions/supercell_cloudops', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'False'}
[0m17:37:01.787130 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality

User config should be moved from the 'config' key in profiles.yml to the 'flags' key in dbt_project.yml.
[0m17:37:01.955649 [info ] [MainThread]: Registered adapter: duckdb=1.9.3
[0m17:37:01.993901 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m17:37:02.036634 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:37:02.037049 [debug] [MainThread]: Partial parsing: updated file: supercell://models/supercell_models/metrics/total_cost.sql
[0m17:37:02.181873 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.supercell.example
[0m17:37:02.215302 [debug] [MainThread]: Wrote artifact WritableManifest to /home/harsha/data_actions/supercell_cloudops/target/manifest.json
[0m17:37:02.216317 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/harsha/data_actions/supercell_cloudops/target/semantic_manifest.json
[0m17:37:02.222943 [info ] [MainThread]: Found 5 models, 428 macros
[0m17:37:02.224398 [info ] [MainThread]: 
[0m17:37:02.224721 [info ] [MainThread]: Concurrency: 4 threads (target='default')
[0m17:37:02.224907 [info ] [MainThread]: 
[0m17:37:02.225227 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m17:37:02.229602 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_supercell'
[0m17:37:02.250443 [debug] [ThreadPool]: Using duckdb connection "list_supercell"
[0m17:37:02.250744 [debug] [ThreadPool]: On list_supercell: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "connection_name": "list_supercell"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"supercell"'
    
  
  
[0m17:37:02.250919 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:37:02.258786 [debug] [ThreadPool]: SQL status: OK in 0.008 seconds
[0m17:37:02.259722 [debug] [ThreadPool]: On list_supercell: Close
[0m17:37:02.260368 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_supercell, now create_supercell_main)
[0m17:37:02.260672 [debug] [ThreadPool]: Creating schema "database: "supercell"
schema: "main"
"
[0m17:37:02.264574 [debug] [ThreadPool]: Using duckdb connection "create_supercell_main"
[0m17:37:02.264796 [debug] [ThreadPool]: On create_supercell_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "connection_name": "create_supercell_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='supercell'
        and type='sqlite'
    
  
[0m17:37:02.264965 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:37:02.265558 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m17:37:02.266310 [debug] [ThreadPool]: Using duckdb connection "create_supercell_main"
[0m17:37:02.266496 [debug] [ThreadPool]: On create_supercell_main: BEGIN
[0m17:37:02.266773 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:37:02.266953 [debug] [ThreadPool]: Using duckdb connection "create_supercell_main"
[0m17:37:02.267098 [debug] [ThreadPool]: On create_supercell_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "connection_name": "create_supercell_main"} */

    
    
        create schema if not exists "supercell"."main"
    
[0m17:37:02.267365 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:37:02.267820 [debug] [ThreadPool]: On create_supercell_main: COMMIT
[0m17:37:02.268004 [debug] [ThreadPool]: Using duckdb connection "create_supercell_main"
[0m17:37:02.268172 [debug] [ThreadPool]: On create_supercell_main: COMMIT
[0m17:37:02.268423 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:37:02.268586 [debug] [ThreadPool]: On create_supercell_main: Close
[0m17:37:02.269889 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_supercell_main, now list_supercell_main)
[0m17:37:02.275123 [debug] [ThreadPool]: Using duckdb connection "list_supercell_main"
[0m17:37:02.275533 [debug] [ThreadPool]: On list_supercell_main: BEGIN
[0m17:37:02.275819 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:37:02.276486 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m17:37:02.276804 [debug] [ThreadPool]: Using duckdb connection "list_supercell_main"
[0m17:37:02.277094 [debug] [ThreadPool]: On list_supercell_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "connection_name": "list_supercell_main"} */
select
      'supercell' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'supercell'
  
[0m17:37:02.288631 [debug] [ThreadPool]: SQL status: OK in 0.011 seconds
[0m17:37:02.289589 [debug] [ThreadPool]: On list_supercell_main: ROLLBACK
[0m17:37:02.290313 [debug] [ThreadPool]: Failed to rollback 'list_supercell_main'
[0m17:37:02.290542 [debug] [ThreadPool]: On list_supercell_main: Close
[0m17:37:02.291636 [debug] [MainThread]: Using duckdb connection "master"
[0m17:37:02.291852 [debug] [MainThread]: On master: BEGIN
[0m17:37:02.292009 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:37:02.292460 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:37:02.292672 [debug] [MainThread]: On master: COMMIT
[0m17:37:02.292838 [debug] [MainThread]: Using duckdb connection "master"
[0m17:37:02.292988 [debug] [MainThread]: On master: COMMIT
[0m17:37:02.293246 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:37:02.293420 [debug] [MainThread]: On master: Close
[0m17:37:02.295584 [debug] [Thread-1 (]: Began running node model.supercell.cleaned_usagelogs
[0m17:37:02.296129 [info ] [Thread-1 (]: 1 of 5 START sql table model main.cleaned_usagelogs ............................ [RUN]
[0m17:37:02.296574 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_supercell_main, now model.supercell.cleaned_usagelogs)
[0m17:37:02.296927 [debug] [Thread-1 (]: Began compiling node model.supercell.cleaned_usagelogs
[0m17:37:02.304592 [debug] [Thread-1 (]: Writing injected SQL for node "model.supercell.cleaned_usagelogs"
[0m17:37:02.305299 [debug] [Thread-1 (]: Began executing node model.supercell.cleaned_usagelogs
[0m17:37:02.326955 [debug] [Thread-1 (]: Writing runtime sql for node "model.supercell.cleaned_usagelogs"
[0m17:37:02.327465 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.cleaned_usagelogs"
[0m17:37:02.327693 [debug] [Thread-1 (]: On model.supercell.cleaned_usagelogs: BEGIN
[0m17:37:02.327869 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:37:02.328414 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:37:02.328622 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.cleaned_usagelogs"
[0m17:37:02.328805 [debug] [Thread-1 (]: On model.supercell.cleaned_usagelogs: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.cleaned_usagelogs"} */

  
    
    

    create  table
      "supercell"."main"."cleaned_usagelogs__dbt_tmp"
  
    as (
      


SELECT
    CAST("LinkedAccountId" AS VARCHAR) AS linked_account_id,
    CAST("bill/PayerAccountId" AS VARCHAR) AS payer_account_id,
    CAST("lineItem/UsageStartDate" AS TIMESTAMP) AS usage_start_date,
    CAST("lineItem/UsageEndDate" AS TIMESTAMP) AS usage_end_date,
    CAST("lineItem/UsageAmount" AS DECIMAL(18, 6)) AS usage_amount,
    CAST("lineItem/Operation" AS VARCHAR) AS operation,
    CAST("pricing/PricingModel" AS VARCHAR) AS pricing_model,
    CAST("resourceTags/TagKeys" AS VARCHAR) AS tag_keys,
    CAST("resourceTags/TagValues" AS VARCHAR) AS tag_values,
    CAST("product/Region" AS VARCHAR) AS region,
    CAST("product/ServiceCode" AS VARCHAR) AS service_code,
    CAST("product/InstanceType" AS VARCHAR) AS instance_type,
    CAST("amortized_cost" AS DECIMAL(18, 6)) AS amortized_cost,
    CAST("product/Description" AS VARCHAR) AS description
FROM supercell_usagelogs
    );
  
  
[0m17:37:02.602387 [debug] [Thread-1 (]: SQL status: OK in 0.273 seconds
[0m17:37:02.606168 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.cleaned_usagelogs"
[0m17:37:02.606438 [debug] [Thread-1 (]: On model.supercell.cleaned_usagelogs: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.cleaned_usagelogs"} */
alter table "supercell"."main"."cleaned_usagelogs" rename to "cleaned_usagelogs__dbt_backup"
[0m17:37:02.607015 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:37:02.608836 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.cleaned_usagelogs"
[0m17:37:02.609075 [debug] [Thread-1 (]: On model.supercell.cleaned_usagelogs: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.cleaned_usagelogs"} */
alter table "supercell"."main"."cleaned_usagelogs__dbt_tmp" rename to "cleaned_usagelogs"
[0m17:37:02.609563 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:37:02.618753 [debug] [Thread-1 (]: On model.supercell.cleaned_usagelogs: COMMIT
[0m17:37:02.619015 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.cleaned_usagelogs"
[0m17:37:02.619209 [debug] [Thread-1 (]: On model.supercell.cleaned_usagelogs: COMMIT
[0m17:37:02.632868 [debug] [Thread-1 (]: SQL status: OK in 0.013 seconds
[0m17:37:02.636315 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.cleaned_usagelogs"
[0m17:37:02.636587 [debug] [Thread-1 (]: On model.supercell.cleaned_usagelogs: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.cleaned_usagelogs"} */
drop table if exists "supercell"."main"."cleaned_usagelogs__dbt_backup" cascade
[0m17:37:02.638372 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m17:37:02.640010 [debug] [Thread-1 (]: On model.supercell.cleaned_usagelogs: Close
[0m17:37:02.645238 [info ] [Thread-1 (]: 1 of 5 OK created sql table model main.cleaned_usagelogs ....................... [[32mOK[0m in 0.35s]
[0m17:37:02.645648 [debug] [Thread-1 (]: Finished running node model.supercell.cleaned_usagelogs
[0m17:37:02.646551 [debug] [Thread-3 (]: Began running node model.supercell.dim_accounts
[0m17:37:02.647248 [info ] [Thread-3 (]: 2 of 5 START sql table model main.dim_accounts ................................. [RUN]
[0m17:37:02.647776 [debug] [Thread-4 (]: Began running node model.supercell.dim_resource
[0m17:37:02.648297 [debug] [Thread-2 (]: Began running node model.supercell.fact_bill_generation
[0m17:37:02.649093 [debug] [Thread-3 (]: Acquiring new duckdb connection 'model.supercell.dim_accounts'
[0m17:37:02.650111 [info ] [Thread-4 (]: 3 of 5 START sql table model main.dim_resource ................................. [RUN]
[0m17:37:02.650794 [info ] [Thread-2 (]: 4 of 5 START sql table model main.fact_bill_generation ......................... [RUN]
[0m17:37:02.651648 [debug] [Thread-3 (]: Began compiling node model.supercell.dim_accounts
[0m17:37:02.652446 [debug] [Thread-4 (]: Acquiring new duckdb connection 'model.supercell.dim_resource'
[0m17:37:02.653007 [debug] [Thread-2 (]: Acquiring new duckdb connection 'model.supercell.fact_bill_generation'
[0m17:37:02.658726 [debug] [Thread-3 (]: Writing injected SQL for node "model.supercell.dim_accounts"
[0m17:37:02.659327 [debug] [Thread-4 (]: Began compiling node model.supercell.dim_resource
[0m17:37:02.659817 [debug] [Thread-2 (]: Began compiling node model.supercell.fact_bill_generation
[0m17:37:02.663178 [debug] [Thread-4 (]: Writing injected SQL for node "model.supercell.dim_resource"
[0m17:37:02.663929 [debug] [Thread-3 (]: Began executing node model.supercell.dim_accounts
[0m17:37:02.665832 [debug] [Thread-2 (]: Writing injected SQL for node "model.supercell.fact_bill_generation"
[0m17:37:02.668044 [debug] [Thread-3 (]: Writing runtime sql for node "model.supercell.dim_accounts"
[0m17:37:02.668448 [debug] [Thread-4 (]: Began executing node model.supercell.dim_resource
[0m17:37:02.669098 [debug] [Thread-2 (]: Began executing node model.supercell.fact_bill_generation
[0m17:37:02.671420 [debug] [Thread-4 (]: Writing runtime sql for node "model.supercell.dim_resource"
[0m17:37:02.673321 [debug] [Thread-2 (]: Writing runtime sql for node "model.supercell.fact_bill_generation"
[0m17:37:02.673628 [debug] [Thread-3 (]: Using duckdb connection "model.supercell.dim_accounts"
[0m17:37:02.674484 [debug] [Thread-4 (]: Using duckdb connection "model.supercell.dim_resource"
[0m17:37:02.674879 [debug] [Thread-2 (]: Using duckdb connection "model.supercell.fact_bill_generation"
[0m17:37:02.675360 [debug] [Thread-3 (]: On model.supercell.dim_accounts: BEGIN
[0m17:37:02.675743 [debug] [Thread-4 (]: On model.supercell.dim_resource: BEGIN
[0m17:37:02.676045 [debug] [Thread-2 (]: On model.supercell.fact_bill_generation: BEGIN
[0m17:37:02.676425 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m17:37:02.676877 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m17:37:02.677153 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m17:37:02.678059 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m17:37:02.678576 [debug] [Thread-3 (]: Using duckdb connection "model.supercell.dim_accounts"
[0m17:37:02.678946 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m17:37:02.679248 [debug] [Thread-3 (]: On model.supercell.dim_accounts: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.dim_accounts"} */

  
    
    

    create  table
      "supercell"."main"."dim_accounts__dbt_tmp"
  
    as (
      


select
    linked_account_id as linked_account_id,
    tag_keys as tag_keys,
    tag_values as tag_values
from "supercell"."main"."cleaned_usagelogs"
    );
  
  
[0m17:37:02.679727 [debug] [Thread-2 (]: SQL status: OK in 0.003 seconds
[0m17:37:02.679959 [debug] [Thread-4 (]: Using duckdb connection "model.supercell.dim_resource"
[0m17:37:02.680367 [debug] [Thread-2 (]: Using duckdb connection "model.supercell.fact_bill_generation"
[0m17:37:02.680626 [debug] [Thread-4 (]: On model.supercell.dim_resource: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.dim_resource"} */

  
    
    

    create  table
      "supercell"."main"."dim_resource__dbt_tmp"
  
    as (
      


select
    md5(concat(linked_account_id, '_', service_code, '_', instance_type, '_', region, '_', CAST(usage_start_date AS VARCHAR), '_', CAST(usage_end_date AS VARCHAR))) AS resource_id,
    linked_account_id as linked_account_id,
    region,
    service_code as product,
    instance_type as instance_type,
    pricing_model as pricing_model
from "supercell"."main"."cleaned_usagelogs"
    );
  
  
[0m17:37:02.681050 [debug] [Thread-2 (]: On model.supercell.fact_bill_generation: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.fact_bill_generation"} */

  
    
    

    create  table
      "supercell"."main"."fact_bill_generation__dbt_tmp"
  
    as (
      


select
    md5(concat(linked_account_id, '_', service_code, '_', instance_type, '_', region, '_', CAST(usage_start_date AS VARCHAR), '_', CAST(usage_end_date AS VARCHAR))) AS resource_id,
    usage_start_date as start_date,
    usage_end_date as bill_date,
    usage_amount as bill_amount,
    operation
from "supercell"."main"."cleaned_usagelogs"
    );
  
  
[0m17:37:02.795278 [debug] [Thread-3 (]: SQL status: OK in 0.115 seconds
[0m17:37:02.799932 [debug] [Thread-3 (]: Using duckdb connection "model.supercell.dim_accounts"
[0m17:37:02.800764 [debug] [Thread-3 (]: On model.supercell.dim_accounts: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.dim_accounts"} */
alter table "supercell"."main"."dim_accounts" rename to "dim_accounts__dbt_backup"
[0m17:37:02.802204 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m17:37:02.806958 [debug] [Thread-3 (]: Using duckdb connection "model.supercell.dim_accounts"
[0m17:37:02.808098 [debug] [Thread-3 (]: On model.supercell.dim_accounts: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.dim_accounts"} */
alter table "supercell"."main"."dim_accounts__dbt_tmp" rename to "dim_accounts"
[0m17:37:02.809464 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m17:37:02.812509 [debug] [Thread-3 (]: On model.supercell.dim_accounts: COMMIT
[0m17:37:02.813396 [debug] [Thread-3 (]: Using duckdb connection "model.supercell.dim_accounts"
[0m17:37:02.814159 [debug] [Thread-3 (]: On model.supercell.dim_accounts: COMMIT
[0m17:37:02.821100 [debug] [Thread-3 (]: SQL status: OK in 0.006 seconds
[0m17:37:02.825037 [debug] [Thread-3 (]: Using duckdb connection "model.supercell.dim_accounts"
[0m17:37:02.826161 [debug] [Thread-3 (]: On model.supercell.dim_accounts: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.dim_accounts"} */
drop table if exists "supercell"."main"."dim_accounts__dbt_backup" cascade
[0m17:37:02.829033 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m17:37:02.831627 [debug] [Thread-3 (]: On model.supercell.dim_accounts: Close
[0m17:37:02.836814 [info ] [Thread-3 (]: 2 of 5 OK created sql table model main.dim_accounts ............................ [[32mOK[0m in 0.19s]
[0m17:37:02.837819 [debug] [Thread-3 (]: Finished running node model.supercell.dim_accounts
[0m17:37:02.959566 [debug] [Thread-2 (]: SQL status: OK in 0.278 seconds
[0m17:37:02.963349 [debug] [Thread-2 (]: Using duckdb connection "model.supercell.fact_bill_generation"
[0m17:37:02.963927 [debug] [Thread-2 (]: On model.supercell.fact_bill_generation: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.fact_bill_generation"} */
alter table "supercell"."main"."fact_bill_generation" rename to "fact_bill_generation__dbt_backup"
[0m17:37:02.965072 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m17:37:02.968232 [debug] [Thread-2 (]: Using duckdb connection "model.supercell.fact_bill_generation"
[0m17:37:02.968716 [debug] [Thread-2 (]: On model.supercell.fact_bill_generation: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.fact_bill_generation"} */
alter table "supercell"."main"."fact_bill_generation__dbt_tmp" rename to "fact_bill_generation"
[0m17:37:02.969673 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m17:37:02.971914 [debug] [Thread-2 (]: On model.supercell.fact_bill_generation: COMMIT
[0m17:37:02.972410 [debug] [Thread-2 (]: Using duckdb connection "model.supercell.fact_bill_generation"
[0m17:37:02.972809 [debug] [Thread-2 (]: On model.supercell.fact_bill_generation: COMMIT
[0m17:37:02.984366 [debug] [Thread-2 (]: SQL status: OK in 0.011 seconds
[0m17:37:02.991569 [debug] [Thread-2 (]: Using duckdb connection "model.supercell.fact_bill_generation"
[0m17:37:02.992512 [debug] [Thread-2 (]: On model.supercell.fact_bill_generation: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.fact_bill_generation"} */
drop table if exists "supercell"."main"."fact_bill_generation__dbt_backup" cascade
[0m17:37:02.995487 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m17:37:02.997570 [debug] [Thread-2 (]: On model.supercell.fact_bill_generation: Close
[0m17:37:03.005774 [info ] [Thread-2 (]: 4 of 5 OK created sql table model main.fact_bill_generation .................... [[32mOK[0m in 0.35s]
[0m17:37:03.006653 [debug] [Thread-2 (]: Finished running node model.supercell.fact_bill_generation
[0m17:37:03.076088 [debug] [Thread-4 (]: SQL status: OK in 0.394 seconds
[0m17:37:03.079556 [debug] [Thread-4 (]: Using duckdb connection "model.supercell.dim_resource"
[0m17:37:03.080092 [debug] [Thread-4 (]: On model.supercell.dim_resource: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.dim_resource"} */
alter table "supercell"."main"."dim_resource" rename to "dim_resource__dbt_backup"
[0m17:37:03.081098 [debug] [Thread-4 (]: SQL status: OK in 0.000 seconds
[0m17:37:03.084513 [debug] [Thread-4 (]: Using duckdb connection "model.supercell.dim_resource"
[0m17:37:03.085001 [debug] [Thread-4 (]: On model.supercell.dim_resource: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.dim_resource"} */
alter table "supercell"."main"."dim_resource__dbt_tmp" rename to "dim_resource"
[0m17:37:03.086117 [debug] [Thread-4 (]: SQL status: OK in 0.000 seconds
[0m17:37:03.088478 [debug] [Thread-4 (]: On model.supercell.dim_resource: COMMIT
[0m17:37:03.088962 [debug] [Thread-4 (]: Using duckdb connection "model.supercell.dim_resource"
[0m17:37:03.089409 [debug] [Thread-4 (]: On model.supercell.dim_resource: COMMIT
[0m17:37:03.095341 [debug] [Thread-4 (]: SQL status: OK in 0.005 seconds
[0m17:37:03.098120 [debug] [Thread-4 (]: Using duckdb connection "model.supercell.dim_resource"
[0m17:37:03.098628 [debug] [Thread-4 (]: On model.supercell.dim_resource: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.dim_resource"} */
drop table if exists "supercell"."main"."dim_resource__dbt_backup" cascade
[0m17:37:03.100961 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m17:37:03.102720 [debug] [Thread-4 (]: On model.supercell.dim_resource: Close
[0m17:37:03.105996 [info ] [Thread-4 (]: 3 of 5 OK created sql table model main.dim_resource ............................ [[32mOK[0m in 0.45s]
[0m17:37:03.106738 [debug] [Thread-4 (]: Finished running node model.supercell.dim_resource
[0m17:37:03.108421 [debug] [Thread-1 (]: Began running node model.supercell.total_cost
[0m17:37:03.109546 [info ] [Thread-1 (]: 5 of 5 START sql table model main.total_cost ................................... [RUN]
[0m17:37:03.110280 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.supercell.cleaned_usagelogs, now model.supercell.total_cost)
[0m17:37:03.110789 [debug] [Thread-1 (]: Began compiling node model.supercell.total_cost
[0m17:37:03.115556 [debug] [Thread-1 (]: Writing injected SQL for node "model.supercell.total_cost"
[0m17:37:03.116919 [debug] [Thread-1 (]: Began executing node model.supercell.total_cost
[0m17:37:03.121224 [debug] [Thread-1 (]: Writing runtime sql for node "model.supercell.total_cost"
[0m17:37:03.122502 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.total_cost"
[0m17:37:03.123165 [debug] [Thread-1 (]: On model.supercell.total_cost: BEGIN
[0m17:37:03.123615 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:37:03.124683 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:37:03.125189 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.total_cost"
[0m17:37:03.125706 [debug] [Thread-1 (]: On model.supercell.total_cost: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.total_cost"} */

  
    
    

    create  table
      "supercell"."main"."total_cost__dbt_tmp"
  
    as (
      

with base as (
    select
        fact_bill_generation.resource_id,
        date_trunc('month', fact_bill_generation.bill_date) as month,
        fact_bill_generation.bill_amount,
        dim_resource.instance_type,
        dim_resource.product,
        dim_resource.region,
        dim_resource.pricing_model,
        dim_resource.linked_account_id
    from "supercell"."main"."fact_bill_generation" as fact_bill_generation
    left join "supercell"."main"."dim_resource" as dim_resource
        on fact_bill_generation.resource_id = dim_resource.resource_id
),
joined as (
    select
        base.*,
        dim_accounts.linked_account_id  -- only if needed
        -- dim_accounts.tag_keys as tag_keys,
        -- dim_accounts.tag_values as tag_values
    from base
    left join "supercell"."main"."dim_accounts" as dim_accounts
        on base.linked_account_id = dim_accounts.linked_account_id
)

select
    month,
    sum(bill_amount) as total_cost,
    instance_type,
    product,
    region,
    pricing_model
    -- tag_keys,
    -- tag_values
from joined
group by
    month,
    instance_type,
    product,
    region,
    pricing_model
order by
    month,
    instance_type,
    product,
    region,
    pricing_model
    -- tag_keys,
    -- tag_values
    );
  
  
[0m17:37:53.256638 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/harsha/data_actions/supercell_cloudops/target/run_results.json
[0m17:37:53.258504 [debug] [MainThread]: DuckDB adapter: cancelling query on connection model.supercell.total_cost. Details: Connection(type='duckdb', name='model.supercell.total_cost', state=<ConnectionState.OPEN: 'open'>, transaction_open=True, _handle=<dbt.adapters.duckdb.environments.local.DuckDBConnectionWrapper object at 0x7b51069aa450>, _credentials=DuckDBCredentials(database='supercell', schema='main', path='/home/harsha/data_actions/supercell_cloudops/supercell.duckdb', config_options=None, extensions=None, settings={}, secrets=[], external_root='.', use_credential_provider=None, attach=None, filesystems=None, remote=None, plugins=None, disable_transactions=False, keep_open=True, module_paths=None, retries=None))
[0m17:37:53.259242 [debug] [MainThread]: DuckDB adapter: query cancelled on connection model.supercell.total_cost
[0m17:37:53.259801 [error] [MainThread]: CANCEL query model.supercell.total_cost ........................................ [[31mCANCEL[0m]
[0m17:37:53.260382 [error] [MainThread]: CANCEL query model.supercell.dim_accounts ...................................... [[31mCANCEL[0m]
[0m17:37:53.261296 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.total_cost"} */

  
    
    

    create  table
      "supercell"."main"."total_cost__dbt_tmp"
  
    as (
      

with base as (
    select
        fact_bill_generation.resource_id,
        date_trunc('month', fact_bill_generation.bill_date) as month,
        fact_bill_generation.bill_amount,
        dim_resource.instance_type,
        dim_resource.product,
        dim_resource.region,
        dim_resource.pricing_model,
        dim_resource.linked_account_id
    from "supercell"."main"."fact_bill_generation" as fact_bill_generation
    left join "supercell"."main"."dim_resource" as dim_resource
        on fact_bill_generation.resource_id = dim_resource.resource_id
),
joined as (
    select
        base.*,
        dim_accounts.linked_account_id  -- only if needed
        -- dim_accounts.tag_keys as tag_keys,
        -- dim_accounts.tag_values as tag_values
    from base
    left join "supercell"."main"."dim_accounts" as dim_accounts
        on base.linked_account_id = dim_accounts.linked_account_id
)

select
    month,
    sum(bill_amount) as total_cost,
    instance_type,
    product,
    region,
    pricing_model
    -- tag_keys,
    -- tag_values
from joined
group by
    month,
    instance_type,
    product,
    region,
    pricing_model
order by
    month,
    instance_type,
    product,
    region,
    pricing_model
    -- tag_keys,
    -- tag_values
    );
  
  
[0m17:37:53.261881 [error] [MainThread]: CANCEL query model.supercell.dim_resource ...................................... [[31mCANCEL[0m]
[0m17:37:53.262614 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m17:37:53.263196 [error] [MainThread]: CANCEL query model.supercell.fact_bill_generation .............................. [[31mCANCEL[0m]
[0m17:37:53.264109 [debug] [Thread-1 (]: On model.supercell.total_cost: ROLLBACK
[0m17:37:53.269809 [debug] [Thread-1 (]: Failed to rollback 'model.supercell.total_cost'
[0m17:37:53.270501 [debug] [Thread-1 (]: On model.supercell.total_cost: Close
[0m17:37:53.279403 [debug] [Thread-1 (]: Runtime Error in model total_cost (models/supercell_models/metrics/total_cost.sql)
  INTERRUPT Error: Interrupted!
[0m17:37:53.280182 [error] [Thread-1 (]: 5 of 5 ERROR creating sql table model main.total_cost .......................... [[31mERROR[0m in 50.17s]
[0m17:37:53.280718 [debug] [Thread-1 (]: Finished running node model.supercell.total_cost
[0m17:37:53.281154 [info ] [MainThread]: 
[0m17:37:53.281832 [info ] [MainThread]: [33mExited because of keyboard interrupt[0m
[0m17:37:53.282331 [info ] [MainThread]: 
[0m17:37:53.282829 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m17:37:53.283307 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:37:53.283705 [debug] [MainThread]: Connection 'model.supercell.total_cost' was properly closed.
[0m17:37:53.284089 [debug] [MainThread]: Connection 'model.supercell.dim_accounts' was properly closed.
[0m17:37:53.284511 [debug] [MainThread]: Connection 'model.supercell.dim_resource' was properly closed.
[0m17:37:53.284898 [debug] [MainThread]: Connection 'model.supercell.fact_bill_generation' was properly closed.
[0m17:37:53.285456 [info ] [MainThread]: 
[0m17:37:53.286003 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 51.06 seconds (51.06s).
[0m17:37:53.286692 [error] [MainThread]: Encountered an error:

[0m17:37:53.288154 [error] [MainThread]: Traceback (most recent call last):
  File "/home/harsha/data_actions/supercell_cloudops/supercell_env/lib/python3.12/site-packages/dbt/cli/requires.py", line 153, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "/home/harsha/data_actions/supercell_cloudops/supercell_env/lib/python3.12/site-packages/dbt/cli/requires.py", line 103, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/harsha/data_actions/supercell_cloudops/supercell_env/lib/python3.12/site-packages/dbt/cli/requires.py", line 235, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/harsha/data_actions/supercell_cloudops/supercell_env/lib/python3.12/site-packages/dbt/cli/requires.py", line 264, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/harsha/data_actions/supercell_cloudops/supercell_env/lib/python3.12/site-packages/dbt/cli/requires.py", line 311, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/harsha/data_actions/supercell_cloudops/supercell_env/lib/python3.12/site-packages/dbt/cli/requires.py", line 328, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/harsha/data_actions/supercell_cloudops/supercell_env/lib/python3.12/site-packages/dbt/cli/main.py", line 578, in run
    results = task.run()
              ^^^^^^^^^^
  File "/home/harsha/data_actions/supercell_cloudops/supercell_env/lib/python3.12/site-packages/dbt/task/runnable.py", line 590, in run
    result = self.execute_with_hooks(selected_uids)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/harsha/data_actions/supercell_cloudops/supercell_env/lib/python3.12/site-packages/dbt/task/runnable.py", line 532, in execute_with_hooks
    res = self.execute_nodes()
          ^^^^^^^^^^^^^^^^^^^^
  File "/home/harsha/data_actions/supercell_cloudops/supercell_env/lib/python3.12/site-packages/dbt/task/runnable.py", line 413, in execute_nodes
    self.run_queue(pool)
  File "/home/harsha/data_actions/supercell_cloudops/supercell_env/lib/python3.12/site-packages/dbt/task/runnable.py", line 340, in run_queue
    self.job_queue.join()
  File "/home/harsha/data_actions/supercell_cloudops/supercell_env/lib/python3.12/site-packages/dbt/graph/queue.py", line 206, in join
    self.inner.join()
  File "/usr/lib/python3.12/queue.py", line 90, in join
    self.all_tasks_done.wait()
  File "/usr/lib/python3.12/threading.py", line 355, in wait
    waiter.acquire()
KeyboardInterrupt

[0m17:37:53.289078 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 51.539604, "process_in_blocks": "0", "process_kernel_time": 0.490908, "process_mem_max_rss": "344400", "process_out_blocks": "58352", "process_user_time": 254.83948}
[0m17:37:53.289508 [debug] [MainThread]: Command `dbt run` failed at 17:37:53.289418 after 51.54 seconds
[0m17:37:53.289798 [debug] [MainThread]: Flushing usage events


============================== 17:38:19.070901 | fd2eba0d-57a8-47a0-88b4-243ffbb39867 ==============================
[0m17:38:19.070901 [info ] [MainThread]: Running with dbt=1.9.4
[0m17:38:19.073027 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/harsha/data_actions/supercell_cloudops', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/home/harsha/data_actions/supercell_cloudops/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'False'}
[0m17:38:19.073276 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality

User config should be moved from the 'config' key in profiles.yml to the 'flags' key in dbt_project.yml.
[0m17:38:19.230709 [info ] [MainThread]: Registered adapter: duckdb=1.9.3
[0m17:38:19.269574 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m17:38:19.310620 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:38:19.311044 [debug] [MainThread]: Partial parsing: updated file: supercell://models/supercell_models/metrics/total_cost.sql
[0m17:38:19.453626 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.supercell.example
[0m17:38:19.486476 [debug] [MainThread]: Wrote artifact WritableManifest to /home/harsha/data_actions/supercell_cloudops/target/manifest.json
[0m17:38:19.487565 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/harsha/data_actions/supercell_cloudops/target/semantic_manifest.json
[0m17:38:19.494152 [info ] [MainThread]: Found 5 models, 428 macros
[0m17:38:19.495311 [info ] [MainThread]: 
[0m17:38:19.495657 [info ] [MainThread]: Concurrency: 4 threads (target='default')
[0m17:38:19.495844 [info ] [MainThread]: 
[0m17:38:19.496164 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m17:38:19.500735 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_supercell'
[0m17:38:19.521834 [debug] [ThreadPool]: Using duckdb connection "list_supercell"
[0m17:38:19.522143 [debug] [ThreadPool]: On list_supercell: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "connection_name": "list_supercell"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"supercell"'
    
  
  
[0m17:38:19.522360 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:38:19.530268 [debug] [ThreadPool]: SQL status: OK in 0.008 seconds
[0m17:38:19.531184 [debug] [ThreadPool]: On list_supercell: Close
[0m17:38:19.531695 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_supercell, now create_supercell_main)
[0m17:38:19.532000 [debug] [ThreadPool]: Creating schema "database: "supercell"
schema: "main"
"
[0m17:38:19.536087 [debug] [ThreadPool]: Using duckdb connection "create_supercell_main"
[0m17:38:19.536354 [debug] [ThreadPool]: On create_supercell_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "connection_name": "create_supercell_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='supercell'
        and type='sqlite'
    
  
[0m17:38:19.536521 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:38:19.537204 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m17:38:19.537994 [debug] [ThreadPool]: Using duckdb connection "create_supercell_main"
[0m17:38:19.538216 [debug] [ThreadPool]: On create_supercell_main: BEGIN
[0m17:38:19.538519 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:38:19.538682 [debug] [ThreadPool]: Using duckdb connection "create_supercell_main"
[0m17:38:19.538824 [debug] [ThreadPool]: On create_supercell_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "connection_name": "create_supercell_main"} */

    
    
        create schema if not exists "supercell"."main"
    
[0m17:38:19.539084 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:38:19.539588 [debug] [ThreadPool]: On create_supercell_main: COMMIT
[0m17:38:19.539785 [debug] [ThreadPool]: Using duckdb connection "create_supercell_main"
[0m17:38:19.539935 [debug] [ThreadPool]: On create_supercell_main: COMMIT
[0m17:38:19.540194 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:38:19.540391 [debug] [ThreadPool]: On create_supercell_main: Close
[0m17:38:19.541268 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_supercell_main, now list_supercell_main)
[0m17:38:19.544358 [debug] [ThreadPool]: Using duckdb connection "list_supercell_main"
[0m17:38:19.544559 [debug] [ThreadPool]: On list_supercell_main: BEGIN
[0m17:38:19.544712 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:38:19.545049 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:38:19.545247 [debug] [ThreadPool]: Using duckdb connection "list_supercell_main"
[0m17:38:19.545411 [debug] [ThreadPool]: On list_supercell_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "connection_name": "list_supercell_main"} */
select
      'supercell' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'supercell'
  
[0m17:38:19.553670 [debug] [ThreadPool]: SQL status: OK in 0.008 seconds
[0m17:38:19.554643 [debug] [ThreadPool]: On list_supercell_main: ROLLBACK
[0m17:38:19.555333 [debug] [ThreadPool]: Failed to rollback 'list_supercell_main'
[0m17:38:19.555542 [debug] [ThreadPool]: On list_supercell_main: Close
[0m17:38:19.556616 [debug] [MainThread]: Using duckdb connection "master"
[0m17:38:19.556820 [debug] [MainThread]: On master: BEGIN
[0m17:38:19.556981 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:38:19.557380 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:38:19.557590 [debug] [MainThread]: On master: COMMIT
[0m17:38:19.557768 [debug] [MainThread]: Using duckdb connection "master"
[0m17:38:19.557924 [debug] [MainThread]: On master: COMMIT
[0m17:38:19.558188 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:38:19.558384 [debug] [MainThread]: On master: Close
[0m17:38:19.560251 [debug] [Thread-1 (]: Began running node model.supercell.cleaned_usagelogs
[0m17:38:19.560654 [info ] [Thread-1 (]: 1 of 5 START sql table model main.cleaned_usagelogs ............................ [RUN]
[0m17:38:19.560968 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_supercell_main, now model.supercell.cleaned_usagelogs)
[0m17:38:19.561211 [debug] [Thread-1 (]: Began compiling node model.supercell.cleaned_usagelogs
[0m17:38:19.566857 [debug] [Thread-1 (]: Writing injected SQL for node "model.supercell.cleaned_usagelogs"
[0m17:38:19.567477 [debug] [Thread-1 (]: Began executing node model.supercell.cleaned_usagelogs
[0m17:38:19.586132 [debug] [Thread-1 (]: Writing runtime sql for node "model.supercell.cleaned_usagelogs"
[0m17:38:19.586664 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.cleaned_usagelogs"
[0m17:38:19.586884 [debug] [Thread-1 (]: On model.supercell.cleaned_usagelogs: BEGIN
[0m17:38:19.587060 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:38:19.587667 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:38:19.587890 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.cleaned_usagelogs"
[0m17:38:19.588087 [debug] [Thread-1 (]: On model.supercell.cleaned_usagelogs: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.cleaned_usagelogs"} */

  
    
    

    create  table
      "supercell"."main"."cleaned_usagelogs__dbt_tmp"
  
    as (
      


SELECT
    CAST("LinkedAccountId" AS VARCHAR) AS linked_account_id,
    CAST("bill/PayerAccountId" AS VARCHAR) AS payer_account_id,
    CAST("lineItem/UsageStartDate" AS TIMESTAMP) AS usage_start_date,
    CAST("lineItem/UsageEndDate" AS TIMESTAMP) AS usage_end_date,
    CAST("lineItem/UsageAmount" AS DECIMAL(18, 6)) AS usage_amount,
    CAST("lineItem/Operation" AS VARCHAR) AS operation,
    CAST("pricing/PricingModel" AS VARCHAR) AS pricing_model,
    CAST("resourceTags/TagKeys" AS VARCHAR) AS tag_keys,
    CAST("resourceTags/TagValues" AS VARCHAR) AS tag_values,
    CAST("product/Region" AS VARCHAR) AS region,
    CAST("product/ServiceCode" AS VARCHAR) AS service_code,
    CAST("product/InstanceType" AS VARCHAR) AS instance_type,
    CAST("amortized_cost" AS DECIMAL(18, 6)) AS amortized_cost,
    CAST("product/Description" AS VARCHAR) AS description
FROM supercell_usagelogs
    );
  
  
[0m17:38:19.854926 [debug] [Thread-1 (]: SQL status: OK in 0.267 seconds
[0m17:38:19.858731 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.cleaned_usagelogs"
[0m17:38:19.858995 [debug] [Thread-1 (]: On model.supercell.cleaned_usagelogs: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.cleaned_usagelogs"} */
alter table "supercell"."main"."cleaned_usagelogs" rename to "cleaned_usagelogs__dbt_backup"
[0m17:38:19.859539 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:38:19.861018 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.cleaned_usagelogs"
[0m17:38:19.861251 [debug] [Thread-1 (]: On model.supercell.cleaned_usagelogs: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.cleaned_usagelogs"} */
alter table "supercell"."main"."cleaned_usagelogs__dbt_tmp" rename to "cleaned_usagelogs"
[0m17:38:19.861633 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:38:19.870466 [debug] [Thread-1 (]: On model.supercell.cleaned_usagelogs: COMMIT
[0m17:38:19.870774 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.cleaned_usagelogs"
[0m17:38:19.870961 [debug] [Thread-1 (]: On model.supercell.cleaned_usagelogs: COMMIT
[0m17:38:19.880370 [debug] [Thread-1 (]: SQL status: OK in 0.009 seconds
[0m17:38:19.883389 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.cleaned_usagelogs"
[0m17:38:19.883681 [debug] [Thread-1 (]: On model.supercell.cleaned_usagelogs: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.cleaned_usagelogs"} */
drop table if exists "supercell"."main"."cleaned_usagelogs__dbt_backup" cascade
[0m17:38:19.885562 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m17:38:19.887090 [debug] [Thread-1 (]: On model.supercell.cleaned_usagelogs: Close
[0m17:38:19.891612 [info ] [Thread-1 (]: 1 of 5 OK created sql table model main.cleaned_usagelogs ....................... [[32mOK[0m in 0.33s]
[0m17:38:19.891997 [debug] [Thread-1 (]: Finished running node model.supercell.cleaned_usagelogs
[0m17:38:19.893014 [debug] [Thread-3 (]: Began running node model.supercell.dim_accounts
[0m17:38:19.893734 [info ] [Thread-3 (]: 2 of 5 START sql table model main.dim_accounts ................................. [RUN]
[0m17:38:19.894367 [debug] [Thread-3 (]: Acquiring new duckdb connection 'model.supercell.dim_accounts'
[0m17:38:19.894855 [debug] [Thread-3 (]: Began compiling node model.supercell.dim_accounts
[0m17:38:19.895449 [debug] [Thread-4 (]: Began running node model.supercell.dim_resource
[0m17:38:19.901390 [debug] [Thread-2 (]: Began running node model.supercell.fact_bill_generation
[0m17:38:19.902688 [info ] [Thread-4 (]: 3 of 5 START sql table model main.dim_resource ................................. [RUN]
[0m17:38:19.903230 [debug] [Thread-3 (]: Writing injected SQL for node "model.supercell.dim_accounts"
[0m17:38:19.904216 [info ] [Thread-2 (]: 4 of 5 START sql table model main.fact_bill_generation ......................... [RUN]
[0m17:38:19.905213 [debug] [Thread-4 (]: Acquiring new duckdb connection 'model.supercell.dim_resource'
[0m17:38:19.906062 [debug] [Thread-2 (]: Acquiring new duckdb connection 'model.supercell.fact_bill_generation'
[0m17:38:19.907010 [debug] [Thread-3 (]: Began executing node model.supercell.dim_accounts
[0m17:38:19.907741 [debug] [Thread-4 (]: Began compiling node model.supercell.dim_resource
[0m17:38:19.908298 [debug] [Thread-2 (]: Began compiling node model.supercell.fact_bill_generation
[0m17:38:19.911154 [debug] [Thread-3 (]: Writing runtime sql for node "model.supercell.dim_accounts"
[0m17:38:19.913725 [debug] [Thread-4 (]: Writing injected SQL for node "model.supercell.dim_resource"
[0m17:38:19.915495 [debug] [Thread-2 (]: Writing injected SQL for node "model.supercell.fact_bill_generation"
[0m17:38:19.916775 [debug] [Thread-3 (]: Using duckdb connection "model.supercell.dim_accounts"
[0m17:38:19.917585 [debug] [Thread-3 (]: On model.supercell.dim_accounts: BEGIN
[0m17:38:19.917972 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m17:38:19.918596 [debug] [Thread-2 (]: Began executing node model.supercell.fact_bill_generation
[0m17:38:19.920733 [debug] [Thread-2 (]: Writing runtime sql for node "model.supercell.fact_bill_generation"
[0m17:38:19.921205 [debug] [Thread-2 (]: Using duckdb connection "model.supercell.fact_bill_generation"
[0m17:38:19.921438 [debug] [Thread-2 (]: On model.supercell.fact_bill_generation: BEGIN
[0m17:38:19.921618 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m17:38:19.921974 [debug] [Thread-4 (]: Began executing node model.supercell.dim_resource
[0m17:38:19.922411 [debug] [Thread-3 (]: SQL status: OK in 0.004 seconds
[0m17:38:19.925110 [debug] [Thread-4 (]: Writing runtime sql for node "model.supercell.dim_resource"
[0m17:38:19.925556 [debug] [Thread-2 (]: SQL status: OK in 0.004 seconds
[0m17:38:19.925965 [debug] [Thread-3 (]: Using duckdb connection "model.supercell.dim_accounts"
[0m17:38:19.926441 [debug] [Thread-2 (]: Using duckdb connection "model.supercell.fact_bill_generation"
[0m17:38:19.926839 [debug] [Thread-3 (]: On model.supercell.dim_accounts: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.dim_accounts"} */

  
    
    

    create  table
      "supercell"."main"."dim_accounts__dbt_tmp"
  
    as (
      


select
    linked_account_id as linked_account_id,
    tag_keys as tag_keys,
    tag_values as tag_values
from "supercell"."main"."cleaned_usagelogs"
    );
  
  
[0m17:38:19.927259 [debug] [Thread-4 (]: Using duckdb connection "model.supercell.dim_resource"
[0m17:38:19.927749 [debug] [Thread-2 (]: On model.supercell.fact_bill_generation: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.fact_bill_generation"} */

  
    
    

    create  table
      "supercell"."main"."fact_bill_generation__dbt_tmp"
  
    as (
      


select
    md5(concat(linked_account_id, '_', service_code, '_', instance_type, '_', region, '_', CAST(usage_start_date AS VARCHAR), '_', CAST(usage_end_date AS VARCHAR))) AS resource_id,
    usage_start_date as start_date,
    usage_end_date as bill_date,
    usage_amount as bill_amount,
    operation
from "supercell"."main"."cleaned_usagelogs"
    );
  
  
[0m17:38:19.928311 [debug] [Thread-4 (]: On model.supercell.dim_resource: BEGIN
[0m17:38:19.928775 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m17:38:19.929623 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m17:38:19.930790 [debug] [Thread-4 (]: Using duckdb connection "model.supercell.dim_resource"
[0m17:38:19.932482 [debug] [Thread-4 (]: On model.supercell.dim_resource: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.dim_resource"} */

  
    
    

    create  table
      "supercell"."main"."dim_resource__dbt_tmp"
  
    as (
      


select
    md5(concat(linked_account_id, '_', service_code, '_', instance_type, '_', region, '_', CAST(usage_start_date AS VARCHAR), '_', CAST(usage_end_date AS VARCHAR))) AS resource_id,
    linked_account_id as linked_account_id,
    region,
    service_code as product,
    instance_type as instance_type,
    pricing_model as pricing_model
from "supercell"."main"."cleaned_usagelogs"
    );
  
  
[0m17:38:20.040830 [debug] [Thread-3 (]: SQL status: OK in 0.113 seconds
[0m17:38:20.043956 [debug] [Thread-3 (]: Using duckdb connection "model.supercell.dim_accounts"
[0m17:38:20.044593 [debug] [Thread-3 (]: On model.supercell.dim_accounts: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.dim_accounts"} */
alter table "supercell"."main"."dim_accounts" rename to "dim_accounts__dbt_backup"
[0m17:38:20.045622 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m17:38:20.048541 [debug] [Thread-3 (]: Using duckdb connection "model.supercell.dim_accounts"
[0m17:38:20.049133 [debug] [Thread-3 (]: On model.supercell.dim_accounts: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.dim_accounts"} */
alter table "supercell"."main"."dim_accounts__dbt_tmp" rename to "dim_accounts"
[0m17:38:20.050147 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m17:38:20.052487 [debug] [Thread-3 (]: On model.supercell.dim_accounts: COMMIT
[0m17:38:20.053043 [debug] [Thread-3 (]: Using duckdb connection "model.supercell.dim_accounts"
[0m17:38:20.053494 [debug] [Thread-3 (]: On model.supercell.dim_accounts: COMMIT
[0m17:38:20.062647 [debug] [Thread-3 (]: SQL status: OK in 0.009 seconds
[0m17:38:20.066562 [debug] [Thread-3 (]: Using duckdb connection "model.supercell.dim_accounts"
[0m17:38:20.069108 [debug] [Thread-3 (]: On model.supercell.dim_accounts: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.dim_accounts"} */
drop table if exists "supercell"."main"."dim_accounts__dbt_backup" cascade
[0m17:38:20.076185 [debug] [Thread-3 (]: SQL status: OK in 0.005 seconds
[0m17:38:20.078144 [debug] [Thread-3 (]: On model.supercell.dim_accounts: Close
[0m17:38:20.083716 [info ] [Thread-3 (]: 2 of 5 OK created sql table model main.dim_accounts ............................ [[32mOK[0m in 0.19s]
[0m17:38:20.084774 [debug] [Thread-3 (]: Finished running node model.supercell.dim_accounts
[0m17:38:20.096512 [debug] [Thread-2 (]: SQL status: OK in 0.168 seconds
[0m17:38:20.099646 [debug] [Thread-2 (]: Using duckdb connection "model.supercell.fact_bill_generation"
[0m17:38:20.100305 [debug] [Thread-2 (]: On model.supercell.fact_bill_generation: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.fact_bill_generation"} */
alter table "supercell"."main"."fact_bill_generation" rename to "fact_bill_generation__dbt_backup"
[0m17:38:20.101184 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m17:38:20.103639 [debug] [Thread-2 (]: Using duckdb connection "model.supercell.fact_bill_generation"
[0m17:38:20.104021 [debug] [Thread-2 (]: On model.supercell.fact_bill_generation: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.fact_bill_generation"} */
alter table "supercell"."main"."fact_bill_generation__dbt_tmp" rename to "fact_bill_generation"
[0m17:38:20.104789 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m17:38:20.106454 [debug] [Thread-2 (]: On model.supercell.fact_bill_generation: COMMIT
[0m17:38:20.106838 [debug] [Thread-2 (]: Using duckdb connection "model.supercell.fact_bill_generation"
[0m17:38:20.107169 [debug] [Thread-2 (]: On model.supercell.fact_bill_generation: COMMIT
[0m17:38:20.113720 [debug] [Thread-2 (]: SQL status: OK in 0.006 seconds
[0m17:38:20.117350 [debug] [Thread-2 (]: Using duckdb connection "model.supercell.fact_bill_generation"
[0m17:38:20.117809 [debug] [Thread-2 (]: On model.supercell.fact_bill_generation: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.fact_bill_generation"} */
drop table if exists "supercell"."main"."fact_bill_generation__dbt_backup" cascade
[0m17:38:20.119586 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m17:38:20.120881 [debug] [Thread-2 (]: On model.supercell.fact_bill_generation: Close
[0m17:38:20.123225 [info ] [Thread-2 (]: 4 of 5 OK created sql table model main.fact_bill_generation .................... [[32mOK[0m in 0.22s]
[0m17:38:20.123868 [debug] [Thread-2 (]: Finished running node model.supercell.fact_bill_generation
[0m17:38:20.214240 [debug] [Thread-4 (]: SQL status: OK in 0.280 seconds
[0m17:38:20.216059 [debug] [Thread-4 (]: Using duckdb connection "model.supercell.dim_resource"
[0m17:38:20.216394 [debug] [Thread-4 (]: On model.supercell.dim_resource: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.dim_resource"} */
alter table "supercell"."main"."dim_resource" rename to "dim_resource__dbt_backup"
[0m17:38:20.217097 [debug] [Thread-4 (]: SQL status: OK in 0.000 seconds
[0m17:38:20.218982 [debug] [Thread-4 (]: Using duckdb connection "model.supercell.dim_resource"
[0m17:38:20.219320 [debug] [Thread-4 (]: On model.supercell.dim_resource: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.dim_resource"} */
alter table "supercell"."main"."dim_resource__dbt_tmp" rename to "dim_resource"
[0m17:38:20.219930 [debug] [Thread-4 (]: SQL status: OK in 0.000 seconds
[0m17:38:20.221078 [debug] [Thread-4 (]: On model.supercell.dim_resource: COMMIT
[0m17:38:20.221331 [debug] [Thread-4 (]: Using duckdb connection "model.supercell.dim_resource"
[0m17:38:20.221556 [debug] [Thread-4 (]: On model.supercell.dim_resource: COMMIT
[0m17:38:20.227630 [debug] [Thread-4 (]: SQL status: OK in 0.006 seconds
[0m17:38:20.229086 [debug] [Thread-4 (]: Using duckdb connection "model.supercell.dim_resource"
[0m17:38:20.229373 [debug] [Thread-4 (]: On model.supercell.dim_resource: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.dim_resource"} */
drop table if exists "supercell"."main"."dim_resource__dbt_backup" cascade
[0m17:38:20.231126 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m17:38:20.232021 [debug] [Thread-4 (]: On model.supercell.dim_resource: Close
[0m17:38:20.235056 [info ] [Thread-4 (]: 3 of 5 OK created sql table model main.dim_resource ............................ [[32mOK[0m in 0.33s]
[0m17:38:20.235503 [debug] [Thread-4 (]: Finished running node model.supercell.dim_resource
[0m17:38:20.236097 [debug] [Thread-1 (]: Began running node model.supercell.total_cost
[0m17:38:20.236556 [info ] [Thread-1 (]: 5 of 5 START sql table model main.total_cost ................................... [RUN]
[0m17:38:20.236923 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.supercell.cleaned_usagelogs, now model.supercell.total_cost)
[0m17:38:20.237168 [debug] [Thread-1 (]: Began compiling node model.supercell.total_cost
[0m17:38:20.240370 [debug] [Thread-1 (]: Writing injected SQL for node "model.supercell.total_cost"
[0m17:38:20.241756 [debug] [Thread-1 (]: Began executing node model.supercell.total_cost
[0m17:38:20.245172 [debug] [Thread-1 (]: Writing runtime sql for node "model.supercell.total_cost"
[0m17:38:20.246132 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.total_cost"
[0m17:38:20.246473 [debug] [Thread-1 (]: On model.supercell.total_cost: BEGIN
[0m17:38:20.246697 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:38:20.247509 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:38:20.247883 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.total_cost"
[0m17:38:20.248169 [debug] [Thread-1 (]: On model.supercell.total_cost: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.total_cost"} */

  
    
    

    create  table
      "supercell"."main"."total_cost__dbt_tmp"
  
    as (
      

with base as (
    select
        fact_bill_generation.resource_id,
        date_trunc('month', fact_bill_generation.bill_date) as month,
        fact_bill_generation.bill_amount,
        dim_resource.instance_type,
        dim_resource.product,
        dim_resource.region,
        dim_resource.pricing_model,
        dim_resource.linked_account_id
    from "supercell"."main"."fact_bill_generation" as fact_bill_generation
    left join "supercell"."main"."dim_resource" as dim_resource
        on fact_bill_generation.resource_id = dim_resource.resource_id
)
-- ,
-- joined as (
--     select
--         base.*,
--         dim_accounts.linked_account_id
--         -- dim_accounts.tag_keys as tag_keys,
--         -- dim_accounts.tag_values as tag_values
--     from base
--     left join "supercell"."main"."dim_accounts" as dim_accounts
--         on base.linked_account_id = dim_accounts.linked_account_id
-- )

select
    month,
    sum(bill_amount) as total_cost,
    instance_type,
    product,
    region,
    pricing_model
    -- tag_keys,
    -- tag_values
from base
group by
    month,
    instance_type,
    product,
    region,
    pricing_model
order by
    month,
    instance_type,
    product,
    region,
    pricing_model
    -- tag_keys,
    -- tag_values
    );
  
  
[0m17:38:20.524920 [debug] [Thread-1 (]: SQL status: OK in 0.276 seconds
[0m17:38:20.526836 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.total_cost"
[0m17:38:20.527103 [debug] [Thread-1 (]: On model.supercell.total_cost: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.total_cost"} */
alter table "supercell"."main"."total_cost" rename to "total_cost__dbt_backup"
[0m17:38:20.527662 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:38:20.529396 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.total_cost"
[0m17:38:20.529630 [debug] [Thread-1 (]: On model.supercell.total_cost: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.total_cost"} */
alter table "supercell"."main"."total_cost__dbt_tmp" rename to "total_cost"
[0m17:38:20.530061 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:38:20.531228 [debug] [Thread-1 (]: On model.supercell.total_cost: COMMIT
[0m17:38:20.531475 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.total_cost"
[0m17:38:20.531687 [debug] [Thread-1 (]: On model.supercell.total_cost: COMMIT
[0m17:38:20.534680 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m17:38:20.536142 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.total_cost"
[0m17:38:20.536407 [debug] [Thread-1 (]: On model.supercell.total_cost: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.total_cost"} */
drop table if exists "supercell"."main"."total_cost__dbt_backup" cascade
[0m17:38:20.537894 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:38:20.538725 [debug] [Thread-1 (]: On model.supercell.total_cost: Close
[0m17:38:20.542407 [info ] [Thread-1 (]: 5 of 5 OK created sql table model main.total_cost .............................. [[32mOK[0m in 0.31s]
[0m17:38:20.542807 [debug] [Thread-1 (]: Finished running node model.supercell.total_cost
[0m17:38:20.544426 [debug] [MainThread]: Using duckdb connection "master"
[0m17:38:20.544862 [debug] [MainThread]: On master: BEGIN
[0m17:38:20.545194 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:38:20.546275 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m17:38:20.546749 [debug] [MainThread]: On master: COMMIT
[0m17:38:20.546969 [debug] [MainThread]: Using duckdb connection "master"
[0m17:38:20.547160 [debug] [MainThread]: On master: COMMIT
[0m17:38:20.547616 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:38:20.547835 [debug] [MainThread]: On master: Close
[0m17:38:20.548417 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:38:20.548659 [debug] [MainThread]: Connection 'model.supercell.total_cost' was properly closed.
[0m17:38:20.548830 [debug] [MainThread]: Connection 'model.supercell.dim_accounts' was properly closed.
[0m17:38:20.548986 [debug] [MainThread]: Connection 'model.supercell.dim_resource' was properly closed.
[0m17:38:20.549149 [debug] [MainThread]: Connection 'model.supercell.fact_bill_generation' was properly closed.
[0m17:38:20.549406 [info ] [MainThread]: 
[0m17:38:20.549602 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 1.05 seconds (1.05s).
[0m17:38:20.550267 [debug] [MainThread]: Command end result
[0m17:38:20.603205 [debug] [MainThread]: Wrote artifact WritableManifest to /home/harsha/data_actions/supercell_cloudops/target/manifest.json
[0m17:38:20.604235 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/harsha/data_actions/supercell_cloudops/target/semantic_manifest.json
[0m17:38:20.607874 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/harsha/data_actions/supercell_cloudops/target/run_results.json
[0m17:38:20.608286 [info ] [MainThread]: 
[0m17:38:20.608546 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:38:20.608717 [info ] [MainThread]: 
[0m17:38:20.608894 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m17:38:20.609585 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.5766399, "process_in_blocks": "0", "process_kernel_time": 0.346413, "process_mem_max_rss": "339260", "process_out_blocks": "59752", "process_user_time": 5.178186}
[0m17:38:20.609925 [debug] [MainThread]: Command `dbt run` succeeded at 17:38:20.609862 after 1.58 seconds
[0m17:38:20.610129 [debug] [MainThread]: Flushing usage events


============================== 17:40:39.024406 | aab61b6e-0e78-4f27-ac9a-7295ff3676ab ==============================
[0m17:40:39.024406 [info ] [MainThread]: Running with dbt=1.9.4
[0m17:40:39.026490 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/harsha/data_actions/supercell_cloudops', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/harsha/data_actions/supercell_cloudops/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'False'}
[0m17:40:39.026781 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality

User config should be moved from the 'config' key in profiles.yml to the 'flags' key in dbt_project.yml.
[0m17:40:39.181485 [info ] [MainThread]: Registered adapter: duckdb=1.9.3
[0m17:40:39.219144 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m17:40:39.258869 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:40:39.259318 [debug] [MainThread]: Partial parsing: updated file: supercell://models/supercell_models/metrics/total_cost.sql
[0m17:40:39.400000 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.supercell.example
[0m17:40:39.432962 [debug] [MainThread]: Wrote artifact WritableManifest to /home/harsha/data_actions/supercell_cloudops/target/manifest.json
[0m17:40:39.434008 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/harsha/data_actions/supercell_cloudops/target/semantic_manifest.json
[0m17:40:39.441120 [info ] [MainThread]: Found 5 models, 428 macros
[0m17:40:39.442451 [info ] [MainThread]: 
[0m17:40:39.442782 [info ] [MainThread]: Concurrency: 4 threads (target='default')
[0m17:40:39.442979 [info ] [MainThread]: 
[0m17:40:39.443316 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m17:40:39.448099 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_supercell'
[0m17:40:39.468272 [debug] [ThreadPool]: Using duckdb connection "list_supercell"
[0m17:40:39.468586 [debug] [ThreadPool]: On list_supercell: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "connection_name": "list_supercell"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"supercell"'
    
  
  
[0m17:40:39.468768 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:40:39.476366 [debug] [ThreadPool]: SQL status: OK in 0.008 seconds
[0m17:40:39.477276 [debug] [ThreadPool]: On list_supercell: Close
[0m17:40:39.477856 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_supercell, now create_supercell_main)
[0m17:40:39.478221 [debug] [ThreadPool]: Creating schema "database: "supercell"
schema: "main"
"
[0m17:40:39.482647 [debug] [ThreadPool]: Using duckdb connection "create_supercell_main"
[0m17:40:39.482972 [debug] [ThreadPool]: On create_supercell_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "connection_name": "create_supercell_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='supercell'
        and type='sqlite'
    
  
[0m17:40:39.483158 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:40:39.485235 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m17:40:39.487026 [debug] [ThreadPool]: Using duckdb connection "create_supercell_main"
[0m17:40:39.487299 [debug] [ThreadPool]: On create_supercell_main: BEGIN
[0m17:40:39.487776 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:40:39.487981 [debug] [ThreadPool]: Using duckdb connection "create_supercell_main"
[0m17:40:39.488163 [debug] [ThreadPool]: On create_supercell_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "connection_name": "create_supercell_main"} */

    
    
        create schema if not exists "supercell"."main"
    
[0m17:40:39.488585 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:40:39.489087 [debug] [ThreadPool]: On create_supercell_main: COMMIT
[0m17:40:39.489304 [debug] [ThreadPool]: Using duckdb connection "create_supercell_main"
[0m17:40:39.489453 [debug] [ThreadPool]: On create_supercell_main: COMMIT
[0m17:40:39.489723 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:40:39.489910 [debug] [ThreadPool]: On create_supercell_main: Close
[0m17:40:39.491227 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_supercell_main, now list_supercell_main)
[0m17:40:39.494560 [debug] [ThreadPool]: Using duckdb connection "list_supercell_main"
[0m17:40:39.494806 [debug] [ThreadPool]: On list_supercell_main: BEGIN
[0m17:40:39.495007 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:40:39.495515 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:40:39.495721 [debug] [ThreadPool]: Using duckdb connection "list_supercell_main"
[0m17:40:39.495903 [debug] [ThreadPool]: On list_supercell_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "connection_name": "list_supercell_main"} */
select
      'supercell' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'supercell'
  
[0m17:40:39.504446 [debug] [ThreadPool]: SQL status: OK in 0.008 seconds
[0m17:40:39.505477 [debug] [ThreadPool]: On list_supercell_main: ROLLBACK
[0m17:40:39.506185 [debug] [ThreadPool]: Failed to rollback 'list_supercell_main'
[0m17:40:39.506387 [debug] [ThreadPool]: On list_supercell_main: Close
[0m17:40:39.507828 [debug] [MainThread]: Using duckdb connection "master"
[0m17:40:39.508028 [debug] [MainThread]: On master: BEGIN
[0m17:40:39.508223 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:40:39.508657 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:40:39.508849 [debug] [MainThread]: On master: COMMIT
[0m17:40:39.509013 [debug] [MainThread]: Using duckdb connection "master"
[0m17:40:39.509176 [debug] [MainThread]: On master: COMMIT
[0m17:40:39.509472 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:40:39.509664 [debug] [MainThread]: On master: Close
[0m17:40:39.511483 [debug] [Thread-1 (]: Began running node model.supercell.cleaned_usagelogs
[0m17:40:39.512109 [info ] [Thread-1 (]: 1 of 5 START sql table model main.cleaned_usagelogs ............................ [RUN]
[0m17:40:39.512596 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_supercell_main, now model.supercell.cleaned_usagelogs)
[0m17:40:39.513009 [debug] [Thread-1 (]: Began compiling node model.supercell.cleaned_usagelogs
[0m17:40:39.519894 [debug] [Thread-1 (]: Writing injected SQL for node "model.supercell.cleaned_usagelogs"
[0m17:40:39.520393 [debug] [Thread-1 (]: Began executing node model.supercell.cleaned_usagelogs
[0m17:40:39.539208 [debug] [Thread-1 (]: Writing runtime sql for node "model.supercell.cleaned_usagelogs"
[0m17:40:39.539731 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.cleaned_usagelogs"
[0m17:40:39.539960 [debug] [Thread-1 (]: On model.supercell.cleaned_usagelogs: BEGIN
[0m17:40:39.540149 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:40:39.540795 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:40:39.541016 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.cleaned_usagelogs"
[0m17:40:39.541252 [debug] [Thread-1 (]: On model.supercell.cleaned_usagelogs: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.cleaned_usagelogs"} */

  
    
    

    create  table
      "supercell"."main"."cleaned_usagelogs__dbt_tmp"
  
    as (
      


SELECT
    CAST("LinkedAccountId" AS VARCHAR) AS linked_account_id,
    CAST("bill/PayerAccountId" AS VARCHAR) AS payer_account_id,
    CAST("lineItem/UsageStartDate" AS TIMESTAMP) AS usage_start_date,
    CAST("lineItem/UsageEndDate" AS TIMESTAMP) AS usage_end_date,
    CAST("lineItem/UsageAmount" AS DECIMAL(18, 6)) AS usage_amount,
    CAST("lineItem/Operation" AS VARCHAR) AS operation,
    CAST("pricing/PricingModel" AS VARCHAR) AS pricing_model,
    CAST("resourceTags/TagKeys" AS VARCHAR) AS tag_keys,
    CAST("resourceTags/TagValues" AS VARCHAR) AS tag_values,
    CAST("product/Region" AS VARCHAR) AS region,
    CAST("product/ServiceCode" AS VARCHAR) AS service_code,
    CAST("product/InstanceType" AS VARCHAR) AS instance_type,
    CAST("amortized_cost" AS DECIMAL(18, 6)) AS amortized_cost,
    CAST("product/Description" AS VARCHAR) AS description
FROM supercell_usagelogs
    );
  
  
[0m17:40:39.798601 [debug] [Thread-1 (]: SQL status: OK in 0.257 seconds
[0m17:40:39.802423 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.cleaned_usagelogs"
[0m17:40:39.802673 [debug] [Thread-1 (]: On model.supercell.cleaned_usagelogs: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.cleaned_usagelogs"} */
alter table "supercell"."main"."cleaned_usagelogs" rename to "cleaned_usagelogs__dbt_backup"
[0m17:40:39.803207 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:40:39.804756 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.cleaned_usagelogs"
[0m17:40:39.804986 [debug] [Thread-1 (]: On model.supercell.cleaned_usagelogs: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.cleaned_usagelogs"} */
alter table "supercell"."main"."cleaned_usagelogs__dbt_tmp" rename to "cleaned_usagelogs"
[0m17:40:39.805392 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:40:39.814638 [debug] [Thread-1 (]: On model.supercell.cleaned_usagelogs: COMMIT
[0m17:40:39.814945 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.cleaned_usagelogs"
[0m17:40:39.815172 [debug] [Thread-1 (]: On model.supercell.cleaned_usagelogs: COMMIT
[0m17:40:39.826173 [debug] [Thread-1 (]: SQL status: OK in 0.011 seconds
[0m17:40:39.829932 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.cleaned_usagelogs"
[0m17:40:39.830241 [debug] [Thread-1 (]: On model.supercell.cleaned_usagelogs: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.cleaned_usagelogs"} */
drop table if exists "supercell"."main"."cleaned_usagelogs__dbt_backup" cascade
[0m17:40:39.832173 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m17:40:39.833807 [debug] [Thread-1 (]: On model.supercell.cleaned_usagelogs: Close
[0m17:40:39.838215 [info ] [Thread-1 (]: 1 of 5 OK created sql table model main.cleaned_usagelogs ....................... [[32mOK[0m in 0.32s]
[0m17:40:39.838592 [debug] [Thread-1 (]: Finished running node model.supercell.cleaned_usagelogs
[0m17:40:39.839474 [debug] [Thread-3 (]: Began running node model.supercell.dim_accounts
[0m17:40:39.840131 [info ] [Thread-3 (]: 2 of 5 START sql table model main.dim_accounts ................................. [RUN]
[0m17:40:39.840702 [debug] [Thread-4 (]: Began running node model.supercell.dim_resource
[0m17:40:39.841338 [debug] [Thread-3 (]: Acquiring new duckdb connection 'model.supercell.dim_accounts'
[0m17:40:39.841951 [debug] [Thread-2 (]: Began running node model.supercell.fact_bill_generation
[0m17:40:39.842834 [info ] [Thread-4 (]: 3 of 5 START sql table model main.dim_resource ................................. [RUN]
[0m17:40:39.843872 [debug] [Thread-3 (]: Began compiling node model.supercell.dim_accounts
[0m17:40:39.845037 [info ] [Thread-2 (]: 4 of 5 START sql table model main.fact_bill_generation ......................... [RUN]
[0m17:40:39.846074 [debug] [Thread-4 (]: Acquiring new duckdb connection 'model.supercell.dim_resource'
[0m17:40:39.851415 [debug] [Thread-3 (]: Writing injected SQL for node "model.supercell.dim_accounts"
[0m17:40:39.852412 [debug] [Thread-2 (]: Acquiring new duckdb connection 'model.supercell.fact_bill_generation'
[0m17:40:39.852977 [debug] [Thread-4 (]: Began compiling node model.supercell.dim_resource
[0m17:40:39.853804 [debug] [Thread-2 (]: Began compiling node model.supercell.fact_bill_generation
[0m17:40:39.856130 [debug] [Thread-4 (]: Writing injected SQL for node "model.supercell.dim_resource"
[0m17:40:39.858633 [debug] [Thread-2 (]: Writing injected SQL for node "model.supercell.fact_bill_generation"
[0m17:40:39.859252 [debug] [Thread-3 (]: Began executing node model.supercell.dim_accounts
[0m17:40:39.861447 [debug] [Thread-3 (]: Writing runtime sql for node "model.supercell.dim_accounts"
[0m17:40:39.861887 [debug] [Thread-4 (]: Began executing node model.supercell.dim_resource
[0m17:40:39.863967 [debug] [Thread-4 (]: Writing runtime sql for node "model.supercell.dim_resource"
[0m17:40:39.864365 [debug] [Thread-2 (]: Began executing node model.supercell.fact_bill_generation
[0m17:40:39.864785 [debug] [Thread-3 (]: Using duckdb connection "model.supercell.dim_accounts"
[0m17:40:39.867453 [debug] [Thread-2 (]: Writing runtime sql for node "model.supercell.fact_bill_generation"
[0m17:40:39.867849 [debug] [Thread-3 (]: On model.supercell.dim_accounts: BEGIN
[0m17:40:39.868254 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m17:40:39.868758 [debug] [Thread-4 (]: Using duckdb connection "model.supercell.dim_resource"
[0m17:40:39.869250 [debug] [Thread-2 (]: Using duckdb connection "model.supercell.fact_bill_generation"
[0m17:40:39.869623 [debug] [Thread-4 (]: On model.supercell.dim_resource: BEGIN
[0m17:40:39.869965 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m17:40:39.870233 [debug] [Thread-2 (]: On model.supercell.fact_bill_generation: BEGIN
[0m17:40:39.870592 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m17:40:39.870890 [debug] [Thread-3 (]: Using duckdb connection "model.supercell.dim_accounts"
[0m17:40:39.871280 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m17:40:39.871741 [debug] [Thread-3 (]: On model.supercell.dim_accounts: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.dim_accounts"} */

  
    
    

    create  table
      "supercell"."main"."dim_accounts__dbt_tmp"
  
    as (
      


select
    linked_account_id as linked_account_id,
    tag_keys as tag_keys,
    tag_values as tag_values
from "supercell"."main"."cleaned_usagelogs"
    );
  
  
[0m17:40:39.872209 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m17:40:39.872716 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m17:40:39.873164 [debug] [Thread-4 (]: Using duckdb connection "model.supercell.dim_resource"
[0m17:40:39.873613 [debug] [Thread-2 (]: Using duckdb connection "model.supercell.fact_bill_generation"
[0m17:40:39.874529 [debug] [Thread-4 (]: On model.supercell.dim_resource: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.dim_resource"} */

  
    
    

    create  table
      "supercell"."main"."dim_resource__dbt_tmp"
  
    as (
      


select
    md5(concat(linked_account_id, '_', service_code, '_', instance_type, '_', region, '_', CAST(usage_start_date AS VARCHAR), '_', CAST(usage_end_date AS VARCHAR))) AS resource_id,
    linked_account_id as linked_account_id,
    region,
    service_code as product,
    instance_type as instance_type,
    pricing_model as pricing_model
from "supercell"."main"."cleaned_usagelogs"
    );
  
  
[0m17:40:39.875388 [debug] [Thread-2 (]: On model.supercell.fact_bill_generation: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.fact_bill_generation"} */

  
    
    

    create  table
      "supercell"."main"."fact_bill_generation__dbt_tmp"
  
    as (
      


select
    md5(concat(linked_account_id, '_', service_code, '_', instance_type, '_', region, '_', CAST(usage_start_date AS VARCHAR), '_', CAST(usage_end_date AS VARCHAR))) AS resource_id,
    usage_start_date as start_date,
    usage_end_date as bill_date,
    usage_amount as bill_amount,
    operation
from "supercell"."main"."cleaned_usagelogs"
    );
  
  
[0m17:40:39.972128 [debug] [Thread-3 (]: SQL status: OK in 0.099 seconds
[0m17:40:39.976207 [debug] [Thread-3 (]: Using duckdb connection "model.supercell.dim_accounts"
[0m17:40:39.976766 [debug] [Thread-3 (]: On model.supercell.dim_accounts: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.dim_accounts"} */
alter table "supercell"."main"."dim_accounts" rename to "dim_accounts__dbt_backup"
[0m17:40:39.977869 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m17:40:39.981681 [debug] [Thread-3 (]: Using duckdb connection "model.supercell.dim_accounts"
[0m17:40:39.982394 [debug] [Thread-3 (]: On model.supercell.dim_accounts: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.dim_accounts"} */
alter table "supercell"."main"."dim_accounts__dbt_tmp" rename to "dim_accounts"
[0m17:40:39.983441 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m17:40:39.985452 [debug] [Thread-3 (]: On model.supercell.dim_accounts: COMMIT
[0m17:40:39.986019 [debug] [Thread-3 (]: Using duckdb connection "model.supercell.dim_accounts"
[0m17:40:39.986485 [debug] [Thread-3 (]: On model.supercell.dim_accounts: COMMIT
[0m17:40:39.993334 [debug] [Thread-3 (]: SQL status: OK in 0.006 seconds
[0m17:40:39.996702 [debug] [Thread-3 (]: Using duckdb connection "model.supercell.dim_accounts"
[0m17:40:39.997312 [debug] [Thread-3 (]: On model.supercell.dim_accounts: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.dim_accounts"} */
drop table if exists "supercell"."main"."dim_accounts__dbt_backup" cascade
[0m17:40:39.999481 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m17:40:40.001224 [debug] [Thread-3 (]: On model.supercell.dim_accounts: Close
[0m17:40:40.005751 [info ] [Thread-3 (]: 2 of 5 OK created sql table model main.dim_accounts ............................ [[32mOK[0m in 0.16s]
[0m17:40:40.006645 [debug] [Thread-3 (]: Finished running node model.supercell.dim_accounts
[0m17:40:40.052394 [debug] [Thread-2 (]: SQL status: OK in 0.176 seconds
[0m17:40:40.054338 [debug] [Thread-2 (]: Using duckdb connection "model.supercell.fact_bill_generation"
[0m17:40:40.054610 [debug] [Thread-2 (]: On model.supercell.fact_bill_generation: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.fact_bill_generation"} */
alter table "supercell"."main"."fact_bill_generation" rename to "fact_bill_generation__dbt_backup"
[0m17:40:40.055267 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m17:40:40.056886 [debug] [Thread-2 (]: Using duckdb connection "model.supercell.fact_bill_generation"
[0m17:40:40.057112 [debug] [Thread-2 (]: On model.supercell.fact_bill_generation: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.fact_bill_generation"} */
alter table "supercell"."main"."fact_bill_generation__dbt_tmp" rename to "fact_bill_generation"
[0m17:40:40.057570 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m17:40:40.058708 [debug] [Thread-2 (]: On model.supercell.fact_bill_generation: COMMIT
[0m17:40:40.058969 [debug] [Thread-2 (]: Using duckdb connection "model.supercell.fact_bill_generation"
[0m17:40:40.059166 [debug] [Thread-2 (]: On model.supercell.fact_bill_generation: COMMIT
[0m17:40:40.072073 [debug] [Thread-2 (]: SQL status: OK in 0.013 seconds
[0m17:40:40.075434 [debug] [Thread-2 (]: Using duckdb connection "model.supercell.fact_bill_generation"
[0m17:40:40.075839 [debug] [Thread-2 (]: On model.supercell.fact_bill_generation: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.fact_bill_generation"} */
drop table if exists "supercell"."main"."fact_bill_generation__dbt_backup" cascade
[0m17:40:40.077744 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m17:40:40.079266 [debug] [Thread-2 (]: On model.supercell.fact_bill_generation: Close
[0m17:40:40.083742 [info ] [Thread-2 (]: 4 of 5 OK created sql table model main.fact_bill_generation .................... [[32mOK[0m in 0.23s]
[0m17:40:40.084400 [debug] [Thread-2 (]: Finished running node model.supercell.fact_bill_generation
[0m17:40:40.132992 [debug] [Thread-4 (]: SQL status: OK in 0.257 seconds
[0m17:40:40.134812 [debug] [Thread-4 (]: Using duckdb connection "model.supercell.dim_resource"
[0m17:40:40.135104 [debug] [Thread-4 (]: On model.supercell.dim_resource: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.dim_resource"} */
alter table "supercell"."main"."dim_resource" rename to "dim_resource__dbt_backup"
[0m17:40:40.135609 [debug] [Thread-4 (]: SQL status: OK in 0.000 seconds
[0m17:40:40.137101 [debug] [Thread-4 (]: Using duckdb connection "model.supercell.dim_resource"
[0m17:40:40.137334 [debug] [Thread-4 (]: On model.supercell.dim_resource: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.dim_resource"} */
alter table "supercell"."main"."dim_resource__dbt_tmp" rename to "dim_resource"
[0m17:40:40.137711 [debug] [Thread-4 (]: SQL status: OK in 0.000 seconds
[0m17:40:40.138691 [debug] [Thread-4 (]: On model.supercell.dim_resource: COMMIT
[0m17:40:40.138924 [debug] [Thread-4 (]: Using duckdb connection "model.supercell.dim_resource"
[0m17:40:40.139113 [debug] [Thread-4 (]: On model.supercell.dim_resource: COMMIT
[0m17:40:40.144159 [debug] [Thread-4 (]: SQL status: OK in 0.005 seconds
[0m17:40:40.145442 [debug] [Thread-4 (]: Using duckdb connection "model.supercell.dim_resource"
[0m17:40:40.145684 [debug] [Thread-4 (]: On model.supercell.dim_resource: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.dim_resource"} */
drop table if exists "supercell"."main"."dim_resource__dbt_backup" cascade
[0m17:40:40.147358 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m17:40:40.148155 [debug] [Thread-4 (]: On model.supercell.dim_resource: Close
[0m17:40:40.150179 [info ] [Thread-4 (]: 3 of 5 OK created sql table model main.dim_resource ............................ [[32mOK[0m in 0.30s]
[0m17:40:40.150541 [debug] [Thread-4 (]: Finished running node model.supercell.dim_resource
[0m17:40:40.151279 [debug] [Thread-1 (]: Began running node model.supercell.total_cost
[0m17:40:40.151656 [info ] [Thread-1 (]: 5 of 5 START sql table model main.total_cost ................................... [RUN]
[0m17:40:40.151983 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.supercell.cleaned_usagelogs, now model.supercell.total_cost)
[0m17:40:40.152217 [debug] [Thread-1 (]: Began compiling node model.supercell.total_cost
[0m17:40:40.154720 [debug] [Thread-1 (]: Writing injected SQL for node "model.supercell.total_cost"
[0m17:40:40.155699 [debug] [Thread-1 (]: Began executing node model.supercell.total_cost
[0m17:40:40.158560 [debug] [Thread-1 (]: Writing runtime sql for node "model.supercell.total_cost"
[0m17:40:40.159194 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.total_cost"
[0m17:40:40.159513 [debug] [Thread-1 (]: On model.supercell.total_cost: BEGIN
[0m17:40:40.159745 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:40:40.160598 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:40:40.160860 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.total_cost"
[0m17:40:40.161084 [debug] [Thread-1 (]: On model.supercell.total_cost: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.total_cost"} */

  
    
    

    create  table
      "supercell"."main"."total_cost__dbt_tmp"
  
    as (
      

with base as (
    select
        fact_bill_generation.resource_id,
        date_trunc('month', fact_bill_generation.bill_date) as month,
        fact_bill_generation.bill_amount,
        dim_resource.instance_type,
        dim_resource.product,
        dim_resource.region,
        dim_resource.pricing_model,
        md5(dim_resource.linked_account_id) as linked_account_id
    from "supercell"."main"."fact_bill_generation" as fact_bill_generation
    left join "supercell"."main"."dim_resource" as dim_resource
        on fact_bill_generation.resource_id = dim_resource.resource_id
)
,
joined as (
    select
        base.*,
        dim_accounts.tag_keys as tag_keys,
        dim_accounts.tag_values as tag_values
    from base
    left join "supercell"."main"."dim_accounts" as dim_accounts
        on base.linked_account_id =  md5(dim_accounts.linked_account_id)
)

select
    month,
    sum(bill_amount) as total_cost,
    instance_type,
    product,
    region,
    pricing_model
    -- tag_keys,
    -- tag_values
from base
group by
    month,
    instance_type,
    product,
    region,
    pricing_model
order by
    month,
    instance_type,
    product,
    region,
    pricing_model
    -- tag_keys,
    -- tag_values
    );
  
  
[0m17:40:40.431589 [debug] [Thread-1 (]: SQL status: OK in 0.270 seconds
[0m17:40:40.434231 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.total_cost"
[0m17:40:40.434658 [debug] [Thread-1 (]: On model.supercell.total_cost: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.total_cost"} */
alter table "supercell"."main"."total_cost" rename to "total_cost__dbt_backup"
[0m17:40:40.435441 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:40:40.437790 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.total_cost"
[0m17:40:40.438169 [debug] [Thread-1 (]: On model.supercell.total_cost: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.total_cost"} */
alter table "supercell"."main"."total_cost__dbt_tmp" rename to "total_cost"
[0m17:40:40.438812 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:40:40.440486 [debug] [Thread-1 (]: On model.supercell.total_cost: COMMIT
[0m17:40:40.440850 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.total_cost"
[0m17:40:40.441181 [debug] [Thread-1 (]: On model.supercell.total_cost: COMMIT
[0m17:40:40.444282 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m17:40:40.445780 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.total_cost"
[0m17:40:40.446040 [debug] [Thread-1 (]: On model.supercell.total_cost: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.total_cost"} */
drop table if exists "supercell"."main"."total_cost__dbt_backup" cascade
[0m17:40:40.447547 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:40:40.448443 [debug] [Thread-1 (]: On model.supercell.total_cost: Close
[0m17:40:40.452242 [info ] [Thread-1 (]: 5 of 5 OK created sql table model main.total_cost .............................. [[32mOK[0m in 0.30s]
[0m17:40:40.452617 [debug] [Thread-1 (]: Finished running node model.supercell.total_cost
[0m17:40:40.454033 [debug] [MainThread]: Using duckdb connection "master"
[0m17:40:40.454475 [debug] [MainThread]: On master: BEGIN
[0m17:40:40.454778 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:40:40.455805 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m17:40:40.456499 [debug] [MainThread]: On master: COMMIT
[0m17:40:40.456882 [debug] [MainThread]: Using duckdb connection "master"
[0m17:40:40.457208 [debug] [MainThread]: On master: COMMIT
[0m17:40:40.458327 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m17:40:40.458809 [debug] [MainThread]: On master: Close
[0m17:40:40.459303 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:40:40.459591 [debug] [MainThread]: Connection 'model.supercell.total_cost' was properly closed.
[0m17:40:40.459845 [debug] [MainThread]: Connection 'model.supercell.dim_accounts' was properly closed.
[0m17:40:40.460084 [debug] [MainThread]: Connection 'model.supercell.dim_resource' was properly closed.
[0m17:40:40.460334 [debug] [MainThread]: Connection 'model.supercell.fact_bill_generation' was properly closed.
[0m17:40:40.460688 [info ] [MainThread]: 
[0m17:40:40.461037 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 1.02 seconds (1.02s).
[0m17:40:40.462413 [debug] [MainThread]: Command end result
[0m17:40:40.522843 [debug] [MainThread]: Wrote artifact WritableManifest to /home/harsha/data_actions/supercell_cloudops/target/manifest.json
[0m17:40:40.523900 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/harsha/data_actions/supercell_cloudops/target/semantic_manifest.json
[0m17:40:40.527657 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/harsha/data_actions/supercell_cloudops/target/run_results.json
[0m17:40:40.527893 [info ] [MainThread]: 
[0m17:40:40.528146 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:40:40.528359 [info ] [MainThread]: 
[0m17:40:40.528576 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m17:40:40.529488 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.5411114, "process_in_blocks": "0", "process_kernel_time": 0.341069, "process_mem_max_rss": "340220", "process_out_blocks": "59760", "process_user_time": 5.079039}
[0m17:40:40.530028 [debug] [MainThread]: Command `dbt run` succeeded at 17:40:40.529935 after 1.54 seconds
[0m17:40:40.530342 [debug] [MainThread]: Flushing usage events


============================== 17:40:56.550444 | a442af19-df65-495b-8185-65483bdd9859 ==============================
[0m17:40:56.550444 [info ] [MainThread]: Running with dbt=1.9.4
[0m17:40:56.553496 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/harsha/data_actions/supercell_cloudops', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/harsha/data_actions/supercell_cloudops/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'False'}
[0m17:40:56.553960 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality

User config should be moved from the 'config' key in profiles.yml to the 'flags' key in dbt_project.yml.
[0m17:40:56.713780 [info ] [MainThread]: Registered adapter: duckdb=1.9.3
[0m17:40:56.752401 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m17:40:56.794271 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:40:56.794689 [debug] [MainThread]: Partial parsing: updated file: supercell://models/supercell_models/metrics/total_cost.sql
[0m17:40:56.938084 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.supercell.example
[0m17:40:56.971503 [debug] [MainThread]: Wrote artifact WritableManifest to /home/harsha/data_actions/supercell_cloudops/target/manifest.json
[0m17:40:56.972621 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/harsha/data_actions/supercell_cloudops/target/semantic_manifest.json
[0m17:40:56.979821 [info ] [MainThread]: Found 5 models, 428 macros
[0m17:40:56.981160 [info ] [MainThread]: 
[0m17:40:56.981495 [info ] [MainThread]: Concurrency: 4 threads (target='default')
[0m17:40:56.981687 [info ] [MainThread]: 
[0m17:40:56.982001 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m17:40:56.985982 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_supercell'
[0m17:40:57.008786 [debug] [ThreadPool]: Using duckdb connection "list_supercell"
[0m17:40:57.009089 [debug] [ThreadPool]: On list_supercell: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "connection_name": "list_supercell"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"supercell"'
    
  
  
[0m17:40:57.009272 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:40:57.017120 [debug] [ThreadPool]: SQL status: OK in 0.008 seconds
[0m17:40:57.018009 [debug] [ThreadPool]: On list_supercell: Close
[0m17:40:57.018586 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_supercell, now create_supercell_main)
[0m17:40:57.018856 [debug] [ThreadPool]: Creating schema "database: "supercell"
schema: "main"
"
[0m17:40:57.022892 [debug] [ThreadPool]: Using duckdb connection "create_supercell_main"
[0m17:40:57.023173 [debug] [ThreadPool]: On create_supercell_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "connection_name": "create_supercell_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='supercell'
        and type='sqlite'
    
  
[0m17:40:57.023359 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:40:57.024096 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m17:40:57.024880 [debug] [ThreadPool]: Using duckdb connection "create_supercell_main"
[0m17:40:57.025071 [debug] [ThreadPool]: On create_supercell_main: BEGIN
[0m17:40:57.025372 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:40:57.025548 [debug] [ThreadPool]: Using duckdb connection "create_supercell_main"
[0m17:40:57.025695 [debug] [ThreadPool]: On create_supercell_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "connection_name": "create_supercell_main"} */

    
    
        create schema if not exists "supercell"."main"
    
[0m17:40:57.025960 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:40:57.026435 [debug] [ThreadPool]: On create_supercell_main: COMMIT
[0m17:40:57.026622 [debug] [ThreadPool]: Using duckdb connection "create_supercell_main"
[0m17:40:57.026771 [debug] [ThreadPool]: On create_supercell_main: COMMIT
[0m17:40:57.027126 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:40:57.027324 [debug] [ThreadPool]: On create_supercell_main: Close
[0m17:40:57.028441 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_supercell_main, now list_supercell_main)
[0m17:40:57.033532 [debug] [ThreadPool]: Using duckdb connection "list_supercell_main"
[0m17:40:57.033878 [debug] [ThreadPool]: On list_supercell_main: BEGIN
[0m17:40:57.034178 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:40:57.034758 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m17:40:57.035068 [debug] [ThreadPool]: Using duckdb connection "list_supercell_main"
[0m17:40:57.035378 [debug] [ThreadPool]: On list_supercell_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "connection_name": "list_supercell_main"} */
select
      'supercell' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'supercell'
  
[0m17:40:57.050086 [debug] [ThreadPool]: SQL status: OK in 0.014 seconds
[0m17:40:57.051056 [debug] [ThreadPool]: On list_supercell_main: ROLLBACK
[0m17:40:57.051697 [debug] [ThreadPool]: Failed to rollback 'list_supercell_main'
[0m17:40:57.051896 [debug] [ThreadPool]: On list_supercell_main: Close
[0m17:40:57.053180 [debug] [MainThread]: Using duckdb connection "master"
[0m17:40:57.053396 [debug] [MainThread]: On master: BEGIN
[0m17:40:57.053558 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:40:57.053984 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:40:57.054214 [debug] [MainThread]: On master: COMMIT
[0m17:40:57.054386 [debug] [MainThread]: Using duckdb connection "master"
[0m17:40:57.054533 [debug] [MainThread]: On master: COMMIT
[0m17:40:57.054837 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:40:57.055038 [debug] [MainThread]: On master: Close
[0m17:40:57.057272 [debug] [Thread-1 (]: Began running node model.supercell.cleaned_usagelogs
[0m17:40:57.057793 [info ] [Thread-1 (]: 1 of 5 START sql table model main.cleaned_usagelogs ............................ [RUN]
[0m17:40:57.058236 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_supercell_main, now model.supercell.cleaned_usagelogs)
[0m17:40:57.058598 [debug] [Thread-1 (]: Began compiling node model.supercell.cleaned_usagelogs
[0m17:40:57.064963 [debug] [Thread-1 (]: Writing injected SQL for node "model.supercell.cleaned_usagelogs"
[0m17:40:57.065505 [debug] [Thread-1 (]: Began executing node model.supercell.cleaned_usagelogs
[0m17:40:57.084583 [debug] [Thread-1 (]: Writing runtime sql for node "model.supercell.cleaned_usagelogs"
[0m17:40:57.085090 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.cleaned_usagelogs"
[0m17:40:57.085336 [debug] [Thread-1 (]: On model.supercell.cleaned_usagelogs: BEGIN
[0m17:40:57.085517 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:40:57.086055 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:40:57.086286 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.cleaned_usagelogs"
[0m17:40:57.086488 [debug] [Thread-1 (]: On model.supercell.cleaned_usagelogs: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.cleaned_usagelogs"} */

  
    
    

    create  table
      "supercell"."main"."cleaned_usagelogs__dbt_tmp"
  
    as (
      


SELECT
    CAST("LinkedAccountId" AS VARCHAR) AS linked_account_id,
    CAST("bill/PayerAccountId" AS VARCHAR) AS payer_account_id,
    CAST("lineItem/UsageStartDate" AS TIMESTAMP) AS usage_start_date,
    CAST("lineItem/UsageEndDate" AS TIMESTAMP) AS usage_end_date,
    CAST("lineItem/UsageAmount" AS DECIMAL(18, 6)) AS usage_amount,
    CAST("lineItem/Operation" AS VARCHAR) AS operation,
    CAST("pricing/PricingModel" AS VARCHAR) AS pricing_model,
    CAST("resourceTags/TagKeys" AS VARCHAR) AS tag_keys,
    CAST("resourceTags/TagValues" AS VARCHAR) AS tag_values,
    CAST("product/Region" AS VARCHAR) AS region,
    CAST("product/ServiceCode" AS VARCHAR) AS service_code,
    CAST("product/InstanceType" AS VARCHAR) AS instance_type,
    CAST("amortized_cost" AS DECIMAL(18, 6)) AS amortized_cost,
    CAST("product/Description" AS VARCHAR) AS description
FROM supercell_usagelogs
    );
  
  
[0m17:40:57.370883 [debug] [Thread-1 (]: SQL status: OK in 0.284 seconds
[0m17:40:57.375044 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.cleaned_usagelogs"
[0m17:40:57.375333 [debug] [Thread-1 (]: On model.supercell.cleaned_usagelogs: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.cleaned_usagelogs"} */
alter table "supercell"."main"."cleaned_usagelogs" rename to "cleaned_usagelogs__dbt_backup"
[0m17:40:57.375905 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:40:57.377433 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.cleaned_usagelogs"
[0m17:40:57.377646 [debug] [Thread-1 (]: On model.supercell.cleaned_usagelogs: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.cleaned_usagelogs"} */
alter table "supercell"."main"."cleaned_usagelogs__dbt_tmp" rename to "cleaned_usagelogs"
[0m17:40:57.378024 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:40:57.387464 [debug] [Thread-1 (]: On model.supercell.cleaned_usagelogs: COMMIT
[0m17:40:57.387754 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.cleaned_usagelogs"
[0m17:40:57.387950 [debug] [Thread-1 (]: On model.supercell.cleaned_usagelogs: COMMIT
[0m17:40:57.399465 [debug] [Thread-1 (]: SQL status: OK in 0.011 seconds
[0m17:40:57.402564 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.cleaned_usagelogs"
[0m17:40:57.402808 [debug] [Thread-1 (]: On model.supercell.cleaned_usagelogs: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.cleaned_usagelogs"} */
drop table if exists "supercell"."main"."cleaned_usagelogs__dbt_backup" cascade
[0m17:40:57.404713 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m17:40:57.406418 [debug] [Thread-1 (]: On model.supercell.cleaned_usagelogs: Close
[0m17:40:57.411638 [info ] [Thread-1 (]: 1 of 5 OK created sql table model main.cleaned_usagelogs ....................... [[32mOK[0m in 0.35s]
[0m17:40:57.412060 [debug] [Thread-1 (]: Finished running node model.supercell.cleaned_usagelogs
[0m17:40:57.412933 [debug] [Thread-3 (]: Began running node model.supercell.dim_accounts
[0m17:40:57.413492 [debug] [Thread-4 (]: Began running node model.supercell.dim_resource
[0m17:40:57.414117 [info ] [Thread-3 (]: 2 of 5 START sql table model main.dim_accounts ................................. [RUN]
[0m17:40:57.414747 [debug] [Thread-2 (]: Began running node model.supercell.fact_bill_generation
[0m17:40:57.415284 [info ] [Thread-4 (]: 3 of 5 START sql table model main.dim_resource ................................. [RUN]
[0m17:40:57.416234 [debug] [Thread-3 (]: Acquiring new duckdb connection 'model.supercell.dim_accounts'
[0m17:40:57.416970 [info ] [Thread-2 (]: 4 of 5 START sql table model main.fact_bill_generation ......................... [RUN]
[0m17:40:57.417478 [debug] [Thread-4 (]: Acquiring new duckdb connection 'model.supercell.dim_resource'
[0m17:40:57.418000 [debug] [Thread-3 (]: Began compiling node model.supercell.dim_accounts
[0m17:40:57.418616 [debug] [Thread-2 (]: Acquiring new duckdb connection 'model.supercell.fact_bill_generation'
[0m17:40:57.419060 [debug] [Thread-4 (]: Began compiling node model.supercell.dim_resource
[0m17:40:57.424557 [debug] [Thread-3 (]: Writing injected SQL for node "model.supercell.dim_accounts"
[0m17:40:57.424946 [debug] [Thread-2 (]: Began compiling node model.supercell.fact_bill_generation
[0m17:40:57.427437 [debug] [Thread-4 (]: Writing injected SQL for node "model.supercell.dim_resource"
[0m17:40:57.429420 [debug] [Thread-2 (]: Writing injected SQL for node "model.supercell.fact_bill_generation"
[0m17:40:57.429831 [debug] [Thread-3 (]: Began executing node model.supercell.dim_accounts
[0m17:40:57.430670 [debug] [Thread-4 (]: Began executing node model.supercell.dim_resource
[0m17:40:57.431081 [debug] [Thread-2 (]: Began executing node model.supercell.fact_bill_generation
[0m17:40:57.433600 [debug] [Thread-3 (]: Writing runtime sql for node "model.supercell.dim_accounts"
[0m17:40:57.435520 [debug] [Thread-4 (]: Writing runtime sql for node "model.supercell.dim_resource"
[0m17:40:57.437969 [debug] [Thread-2 (]: Writing runtime sql for node "model.supercell.fact_bill_generation"
[0m17:40:57.438872 [debug] [Thread-4 (]: Using duckdb connection "model.supercell.dim_resource"
[0m17:40:57.439296 [debug] [Thread-3 (]: Using duckdb connection "model.supercell.dim_accounts"
[0m17:40:57.439866 [debug] [Thread-2 (]: Using duckdb connection "model.supercell.fact_bill_generation"
[0m17:40:57.440233 [debug] [Thread-4 (]: On model.supercell.dim_resource: BEGIN
[0m17:40:57.440537 [debug] [Thread-3 (]: On model.supercell.dim_accounts: BEGIN
[0m17:40:57.440933 [debug] [Thread-2 (]: On model.supercell.fact_bill_generation: BEGIN
[0m17:40:57.441339 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m17:40:57.441701 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m17:40:57.442266 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m17:40:57.443120 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m17:40:57.443377 [debug] [Thread-4 (]: Using duckdb connection "model.supercell.dim_resource"
[0m17:40:57.443585 [debug] [Thread-4 (]: On model.supercell.dim_resource: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.dim_resource"} */

  
    
    

    create  table
      "supercell"."main"."dim_resource__dbt_tmp"
  
    as (
      


select
    md5(concat(linked_account_id, '_', service_code, '_', instance_type, '_', region, '_', CAST(usage_start_date AS VARCHAR), '_', CAST(usage_end_date AS VARCHAR))) AS resource_id,
    linked_account_id as linked_account_id,
    region,
    service_code as product,
    instance_type as instance_type,
    pricing_model as pricing_model
from "supercell"."main"."cleaned_usagelogs"
    );
  
  
[0m17:40:57.443957 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m17:40:57.444226 [debug] [Thread-2 (]: Using duckdb connection "model.supercell.fact_bill_generation"
[0m17:40:57.444720 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m17:40:57.445256 [debug] [Thread-2 (]: On model.supercell.fact_bill_generation: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.fact_bill_generation"} */

  
    
    

    create  table
      "supercell"."main"."fact_bill_generation__dbt_tmp"
  
    as (
      


select
    md5(concat(linked_account_id, '_', service_code, '_', instance_type, '_', region, '_', CAST(usage_start_date AS VARCHAR), '_', CAST(usage_end_date AS VARCHAR))) AS resource_id,
    usage_start_date as start_date,
    usage_end_date as bill_date,
    usage_amount as bill_amount,
    operation
from "supercell"."main"."cleaned_usagelogs"
    );
  
  
[0m17:40:57.445752 [debug] [Thread-3 (]: Using duckdb connection "model.supercell.dim_accounts"
[0m17:40:57.446379 [debug] [Thread-3 (]: On model.supercell.dim_accounts: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.dim_accounts"} */

  
    
    

    create  table
      "supercell"."main"."dim_accounts__dbt_tmp"
  
    as (
      


select
    linked_account_id as linked_account_id,
    tag_keys as tag_keys,
    tag_values as tag_values
from "supercell"."main"."cleaned_usagelogs"
    );
  
  
[0m17:40:57.619285 [debug] [Thread-3 (]: SQL status: OK in 0.172 seconds
[0m17:40:57.622595 [debug] [Thread-3 (]: Using duckdb connection "model.supercell.dim_accounts"
[0m17:40:57.623090 [debug] [Thread-3 (]: On model.supercell.dim_accounts: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.dim_accounts"} */
alter table "supercell"."main"."dim_accounts" rename to "dim_accounts__dbt_backup"
[0m17:40:57.623953 [debug] [Thread-3 (]: SQL status: OK in 0.000 seconds
[0m17:40:57.626427 [debug] [Thread-3 (]: Using duckdb connection "model.supercell.dim_accounts"
[0m17:40:57.626970 [debug] [Thread-3 (]: On model.supercell.dim_accounts: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.dim_accounts"} */
alter table "supercell"."main"."dim_accounts__dbt_tmp" rename to "dim_accounts"
[0m17:40:57.627988 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m17:40:57.629654 [debug] [Thread-3 (]: On model.supercell.dim_accounts: COMMIT
[0m17:40:57.630058 [debug] [Thread-3 (]: Using duckdb connection "model.supercell.dim_accounts"
[0m17:40:57.630432 [debug] [Thread-3 (]: On model.supercell.dim_accounts: COMMIT
[0m17:40:57.634616 [debug] [Thread-2 (]: SQL status: OK in 0.188 seconds
[0m17:40:57.637533 [debug] [Thread-2 (]: Using duckdb connection "model.supercell.fact_bill_generation"
[0m17:40:57.638114 [debug] [Thread-2 (]: On model.supercell.fact_bill_generation: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.fact_bill_generation"} */
alter table "supercell"."main"."fact_bill_generation" rename to "fact_bill_generation__dbt_backup"
[0m17:40:57.639060 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m17:40:57.641661 [debug] [Thread-2 (]: Using duckdb connection "model.supercell.fact_bill_generation"
[0m17:40:57.642069 [debug] [Thread-2 (]: On model.supercell.fact_bill_generation: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.fact_bill_generation"} */
alter table "supercell"."main"."fact_bill_generation__dbt_tmp" rename to "fact_bill_generation"
[0m17:40:57.642854 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m17:40:57.644403 [debug] [Thread-2 (]: On model.supercell.fact_bill_generation: COMMIT
[0m17:40:57.644790 [debug] [Thread-2 (]: Using duckdb connection "model.supercell.fact_bill_generation"
[0m17:40:57.645140 [debug] [Thread-2 (]: On model.supercell.fact_bill_generation: COMMIT
[0m17:40:57.663721 [debug] [Thread-3 (]: SQL status: OK in 0.033 seconds
[0m17:40:57.665977 [debug] [Thread-3 (]: Using duckdb connection "model.supercell.dim_accounts"
[0m17:40:57.666389 [debug] [Thread-3 (]: On model.supercell.dim_accounts: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.dim_accounts"} */
drop table if exists "supercell"."main"."dim_accounts__dbt_backup" cascade
[0m17:40:57.666971 [debug] [Thread-2 (]: SQL status: OK in 0.021 seconds
[0m17:40:57.669711 [debug] [Thread-2 (]: Using duckdb connection "model.supercell.fact_bill_generation"
[0m17:40:57.670185 [debug] [Thread-2 (]: On model.supercell.fact_bill_generation: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.fact_bill_generation"} */
drop table if exists "supercell"."main"."fact_bill_generation__dbt_backup" cascade
[0m17:40:57.670734 [debug] [Thread-3 (]: SQL status: OK in 0.004 seconds
[0m17:40:57.672362 [debug] [Thread-3 (]: On model.supercell.dim_accounts: Close
[0m17:40:57.677849 [debug] [Thread-2 (]: SQL status: OK in 0.007 seconds
[0m17:40:57.678931 [debug] [Thread-2 (]: On model.supercell.fact_bill_generation: Close
[0m17:40:57.680013 [info ] [Thread-3 (]: 2 of 5 OK created sql table model main.dim_accounts ............................ [[32mOK[0m in 0.26s]
[0m17:40:57.680781 [info ] [Thread-2 (]: 4 of 5 OK created sql table model main.fact_bill_generation .................... [[32mOK[0m in 0.26s]
[0m17:40:57.681288 [debug] [Thread-3 (]: Finished running node model.supercell.dim_accounts
[0m17:40:57.681763 [debug] [Thread-2 (]: Finished running node model.supercell.fact_bill_generation
[0m17:40:57.699236 [debug] [Thread-4 (]: SQL status: OK in 0.255 seconds
[0m17:40:57.701018 [debug] [Thread-4 (]: Using duckdb connection "model.supercell.dim_resource"
[0m17:40:57.701258 [debug] [Thread-4 (]: On model.supercell.dim_resource: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.dim_resource"} */
alter table "supercell"."main"."dim_resource" rename to "dim_resource__dbt_backup"
[0m17:40:57.701725 [debug] [Thread-4 (]: SQL status: OK in 0.000 seconds
[0m17:40:57.703269 [debug] [Thread-4 (]: Using duckdb connection "model.supercell.dim_resource"
[0m17:40:57.703479 [debug] [Thread-4 (]: On model.supercell.dim_resource: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.dim_resource"} */
alter table "supercell"."main"."dim_resource__dbt_tmp" rename to "dim_resource"
[0m17:40:57.703851 [debug] [Thread-4 (]: SQL status: OK in 0.000 seconds
[0m17:40:57.704873 [debug] [Thread-4 (]: On model.supercell.dim_resource: COMMIT
[0m17:40:57.705157 [debug] [Thread-4 (]: Using duckdb connection "model.supercell.dim_resource"
[0m17:40:57.705376 [debug] [Thread-4 (]: On model.supercell.dim_resource: COMMIT
[0m17:40:57.710026 [debug] [Thread-4 (]: SQL status: OK in 0.004 seconds
[0m17:40:57.711388 [debug] [Thread-4 (]: Using duckdb connection "model.supercell.dim_resource"
[0m17:40:57.711594 [debug] [Thread-4 (]: On model.supercell.dim_resource: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.dim_resource"} */
drop table if exists "supercell"."main"."dim_resource__dbt_backup" cascade
[0m17:40:57.713399 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m17:40:57.714244 [debug] [Thread-4 (]: On model.supercell.dim_resource: Close
[0m17:40:57.715151 [info ] [Thread-4 (]: 3 of 5 OK created sql table model main.dim_resource ............................ [[32mOK[0m in 0.30s]
[0m17:40:57.715523 [debug] [Thread-4 (]: Finished running node model.supercell.dim_resource
[0m17:40:57.716229 [debug] [Thread-1 (]: Began running node model.supercell.total_cost
[0m17:40:57.716630 [info ] [Thread-1 (]: 5 of 5 START sql table model main.total_cost ................................... [RUN]
[0m17:40:57.717029 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.supercell.cleaned_usagelogs, now model.supercell.total_cost)
[0m17:40:57.717301 [debug] [Thread-1 (]: Began compiling node model.supercell.total_cost
[0m17:40:57.720093 [debug] [Thread-1 (]: Writing injected SQL for node "model.supercell.total_cost"
[0m17:40:57.720866 [debug] [Thread-1 (]: Began executing node model.supercell.total_cost
[0m17:40:57.723020 [debug] [Thread-1 (]: Writing runtime sql for node "model.supercell.total_cost"
[0m17:40:57.723464 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.total_cost"
[0m17:40:57.723693 [debug] [Thread-1 (]: On model.supercell.total_cost: BEGIN
[0m17:40:57.723882 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:40:57.724429 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:40:57.724646 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.total_cost"
[0m17:40:57.724873 [debug] [Thread-1 (]: On model.supercell.total_cost: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.total_cost"} */

  
    
    

    create  table
      "supercell"."main"."total_cost__dbt_tmp"
  
    as (
      

with base as (
    select
        fact_bill_generation.resource_id,
        date_trunc('month', fact_bill_generation.bill_date) as month,
        fact_bill_generation.bill_amount,
        dim_resource.instance_type,
        dim_resource.product,
        dim_resource.region,
        dim_resource.pricing_model,
        md5(dim_resource.linked_account_id) as linked_account_id
    from "supercell"."main"."fact_bill_generation" as fact_bill_generation
    left join "supercell"."main"."dim_resource" as dim_resource
        on fact_bill_generation.resource_id = dim_resource.resource_id
)
,
joined as (
    select
        base.*,
        dim_accounts.tag_keys as tag_keys,
        dim_accounts.tag_values as tag_values
    from base
    left join "supercell"."main"."dim_accounts" as dim_accounts
        on base.linked_account_id =  md5(dim_accounts.linked_account_id)
)

select
    month,
    sum(bill_amount) as total_cost,
    instance_type,
    product,
    region,
    pricing_model
    tag_keys,
    tag_values
from base
group by
    month,
    instance_type,
    product,
    region,
    pricing_model
order by
    month,
    instance_type,
    product,
    region,
    pricing_model
    tag_keys,
    tag_values
    );
  
  
[0m17:40:57.725402 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.total_cost"} */

  
    
    

    create  table
      "supercell"."main"."total_cost__dbt_tmp"
  
    as (
      

with base as (
    select
        fact_bill_generation.resource_id,
        date_trunc('month', fact_bill_generation.bill_date) as month,
        fact_bill_generation.bill_amount,
        dim_resource.instance_type,
        dim_resource.product,
        dim_resource.region,
        dim_resource.pricing_model,
        md5(dim_resource.linked_account_id) as linked_account_id
    from "supercell"."main"."fact_bill_generation" as fact_bill_generation
    left join "supercell"."main"."dim_resource" as dim_resource
        on fact_bill_generation.resource_id = dim_resource.resource_id
)
,
joined as (
    select
        base.*,
        dim_accounts.tag_keys as tag_keys,
        dim_accounts.tag_values as tag_values
    from base
    left join "supercell"."main"."dim_accounts" as dim_accounts
        on base.linked_account_id =  md5(dim_accounts.linked_account_id)
)

select
    month,
    sum(bill_amount) as total_cost,
    instance_type,
    product,
    region,
    pricing_model
    tag_keys,
    tag_values
from base
group by
    month,
    instance_type,
    product,
    region,
    pricing_model
order by
    month,
    instance_type,
    product,
    region,
    pricing_model
    tag_keys,
    tag_values
    );
  
  
[0m17:40:57.725658 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m17:40:57.725930 [debug] [Thread-1 (]: On model.supercell.total_cost: ROLLBACK
[0m17:40:57.727982 [debug] [Thread-1 (]: Failed to rollback 'model.supercell.total_cost'
[0m17:40:57.728264 [debug] [Thread-1 (]: On model.supercell.total_cost: Close
[0m17:40:57.729709 [debug] [Thread-1 (]: Runtime Error in model total_cost (models/supercell_models/metrics/total_cost.sql)
  Parser Error: syntax error at or near "tag_keys"
[0m17:40:57.730191 [error] [Thread-1 (]: 5 of 5 ERROR creating sql table model main.total_cost .......................... [[31mERROR[0m in 0.01s]
[0m17:40:57.730568 [debug] [Thread-1 (]: Finished running node model.supercell.total_cost
[0m17:40:57.731151 [debug] [Thread-7 (]: Marking all children of 'model.supercell.total_cost' to be skipped because of status 'error'.  Reason: Runtime Error in model total_cost (models/supercell_models/metrics/total_cost.sql)
  Parser Error: syntax error at or near "tag_keys".
[0m17:40:57.733934 [debug] [MainThread]: Using duckdb connection "master"
[0m17:40:57.734617 [debug] [MainThread]: On master: BEGIN
[0m17:40:57.734886 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:40:57.735560 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m17:40:57.735845 [debug] [MainThread]: On master: COMMIT
[0m17:40:57.736036 [debug] [MainThread]: Using duckdb connection "master"
[0m17:40:57.736226 [debug] [MainThread]: On master: COMMIT
[0m17:40:57.736790 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:40:57.737118 [debug] [MainThread]: On master: Close
[0m17:40:57.737621 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:40:57.737870 [debug] [MainThread]: Connection 'model.supercell.total_cost' was properly closed.
[0m17:40:57.738056 [debug] [MainThread]: Connection 'model.supercell.dim_accounts' was properly closed.
[0m17:40:57.738257 [debug] [MainThread]: Connection 'model.supercell.dim_resource' was properly closed.
[0m17:40:57.738424 [debug] [MainThread]: Connection 'model.supercell.fact_bill_generation' was properly closed.
[0m17:40:57.738755 [info ] [MainThread]: 
[0m17:40:57.739019 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 0.76 seconds (0.76s).
[0m17:40:57.739771 [debug] [MainThread]: Command end result
[0m17:40:57.750149 [debug] [MainThread]: Wrote artifact WritableManifest to /home/harsha/data_actions/supercell_cloudops/target/manifest.json
[0m17:40:57.751294 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/harsha/data_actions/supercell_cloudops/target/semantic_manifest.json
[0m17:40:57.755747 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/harsha/data_actions/supercell_cloudops/target/run_results.json
[0m17:40:57.756069 [info ] [MainThread]: 
[0m17:40:57.756321 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m17:40:57.756513 [info ] [MainThread]: 
[0m17:40:57.756733 [error] [MainThread]:   Runtime Error in model total_cost (models/supercell_models/metrics/total_cost.sql)
  Parser Error: syntax error at or near "tag_keys"
[0m17:40:57.756907 [info ] [MainThread]: 
[0m17:40:57.757091 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
[0m17:40:57.757830 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.2382573, "process_in_blocks": "0", "process_kernel_time": 0.386504, "process_mem_max_rss": "365912", "process_out_blocks": "59208", "process_user_time": 4.285593}
[0m17:40:57.758193 [debug] [MainThread]: Command `dbt run` failed at 17:40:57.758112 after 1.24 seconds
[0m17:40:57.758412 [debug] [MainThread]: Flushing usage events


============================== 17:41:34.780408 | 37d88c28-37f3-4bfa-a571-06259b92e33a ==============================
[0m17:41:34.780408 [info ] [MainThread]: Running with dbt=1.9.4
[0m17:41:34.783555 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/home/harsha/data_actions/supercell_cloudops', 'log_path': '/home/harsha/data_actions/supercell_cloudops/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'False'}
[0m17:41:34.783818 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality

User config should be moved from the 'config' key in profiles.yml to the 'flags' key in dbt_project.yml.
[0m17:41:34.943777 [info ] [MainThread]: Registered adapter: duckdb=1.9.3
[0m17:41:34.982300 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m17:41:35.024366 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:41:35.024753 [debug] [MainThread]: Partial parsing: updated file: supercell://models/supercell_models/metrics/total_cost.sql
[0m17:41:35.165188 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.supercell.example
[0m17:41:35.198114 [debug] [MainThread]: Wrote artifact WritableManifest to /home/harsha/data_actions/supercell_cloudops/target/manifest.json
[0m17:41:35.199181 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/harsha/data_actions/supercell_cloudops/target/semantic_manifest.json
[0m17:41:35.206005 [info ] [MainThread]: Found 5 models, 428 macros
[0m17:41:35.207145 [info ] [MainThread]: 
[0m17:41:35.207514 [info ] [MainThread]: Concurrency: 4 threads (target='default')
[0m17:41:35.207704 [info ] [MainThread]: 
[0m17:41:35.208014 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m17:41:35.211771 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_supercell'
[0m17:41:35.232665 [debug] [ThreadPool]: Using duckdb connection "list_supercell"
[0m17:41:35.232992 [debug] [ThreadPool]: On list_supercell: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "connection_name": "list_supercell"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"supercell"'
    
  
  
[0m17:41:35.233183 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:41:35.241188 [debug] [ThreadPool]: SQL status: OK in 0.008 seconds
[0m17:41:35.242075 [debug] [ThreadPool]: On list_supercell: Close
[0m17:41:35.242714 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_supercell, now create_supercell_main)
[0m17:41:35.243049 [debug] [ThreadPool]: Creating schema "database: "supercell"
schema: "main"
"
[0m17:41:35.247018 [debug] [ThreadPool]: Using duckdb connection "create_supercell_main"
[0m17:41:35.247269 [debug] [ThreadPool]: On create_supercell_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "connection_name": "create_supercell_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='supercell'
        and type='sqlite'
    
  
[0m17:41:35.247449 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:41:35.248200 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m17:41:35.248983 [debug] [ThreadPool]: Using duckdb connection "create_supercell_main"
[0m17:41:35.249185 [debug] [ThreadPool]: On create_supercell_main: BEGIN
[0m17:41:35.249496 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:41:35.249680 [debug] [ThreadPool]: Using duckdb connection "create_supercell_main"
[0m17:41:35.249845 [debug] [ThreadPool]: On create_supercell_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "connection_name": "create_supercell_main"} */

    
    
        create schema if not exists "supercell"."main"
    
[0m17:41:35.250167 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:41:35.250681 [debug] [ThreadPool]: On create_supercell_main: COMMIT
[0m17:41:35.250856 [debug] [ThreadPool]: Using duckdb connection "create_supercell_main"
[0m17:41:35.251005 [debug] [ThreadPool]: On create_supercell_main: COMMIT
[0m17:41:35.251281 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:41:35.251455 [debug] [ThreadPool]: On create_supercell_main: Close
[0m17:41:35.252548 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_supercell_main, now list_supercell_main)
[0m17:41:35.256856 [debug] [ThreadPool]: Using duckdb connection "list_supercell_main"
[0m17:41:35.257091 [debug] [ThreadPool]: On list_supercell_main: BEGIN
[0m17:41:35.257289 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:41:35.257884 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m17:41:35.258079 [debug] [ThreadPool]: Using duckdb connection "list_supercell_main"
[0m17:41:35.258248 [debug] [ThreadPool]: On list_supercell_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "connection_name": "list_supercell_main"} */
select
      'supercell' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'supercell'
  
[0m17:41:35.266250 [debug] [ThreadPool]: SQL status: OK in 0.008 seconds
[0m17:41:35.267219 [debug] [ThreadPool]: On list_supercell_main: ROLLBACK
[0m17:41:35.267862 [debug] [ThreadPool]: Failed to rollback 'list_supercell_main'
[0m17:41:35.268053 [debug] [ThreadPool]: On list_supercell_main: Close
[0m17:41:35.269312 [debug] [MainThread]: Using duckdb connection "master"
[0m17:41:35.269525 [debug] [MainThread]: On master: BEGIN
[0m17:41:35.269686 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:41:35.270023 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:41:35.270225 [debug] [MainThread]: On master: COMMIT
[0m17:41:35.270395 [debug] [MainThread]: Using duckdb connection "master"
[0m17:41:35.270538 [debug] [MainThread]: On master: COMMIT
[0m17:41:35.270819 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:41:35.271015 [debug] [MainThread]: On master: Close
[0m17:41:35.272913 [debug] [Thread-1 (]: Began running node model.supercell.cleaned_usagelogs
[0m17:41:35.273456 [info ] [Thread-1 (]: 1 of 5 START sql table model main.cleaned_usagelogs ............................ [RUN]
[0m17:41:35.273898 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_supercell_main, now model.supercell.cleaned_usagelogs)
[0m17:41:35.274274 [debug] [Thread-1 (]: Began compiling node model.supercell.cleaned_usagelogs
[0m17:41:35.281015 [debug] [Thread-1 (]: Writing injected SQL for node "model.supercell.cleaned_usagelogs"
[0m17:41:35.281546 [debug] [Thread-1 (]: Began executing node model.supercell.cleaned_usagelogs
[0m17:41:35.300461 [debug] [Thread-1 (]: Writing runtime sql for node "model.supercell.cleaned_usagelogs"
[0m17:41:35.300968 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.cleaned_usagelogs"
[0m17:41:35.301221 [debug] [Thread-1 (]: On model.supercell.cleaned_usagelogs: BEGIN
[0m17:41:35.301432 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:41:35.302043 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:41:35.302296 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.cleaned_usagelogs"
[0m17:41:35.302495 [debug] [Thread-1 (]: On model.supercell.cleaned_usagelogs: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.cleaned_usagelogs"} */

  
    
    

    create  table
      "supercell"."main"."cleaned_usagelogs__dbt_tmp"
  
    as (
      


SELECT
    CAST("LinkedAccountId" AS VARCHAR) AS linked_account_id,
    CAST("bill/PayerAccountId" AS VARCHAR) AS payer_account_id,
    CAST("lineItem/UsageStartDate" AS TIMESTAMP) AS usage_start_date,
    CAST("lineItem/UsageEndDate" AS TIMESTAMP) AS usage_end_date,
    CAST("lineItem/UsageAmount" AS DECIMAL(18, 6)) AS usage_amount,
    CAST("lineItem/Operation" AS VARCHAR) AS operation,
    CAST("pricing/PricingModel" AS VARCHAR) AS pricing_model,
    CAST("resourceTags/TagKeys" AS VARCHAR) AS tag_keys,
    CAST("resourceTags/TagValues" AS VARCHAR) AS tag_values,
    CAST("product/Region" AS VARCHAR) AS region,
    CAST("product/ServiceCode" AS VARCHAR) AS service_code,
    CAST("product/InstanceType" AS VARCHAR) AS instance_type,
    CAST("amortized_cost" AS DECIMAL(18, 6)) AS amortized_cost,
    CAST("product/Description" AS VARCHAR) AS description
FROM supercell_usagelogs
    );
  
  
[0m17:41:35.559394 [debug] [Thread-1 (]: SQL status: OK in 0.257 seconds
[0m17:41:35.563602 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.cleaned_usagelogs"
[0m17:41:35.563883 [debug] [Thread-1 (]: On model.supercell.cleaned_usagelogs: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.cleaned_usagelogs"} */
alter table "supercell"."main"."cleaned_usagelogs" rename to "cleaned_usagelogs__dbt_backup"
[0m17:41:35.564477 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:41:35.565971 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.cleaned_usagelogs"
[0m17:41:35.566212 [debug] [Thread-1 (]: On model.supercell.cleaned_usagelogs: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.cleaned_usagelogs"} */
alter table "supercell"."main"."cleaned_usagelogs__dbt_tmp" rename to "cleaned_usagelogs"
[0m17:41:35.566615 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:41:35.575207 [debug] [Thread-1 (]: On model.supercell.cleaned_usagelogs: COMMIT
[0m17:41:35.575440 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.cleaned_usagelogs"
[0m17:41:35.575627 [debug] [Thread-1 (]: On model.supercell.cleaned_usagelogs: COMMIT
[0m17:41:35.586529 [debug] [Thread-1 (]: SQL status: OK in 0.011 seconds
[0m17:41:35.589890 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.cleaned_usagelogs"
[0m17:41:35.590155 [debug] [Thread-1 (]: On model.supercell.cleaned_usagelogs: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.cleaned_usagelogs"} */
drop table if exists "supercell"."main"."cleaned_usagelogs__dbt_backup" cascade
[0m17:41:35.592241 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m17:41:35.594200 [debug] [Thread-1 (]: On model.supercell.cleaned_usagelogs: Close
[0m17:41:35.599474 [info ] [Thread-1 (]: 1 of 5 OK created sql table model main.cleaned_usagelogs ....................... [[32mOK[0m in 0.32s]
[0m17:41:35.599877 [debug] [Thread-1 (]: Finished running node model.supercell.cleaned_usagelogs
[0m17:41:35.600739 [debug] [Thread-3 (]: Began running node model.supercell.dim_accounts
[0m17:41:35.601290 [debug] [Thread-4 (]: Began running node model.supercell.dim_resource
[0m17:41:35.601907 [info ] [Thread-3 (]: 2 of 5 START sql table model main.dim_accounts ................................. [RUN]
[0m17:41:35.602429 [debug] [Thread-2 (]: Began running node model.supercell.fact_bill_generation
[0m17:41:35.603049 [info ] [Thread-4 (]: 3 of 5 START sql table model main.dim_resource ................................. [RUN]
[0m17:41:35.603801 [debug] [Thread-3 (]: Acquiring new duckdb connection 'model.supercell.dim_accounts'
[0m17:41:35.604532 [info ] [Thread-2 (]: 4 of 5 START sql table model main.fact_bill_generation ......................... [RUN]
[0m17:41:35.605317 [debug] [Thread-4 (]: Acquiring new duckdb connection 'model.supercell.dim_resource'
[0m17:41:35.605857 [debug] [Thread-3 (]: Began compiling node model.supercell.dim_accounts
[0m17:41:35.606418 [debug] [Thread-2 (]: Acquiring new duckdb connection 'model.supercell.fact_bill_generation'
[0m17:41:35.607228 [debug] [Thread-4 (]: Began compiling node model.supercell.dim_resource
[0m17:41:35.611042 [debug] [Thread-3 (]: Writing injected SQL for node "model.supercell.dim_accounts"
[0m17:41:35.611745 [debug] [Thread-2 (]: Began compiling node model.supercell.fact_bill_generation
[0m17:41:35.614391 [debug] [Thread-4 (]: Writing injected SQL for node "model.supercell.dim_resource"
[0m17:41:35.616494 [debug] [Thread-2 (]: Writing injected SQL for node "model.supercell.fact_bill_generation"
[0m17:41:35.617055 [debug] [Thread-3 (]: Began executing node model.supercell.dim_accounts
[0m17:41:35.617530 [debug] [Thread-4 (]: Began executing node model.supercell.dim_resource
[0m17:41:35.617938 [debug] [Thread-2 (]: Began executing node model.supercell.fact_bill_generation
[0m17:41:35.620587 [debug] [Thread-3 (]: Writing runtime sql for node "model.supercell.dim_accounts"
[0m17:41:35.622480 [debug] [Thread-4 (]: Writing runtime sql for node "model.supercell.dim_resource"
[0m17:41:35.625004 [debug] [Thread-2 (]: Writing runtime sql for node "model.supercell.fact_bill_generation"
[0m17:41:35.625716 [debug] [Thread-4 (]: Using duckdb connection "model.supercell.dim_resource"
[0m17:41:35.626123 [debug] [Thread-3 (]: Using duckdb connection "model.supercell.dim_accounts"
[0m17:41:35.626638 [debug] [Thread-4 (]: On model.supercell.dim_resource: BEGIN
[0m17:41:35.627067 [debug] [Thread-3 (]: On model.supercell.dim_accounts: BEGIN
[0m17:41:35.627475 [debug] [Thread-2 (]: Using duckdb connection "model.supercell.fact_bill_generation"
[0m17:41:35.627893 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m17:41:35.628205 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m17:41:35.628601 [debug] [Thread-2 (]: On model.supercell.fact_bill_generation: BEGIN
[0m17:41:35.629401 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m17:41:35.629782 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m17:41:35.630050 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m17:41:35.630458 [debug] [Thread-4 (]: Using duckdb connection "model.supercell.dim_resource"
[0m17:41:35.630707 [debug] [Thread-3 (]: Using duckdb connection "model.supercell.dim_accounts"
[0m17:41:35.630948 [debug] [Thread-4 (]: On model.supercell.dim_resource: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.dim_resource"} */

  
    
    

    create  table
      "supercell"."main"."dim_resource__dbt_tmp"
  
    as (
      


select
    md5(concat(linked_account_id, '_', service_code, '_', instance_type, '_', region, '_', CAST(usage_start_date AS VARCHAR), '_', CAST(usage_end_date AS VARCHAR))) AS resource_id,
    linked_account_id as linked_account_id,
    region,
    service_code as product,
    instance_type as instance_type,
    pricing_model as pricing_model
from "supercell"."main"."cleaned_usagelogs"
    );
  
  
[0m17:41:35.631190 [debug] [Thread-3 (]: On model.supercell.dim_accounts: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.dim_accounts"} */

  
    
    

    create  table
      "supercell"."main"."dim_accounts__dbt_tmp"
  
    as (
      


select
    linked_account_id as linked_account_id,
    tag_keys as tag_keys,
    tag_values as tag_values
from "supercell"."main"."cleaned_usagelogs"
    );
  
  
[0m17:41:35.631466 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m17:41:35.632073 [debug] [Thread-2 (]: Using duckdb connection "model.supercell.fact_bill_generation"
[0m17:41:35.632519 [debug] [Thread-2 (]: On model.supercell.fact_bill_generation: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.fact_bill_generation"} */

  
    
    

    create  table
      "supercell"."main"."fact_bill_generation__dbt_tmp"
  
    as (
      


select
    md5(concat(linked_account_id, '_', service_code, '_', instance_type, '_', region, '_', CAST(usage_start_date AS VARCHAR), '_', CAST(usage_end_date AS VARCHAR))) AS resource_id,
    usage_start_date as start_date,
    usage_end_date as bill_date,
    usage_amount as bill_amount,
    operation
from "supercell"."main"."cleaned_usagelogs"
    );
  
  
[0m17:41:35.762638 [debug] [Thread-3 (]: SQL status: OK in 0.129 seconds
[0m17:41:35.767819 [debug] [Thread-3 (]: Using duckdb connection "model.supercell.dim_accounts"
[0m17:41:35.768453 [debug] [Thread-3 (]: On model.supercell.dim_accounts: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.dim_accounts"} */
alter table "supercell"."main"."dim_accounts" rename to "dim_accounts__dbt_backup"
[0m17:41:35.769530 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m17:41:35.772809 [debug] [Thread-3 (]: Using duckdb connection "model.supercell.dim_accounts"
[0m17:41:35.773474 [debug] [Thread-3 (]: On model.supercell.dim_accounts: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.dim_accounts"} */
alter table "supercell"."main"."dim_accounts__dbt_tmp" rename to "dim_accounts"
[0m17:41:35.774434 [debug] [Thread-3 (]: SQL status: OK in 0.000 seconds
[0m17:41:35.776602 [debug] [Thread-3 (]: On model.supercell.dim_accounts: COMMIT
[0m17:41:35.777450 [debug] [Thread-3 (]: Using duckdb connection "model.supercell.dim_accounts"
[0m17:41:35.778072 [debug] [Thread-3 (]: On model.supercell.dim_accounts: COMMIT
[0m17:41:35.789771 [debug] [Thread-3 (]: SQL status: OK in 0.011 seconds
[0m17:41:35.792309 [debug] [Thread-3 (]: Using duckdb connection "model.supercell.dim_accounts"
[0m17:41:35.792867 [debug] [Thread-3 (]: On model.supercell.dim_accounts: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.dim_accounts"} */
drop table if exists "supercell"."main"."dim_accounts__dbt_backup" cascade
[0m17:41:35.794921 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m17:41:35.796425 [debug] [Thread-3 (]: On model.supercell.dim_accounts: Close
[0m17:41:35.802617 [info ] [Thread-3 (]: 2 of 5 OK created sql table model main.dim_accounts ............................ [[32mOK[0m in 0.20s]
[0m17:41:35.803380 [debug] [Thread-3 (]: Finished running node model.supercell.dim_accounts
[0m17:41:35.834325 [debug] [Thread-2 (]: SQL status: OK in 0.200 seconds
[0m17:41:35.836474 [debug] [Thread-2 (]: Using duckdb connection "model.supercell.fact_bill_generation"
[0m17:41:35.836783 [debug] [Thread-2 (]: On model.supercell.fact_bill_generation: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.fact_bill_generation"} */
alter table "supercell"."main"."fact_bill_generation" rename to "fact_bill_generation__dbt_backup"
[0m17:41:35.837482 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m17:41:35.839293 [debug] [Thread-2 (]: Using duckdb connection "model.supercell.fact_bill_generation"
[0m17:41:35.839544 [debug] [Thread-2 (]: On model.supercell.fact_bill_generation: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.fact_bill_generation"} */
alter table "supercell"."main"."fact_bill_generation__dbt_tmp" rename to "fact_bill_generation"
[0m17:41:35.840318 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m17:41:35.841491 [debug] [Thread-2 (]: On model.supercell.fact_bill_generation: COMMIT
[0m17:41:35.841752 [debug] [Thread-2 (]: Using duckdb connection "model.supercell.fact_bill_generation"
[0m17:41:35.841962 [debug] [Thread-2 (]: On model.supercell.fact_bill_generation: COMMIT
[0m17:41:35.846594 [debug] [Thread-2 (]: SQL status: OK in 0.004 seconds
[0m17:41:35.849442 [debug] [Thread-2 (]: Using duckdb connection "model.supercell.fact_bill_generation"
[0m17:41:35.849734 [debug] [Thread-2 (]: On model.supercell.fact_bill_generation: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.fact_bill_generation"} */
drop table if exists "supercell"."main"."fact_bill_generation__dbt_backup" cascade
[0m17:41:35.851376 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m17:41:35.852394 [debug] [Thread-2 (]: On model.supercell.fact_bill_generation: Close
[0m17:41:35.854315 [info ] [Thread-2 (]: 4 of 5 OK created sql table model main.fact_bill_generation .................... [[32mOK[0m in 0.25s]
[0m17:41:35.854963 [debug] [Thread-2 (]: Finished running node model.supercell.fact_bill_generation
[0m17:41:35.889527 [debug] [Thread-4 (]: SQL status: OK in 0.258 seconds
[0m17:41:35.891353 [debug] [Thread-4 (]: Using duckdb connection "model.supercell.dim_resource"
[0m17:41:35.891594 [debug] [Thread-4 (]: On model.supercell.dim_resource: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.dim_resource"} */
alter table "supercell"."main"."dim_resource" rename to "dim_resource__dbt_backup"
[0m17:41:35.892093 [debug] [Thread-4 (]: SQL status: OK in 0.000 seconds
[0m17:41:35.893833 [debug] [Thread-4 (]: Using duckdb connection "model.supercell.dim_resource"
[0m17:41:35.894083 [debug] [Thread-4 (]: On model.supercell.dim_resource: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.dim_resource"} */
alter table "supercell"."main"."dim_resource__dbt_tmp" rename to "dim_resource"
[0m17:41:35.894633 [debug] [Thread-4 (]: SQL status: OK in 0.000 seconds
[0m17:41:35.895594 [debug] [Thread-4 (]: On model.supercell.dim_resource: COMMIT
[0m17:41:35.895826 [debug] [Thread-4 (]: Using duckdb connection "model.supercell.dim_resource"
[0m17:41:35.896027 [debug] [Thread-4 (]: On model.supercell.dim_resource: COMMIT
[0m17:41:35.901088 [debug] [Thread-4 (]: SQL status: OK in 0.005 seconds
[0m17:41:35.902400 [debug] [Thread-4 (]: Using duckdb connection "model.supercell.dim_resource"
[0m17:41:35.902638 [debug] [Thread-4 (]: On model.supercell.dim_resource: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.dim_resource"} */
drop table if exists "supercell"."main"."dim_resource__dbt_backup" cascade
[0m17:41:35.904372 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m17:41:35.905234 [debug] [Thread-4 (]: On model.supercell.dim_resource: Close
[0m17:41:35.907184 [info ] [Thread-4 (]: 3 of 5 OK created sql table model main.dim_resource ............................ [[32mOK[0m in 0.30s]
[0m17:41:35.907555 [debug] [Thread-4 (]: Finished running node model.supercell.dim_resource
[0m17:41:35.908380 [debug] [Thread-1 (]: Began running node model.supercell.total_cost
[0m17:41:35.908791 [info ] [Thread-1 (]: 5 of 5 START sql table model main.total_cost ................................... [RUN]
[0m17:41:35.909210 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.supercell.cleaned_usagelogs, now model.supercell.total_cost)
[0m17:41:35.909537 [debug] [Thread-1 (]: Began compiling node model.supercell.total_cost
[0m17:41:35.912505 [debug] [Thread-1 (]: Writing injected SQL for node "model.supercell.total_cost"
[0m17:41:35.913064 [debug] [Thread-1 (]: Began executing node model.supercell.total_cost
[0m17:41:35.915870 [debug] [Thread-1 (]: Writing runtime sql for node "model.supercell.total_cost"
[0m17:41:35.916536 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.total_cost"
[0m17:41:35.916817 [debug] [Thread-1 (]: On model.supercell.total_cost: BEGIN
[0m17:41:35.917024 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:41:35.917722 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:41:35.918039 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.total_cost"
[0m17:41:35.918312 [debug] [Thread-1 (]: On model.supercell.total_cost: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.total_cost"} */

  
    
    

    create  table
      "supercell"."main"."total_cost__dbt_tmp"
  
    as (
      

with base as (
    select
        fact_bill_generation.resource_id,
        date_trunc('month', fact_bill_generation.bill_date) as month,
        fact_bill_generation.bill_amount,
        dim_resource.instance_type,
        dim_resource.product,
        dim_resource.region,
        dim_resource.pricing_model,
        md5(dim_resource.linked_account_id) as linked_account_id
    from "supercell"."main"."fact_bill_generation" as fact_bill_generation
    left join "supercell"."main"."dim_resource" as dim_resource
        on fact_bill_generation.resource_id = dim_resource.resource_id
)
,
joined as (
    select
        base.*,
        dim_accounts.tag_keys as tag_keys,
        dim_accounts.tag_values as tag_values
    from base
    left join "supercell"."main"."dim_accounts" as dim_accounts
        on base.linked_account_id =  md5(dim_accounts.linked_account_id)
)

select
    month,
    sum(bill_amount) as total_cost,
    instance_type,
    product,
    region,
    pricing_model
    tag_keys,
    tag_values
from base
group by
    month,
    instance_type,
    product,
    region,
    pricing_model,
    tag_keys,
    tag_values
order by
    month,
    instance_type,
    product,
    region,
    pricing_model
    tag_keys,
    tag_values
    );
  
  
[0m17:41:35.918897 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.total_cost"} */

  
    
    

    create  table
      "supercell"."main"."total_cost__dbt_tmp"
  
    as (
      

with base as (
    select
        fact_bill_generation.resource_id,
        date_trunc('month', fact_bill_generation.bill_date) as month,
        fact_bill_generation.bill_amount,
        dim_resource.instance_type,
        dim_resource.product,
        dim_resource.region,
        dim_resource.pricing_model,
        md5(dim_resource.linked_account_id) as linked_account_id
    from "supercell"."main"."fact_bill_generation" as fact_bill_generation
    left join "supercell"."main"."dim_resource" as dim_resource
        on fact_bill_generation.resource_id = dim_resource.resource_id
)
,
joined as (
    select
        base.*,
        dim_accounts.tag_keys as tag_keys,
        dim_accounts.tag_values as tag_values
    from base
    left join "supercell"."main"."dim_accounts" as dim_accounts
        on base.linked_account_id =  md5(dim_accounts.linked_account_id)
)

select
    month,
    sum(bill_amount) as total_cost,
    instance_type,
    product,
    region,
    pricing_model
    tag_keys,
    tag_values
from base
group by
    month,
    instance_type,
    product,
    region,
    pricing_model,
    tag_keys,
    tag_values
order by
    month,
    instance_type,
    product,
    region,
    pricing_model
    tag_keys,
    tag_values
    );
  
  
[0m17:41:35.919199 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m17:41:35.919532 [debug] [Thread-1 (]: On model.supercell.total_cost: ROLLBACK
[0m17:41:35.921829 [debug] [Thread-1 (]: Failed to rollback 'model.supercell.total_cost'
[0m17:41:35.922083 [debug] [Thread-1 (]: On model.supercell.total_cost: Close
[0m17:41:35.923428 [debug] [Thread-1 (]: Runtime Error in model total_cost (models/supercell_models/metrics/total_cost.sql)
  Parser Error: syntax error at or near "tag_keys"
[0m17:41:35.923856 [error] [Thread-1 (]: 5 of 5 ERROR creating sql table model main.total_cost .......................... [[31mERROR[0m in 0.01s]
[0m17:41:35.924208 [debug] [Thread-1 (]: Finished running node model.supercell.total_cost
[0m17:41:35.924687 [debug] [Thread-7 (]: Marking all children of 'model.supercell.total_cost' to be skipped because of status 'error'.  Reason: Runtime Error in model total_cost (models/supercell_models/metrics/total_cost.sql)
  Parser Error: syntax error at or near "tag_keys".
[0m17:41:35.926565 [debug] [MainThread]: Using duckdb connection "master"
[0m17:41:35.926825 [debug] [MainThread]: On master: BEGIN
[0m17:41:35.927014 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:41:35.927547 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m17:41:35.927754 [debug] [MainThread]: On master: COMMIT
[0m17:41:35.927934 [debug] [MainThread]: Using duckdb connection "master"
[0m17:41:35.928101 [debug] [MainThread]: On master: COMMIT
[0m17:41:35.928393 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:41:35.928580 [debug] [MainThread]: On master: Close
[0m17:41:35.928868 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:41:35.929038 [debug] [MainThread]: Connection 'model.supercell.total_cost' was properly closed.
[0m17:41:35.929205 [debug] [MainThread]: Connection 'model.supercell.dim_accounts' was properly closed.
[0m17:41:35.929362 [debug] [MainThread]: Connection 'model.supercell.dim_resource' was properly closed.
[0m17:41:35.929507 [debug] [MainThread]: Connection 'model.supercell.fact_bill_generation' was properly closed.
[0m17:41:35.929729 [info ] [MainThread]: 
[0m17:41:35.929932 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 0.72 seconds (0.72s).
[0m17:41:35.930604 [debug] [MainThread]: Command end result
[0m17:41:35.941739 [debug] [MainThread]: Wrote artifact WritableManifest to /home/harsha/data_actions/supercell_cloudops/target/manifest.json
[0m17:41:35.943014 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/harsha/data_actions/supercell_cloudops/target/semantic_manifest.json
[0m17:41:35.946833 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/harsha/data_actions/supercell_cloudops/target/run_results.json
[0m17:41:35.947095 [info ] [MainThread]: 
[0m17:41:35.947348 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m17:41:35.947541 [info ] [MainThread]: 
[0m17:41:35.947752 [error] [MainThread]:   Runtime Error in model total_cost (models/supercell_models/metrics/total_cost.sql)
  Parser Error: syntax error at or near "tag_keys"
[0m17:41:35.947922 [info ] [MainThread]: 
[0m17:41:35.948165 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
[0m17:41:35.949500 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 1.2008044, "process_in_blocks": "0", "process_kernel_time": 0.384768, "process_mem_max_rss": "367612", "process_out_blocks": "59208", "process_user_time": 4.066983}
[0m17:41:35.950049 [debug] [MainThread]: Command `dbt run` failed at 17:41:35.949954 after 1.20 seconds
[0m17:41:35.950379 [debug] [MainThread]: Flushing usage events


============================== 17:43:22.612350 | 6fbf52af-4176-452e-9eff-c7581c33d739 ==============================
[0m17:43:22.612350 [info ] [MainThread]: Running with dbt=1.9.4
[0m17:43:22.615665 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/harsha/data_actions/supercell_cloudops', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/harsha/data_actions/supercell_cloudops/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'False'}
[0m17:43:22.616052 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality

User config should be moved from the 'config' key in profiles.yml to the 'flags' key in dbt_project.yml.
[0m17:43:22.806733 [info ] [MainThread]: Registered adapter: duckdb=1.9.3
[0m17:43:22.846497 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m17:43:22.909025 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m17:43:22.909503 [debug] [MainThread]: Partial parsing: updated file: supercell://models/supercell_models/metrics/total_cost.sql
[0m17:43:23.050715 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.supercell.example
[0m17:43:23.082556 [debug] [MainThread]: Wrote artifact WritableManifest to /home/harsha/data_actions/supercell_cloudops/target/manifest.json
[0m17:43:23.083523 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/harsha/data_actions/supercell_cloudops/target/semantic_manifest.json
[0m17:43:23.090301 [info ] [MainThread]: Found 5 models, 428 macros
[0m17:43:23.091491 [info ] [MainThread]: 
[0m17:43:23.091796 [info ] [MainThread]: Concurrency: 4 threads (target='default')
[0m17:43:23.091990 [info ] [MainThread]: 
[0m17:43:23.092305 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m17:43:23.095865 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_supercell'
[0m17:43:23.117149 [debug] [ThreadPool]: Using duckdb connection "list_supercell"
[0m17:43:23.117497 [debug] [ThreadPool]: On list_supercell: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "connection_name": "list_supercell"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"supercell"'
    
  
  
[0m17:43:23.117674 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:43:23.125713 [debug] [ThreadPool]: SQL status: OK in 0.008 seconds
[0m17:43:23.126667 [debug] [ThreadPool]: On list_supercell: Close
[0m17:43:23.127221 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_supercell, now create_supercell_main)
[0m17:43:23.127532 [debug] [ThreadPool]: Creating schema "database: "supercell"
schema: "main"
"
[0m17:43:23.131454 [debug] [ThreadPool]: Using duckdb connection "create_supercell_main"
[0m17:43:23.131686 [debug] [ThreadPool]: On create_supercell_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "connection_name": "create_supercell_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='supercell'
        and type='sqlite'
    
  
[0m17:43:23.131869 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:43:23.132537 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m17:43:23.133282 [debug] [ThreadPool]: Using duckdb connection "create_supercell_main"
[0m17:43:23.133494 [debug] [ThreadPool]: On create_supercell_main: BEGIN
[0m17:43:23.133785 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:43:23.133971 [debug] [ThreadPool]: Using duckdb connection "create_supercell_main"
[0m17:43:23.134123 [debug] [ThreadPool]: On create_supercell_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "connection_name": "create_supercell_main"} */

    
    
        create schema if not exists "supercell"."main"
    
[0m17:43:23.134392 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:43:23.134845 [debug] [ThreadPool]: On create_supercell_main: COMMIT
[0m17:43:23.135033 [debug] [ThreadPool]: Using duckdb connection "create_supercell_main"
[0m17:43:23.135194 [debug] [ThreadPool]: On create_supercell_main: COMMIT
[0m17:43:23.135425 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:43:23.135588 [debug] [ThreadPool]: On create_supercell_main: Close
[0m17:43:23.136919 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_supercell_main, now list_supercell_main)
[0m17:43:23.140476 [debug] [ThreadPool]: Using duckdb connection "list_supercell_main"
[0m17:43:23.140721 [debug] [ThreadPool]: On list_supercell_main: BEGIN
[0m17:43:23.140876 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:43:23.141309 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:43:23.141480 [debug] [ThreadPool]: Using duckdb connection "list_supercell_main"
[0m17:43:23.141625 [debug] [ThreadPool]: On list_supercell_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "connection_name": "list_supercell_main"} */
select
      'supercell' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'supercell'
  
[0m17:43:23.149367 [debug] [ThreadPool]: SQL status: OK in 0.008 seconds
[0m17:43:23.150210 [debug] [ThreadPool]: On list_supercell_main: ROLLBACK
[0m17:43:23.150813 [debug] [ThreadPool]: Failed to rollback 'list_supercell_main'
[0m17:43:23.151003 [debug] [ThreadPool]: On list_supercell_main: Close
[0m17:43:23.152854 [debug] [MainThread]: Using duckdb connection "master"
[0m17:43:23.153250 [debug] [MainThread]: On master: BEGIN
[0m17:43:23.153547 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:43:23.154228 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m17:43:23.154551 [debug] [MainThread]: On master: COMMIT
[0m17:43:23.154831 [debug] [MainThread]: Using duckdb connection "master"
[0m17:43:23.155098 [debug] [MainThread]: On master: COMMIT
[0m17:43:23.155544 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:43:23.155850 [debug] [MainThread]: On master: Close
[0m17:43:23.158376 [debug] [Thread-1 (]: Began running node model.supercell.cleaned_usagelogs
[0m17:43:23.158941 [info ] [Thread-1 (]: 1 of 5 START sql table model main.cleaned_usagelogs ............................ [RUN]
[0m17:43:23.159396 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_supercell_main, now model.supercell.cleaned_usagelogs)
[0m17:43:23.159751 [debug] [Thread-1 (]: Began compiling node model.supercell.cleaned_usagelogs
[0m17:43:23.166763 [debug] [Thread-1 (]: Writing injected SQL for node "model.supercell.cleaned_usagelogs"
[0m17:43:23.167288 [debug] [Thread-1 (]: Began executing node model.supercell.cleaned_usagelogs
[0m17:43:23.185991 [debug] [Thread-1 (]: Writing runtime sql for node "model.supercell.cleaned_usagelogs"
[0m17:43:23.186613 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.cleaned_usagelogs"
[0m17:43:23.186891 [debug] [Thread-1 (]: On model.supercell.cleaned_usagelogs: BEGIN
[0m17:43:23.187113 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:43:23.187779 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:43:23.187991 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.cleaned_usagelogs"
[0m17:43:23.188185 [debug] [Thread-1 (]: On model.supercell.cleaned_usagelogs: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.cleaned_usagelogs"} */

  
    
    

    create  table
      "supercell"."main"."cleaned_usagelogs__dbt_tmp"
  
    as (
      


SELECT
    CAST("LinkedAccountId" AS VARCHAR) AS linked_account_id,
    CAST("bill/PayerAccountId" AS VARCHAR) AS payer_account_id,
    CAST("lineItem/UsageStartDate" AS TIMESTAMP) AS usage_start_date,
    CAST("lineItem/UsageEndDate" AS TIMESTAMP) AS usage_end_date,
    CAST("lineItem/UsageAmount" AS DECIMAL(18, 6)) AS usage_amount,
    CAST("lineItem/Operation" AS VARCHAR) AS operation,
    CAST("pricing/PricingModel" AS VARCHAR) AS pricing_model,
    CAST("resourceTags/TagKeys" AS VARCHAR) AS tag_keys,
    CAST("resourceTags/TagValues" AS VARCHAR) AS tag_values,
    CAST("product/Region" AS VARCHAR) AS region,
    CAST("product/ServiceCode" AS VARCHAR) AS service_code,
    CAST("product/InstanceType" AS VARCHAR) AS instance_type,
    CAST("amortized_cost" AS DECIMAL(18, 6)) AS amortized_cost,
    CAST("product/Description" AS VARCHAR) AS description
FROM supercell_usagelogs
    );
  
  
[0m17:43:23.451024 [debug] [Thread-1 (]: SQL status: OK in 0.263 seconds
[0m17:43:23.454968 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.cleaned_usagelogs"
[0m17:43:23.455287 [debug] [Thread-1 (]: On model.supercell.cleaned_usagelogs: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.cleaned_usagelogs"} */
alter table "supercell"."main"."cleaned_usagelogs" rename to "cleaned_usagelogs__dbt_backup"
[0m17:43:23.455914 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:43:23.457589 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.cleaned_usagelogs"
[0m17:43:23.457812 [debug] [Thread-1 (]: On model.supercell.cleaned_usagelogs: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.cleaned_usagelogs"} */
alter table "supercell"."main"."cleaned_usagelogs__dbt_tmp" rename to "cleaned_usagelogs"
[0m17:43:23.458218 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:43:23.467609 [debug] [Thread-1 (]: On model.supercell.cleaned_usagelogs: COMMIT
[0m17:43:23.467894 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.cleaned_usagelogs"
[0m17:43:23.468094 [debug] [Thread-1 (]: On model.supercell.cleaned_usagelogs: COMMIT
[0m17:43:23.479623 [debug] [Thread-1 (]: SQL status: OK in 0.011 seconds
[0m17:43:23.482773 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.cleaned_usagelogs"
[0m17:43:23.483033 [debug] [Thread-1 (]: On model.supercell.cleaned_usagelogs: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.cleaned_usagelogs"} */
drop table if exists "supercell"."main"."cleaned_usagelogs__dbt_backup" cascade
[0m17:43:23.485055 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m17:43:23.486708 [debug] [Thread-1 (]: On model.supercell.cleaned_usagelogs: Close
[0m17:43:23.491335 [info ] [Thread-1 (]: 1 of 5 OK created sql table model main.cleaned_usagelogs ....................... [[32mOK[0m in 0.33s]
[0m17:43:23.491767 [debug] [Thread-1 (]: Finished running node model.supercell.cleaned_usagelogs
[0m17:43:23.492699 [debug] [Thread-3 (]: Began running node model.supercell.dim_accounts
[0m17:43:23.493295 [debug] [Thread-4 (]: Began running node model.supercell.dim_resource
[0m17:43:23.493883 [info ] [Thread-3 (]: 2 of 5 START sql table model main.dim_accounts ................................. [RUN]
[0m17:43:23.494443 [debug] [Thread-2 (]: Began running node model.supercell.fact_bill_generation
[0m17:43:23.495079 [info ] [Thread-4 (]: 3 of 5 START sql table model main.dim_resource ................................. [RUN]
[0m17:43:23.496206 [debug] [Thread-3 (]: Acquiring new duckdb connection 'model.supercell.dim_accounts'
[0m17:43:23.497046 [info ] [Thread-2 (]: 4 of 5 START sql table model main.fact_bill_generation ......................... [RUN]
[0m17:43:23.497912 [debug] [Thread-4 (]: Acquiring new duckdb connection 'model.supercell.dim_resource'
[0m17:43:23.498709 [debug] [Thread-3 (]: Began compiling node model.supercell.dim_accounts
[0m17:43:23.499386 [debug] [Thread-2 (]: Acquiring new duckdb connection 'model.supercell.fact_bill_generation'
[0m17:43:23.499936 [debug] [Thread-4 (]: Began compiling node model.supercell.dim_resource
[0m17:43:23.503953 [debug] [Thread-3 (]: Writing injected SQL for node "model.supercell.dim_accounts"
[0m17:43:23.504899 [debug] [Thread-2 (]: Began compiling node model.supercell.fact_bill_generation
[0m17:43:23.507246 [debug] [Thread-4 (]: Writing injected SQL for node "model.supercell.dim_resource"
[0m17:43:23.509973 [debug] [Thread-2 (]: Writing injected SQL for node "model.supercell.fact_bill_generation"
[0m17:43:23.510563 [debug] [Thread-3 (]: Began executing node model.supercell.dim_accounts
[0m17:43:23.511223 [debug] [Thread-4 (]: Began executing node model.supercell.dim_resource
[0m17:43:23.514091 [debug] [Thread-3 (]: Writing runtime sql for node "model.supercell.dim_accounts"
[0m17:43:23.514713 [debug] [Thread-2 (]: Began executing node model.supercell.fact_bill_generation
[0m17:43:23.516568 [debug] [Thread-4 (]: Writing runtime sql for node "model.supercell.dim_resource"
[0m17:43:23.519048 [debug] [Thread-2 (]: Writing runtime sql for node "model.supercell.fact_bill_generation"
[0m17:43:23.519540 [debug] [Thread-3 (]: Using duckdb connection "model.supercell.dim_accounts"
[0m17:43:23.520138 [debug] [Thread-4 (]: Using duckdb connection "model.supercell.dim_resource"
[0m17:43:23.520656 [debug] [Thread-3 (]: On model.supercell.dim_accounts: BEGIN
[0m17:43:23.521270 [debug] [Thread-2 (]: Using duckdb connection "model.supercell.fact_bill_generation"
[0m17:43:23.521581 [debug] [Thread-4 (]: On model.supercell.dim_resource: BEGIN
[0m17:43:23.521961 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m17:43:23.522371 [debug] [Thread-2 (]: On model.supercell.fact_bill_generation: BEGIN
[0m17:43:23.522660 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m17:43:23.523163 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m17:43:23.523637 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m17:43:23.524147 [debug] [Thread-3 (]: Using duckdb connection "model.supercell.dim_accounts"
[0m17:43:23.524527 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m17:43:23.524816 [debug] [Thread-3 (]: On model.supercell.dim_accounts: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.dim_accounts"} */

  
    
    

    create  table
      "supercell"."main"."dim_accounts__dbt_tmp"
  
    as (
      


select
    linked_account_id as linked_account_id,
    tag_keys as tag_keys,
    tag_values as tag_values
from "supercell"."main"."cleaned_usagelogs"
    );
  
  
[0m17:43:23.525157 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m17:43:23.525473 [debug] [Thread-4 (]: Using duckdb connection "model.supercell.dim_resource"
[0m17:43:23.525855 [debug] [Thread-2 (]: Using duckdb connection "model.supercell.fact_bill_generation"
[0m17:43:23.526138 [debug] [Thread-4 (]: On model.supercell.dim_resource: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.dim_resource"} */

  
    
    

    create  table
      "supercell"."main"."dim_resource__dbt_tmp"
  
    as (
      


select
    md5(concat(linked_account_id, '_', service_code, '_', instance_type, '_', region, '_', CAST(usage_start_date AS VARCHAR), '_', CAST(usage_end_date AS VARCHAR))) AS resource_id,
    linked_account_id as linked_account_id,
    region,
    service_code as product,
    instance_type as instance_type,
    pricing_model as pricing_model
from "supercell"."main"."cleaned_usagelogs"
    );
  
  
[0m17:43:23.526537 [debug] [Thread-2 (]: On model.supercell.fact_bill_generation: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.fact_bill_generation"} */

  
    
    

    create  table
      "supercell"."main"."fact_bill_generation__dbt_tmp"
  
    as (
      


select
    md5(concat(linked_account_id, '_', service_code, '_', instance_type, '_', region, '_', CAST(usage_start_date AS VARCHAR), '_', CAST(usage_end_date AS VARCHAR))) AS resource_id,
    usage_start_date as start_date,
    usage_end_date as bill_date,
    usage_amount as bill_amount,
    operation
from "supercell"."main"."cleaned_usagelogs"
    );
  
  
[0m17:43:23.617602 [debug] [Thread-3 (]: SQL status: OK in 0.092 seconds
[0m17:43:23.621364 [debug] [Thread-3 (]: Using duckdb connection "model.supercell.dim_accounts"
[0m17:43:23.621967 [debug] [Thread-3 (]: On model.supercell.dim_accounts: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.dim_accounts"} */
alter table "supercell"."main"."dim_accounts" rename to "dim_accounts__dbt_backup"
[0m17:43:23.623126 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m17:43:23.626675 [debug] [Thread-3 (]: Using duckdb connection "model.supercell.dim_accounts"
[0m17:43:23.627446 [debug] [Thread-3 (]: On model.supercell.dim_accounts: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.dim_accounts"} */
alter table "supercell"."main"."dim_accounts__dbt_tmp" rename to "dim_accounts"
[0m17:43:23.628450 [debug] [Thread-3 (]: SQL status: OK in 0.000 seconds
[0m17:43:23.630284 [debug] [Thread-3 (]: On model.supercell.dim_accounts: COMMIT
[0m17:43:23.630676 [debug] [Thread-3 (]: Using duckdb connection "model.supercell.dim_accounts"
[0m17:43:23.630960 [debug] [Thread-3 (]: On model.supercell.dim_accounts: COMMIT
[0m17:43:23.637029 [debug] [Thread-3 (]: SQL status: OK in 0.006 seconds
[0m17:43:23.639227 [debug] [Thread-3 (]: Using duckdb connection "model.supercell.dim_accounts"
[0m17:43:23.639621 [debug] [Thread-3 (]: On model.supercell.dim_accounts: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.dim_accounts"} */
drop table if exists "supercell"."main"."dim_accounts__dbt_backup" cascade
[0m17:43:23.643249 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m17:43:23.644593 [debug] [Thread-3 (]: On model.supercell.dim_accounts: Close
[0m17:43:23.647623 [info ] [Thread-3 (]: 2 of 5 OK created sql table model main.dim_accounts ............................ [[32mOK[0m in 0.15s]
[0m17:43:23.648257 [debug] [Thread-3 (]: Finished running node model.supercell.dim_accounts
[0m17:43:23.691578 [debug] [Thread-2 (]: SQL status: OK in 0.164 seconds
[0m17:43:23.693612 [debug] [Thread-2 (]: Using duckdb connection "model.supercell.fact_bill_generation"
[0m17:43:23.693896 [debug] [Thread-2 (]: On model.supercell.fact_bill_generation: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.fact_bill_generation"} */
alter table "supercell"."main"."fact_bill_generation" rename to "fact_bill_generation__dbt_backup"
[0m17:43:23.694495 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m17:43:23.696216 [debug] [Thread-2 (]: Using duckdb connection "model.supercell.fact_bill_generation"
[0m17:43:23.696477 [debug] [Thread-2 (]: On model.supercell.fact_bill_generation: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.fact_bill_generation"} */
alter table "supercell"."main"."fact_bill_generation__dbt_tmp" rename to "fact_bill_generation"
[0m17:43:23.697033 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m17:43:23.698294 [debug] [Thread-2 (]: On model.supercell.fact_bill_generation: COMMIT
[0m17:43:23.698572 [debug] [Thread-2 (]: Using duckdb connection "model.supercell.fact_bill_generation"
[0m17:43:23.698799 [debug] [Thread-2 (]: On model.supercell.fact_bill_generation: COMMIT
[0m17:43:23.712263 [debug] [Thread-2 (]: SQL status: OK in 0.013 seconds
[0m17:43:23.715546 [debug] [Thread-2 (]: Using duckdb connection "model.supercell.fact_bill_generation"
[0m17:43:23.715963 [debug] [Thread-2 (]: On model.supercell.fact_bill_generation: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.fact_bill_generation"} */
drop table if exists "supercell"."main"."fact_bill_generation__dbt_backup" cascade
[0m17:43:23.717917 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m17:43:23.718944 [debug] [Thread-2 (]: On model.supercell.fact_bill_generation: Close
[0m17:43:23.722036 [info ] [Thread-2 (]: 4 of 5 OK created sql table model main.fact_bill_generation .................... [[32mOK[0m in 0.22s]
[0m17:43:23.722500 [debug] [Thread-2 (]: Finished running node model.supercell.fact_bill_generation
[0m17:43:23.785202 [debug] [Thread-4 (]: SQL status: OK in 0.258 seconds
[0m17:43:23.787056 [debug] [Thread-4 (]: Using duckdb connection "model.supercell.dim_resource"
[0m17:43:23.787411 [debug] [Thread-4 (]: On model.supercell.dim_resource: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.dim_resource"} */
alter table "supercell"."main"."dim_resource" rename to "dim_resource__dbt_backup"
[0m17:43:23.788002 [debug] [Thread-4 (]: SQL status: OK in 0.000 seconds
[0m17:43:23.789590 [debug] [Thread-4 (]: Using duckdb connection "model.supercell.dim_resource"
[0m17:43:23.789819 [debug] [Thread-4 (]: On model.supercell.dim_resource: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.dim_resource"} */
alter table "supercell"."main"."dim_resource__dbt_tmp" rename to "dim_resource"
[0m17:43:23.790242 [debug] [Thread-4 (]: SQL status: OK in 0.000 seconds
[0m17:43:23.791192 [debug] [Thread-4 (]: On model.supercell.dim_resource: COMMIT
[0m17:43:23.791414 [debug] [Thread-4 (]: Using duckdb connection "model.supercell.dim_resource"
[0m17:43:23.791587 [debug] [Thread-4 (]: On model.supercell.dim_resource: COMMIT
[0m17:43:23.796345 [debug] [Thread-4 (]: SQL status: OK in 0.004 seconds
[0m17:43:23.797539 [debug] [Thread-4 (]: Using duckdb connection "model.supercell.dim_resource"
[0m17:43:23.797752 [debug] [Thread-4 (]: On model.supercell.dim_resource: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.dim_resource"} */
drop table if exists "supercell"."main"."dim_resource__dbt_backup" cascade
[0m17:43:23.799237 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m17:43:23.800025 [debug] [Thread-4 (]: On model.supercell.dim_resource: Close
[0m17:43:23.802325 [info ] [Thread-4 (]: 3 of 5 OK created sql table model main.dim_resource ............................ [[32mOK[0m in 0.30s]
[0m17:43:23.802659 [debug] [Thread-4 (]: Finished running node model.supercell.dim_resource
[0m17:43:23.803629 [debug] [Thread-1 (]: Began running node model.supercell.total_cost
[0m17:43:23.804293 [info ] [Thread-1 (]: 5 of 5 START sql table model main.total_cost ................................... [RUN]
[0m17:43:23.804688 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.supercell.cleaned_usagelogs, now model.supercell.total_cost)
[0m17:43:23.804901 [debug] [Thread-1 (]: Began compiling node model.supercell.total_cost
[0m17:43:23.807226 [debug] [Thread-1 (]: Writing injected SQL for node "model.supercell.total_cost"
[0m17:43:23.808014 [debug] [Thread-1 (]: Began executing node model.supercell.total_cost
[0m17:43:23.810802 [debug] [Thread-1 (]: Writing runtime sql for node "model.supercell.total_cost"
[0m17:43:23.811432 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.total_cost"
[0m17:43:23.811675 [debug] [Thread-1 (]: On model.supercell.total_cost: BEGIN
[0m17:43:23.811852 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:43:23.812372 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:43:23.812595 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.total_cost"
[0m17:43:23.812818 [debug] [Thread-1 (]: On model.supercell.total_cost: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.total_cost"} */

  
    
    

    create  table
      "supercell"."main"."total_cost__dbt_tmp"
  
    as (
      

with base as (
    select
        fact_bill_generation.resource_id,
        date_trunc('month', fact_bill_generation.bill_date) as month,
        fact_bill_generation.bill_amount,
        dim_resource.instance_type,
        dim_resource.product,
        dim_resource.region,
        dim_resource.pricing_model,
        md5(dim_resource.linked_account_id) as linked_account_id
    from "supercell"."main"."fact_bill_generation" as fact_bill_generation
    left join "supercell"."main"."dim_resource" as dim_resource
        on fact_bill_generation.resource_id = dim_resource.resource_id
),
joined as (
    select
        base.*,
        dim_accounts.tag_keys as tag_keys,
        dim_accounts.tag_values as tag_values
    from base
    left join "supercell"."main"."dim_accounts" as dim_accounts
        on base.linked_account_id = md5(dim_accounts.linked_account_id)
)

select
    month,
    sum(bill_amount) as total_cost,
    instance_type,
    product,
    region,
    pricing_model,
    tag_keys,
    tag_values
from joined
group by
    month,
    instance_type,
    product,
    region,
    pricing_model,
    tag_keys,
    tag_values
order by
    month,
    instance_type,
    product,
    region,
    pricing_model,
    tag_keys,
    tag_values
    );
  
  
[0m17:43:53.174649 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/harsha/data_actions/supercell_cloudops/target/run_results.json
[0m17:43:53.176721 [debug] [MainThread]: DuckDB adapter: cancelling query on connection model.supercell.total_cost. Details: Connection(type='duckdb', name='model.supercell.total_cost', state=<ConnectionState.OPEN: 'open'>, transaction_open=True, _handle=<dbt.adapters.duckdb.environments.local.DuckDBConnectionWrapper object at 0x743f89296f30>, _credentials=DuckDBCredentials(database='supercell', schema='main', path='/home/harsha/data_actions/supercell_cloudops/supercell.duckdb', config_options=None, extensions=None, settings={}, secrets=[], external_root='.', use_credential_provider=None, attach=None, filesystems=None, remote=None, plugins=None, disable_transactions=False, keep_open=True, module_paths=None, retries=None))
[0m17:43:53.177402 [debug] [MainThread]: DuckDB adapter: query cancelled on connection model.supercell.total_cost
[0m17:43:53.177933 [error] [MainThread]: CANCEL query model.supercell.total_cost ........................................ [[31mCANCEL[0m]
[0m17:43:53.178490 [error] [MainThread]: CANCEL query model.supercell.dim_accounts ...................................... [[31mCANCEL[0m]
[0m17:43:53.178984 [error] [MainThread]: CANCEL query model.supercell.dim_resource ...................................... [[31mCANCEL[0m]
[0m17:43:53.179895 [debug] [Thread-1 (]: DuckDB adapter: Error running SQL: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.total_cost"} */

  
    
    

    create  table
      "supercell"."main"."total_cost__dbt_tmp"
  
    as (
      

with base as (
    select
        fact_bill_generation.resource_id,
        date_trunc('month', fact_bill_generation.bill_date) as month,
        fact_bill_generation.bill_amount,
        dim_resource.instance_type,
        dim_resource.product,
        dim_resource.region,
        dim_resource.pricing_model,
        md5(dim_resource.linked_account_id) as linked_account_id
    from "supercell"."main"."fact_bill_generation" as fact_bill_generation
    left join "supercell"."main"."dim_resource" as dim_resource
        on fact_bill_generation.resource_id = dim_resource.resource_id
),
joined as (
    select
        base.*,
        dim_accounts.tag_keys as tag_keys,
        dim_accounts.tag_values as tag_values
    from base
    left join "supercell"."main"."dim_accounts" as dim_accounts
        on base.linked_account_id = md5(dim_accounts.linked_account_id)
)

select
    month,
    sum(bill_amount) as total_cost,
    instance_type,
    product,
    region,
    pricing_model,
    tag_keys,
    tag_values
from joined
group by
    month,
    instance_type,
    product,
    region,
    pricing_model,
    tag_keys,
    tag_values
order by
    month,
    instance_type,
    product,
    region,
    pricing_model,
    tag_keys,
    tag_values
    );
  
  
[0m17:43:53.180389 [error] [MainThread]: CANCEL query model.supercell.fact_bill_generation .............................. [[31mCANCEL[0m]
[0m17:43:53.181045 [debug] [Thread-1 (]: DuckDB adapter: Rolling back transaction.
[0m17:43:53.182029 [debug] [Thread-1 (]: On model.supercell.total_cost: ROLLBACK
[0m17:43:53.187271 [debug] [Thread-1 (]: Failed to rollback 'model.supercell.total_cost'
[0m17:43:53.187998 [debug] [Thread-1 (]: On model.supercell.total_cost: Close
[0m17:43:53.199605 [debug] [Thread-1 (]: Runtime Error in model total_cost (models/supercell_models/metrics/total_cost.sql)
  INTERRUPT Error: Interrupted!
[0m17:43:53.200345 [error] [Thread-1 (]: 5 of 5 ERROR creating sql table model main.total_cost .......................... [[31mERROR[0m in 29.40s]
[0m17:43:53.200831 [debug] [Thread-1 (]: Finished running node model.supercell.total_cost
[0m17:43:53.201348 [info ] [MainThread]: 
[0m17:43:53.202176 [info ] [MainThread]: [33mExited because of keyboard interrupt[0m
[0m17:43:53.203359 [info ] [MainThread]: 
[0m17:43:53.204282 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m17:43:53.204932 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:43:53.205361 [debug] [MainThread]: Connection 'model.supercell.total_cost' was properly closed.
[0m17:43:53.205741 [debug] [MainThread]: Connection 'model.supercell.dim_accounts' was properly closed.
[0m17:43:53.206105 [debug] [MainThread]: Connection 'model.supercell.dim_resource' was properly closed.
[0m17:43:53.206497 [debug] [MainThread]: Connection 'model.supercell.fact_bill_generation' was properly closed.
[0m17:43:53.207022 [info ] [MainThread]: 
[0m17:43:53.207571 [info ] [MainThread]: Finished running 4 table models in 0 hours 0 minutes and 30.11 seconds (30.11s).
[0m17:43:53.208227 [error] [MainThread]: Encountered an error:

[0m17:43:53.210551 [error] [MainThread]: Traceback (most recent call last):
  File "/home/harsha/data_actions/supercell_cloudops/supercell_env/lib/python3.12/site-packages/dbt/cli/requires.py", line 153, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "/home/harsha/data_actions/supercell_cloudops/supercell_env/lib/python3.12/site-packages/dbt/cli/requires.py", line 103, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/harsha/data_actions/supercell_cloudops/supercell_env/lib/python3.12/site-packages/dbt/cli/requires.py", line 235, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/harsha/data_actions/supercell_cloudops/supercell_env/lib/python3.12/site-packages/dbt/cli/requires.py", line 264, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/harsha/data_actions/supercell_cloudops/supercell_env/lib/python3.12/site-packages/dbt/cli/requires.py", line 311, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/harsha/data_actions/supercell_cloudops/supercell_env/lib/python3.12/site-packages/dbt/cli/requires.py", line 328, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/harsha/data_actions/supercell_cloudops/supercell_env/lib/python3.12/site-packages/dbt/cli/main.py", line 578, in run
    results = task.run()
              ^^^^^^^^^^
  File "/home/harsha/data_actions/supercell_cloudops/supercell_env/lib/python3.12/site-packages/dbt/task/runnable.py", line 590, in run
    result = self.execute_with_hooks(selected_uids)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/home/harsha/data_actions/supercell_cloudops/supercell_env/lib/python3.12/site-packages/dbt/task/runnable.py", line 532, in execute_with_hooks
    res = self.execute_nodes()
          ^^^^^^^^^^^^^^^^^^^^
  File "/home/harsha/data_actions/supercell_cloudops/supercell_env/lib/python3.12/site-packages/dbt/task/runnable.py", line 413, in execute_nodes
    self.run_queue(pool)
  File "/home/harsha/data_actions/supercell_cloudops/supercell_env/lib/python3.12/site-packages/dbt/task/runnable.py", line 340, in run_queue
    self.job_queue.join()
  File "/home/harsha/data_actions/supercell_cloudops/supercell_env/lib/python3.12/site-packages/dbt/graph/queue.py", line 206, in join
    self.inner.join()
  File "/usr/lib/python3.12/queue.py", line 90, in join
    self.all_tasks_done.wait()
  File "/usr/lib/python3.12/threading.py", line 355, in wait
    waiter.acquire()
KeyboardInterrupt

[0m17:43:53.211938 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 30.635094, "process_in_blocks": "0", "process_kernel_time": 0.392981, "process_mem_max_rss": "364764", "process_out_blocks": "58352", "process_user_time": 150.925}
[0m17:43:53.212602 [debug] [MainThread]: Command `dbt run` failed at 17:43:53.212465 after 30.64 seconds
[0m17:43:53.213058 [debug] [MainThread]: Flushing usage events


============================== 17:44:39.902382 | 8a4b1bf6-2a34-44de-9783-5ffb763a13ea ==============================
[0m17:44:39.902382 [info ] [MainThread]: Running with dbt=1.9.4
[0m17:44:39.905418 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/harsha/data_actions/supercell_cloudops', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/harsha/data_actions/supercell_cloudops/logs', 'warn_error': 'None', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'False'}
[0m17:44:39.905905 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality

User config should be moved from the 'config' key in profiles.yml to the 'flags' key in dbt_project.yml.
[0m17:44:40.059722 [info ] [MainThread]: Registered adapter: duckdb=1.9.3
[0m17:44:40.110581 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m17:44:40.149945 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m17:44:40.150344 [debug] [MainThread]: Partial parsing: updated file: supercell://models/supercell_models/metrics/total_cost.sql
[0m17:44:40.150588 [debug] [MainThread]: Partial parsing: updated file: supercell://models/supercell_models/dim_resource.sql
[0m17:44:40.287637 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.supercell.example
[0m17:44:40.319705 [debug] [MainThread]: Wrote artifact WritableManifest to /home/harsha/data_actions/supercell_cloudops/target/manifest.json
[0m17:44:40.320713 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/harsha/data_actions/supercell_cloudops/target/semantic_manifest.json
[0m17:44:40.327274 [info ] [MainThread]: Found 5 models, 428 macros
[0m17:44:40.328510 [info ] [MainThread]: 
[0m17:44:40.328836 [info ] [MainThread]: Concurrency: 4 threads (target='default')
[0m17:44:40.329050 [info ] [MainThread]: 
[0m17:44:40.329516 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m17:44:40.334006 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_supercell'
[0m17:44:40.355253 [debug] [ThreadPool]: Using duckdb connection "list_supercell"
[0m17:44:40.355581 [debug] [ThreadPool]: On list_supercell: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "connection_name": "list_supercell"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"supercell"'
    
  
  
[0m17:44:40.355759 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:44:40.364011 [debug] [ThreadPool]: SQL status: OK in 0.008 seconds
[0m17:44:40.364925 [debug] [ThreadPool]: On list_supercell: Close
[0m17:44:40.365436 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_supercell, now create_supercell_main)
[0m17:44:40.365723 [debug] [ThreadPool]: Creating schema "database: "supercell"
schema: "main"
"
[0m17:44:40.369535 [debug] [ThreadPool]: Using duckdb connection "create_supercell_main"
[0m17:44:40.369743 [debug] [ThreadPool]: On create_supercell_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "connection_name": "create_supercell_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='supercell'
        and type='sqlite'
    
  
[0m17:44:40.369919 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:44:40.370606 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m17:44:40.371357 [debug] [ThreadPool]: Using duckdb connection "create_supercell_main"
[0m17:44:40.371559 [debug] [ThreadPool]: On create_supercell_main: BEGIN
[0m17:44:40.371809 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:44:40.371966 [debug] [ThreadPool]: Using duckdb connection "create_supercell_main"
[0m17:44:40.372106 [debug] [ThreadPool]: On create_supercell_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "connection_name": "create_supercell_main"} */

    
    
        create schema if not exists "supercell"."main"
    
[0m17:44:40.372387 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:44:40.372837 [debug] [ThreadPool]: On create_supercell_main: COMMIT
[0m17:44:40.373009 [debug] [ThreadPool]: Using duckdb connection "create_supercell_main"
[0m17:44:40.373167 [debug] [ThreadPool]: On create_supercell_main: COMMIT
[0m17:44:40.373441 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m17:44:40.373614 [debug] [ThreadPool]: On create_supercell_main: Close
[0m17:44:40.374540 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_supercell_main, now list_supercell_main)
[0m17:44:40.379562 [debug] [ThreadPool]: Using duckdb connection "list_supercell_main"
[0m17:44:40.379959 [debug] [ThreadPool]: On list_supercell_main: BEGIN
[0m17:44:40.380258 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:44:40.380902 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m17:44:40.381222 [debug] [ThreadPool]: Using duckdb connection "list_supercell_main"
[0m17:44:40.381519 [debug] [ThreadPool]: On list_supercell_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "connection_name": "list_supercell_main"} */
select
      'supercell' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'supercell'
  
[0m17:44:40.399131 [debug] [ThreadPool]: SQL status: OK in 0.017 seconds
[0m17:44:40.400095 [debug] [ThreadPool]: On list_supercell_main: ROLLBACK
[0m17:44:40.400762 [debug] [ThreadPool]: Failed to rollback 'list_supercell_main'
[0m17:44:40.400977 [debug] [ThreadPool]: On list_supercell_main: Close
[0m17:44:40.401999 [debug] [MainThread]: Using duckdb connection "master"
[0m17:44:40.402223 [debug] [MainThread]: On master: BEGIN
[0m17:44:40.402399 [debug] [MainThread]: Opening a new connection, currently in state init
[0m17:44:40.402740 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:44:40.402926 [debug] [MainThread]: On master: COMMIT
[0m17:44:40.403089 [debug] [MainThread]: Using duckdb connection "master"
[0m17:44:40.403260 [debug] [MainThread]: On master: COMMIT
[0m17:44:40.403497 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:44:40.403662 [debug] [MainThread]: On master: Close
[0m17:44:40.405766 [debug] [Thread-1 (]: Began running node model.supercell.cleaned_usagelogs
[0m17:44:40.406314 [info ] [Thread-1 (]: 1 of 5 START sql table model main.cleaned_usagelogs ............................ [RUN]
[0m17:44:40.406755 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_supercell_main, now model.supercell.cleaned_usagelogs)
[0m17:44:40.407102 [debug] [Thread-1 (]: Began compiling node model.supercell.cleaned_usagelogs
[0m17:44:40.413676 [debug] [Thread-1 (]: Writing injected SQL for node "model.supercell.cleaned_usagelogs"
[0m17:44:40.414195 [debug] [Thread-1 (]: Began executing node model.supercell.cleaned_usagelogs
[0m17:44:40.432765 [debug] [Thread-1 (]: Writing runtime sql for node "model.supercell.cleaned_usagelogs"
[0m17:44:40.433264 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.cleaned_usagelogs"
[0m17:44:40.433490 [debug] [Thread-1 (]: On model.supercell.cleaned_usagelogs: BEGIN
[0m17:44:40.433661 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:44:40.434268 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:44:40.434465 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.cleaned_usagelogs"
[0m17:44:40.434645 [debug] [Thread-1 (]: On model.supercell.cleaned_usagelogs: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.cleaned_usagelogs"} */

  
    
    

    create  table
      "supercell"."main"."cleaned_usagelogs__dbt_tmp"
  
    as (
      


SELECT
    CAST("LinkedAccountId" AS VARCHAR) AS linked_account_id,
    CAST("bill/PayerAccountId" AS VARCHAR) AS payer_account_id,
    CAST("lineItem/UsageStartDate" AS TIMESTAMP) AS usage_start_date,
    CAST("lineItem/UsageEndDate" AS TIMESTAMP) AS usage_end_date,
    CAST("lineItem/UsageAmount" AS DECIMAL(18, 6)) AS usage_amount,
    CAST("lineItem/Operation" AS VARCHAR) AS operation,
    CAST("pricing/PricingModel" AS VARCHAR) AS pricing_model,
    CAST("resourceTags/TagKeys" AS VARCHAR) AS tag_keys,
    CAST("resourceTags/TagValues" AS VARCHAR) AS tag_values,
    CAST("product/Region" AS VARCHAR) AS region,
    CAST("product/ServiceCode" AS VARCHAR) AS service_code,
    CAST("product/InstanceType" AS VARCHAR) AS instance_type,
    CAST("amortized_cost" AS DECIMAL(18, 6)) AS amortized_cost,
    CAST("product/Description" AS VARCHAR) AS description
FROM supercell_usagelogs
    );
  
  
[0m17:44:40.702443 [debug] [Thread-1 (]: SQL status: OK in 0.268 seconds
[0m17:44:40.706152 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.cleaned_usagelogs"
[0m17:44:40.706419 [debug] [Thread-1 (]: On model.supercell.cleaned_usagelogs: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.cleaned_usagelogs"} */
alter table "supercell"."main"."cleaned_usagelogs" rename to "cleaned_usagelogs__dbt_backup"
[0m17:44:40.706956 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:44:40.708469 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.cleaned_usagelogs"
[0m17:44:40.708691 [debug] [Thread-1 (]: On model.supercell.cleaned_usagelogs: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.cleaned_usagelogs"} */
alter table "supercell"."main"."cleaned_usagelogs__dbt_tmp" rename to "cleaned_usagelogs"
[0m17:44:40.709085 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:44:40.717940 [debug] [Thread-1 (]: On model.supercell.cleaned_usagelogs: COMMIT
[0m17:44:40.718259 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.cleaned_usagelogs"
[0m17:44:40.718453 [debug] [Thread-1 (]: On model.supercell.cleaned_usagelogs: COMMIT
[0m17:44:40.730014 [debug] [Thread-1 (]: SQL status: OK in 0.011 seconds
[0m17:44:40.733417 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.cleaned_usagelogs"
[0m17:44:40.733690 [debug] [Thread-1 (]: On model.supercell.cleaned_usagelogs: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.cleaned_usagelogs"} */
drop table if exists "supercell"."main"."cleaned_usagelogs__dbt_backup" cascade
[0m17:44:40.735678 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m17:44:40.737298 [debug] [Thread-1 (]: On model.supercell.cleaned_usagelogs: Close
[0m17:44:40.742388 [info ] [Thread-1 (]: 1 of 5 OK created sql table model main.cleaned_usagelogs ....................... [[32mOK[0m in 0.33s]
[0m17:44:40.742781 [debug] [Thread-1 (]: Finished running node model.supercell.cleaned_usagelogs
[0m17:44:40.743770 [debug] [Thread-3 (]: Began running node model.supercell.dim_accounts
[0m17:44:40.744285 [debug] [Thread-4 (]: Began running node model.supercell.dim_resource
[0m17:44:40.744818 [info ] [Thread-3 (]: 2 of 5 START sql table model main.dim_accounts ................................. [RUN]
[0m17:44:40.745501 [debug] [Thread-2 (]: Began running node model.supercell.fact_bill_generation
[0m17:44:40.746457 [info ] [Thread-4 (]: 3 of 5 START sql table model main.dim_resource ................................. [RUN]
[0m17:44:40.747489 [debug] [Thread-3 (]: Acquiring new duckdb connection 'model.supercell.dim_accounts'
[0m17:44:40.748354 [info ] [Thread-2 (]: 4 of 5 START sql table model main.fact_bill_generation ......................... [RUN]
[0m17:44:40.749578 [debug] [Thread-4 (]: Acquiring new duckdb connection 'model.supercell.dim_resource'
[0m17:44:40.750201 [debug] [Thread-3 (]: Began compiling node model.supercell.dim_accounts
[0m17:44:40.750824 [debug] [Thread-2 (]: Acquiring new duckdb connection 'model.supercell.fact_bill_generation'
[0m17:44:40.751414 [debug] [Thread-4 (]: Began compiling node model.supercell.dim_resource
[0m17:44:40.756087 [debug] [Thread-3 (]: Writing injected SQL for node "model.supercell.dim_accounts"
[0m17:44:40.756700 [debug] [Thread-2 (]: Began compiling node model.supercell.fact_bill_generation
[0m17:44:40.759939 [debug] [Thread-4 (]: Writing injected SQL for node "model.supercell.dim_resource"
[0m17:44:40.762619 [debug] [Thread-2 (]: Writing injected SQL for node "model.supercell.fact_bill_generation"
[0m17:44:40.763195 [debug] [Thread-3 (]: Began executing node model.supercell.dim_accounts
[0m17:44:40.763688 [debug] [Thread-4 (]: Began executing node model.supercell.dim_resource
[0m17:44:40.765701 [debug] [Thread-3 (]: Writing runtime sql for node "model.supercell.dim_accounts"
[0m17:44:40.766032 [debug] [Thread-2 (]: Began executing node model.supercell.fact_bill_generation
[0m17:44:40.767956 [debug] [Thread-4 (]: Writing runtime sql for node "model.supercell.dim_resource"
[0m17:44:40.768499 [debug] [Thread-3 (]: Using duckdb connection "model.supercell.dim_accounts"
[0m17:44:40.770431 [debug] [Thread-2 (]: Writing runtime sql for node "model.supercell.fact_bill_generation"
[0m17:44:40.770920 [debug] [Thread-3 (]: On model.supercell.dim_accounts: BEGIN
[0m17:44:40.771419 [debug] [Thread-4 (]: Using duckdb connection "model.supercell.dim_resource"
[0m17:44:40.771735 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m17:44:40.772001 [debug] [Thread-2 (]: Using duckdb connection "model.supercell.fact_bill_generation"
[0m17:44:40.772382 [debug] [Thread-4 (]: On model.supercell.dim_resource: BEGIN
[0m17:44:40.773005 [debug] [Thread-2 (]: On model.supercell.fact_bill_generation: BEGIN
[0m17:44:40.773293 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m17:44:40.773670 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m17:44:40.774056 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m17:44:40.774332 [debug] [Thread-3 (]: Using duckdb connection "model.supercell.dim_accounts"
[0m17:44:40.775058 [debug] [Thread-3 (]: On model.supercell.dim_accounts: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.dim_accounts"} */

  
    
    

    create  table
      "supercell"."main"."dim_accounts__dbt_tmp"
  
    as (
      


select
    linked_account_id as linked_account_id,
    tag_keys as tag_keys,
    tag_values as tag_values
from "supercell"."main"."cleaned_usagelogs"
    );
  
  
[0m17:44:40.775382 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m17:44:40.775779 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m17:44:40.776238 [debug] [Thread-2 (]: Using duckdb connection "model.supercell.fact_bill_generation"
[0m17:44:40.776722 [debug] [Thread-4 (]: Using duckdb connection "model.supercell.dim_resource"
[0m17:44:40.777280 [debug] [Thread-2 (]: On model.supercell.fact_bill_generation: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.fact_bill_generation"} */

  
    
    

    create  table
      "supercell"."main"."fact_bill_generation__dbt_tmp"
  
    as (
      


select
    md5(concat(linked_account_id, '_', service_code, '_', instance_type, '_', region, '_', CAST(usage_start_date AS VARCHAR), '_', CAST(usage_end_date AS VARCHAR))) AS resource_id,
    usage_start_date as start_date,
    usage_end_date as bill_date,
    usage_amount as bill_amount,
    operation
from "supercell"."main"."cleaned_usagelogs"
    );
  
  
[0m17:44:40.777920 [debug] [Thread-4 (]: On model.supercell.dim_resource: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.dim_resource"} */

  
    
    

    create  table
      "supercell"."main"."dim_resource__dbt_tmp"
  
    as (
      


select
    md5(concat(linked_account_id, '_', service_code, '_', instance_type, '_', region, '_', CAST(usage_start_date AS VARCHAR), '_', CAST(usage_end_date AS VARCHAR))) AS resource_id,
    linked_account_id as linked_account_id,
    region,
    service_code as product,
    instance_type as instance_type,
    pricing_model as pricing_model,
    tag_keys as tag_keys,
    tag_values as tag_values
from "supercell"."main"."cleaned_usagelogs"
    );
  
  
[0m17:44:40.864857 [debug] [Thread-3 (]: SQL status: OK in 0.089 seconds
[0m17:44:40.868205 [debug] [Thread-3 (]: Using duckdb connection "model.supercell.dim_accounts"
[0m17:44:40.868758 [debug] [Thread-3 (]: On model.supercell.dim_accounts: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.dim_accounts"} */
alter table "supercell"."main"."dim_accounts" rename to "dim_accounts__dbt_backup"
[0m17:44:40.869744 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m17:44:40.873013 [debug] [Thread-3 (]: Using duckdb connection "model.supercell.dim_accounts"
[0m17:44:40.873675 [debug] [Thread-3 (]: On model.supercell.dim_accounts: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.dim_accounts"} */
alter table "supercell"."main"."dim_accounts__dbt_tmp" rename to "dim_accounts"
[0m17:44:40.874562 [debug] [Thread-3 (]: SQL status: OK in 0.000 seconds
[0m17:44:40.876508 [debug] [Thread-3 (]: On model.supercell.dim_accounts: COMMIT
[0m17:44:40.877064 [debug] [Thread-3 (]: Using duckdb connection "model.supercell.dim_accounts"
[0m17:44:40.877473 [debug] [Thread-3 (]: On model.supercell.dim_accounts: COMMIT
[0m17:44:40.883848 [debug] [Thread-3 (]: SQL status: OK in 0.006 seconds
[0m17:44:40.886393 [debug] [Thread-3 (]: Using duckdb connection "model.supercell.dim_accounts"
[0m17:44:40.886876 [debug] [Thread-3 (]: On model.supercell.dim_accounts: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.dim_accounts"} */
drop table if exists "supercell"."main"."dim_accounts__dbt_backup" cascade
[0m17:44:40.888937 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m17:44:40.890101 [debug] [Thread-3 (]: On model.supercell.dim_accounts: Close
[0m17:44:40.893002 [info ] [Thread-3 (]: 2 of 5 OK created sql table model main.dim_accounts ............................ [[32mOK[0m in 0.15s]
[0m17:44:40.893613 [debug] [Thread-3 (]: Finished running node model.supercell.dim_accounts
[0m17:44:40.949277 [debug] [Thread-2 (]: SQL status: OK in 0.171 seconds
[0m17:44:40.951356 [debug] [Thread-2 (]: Using duckdb connection "model.supercell.fact_bill_generation"
[0m17:44:40.951684 [debug] [Thread-2 (]: On model.supercell.fact_bill_generation: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.fact_bill_generation"} */
alter table "supercell"."main"."fact_bill_generation" rename to "fact_bill_generation__dbt_backup"
[0m17:44:40.952303 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m17:44:40.954005 [debug] [Thread-2 (]: Using duckdb connection "model.supercell.fact_bill_generation"
[0m17:44:40.954266 [debug] [Thread-2 (]: On model.supercell.fact_bill_generation: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.fact_bill_generation"} */
alter table "supercell"."main"."fact_bill_generation__dbt_tmp" rename to "fact_bill_generation"
[0m17:44:40.954763 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m17:44:40.955927 [debug] [Thread-2 (]: On model.supercell.fact_bill_generation: COMMIT
[0m17:44:40.956200 [debug] [Thread-2 (]: Using duckdb connection "model.supercell.fact_bill_generation"
[0m17:44:40.956422 [debug] [Thread-2 (]: On model.supercell.fact_bill_generation: COMMIT
[0m17:44:40.967275 [debug] [Thread-2 (]: SQL status: OK in 0.011 seconds
[0m17:44:40.969907 [debug] [Thread-2 (]: Using duckdb connection "model.supercell.fact_bill_generation"
[0m17:44:40.970232 [debug] [Thread-2 (]: On model.supercell.fact_bill_generation: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.fact_bill_generation"} */
drop table if exists "supercell"."main"."fact_bill_generation__dbt_backup" cascade
[0m17:44:40.972285 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m17:44:40.973325 [debug] [Thread-2 (]: On model.supercell.fact_bill_generation: Close
[0m17:44:40.976084 [info ] [Thread-2 (]: 4 of 5 OK created sql table model main.fact_bill_generation .................... [[32mOK[0m in 0.23s]
[0m17:44:40.976563 [debug] [Thread-2 (]: Finished running node model.supercell.fact_bill_generation
[0m17:44:41.071870 [debug] [Thread-4 (]: SQL status: OK in 0.293 seconds
[0m17:44:41.073820 [debug] [Thread-4 (]: Using duckdb connection "model.supercell.dim_resource"
[0m17:44:41.074139 [debug] [Thread-4 (]: On model.supercell.dim_resource: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.dim_resource"} */
alter table "supercell"."main"."dim_resource" rename to "dim_resource__dbt_backup"
[0m17:44:41.074744 [debug] [Thread-4 (]: SQL status: OK in 0.000 seconds
[0m17:44:41.076379 [debug] [Thread-4 (]: Using duckdb connection "model.supercell.dim_resource"
[0m17:44:41.076600 [debug] [Thread-4 (]: On model.supercell.dim_resource: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.dim_resource"} */
alter table "supercell"."main"."dim_resource__dbt_tmp" rename to "dim_resource"
[0m17:44:41.076985 [debug] [Thread-4 (]: SQL status: OK in 0.000 seconds
[0m17:44:41.077911 [debug] [Thread-4 (]: On model.supercell.dim_resource: COMMIT
[0m17:44:41.078122 [debug] [Thread-4 (]: Using duckdb connection "model.supercell.dim_resource"
[0m17:44:41.078355 [debug] [Thread-4 (]: On model.supercell.dim_resource: COMMIT
[0m17:44:41.083467 [debug] [Thread-4 (]: SQL status: OK in 0.005 seconds
[0m17:44:41.084871 [debug] [Thread-4 (]: Using duckdb connection "model.supercell.dim_resource"
[0m17:44:41.085098 [debug] [Thread-4 (]: On model.supercell.dim_resource: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.dim_resource"} */
drop table if exists "supercell"."main"."dim_resource__dbt_backup" cascade
[0m17:44:41.086679 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m17:44:41.087626 [debug] [Thread-4 (]: On model.supercell.dim_resource: Close
[0m17:44:41.091100 [info ] [Thread-4 (]: 3 of 5 OK created sql table model main.dim_resource ............................ [[32mOK[0m in 0.34s]
[0m17:44:41.091622 [debug] [Thread-4 (]: Finished running node model.supercell.dim_resource
[0m17:44:41.092393 [debug] [Thread-1 (]: Began running node model.supercell.total_cost
[0m17:44:41.092794 [info ] [Thread-1 (]: 5 of 5 START sql table model main.total_cost ................................... [RUN]
[0m17:44:41.093129 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.supercell.cleaned_usagelogs, now model.supercell.total_cost)
[0m17:44:41.093409 [debug] [Thread-1 (]: Began compiling node model.supercell.total_cost
[0m17:44:41.095856 [debug] [Thread-1 (]: Writing injected SQL for node "model.supercell.total_cost"
[0m17:44:41.096597 [debug] [Thread-1 (]: Began executing node model.supercell.total_cost
[0m17:44:41.100774 [debug] [Thread-1 (]: Writing runtime sql for node "model.supercell.total_cost"
[0m17:44:41.101480 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.total_cost"
[0m17:44:41.101773 [debug] [Thread-1 (]: On model.supercell.total_cost: BEGIN
[0m17:44:41.101972 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:44:41.102766 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:44:41.103007 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.total_cost"
[0m17:44:41.103215 [debug] [Thread-1 (]: On model.supercell.total_cost: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.total_cost"} */

  
    
    

    create  table
      "supercell"."main"."total_cost__dbt_tmp"
  
    as (
      

with base as (
    select
        fact_bill_generation.resource_id,
        date_trunc('month', fact_bill_generation.bill_date) as month,
        fact_bill_generation.bill_amount,
        dim_resource.instance_type,
        dim_resource.product,
        dim_resource.region,
        dim_resource.pricing_model,
        dim_resource.tag_keys,
        dim_resource.tag_values
    from "supercell"."main"."fact_bill_generation" as fact_bill_generation
    left join "supercell"."main"."dim_resource" as dim_resource
        on fact_bill_generation.resource_id = dim_resource.resource_id
)

select
    month,
    sum(bill_amount) as total_cost,
    instance_type,
    product,
    region,
    pricing_model,
    tag_keys,
    tag_values
from base
group by
    month,
    instance_type,
    product,
    region,
    pricing_model,
    tag_keys,
    tag_values
order by
    month,
    instance_type,
    product,
    region,
    pricing_model,
    tag_keys,
    tag_values
    );
  
  
[0m17:44:41.401958 [debug] [Thread-1 (]: SQL status: OK in 0.298 seconds
[0m17:44:41.404574 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.total_cost"
[0m17:44:41.404983 [debug] [Thread-1 (]: On model.supercell.total_cost: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.total_cost"} */
alter table "supercell"."main"."total_cost" rename to "total_cost__dbt_backup"
[0m17:44:41.405748 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:44:41.408132 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.total_cost"
[0m17:44:41.408506 [debug] [Thread-1 (]: On model.supercell.total_cost: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.total_cost"} */
alter table "supercell"."main"."total_cost__dbt_tmp" rename to "total_cost"
[0m17:44:41.409103 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m17:44:41.410771 [debug] [Thread-1 (]: On model.supercell.total_cost: COMMIT
[0m17:44:41.411142 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.total_cost"
[0m17:44:41.411480 [debug] [Thread-1 (]: On model.supercell.total_cost: COMMIT
[0m17:44:41.414895 [debug] [Thread-1 (]: SQL status: OK in 0.003 seconds
[0m17:44:41.416926 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.total_cost"
[0m17:44:41.417306 [debug] [Thread-1 (]: On model.supercell.total_cost: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.total_cost"} */
drop table if exists "supercell"."main"."total_cost__dbt_backup" cascade
[0m17:44:41.419091 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m17:44:41.420313 [debug] [Thread-1 (]: On model.supercell.total_cost: Close
[0m17:44:41.424862 [info ] [Thread-1 (]: 5 of 5 OK created sql table model main.total_cost .............................. [[32mOK[0m in 0.33s]
[0m17:44:41.425247 [debug] [Thread-1 (]: Finished running node model.supercell.total_cost
[0m17:44:41.426740 [debug] [MainThread]: Using duckdb connection "master"
[0m17:44:41.427024 [debug] [MainThread]: On master: BEGIN
[0m17:44:41.427238 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m17:44:41.427744 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:44:41.427946 [debug] [MainThread]: On master: COMMIT
[0m17:44:41.428116 [debug] [MainThread]: Using duckdb connection "master"
[0m17:44:41.428342 [debug] [MainThread]: On master: COMMIT
[0m17:44:41.428842 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m17:44:41.429147 [debug] [MainThread]: On master: Close
[0m17:44:41.429554 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:44:41.429721 [debug] [MainThread]: Connection 'model.supercell.total_cost' was properly closed.
[0m17:44:41.429860 [debug] [MainThread]: Connection 'model.supercell.dim_accounts' was properly closed.
[0m17:44:41.429994 [debug] [MainThread]: Connection 'model.supercell.dim_resource' was properly closed.
[0m17:44:41.430145 [debug] [MainThread]: Connection 'model.supercell.fact_bill_generation' was properly closed.
[0m17:44:41.430423 [info ] [MainThread]: 
[0m17:44:41.430672 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 1.10 seconds (1.10s).
[0m17:44:41.431828 [debug] [MainThread]: Command end result
[0m17:44:41.491925 [debug] [MainThread]: Wrote artifact WritableManifest to /home/harsha/data_actions/supercell_cloudops/target/manifest.json
[0m17:44:41.492926 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/harsha/data_actions/supercell_cloudops/target/semantic_manifest.json
[0m17:44:41.496240 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/harsha/data_actions/supercell_cloudops/target/run_results.json
[0m17:44:41.496482 [info ] [MainThread]: 
[0m17:44:41.496709 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:44:41.496900 [info ] [MainThread]: 
[0m17:44:41.497106 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m17:44:41.497819 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.6259104, "process_in_blocks": "0", "process_kernel_time": 0.347966, "process_mem_max_rss": "342944", "process_out_blocks": "60272", "process_user_time": 5.1765}
[0m17:44:41.498100 [debug] [MainThread]: Command `dbt run` succeeded at 17:44:41.498045 after 1.63 seconds
[0m17:44:41.498325 [debug] [MainThread]: Flushing usage events


============================== 18:34:34.339459 | 91acd228-515e-49ea-a48b-fda5dd9944cd ==============================
[0m18:34:34.339459 [info ] [MainThread]: Running with dbt=1.9.4
[0m18:34:34.346263 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/harsha/data_actions/supercell_cloudops', 'debug': 'False', 'warn_error': 'None', 'log_path': '/home/harsha/data_actions/supercell_cloudops/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'False'}
[0m18:34:34.347113 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality

User config should be moved from the 'config' key in profiles.yml to the 'flags' key in dbt_project.yml.
[0m18:34:34.683612 [info ] [MainThread]: Registered adapter: duckdb=1.9.3
[0m18:34:34.752344 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m18:34:34.841263 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:34:34.841730 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:34:34.850215 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.supercell.example
[0m18:34:34.930913 [debug] [MainThread]: Wrote artifact WritableManifest to /home/harsha/data_actions/supercell_cloudops/target/manifest.json
[0m18:34:34.932727 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/harsha/data_actions/supercell_cloudops/target/semantic_manifest.json
[0m18:34:34.955880 [info ] [MainThread]: Found 5 models, 428 macros
[0m18:34:34.959052 [info ] [MainThread]: 
[0m18:34:34.959930 [info ] [MainThread]: Concurrency: 4 threads (target='default')
[0m18:34:34.960624 [info ] [MainThread]: 
[0m18:34:34.961700 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m18:34:34.970392 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_supercell'
[0m18:34:35.040723 [debug] [ThreadPool]: Using duckdb connection "list_supercell"
[0m18:34:35.041652 [debug] [ThreadPool]: On list_supercell: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "connection_name": "list_supercell"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"supercell"'
    
  
  
[0m18:34:35.042436 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:34:35.072709 [debug] [ThreadPool]: SQL status: OK in 0.030 seconds
[0m18:34:35.075446 [debug] [ThreadPool]: On list_supercell: Close
[0m18:34:35.076866 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_supercell, now create_supercell_main)
[0m18:34:35.077819 [debug] [ThreadPool]: Creating schema "database: "supercell"
schema: "main"
"
[0m18:34:35.088785 [debug] [ThreadPool]: Using duckdb connection "create_supercell_main"
[0m18:34:35.089549 [debug] [ThreadPool]: On create_supercell_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "connection_name": "create_supercell_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='supercell'
        and type='sqlite'
    
  
[0m18:34:35.090027 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:34:35.092560 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m18:34:35.095594 [debug] [ThreadPool]: Using duckdb connection "create_supercell_main"
[0m18:34:35.096381 [debug] [ThreadPool]: On create_supercell_main: BEGIN
[0m18:34:35.097544 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m18:34:35.098234 [debug] [ThreadPool]: Using duckdb connection "create_supercell_main"
[0m18:34:35.098833 [debug] [ThreadPool]: On create_supercell_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "connection_name": "create_supercell_main"} */

    
    
        create schema if not exists "supercell"."main"
    
[0m18:34:35.100547 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m18:34:35.102214 [debug] [ThreadPool]: On create_supercell_main: COMMIT
[0m18:34:35.102783 [debug] [ThreadPool]: Using duckdb connection "create_supercell_main"
[0m18:34:35.103236 [debug] [ThreadPool]: On create_supercell_main: COMMIT
[0m18:34:35.104729 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m18:34:35.105345 [debug] [ThreadPool]: On create_supercell_main: Close
[0m18:34:35.107923 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_supercell_main, now list_supercell_main)
[0m18:34:35.119879 [debug] [ThreadPool]: Using duckdb connection "list_supercell_main"
[0m18:34:35.120857 [debug] [ThreadPool]: On list_supercell_main: BEGIN
[0m18:34:35.121614 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:34:35.123591 [debug] [ThreadPool]: SQL status: OK in 0.002 seconds
[0m18:34:35.124647 [debug] [ThreadPool]: Using duckdb connection "list_supercell_main"
[0m18:34:35.125649 [debug] [ThreadPool]: On list_supercell_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "connection_name": "list_supercell_main"} */
select
      'supercell' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'supercell'
  
[0m18:34:35.178589 [debug] [ThreadPool]: SQL status: OK in 0.052 seconds
[0m18:34:35.183070 [debug] [ThreadPool]: On list_supercell_main: ROLLBACK
[0m18:34:35.187837 [debug] [ThreadPool]: Failed to rollback 'list_supercell_main'
[0m18:34:35.189389 [debug] [ThreadPool]: On list_supercell_main: Close
[0m18:34:35.194297 [debug] [MainThread]: Using duckdb connection "master"
[0m18:34:35.195180 [debug] [MainThread]: On master: BEGIN
[0m18:34:35.195933 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:34:35.197592 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m18:34:35.198489 [debug] [MainThread]: On master: COMMIT
[0m18:34:35.199265 [debug] [MainThread]: Using duckdb connection "master"
[0m18:34:35.199975 [debug] [MainThread]: On master: COMMIT
[0m18:34:35.201599 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m18:34:35.202425 [debug] [MainThread]: On master: Close
[0m18:34:35.208723 [debug] [Thread-1 (]: Began running node model.supercell.cleaned_usagelogs
[0m18:34:35.210123 [info ] [Thread-1 (]: 1 of 5 START sql table model main.cleaned_usagelogs ............................ [RUN]
[0m18:34:35.211053 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_supercell_main, now model.supercell.cleaned_usagelogs)
[0m18:34:35.211638 [debug] [Thread-1 (]: Began compiling node model.supercell.cleaned_usagelogs
[0m18:34:35.222946 [debug] [Thread-1 (]: Writing injected SQL for node "model.supercell.cleaned_usagelogs"
[0m18:34:35.224322 [debug] [Thread-1 (]: Began executing node model.supercell.cleaned_usagelogs
[0m18:34:35.278891 [debug] [Thread-1 (]: Writing runtime sql for node "model.supercell.cleaned_usagelogs"
[0m18:34:35.280348 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.cleaned_usagelogs"
[0m18:34:35.281186 [debug] [Thread-1 (]: On model.supercell.cleaned_usagelogs: BEGIN
[0m18:34:35.281901 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:34:35.283427 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:34:35.283956 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.cleaned_usagelogs"
[0m18:34:35.284411 [debug] [Thread-1 (]: On model.supercell.cleaned_usagelogs: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.cleaned_usagelogs"} */

  
    
    

    create  table
      "supercell"."main"."cleaned_usagelogs__dbt_tmp"
  
    as (
      


SELECT
    CAST("LinkedAccountId" AS VARCHAR) AS linked_account_id,
    CAST("bill/PayerAccountId" AS VARCHAR) AS payer_account_id,
    CAST("lineItem/UsageStartDate" AS TIMESTAMP) AS usage_start_date,
    CAST("lineItem/UsageEndDate" AS TIMESTAMP) AS usage_end_date,
    CAST("lineItem/UsageAmount" AS DECIMAL(18, 6)) AS usage_amount,
    CAST("lineItem/Operation" AS VARCHAR) AS operation,
    CAST("pricing/PricingModel" AS VARCHAR) AS pricing_model,
    CAST("resourceTags/TagKeys" AS VARCHAR) AS tag_keys,
    CAST("resourceTags/TagValues" AS VARCHAR) AS tag_values,
    CAST("product/Region" AS VARCHAR) AS region,
    CAST("product/ServiceCode" AS VARCHAR) AS service_code,
    CAST("product/InstanceType" AS VARCHAR) AS instance_type,
    CAST("amortized_cost" AS DECIMAL(18, 6)) AS amortized_cost,
    CAST("product/Description" AS VARCHAR) AS description
FROM supercell_usagelogs
    );
  
  
[0m18:34:36.003846 [debug] [Thread-1 (]: SQL status: OK in 0.719 seconds
[0m18:34:36.011223 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.cleaned_usagelogs"
[0m18:34:36.011710 [debug] [Thread-1 (]: On model.supercell.cleaned_usagelogs: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.cleaned_usagelogs"} */
alter table "supercell"."main"."cleaned_usagelogs" rename to "cleaned_usagelogs__dbt_backup"
[0m18:34:36.012575 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:34:36.015503 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.cleaned_usagelogs"
[0m18:34:36.015935 [debug] [Thread-1 (]: On model.supercell.cleaned_usagelogs: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.cleaned_usagelogs"} */
alter table "supercell"."main"."cleaned_usagelogs__dbt_tmp" rename to "cleaned_usagelogs"
[0m18:34:36.016763 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m18:34:36.035227 [debug] [Thread-1 (]: On model.supercell.cleaned_usagelogs: COMMIT
[0m18:34:36.035802 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.cleaned_usagelogs"
[0m18:34:36.036210 [debug] [Thread-1 (]: On model.supercell.cleaned_usagelogs: COMMIT
[0m18:34:36.078881 [debug] [Thread-1 (]: SQL status: OK in 0.042 seconds
[0m18:34:36.086472 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.cleaned_usagelogs"
[0m18:34:36.086995 [debug] [Thread-1 (]: On model.supercell.cleaned_usagelogs: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.cleaned_usagelogs"} */
drop table if exists "supercell"."main"."cleaned_usagelogs__dbt_backup" cascade
[0m18:34:36.089744 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m18:34:36.092584 [debug] [Thread-1 (]: On model.supercell.cleaned_usagelogs: Close
[0m18:34:36.105009 [info ] [Thread-1 (]: 1 of 5 OK created sql table model main.cleaned_usagelogs ....................... [[32mOK[0m in 0.89s]
[0m18:34:36.105770 [debug] [Thread-1 (]: Finished running node model.supercell.cleaned_usagelogs
[0m18:34:36.107256 [debug] [Thread-3 (]: Began running node model.supercell.dim_accounts
[0m18:34:36.108099 [debug] [Thread-4 (]: Began running node model.supercell.dim_resource
[0m18:34:36.108931 [debug] [Thread-2 (]: Began running node model.supercell.fact_bill_generation
[0m18:34:36.109970 [info ] [Thread-3 (]: 2 of 5 START sql table model main.dim_accounts ................................. [RUN]
[0m18:34:36.111083 [info ] [Thread-4 (]: 3 of 5 START sql table model main.dim_resource ................................. [RUN]
[0m18:34:36.112705 [info ] [Thread-2 (]: 4 of 5 START sql table model main.fact_bill_generation ......................... [RUN]
[0m18:34:36.114239 [debug] [Thread-3 (]: Acquiring new duckdb connection 'model.supercell.dim_accounts'
[0m18:34:36.115656 [debug] [Thread-4 (]: Acquiring new duckdb connection 'model.supercell.dim_resource'
[0m18:34:36.116552 [debug] [Thread-2 (]: Acquiring new duckdb connection 'model.supercell.fact_bill_generation'
[0m18:34:36.117474 [debug] [Thread-3 (]: Began compiling node model.supercell.dim_accounts
[0m18:34:36.118391 [debug] [Thread-4 (]: Began compiling node model.supercell.dim_resource
[0m18:34:36.118937 [debug] [Thread-2 (]: Began compiling node model.supercell.fact_bill_generation
[0m18:34:36.124011 [debug] [Thread-3 (]: Writing injected SQL for node "model.supercell.dim_accounts"
[0m18:34:36.128772 [debug] [Thread-4 (]: Writing injected SQL for node "model.supercell.dim_resource"
[0m18:34:36.133765 [debug] [Thread-2 (]: Writing injected SQL for node "model.supercell.fact_bill_generation"
[0m18:34:36.135541 [debug] [Thread-4 (]: Began executing node model.supercell.dim_resource
[0m18:34:36.140950 [debug] [Thread-4 (]: Writing runtime sql for node "model.supercell.dim_resource"
[0m18:34:36.141877 [debug] [Thread-3 (]: Began executing node model.supercell.dim_accounts
[0m18:34:36.146283 [debug] [Thread-3 (]: Writing runtime sql for node "model.supercell.dim_accounts"
[0m18:34:36.147039 [debug] [Thread-2 (]: Began executing node model.supercell.fact_bill_generation
[0m18:34:36.153669 [debug] [Thread-2 (]: Writing runtime sql for node "model.supercell.fact_bill_generation"
[0m18:34:36.154637 [debug] [Thread-4 (]: Using duckdb connection "model.supercell.dim_resource"
[0m18:34:36.155626 [debug] [Thread-4 (]: On model.supercell.dim_resource: BEGIN
[0m18:34:36.156407 [debug] [Thread-3 (]: Using duckdb connection "model.supercell.dim_accounts"
[0m18:34:36.157124 [debug] [Thread-2 (]: Using duckdb connection "model.supercell.fact_bill_generation"
[0m18:34:36.157640 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m18:34:36.158384 [debug] [Thread-3 (]: On model.supercell.dim_accounts: BEGIN
[0m18:34:36.158987 [debug] [Thread-2 (]: On model.supercell.fact_bill_generation: BEGIN
[0m18:34:36.159903 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m18:34:36.160516 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m18:34:36.161051 [debug] [Thread-4 (]: SQL status: OK in 0.003 seconds
[0m18:34:36.162397 [debug] [Thread-4 (]: Using duckdb connection "model.supercell.dim_resource"
[0m18:34:36.163037 [debug] [Thread-2 (]: SQL status: OK in 0.002 seconds
[0m18:34:36.163589 [debug] [Thread-4 (]: On model.supercell.dim_resource: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.dim_resource"} */

  
    
    

    create  table
      "supercell"."main"."dim_resource__dbt_tmp"
  
    as (
      


select
    md5(concat(linked_account_id, '_', service_code, '_', instance_type, '_', region, '_', CAST(usage_start_date AS VARCHAR), '_', CAST(usage_end_date AS VARCHAR))) AS resource_id,
    linked_account_id as linked_account_id,
    region,
    service_code as product,
    instance_type as instance_type,
    pricing_model as pricing_model,
    tag_keys as tag_keys,
    tag_values as tag_values
from "supercell"."main"."cleaned_usagelogs"
    );
  
  
[0m18:34:36.164194 [debug] [Thread-2 (]: Using duckdb connection "model.supercell.fact_bill_generation"
[0m18:34:36.164683 [debug] [Thread-3 (]: SQL status: OK in 0.005 seconds
[0m18:34:36.165392 [debug] [Thread-2 (]: On model.supercell.fact_bill_generation: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.fact_bill_generation"} */

  
    
    

    create  table
      "supercell"."main"."fact_bill_generation__dbt_tmp"
  
    as (
      


select
    md5(concat(linked_account_id, '_', service_code, '_', instance_type, '_', region, '_', CAST(usage_start_date AS VARCHAR), '_', CAST(usage_end_date AS VARCHAR))) AS resource_id,
    usage_start_date as start_date,
    usage_end_date as bill_date,
    usage_amount as bill_amount,
    operation
from "supercell"."main"."cleaned_usagelogs"
    );
  
  
[0m18:34:36.166163 [debug] [Thread-3 (]: Using duckdb connection "model.supercell.dim_accounts"
[0m18:34:36.172173 [debug] [Thread-3 (]: On model.supercell.dim_accounts: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.dim_accounts"} */

  
    
    

    create  table
      "supercell"."main"."dim_accounts__dbt_tmp"
  
    as (
      


select
    linked_account_id as linked_account_id,
    tag_keys as tag_keys,
    tag_values as tag_values
from "supercell"."main"."cleaned_usagelogs"
    );
  
  
[0m18:34:36.980737 [debug] [Thread-3 (]: SQL status: OK in 0.808 seconds
[0m18:34:36.985066 [debug] [Thread-3 (]: Using duckdb connection "model.supercell.dim_accounts"
[0m18:34:36.985704 [debug] [Thread-3 (]: On model.supercell.dim_accounts: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.dim_accounts"} */
alter table "supercell"."main"."dim_accounts" rename to "dim_accounts__dbt_backup"
[0m18:34:36.987032 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m18:34:36.993160 [debug] [Thread-3 (]: Using duckdb connection "model.supercell.dim_accounts"
[0m18:34:36.993854 [debug] [Thread-3 (]: On model.supercell.dim_accounts: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.dim_accounts"} */
alter table "supercell"."main"."dim_accounts__dbt_tmp" rename to "dim_accounts"
[0m18:34:36.995316 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m18:34:37.000109 [debug] [Thread-3 (]: On model.supercell.dim_accounts: COMMIT
[0m18:34:37.001454 [debug] [Thread-3 (]: Using duckdb connection "model.supercell.dim_accounts"
[0m18:34:37.002491 [debug] [Thread-3 (]: On model.supercell.dim_accounts: COMMIT
[0m18:34:37.084866 [debug] [Thread-3 (]: SQL status: OK in 0.081 seconds
[0m18:34:37.090222 [debug] [Thread-3 (]: Using duckdb connection "model.supercell.dim_accounts"
[0m18:34:37.091288 [debug] [Thread-3 (]: On model.supercell.dim_accounts: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.dim_accounts"} */
drop table if exists "supercell"."main"."dim_accounts__dbt_backup" cascade
[0m18:34:37.094604 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m18:34:37.097992 [debug] [Thread-3 (]: On model.supercell.dim_accounts: Close
[0m18:34:37.127048 [info ] [Thread-3 (]: 2 of 5 OK created sql table model main.dim_accounts ............................ [[32mOK[0m in 1.01s]
[0m18:34:37.128957 [debug] [Thread-3 (]: Finished running node model.supercell.dim_accounts
[0m18:34:37.130789 [debug] [Thread-2 (]: SQL status: OK in 0.964 seconds
[0m18:34:37.137858 [debug] [Thread-2 (]: Using duckdb connection "model.supercell.fact_bill_generation"
[0m18:34:37.139423 [debug] [Thread-2 (]: On model.supercell.fact_bill_generation: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.fact_bill_generation"} */
alter table "supercell"."main"."fact_bill_generation" rename to "fact_bill_generation__dbt_backup"
[0m18:34:37.142067 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m18:34:37.148671 [debug] [Thread-2 (]: Using duckdb connection "model.supercell.fact_bill_generation"
[0m18:34:37.149921 [debug] [Thread-2 (]: On model.supercell.fact_bill_generation: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.fact_bill_generation"} */
alter table "supercell"."main"."fact_bill_generation__dbt_tmp" rename to "fact_bill_generation"
[0m18:34:37.151928 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m18:34:37.156665 [debug] [Thread-2 (]: On model.supercell.fact_bill_generation: COMMIT
[0m18:34:37.157828 [debug] [Thread-2 (]: Using duckdb connection "model.supercell.fact_bill_generation"
[0m18:34:37.158813 [debug] [Thread-2 (]: On model.supercell.fact_bill_generation: COMMIT
[0m18:34:37.168567 [debug] [Thread-4 (]: SQL status: OK in 1.003 seconds
[0m18:34:37.172620 [debug] [Thread-4 (]: Using duckdb connection "model.supercell.dim_resource"
[0m18:34:37.173574 [debug] [Thread-4 (]: On model.supercell.dim_resource: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.dim_resource"} */
alter table "supercell"."main"."dim_resource" rename to "dim_resource__dbt_backup"
[0m18:34:37.176006 [debug] [Thread-4 (]: SQL status: OK in 0.001 seconds
[0m18:34:37.182646 [debug] [Thread-4 (]: Using duckdb connection "model.supercell.dim_resource"
[0m18:34:37.183796 [debug] [Thread-2 (]: SQL status: OK in 0.024 seconds
[0m18:34:37.184886 [debug] [Thread-4 (]: On model.supercell.dim_resource: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.dim_resource"} */
alter table "supercell"."main"."dim_resource__dbt_tmp" rename to "dim_resource"
[0m18:34:37.190284 [debug] [Thread-2 (]: Using duckdb connection "model.supercell.fact_bill_generation"
[0m18:34:37.191777 [debug] [Thread-2 (]: On model.supercell.fact_bill_generation: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.fact_bill_generation"} */
drop table if exists "supercell"."main"."fact_bill_generation__dbt_backup" cascade
[0m18:34:37.193259 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m18:34:37.196017 [debug] [Thread-4 (]: On model.supercell.dim_resource: COMMIT
[0m18:34:37.196665 [debug] [Thread-4 (]: Using duckdb connection "model.supercell.dim_resource"
[0m18:34:37.197151 [debug] [Thread-4 (]: On model.supercell.dim_resource: COMMIT
[0m18:34:37.197868 [debug] [Thread-2 (]: SQL status: OK in 0.005 seconds
[0m18:34:37.201272 [debug] [Thread-2 (]: On model.supercell.fact_bill_generation: Close
[0m18:34:37.204751 [debug] [Thread-4 (]: SQL status: OK in 0.007 seconds
[0m18:34:37.206441 [info ] [Thread-2 (]: 4 of 5 OK created sql table model main.fact_bill_generation .................... [[32mOK[0m in 1.09s]
[0m18:34:37.211773 [debug] [Thread-4 (]: Using duckdb connection "model.supercell.dim_resource"
[0m18:34:37.213621 [debug] [Thread-2 (]: Finished running node model.supercell.fact_bill_generation
[0m18:34:37.214841 [debug] [Thread-4 (]: On model.supercell.dim_resource: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.dim_resource"} */
drop table if exists "supercell"."main"."dim_resource__dbt_backup" cascade
[0m18:34:37.218933 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m18:34:37.222562 [debug] [Thread-4 (]: On model.supercell.dim_resource: Close
[0m18:34:37.225344 [info ] [Thread-4 (]: 3 of 5 OK created sql table model main.dim_resource ............................ [[32mOK[0m in 1.11s]
[0m18:34:37.226353 [debug] [Thread-4 (]: Finished running node model.supercell.dim_resource
[0m18:34:37.227726 [debug] [Thread-1 (]: Began running node model.supercell.total_cost
[0m18:34:37.228529 [info ] [Thread-1 (]: 5 of 5 START sql table model main.total_cost ................................... [RUN]
[0m18:34:37.229223 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.supercell.cleaned_usagelogs, now model.supercell.total_cost)
[0m18:34:37.229741 [debug] [Thread-1 (]: Began compiling node model.supercell.total_cost
[0m18:34:37.235010 [debug] [Thread-1 (]: Writing injected SQL for node "model.supercell.total_cost"
[0m18:34:37.237421 [debug] [Thread-1 (]: Began executing node model.supercell.total_cost
[0m18:34:37.246697 [debug] [Thread-1 (]: Writing runtime sql for node "model.supercell.total_cost"
[0m18:34:37.248365 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.total_cost"
[0m18:34:37.249344 [debug] [Thread-1 (]: On model.supercell.total_cost: BEGIN
[0m18:34:37.250343 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m18:34:37.251615 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:34:37.252222 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.total_cost"
[0m18:34:37.252783 [debug] [Thread-1 (]: On model.supercell.total_cost: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.total_cost"} */

  
    
    

    create  table
      "supercell"."main"."total_cost__dbt_tmp"
  
    as (
      

with base as (
    select
        fact_bill_generation.resource_id,
        date_trunc('month', fact_bill_generation.bill_date) as month,
        fact_bill_generation.bill_amount,
        dim_resource.instance_type,
        dim_resource.product,
        dim_resource.region,
        dim_resource.pricing_model,
        dim_resource.tag_keys,
        dim_resource.tag_values
    from "supercell"."main"."fact_bill_generation" as fact_bill_generation
    left join "supercell"."main"."dim_resource" as dim_resource
        on fact_bill_generation.resource_id = dim_resource.resource_id
)

select
    month,
    sum(bill_amount) as total_cost,
    instance_type,
    product,
    region,
    pricing_model,
    tag_keys,
    tag_values
from base
group by
    month,
    instance_type,
    product,
    region,
    pricing_model,
    tag_keys,
    tag_values
order by
    month,
    instance_type,
    product,
    region,
    pricing_model,
    tag_keys,
    tag_values
    );
  
  
[0m18:34:39.637829 [debug] [Thread-1 (]: SQL status: OK in 2.384 seconds
[0m18:34:39.646799 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.total_cost"
[0m18:34:39.647567 [debug] [Thread-1 (]: On model.supercell.total_cost: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.total_cost"} */
alter table "supercell"."main"."total_cost" rename to "total_cost__dbt_backup"
[0m18:34:39.648837 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:34:39.652834 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.total_cost"
[0m18:34:39.653481 [debug] [Thread-1 (]: On model.supercell.total_cost: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.total_cost"} */
alter table "supercell"."main"."total_cost__dbt_tmp" rename to "total_cost"
[0m18:34:39.654612 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m18:34:39.657548 [debug] [Thread-1 (]: On model.supercell.total_cost: COMMIT
[0m18:34:39.658322 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.total_cost"
[0m18:34:39.658859 [debug] [Thread-1 (]: On model.supercell.total_cost: COMMIT
[0m18:34:39.664562 [debug] [Thread-1 (]: SQL status: OK in 0.004 seconds
[0m18:34:39.668005 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.total_cost"
[0m18:34:39.668630 [debug] [Thread-1 (]: On model.supercell.total_cost: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.total_cost"} */
drop table if exists "supercell"."main"."total_cost__dbt_backup" cascade
[0m18:34:39.671576 [debug] [Thread-1 (]: SQL status: OK in 0.002 seconds
[0m18:34:39.673708 [debug] [Thread-1 (]: On model.supercell.total_cost: Close
[0m18:34:39.689434 [info ] [Thread-1 (]: 5 of 5 OK created sql table model main.total_cost .............................. [[32mOK[0m in 2.46s]
[0m18:34:39.690523 [debug] [Thread-1 (]: Finished running node model.supercell.total_cost
[0m18:34:39.693503 [debug] [MainThread]: Using duckdb connection "master"
[0m18:34:39.694654 [debug] [MainThread]: On master: BEGIN
[0m18:34:39.695561 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:34:39.697247 [debug] [MainThread]: SQL status: OK in 0.002 seconds
[0m18:34:39.697901 [debug] [MainThread]: On master: COMMIT
[0m18:34:39.698447 [debug] [MainThread]: Using duckdb connection "master"
[0m18:34:39.698888 [debug] [MainThread]: On master: COMMIT
[0m18:34:39.699930 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m18:34:39.700486 [debug] [MainThread]: On master: Close
[0m18:34:39.701246 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:34:39.701738 [debug] [MainThread]: Connection 'model.supercell.total_cost' was properly closed.
[0m18:34:39.702124 [debug] [MainThread]: Connection 'model.supercell.dim_accounts' was properly closed.
[0m18:34:39.702489 [debug] [MainThread]: Connection 'model.supercell.dim_resource' was properly closed.
[0m18:34:39.702841 [debug] [MainThread]: Connection 'model.supercell.fact_bill_generation' was properly closed.
[0m18:34:39.703609 [info ] [MainThread]: 
[0m18:34:39.704373 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 4.74 seconds (4.74s).
[0m18:34:39.706169 [debug] [MainThread]: Command end result
[0m18:34:39.732734 [debug] [MainThread]: Wrote artifact WritableManifest to /home/harsha/data_actions/supercell_cloudops/target/manifest.json
[0m18:34:39.735149 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/harsha/data_actions/supercell_cloudops/target/semantic_manifest.json
[0m18:34:39.745369 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/harsha/data_actions/supercell_cloudops/target/run_results.json
[0m18:34:39.746726 [info ] [MainThread]: 
[0m18:34:39.747933 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:34:39.748980 [info ] [MainThread]: 
[0m18:34:39.750207 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m18:34:39.752679 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 5.487516, "process_in_blocks": "37176", "process_kernel_time": 1.198807, "process_mem_max_rss": "495564", "process_out_blocks": "113200", "process_user_time": 33.392925}
[0m18:34:39.753946 [debug] [MainThread]: Command `dbt run` succeeded at 18:34:39.753654 after 5.49 seconds
[0m18:34:39.754893 [debug] [MainThread]: Flushing usage events


============================== 19:06:18.568301 | f61acf04-1c67-4229-95d4-57184a9ba074 ==============================
[0m19:06:18.568301 [info ] [MainThread]: Running with dbt=1.9.4
[0m19:06:18.570300 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/home/harsha/data_actions/supercell_cloudops', 'log_path': '/home/harsha/data_actions/supercell_cloudops/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'False'}
[0m19:06:18.570551 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality

User config should be moved from the 'config' key in profiles.yml to the 'flags' key in dbt_project.yml.
[0m19:06:18.721568 [info ] [MainThread]: Registered adapter: duckdb=1.9.3
[0m19:06:18.758634 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m19:06:18.803102 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:06:18.803462 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:06:18.808565 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.supercell.example
[0m19:06:18.854984 [debug] [MainThread]: Wrote artifact WritableManifest to /home/harsha/data_actions/supercell_cloudops/target/manifest.json
[0m19:06:18.856519 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/harsha/data_actions/supercell_cloudops/target/semantic_manifest.json
[0m19:06:18.865337 [info ] [MainThread]: Found 5 models, 428 macros
[0m19:06:18.867226 [info ] [MainThread]: 
[0m19:06:18.867867 [info ] [MainThread]: Concurrency: 4 threads (target='default')
[0m19:06:18.868114 [info ] [MainThread]: 
[0m19:06:18.868624 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m19:06:18.872961 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_supercell'
[0m19:06:18.909111 [debug] [ThreadPool]: Using duckdb connection "list_supercell"
[0m19:06:18.909559 [debug] [ThreadPool]: On list_supercell: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "connection_name": "list_supercell"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"supercell"'
    
  
  
[0m19:06:18.909893 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:06:18.920024 [debug] [ThreadPool]: SQL status: OK in 0.010 seconds
[0m19:06:18.921066 [debug] [ThreadPool]: On list_supercell: Close
[0m19:06:18.921608 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_supercell, now create_supercell_main)
[0m19:06:18.921929 [debug] [ThreadPool]: Creating schema "database: "supercell"
schema: "main"
"
[0m19:06:18.926248 [debug] [ThreadPool]: Using duckdb connection "create_supercell_main"
[0m19:06:18.926495 [debug] [ThreadPool]: On create_supercell_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "connection_name": "create_supercell_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='supercell'
        and type='sqlite'
    
  
[0m19:06:18.926685 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:06:18.927415 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m19:06:18.928283 [debug] [ThreadPool]: Using duckdb connection "create_supercell_main"
[0m19:06:18.928493 [debug] [ThreadPool]: On create_supercell_main: BEGIN
[0m19:06:18.928790 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m19:06:18.928970 [debug] [ThreadPool]: Using duckdb connection "create_supercell_main"
[0m19:06:18.929128 [debug] [ThreadPool]: On create_supercell_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "connection_name": "create_supercell_main"} */

    
    
        create schema if not exists "supercell"."main"
    
[0m19:06:18.929464 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m19:06:18.929991 [debug] [ThreadPool]: On create_supercell_main: COMMIT
[0m19:06:18.930219 [debug] [ThreadPool]: Using duckdb connection "create_supercell_main"
[0m19:06:18.930399 [debug] [ThreadPool]: On create_supercell_main: COMMIT
[0m19:06:18.930670 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m19:06:18.930862 [debug] [ThreadPool]: On create_supercell_main: Close
[0m19:06:18.931885 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_supercell_main, now list_supercell_main)
[0m19:06:18.936837 [debug] [ThreadPool]: Using duckdb connection "list_supercell_main"
[0m19:06:18.937608 [debug] [ThreadPool]: On list_supercell_main: BEGIN
[0m19:06:18.937936 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:06:18.938664 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m19:06:18.938974 [debug] [ThreadPool]: Using duckdb connection "list_supercell_main"
[0m19:06:18.939286 [debug] [ThreadPool]: On list_supercell_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "connection_name": "list_supercell_main"} */
select
      'supercell' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'supercell'
  
[0m19:06:18.958717 [debug] [ThreadPool]: SQL status: OK in 0.019 seconds
[0m19:06:18.960091 [debug] [ThreadPool]: On list_supercell_main: ROLLBACK
[0m19:06:18.961102 [debug] [ThreadPool]: Failed to rollback 'list_supercell_main'
[0m19:06:18.961452 [debug] [ThreadPool]: On list_supercell_main: Close
[0m19:06:18.962569 [debug] [MainThread]: Using duckdb connection "master"
[0m19:06:18.962820 [debug] [MainThread]: On master: BEGIN
[0m19:06:18.963036 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:06:18.963605 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m19:06:18.963795 [debug] [MainThread]: On master: COMMIT
[0m19:06:18.963963 [debug] [MainThread]: Using duckdb connection "master"
[0m19:06:18.964109 [debug] [MainThread]: On master: COMMIT
[0m19:06:18.964549 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m19:06:18.964893 [debug] [MainThread]: On master: Close
[0m19:06:18.968116 [debug] [Thread-1 (]: Began running node model.supercell.cleaned_usagelogs
[0m19:06:18.968810 [info ] [Thread-1 (]: 1 of 5 START sql table model main.cleaned_usagelogs ............................ [RUN]
[0m19:06:18.969395 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_supercell_main, now model.supercell.cleaned_usagelogs)
[0m19:06:18.969911 [debug] [Thread-1 (]: Began compiling node model.supercell.cleaned_usagelogs
[0m19:06:18.977663 [debug] [Thread-1 (]: Writing injected SQL for node "model.supercell.cleaned_usagelogs"
[0m19:06:18.978543 [debug] [Thread-1 (]: Began executing node model.supercell.cleaned_usagelogs
[0m19:06:19.003384 [debug] [Thread-1 (]: Writing runtime sql for node "model.supercell.cleaned_usagelogs"
[0m19:06:19.004089 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.cleaned_usagelogs"
[0m19:06:19.004371 [debug] [Thread-1 (]: On model.supercell.cleaned_usagelogs: BEGIN
[0m19:06:19.004588 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:06:19.005277 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:06:19.005529 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.cleaned_usagelogs"
[0m19:06:19.005764 [debug] [Thread-1 (]: On model.supercell.cleaned_usagelogs: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.cleaned_usagelogs"} */

  
    
    

    create  table
      "supercell"."main"."cleaned_usagelogs__dbt_tmp"
  
    as (
      


SELECT
    CAST("LinkedAccountId" AS VARCHAR) AS linked_account_id,
    CAST("bill/PayerAccountId" AS VARCHAR) AS payer_account_id,
    CAST("lineItem/UsageStartDate" AS TIMESTAMP) AS usage_start_date,
    CAST("lineItem/UsageEndDate" AS TIMESTAMP) AS usage_end_date,
    CAST("lineItem/UsageAmount" AS DECIMAL(18, 6)) AS usage_amount,
    CAST("lineItem/Operation" AS VARCHAR) AS operation,
    CAST("pricing/PricingModel" AS VARCHAR) AS pricing_model,
    CAST("resourceTags/TagKeys" AS VARCHAR) AS tag_keys,
    CAST("resourceTags/TagValues" AS VARCHAR) AS tag_values,
    CAST("product/Region" AS VARCHAR) AS region,
    CAST("product/ServiceCode" AS VARCHAR) AS service_code,
    CAST("product/InstanceType" AS VARCHAR) AS instance_type,
    CAST("amortized_cost" AS DECIMAL(18, 6)) AS amortized_cost,
    CAST("product/Description" AS VARCHAR) AS description
FROM supercell_usagelogs
    );
  
  
[0m19:06:19.093833 [debug] [Thread-1 (]: SQL status: OK in 0.088 seconds
[0m19:06:19.098500 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.cleaned_usagelogs"
[0m19:06:19.098862 [debug] [Thread-1 (]: On model.supercell.cleaned_usagelogs: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.cleaned_usagelogs"} */
alter table "supercell"."main"."cleaned_usagelogs__dbt_tmp" rename to "cleaned_usagelogs"
[0m19:06:19.099528 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m19:06:19.108891 [debug] [Thread-1 (]: On model.supercell.cleaned_usagelogs: COMMIT
[0m19:06:19.109297 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.cleaned_usagelogs"
[0m19:06:19.109532 [debug] [Thread-1 (]: On model.supercell.cleaned_usagelogs: COMMIT
[0m19:06:19.206638 [debug] [Thread-1 (]: SQL status: OK in 0.097 seconds
[0m19:06:19.210079 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.cleaned_usagelogs"
[0m19:06:19.210375 [debug] [Thread-1 (]: On model.supercell.cleaned_usagelogs: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.cleaned_usagelogs"} */
drop table if exists "supercell"."main"."cleaned_usagelogs__dbt_backup" cascade
[0m19:06:19.210891 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m19:06:19.212461 [debug] [Thread-1 (]: On model.supercell.cleaned_usagelogs: Close
[0m19:06:19.215353 [info ] [Thread-1 (]: 1 of 5 OK created sql table model main.cleaned_usagelogs ....................... [[32mOK[0m in 0.25s]
[0m19:06:19.215768 [debug] [Thread-1 (]: Finished running node model.supercell.cleaned_usagelogs
[0m19:06:19.216646 [debug] [Thread-3 (]: Began running node model.supercell.dim_accounts
[0m19:06:19.217125 [debug] [Thread-4 (]: Began running node model.supercell.dim_resource
[0m19:06:19.217857 [info ] [Thread-3 (]: 2 of 5 START sql table model main.dim_accounts ................................. [RUN]
[0m19:06:19.218441 [debug] [Thread-2 (]: Began running node model.supercell.fact_bill_generation
[0m19:06:19.219168 [info ] [Thread-4 (]: 3 of 5 START sql table model main.dim_resource ................................. [RUN]
[0m19:06:19.220335 [debug] [Thread-3 (]: Acquiring new duckdb connection 'model.supercell.dim_accounts'
[0m19:06:19.220979 [info ] [Thread-2 (]: 4 of 5 START sql table model main.fact_bill_generation ......................... [RUN]
[0m19:06:19.222521 [debug] [Thread-4 (]: Acquiring new duckdb connection 'model.supercell.dim_resource'
[0m19:06:19.223298 [debug] [Thread-3 (]: Began compiling node model.supercell.dim_accounts
[0m19:06:19.223997 [debug] [Thread-2 (]: Acquiring new duckdb connection 'model.supercell.fact_bill_generation'
[0m19:06:19.224579 [debug] [Thread-4 (]: Began compiling node model.supercell.dim_resource
[0m19:06:19.228750 [debug] [Thread-3 (]: Writing injected SQL for node "model.supercell.dim_accounts"
[0m19:06:19.229468 [debug] [Thread-2 (]: Began compiling node model.supercell.fact_bill_generation
[0m19:06:19.232444 [debug] [Thread-4 (]: Writing injected SQL for node "model.supercell.dim_resource"
[0m19:06:19.235055 [debug] [Thread-2 (]: Writing injected SQL for node "model.supercell.fact_bill_generation"
[0m19:06:19.236035 [debug] [Thread-2 (]: Began executing node model.supercell.fact_bill_generation
[0m19:06:19.236556 [debug] [Thread-3 (]: Began executing node model.supercell.dim_accounts
[0m19:06:19.239194 [debug] [Thread-2 (]: Writing runtime sql for node "model.supercell.fact_bill_generation"
[0m19:06:19.241313 [debug] [Thread-3 (]: Writing runtime sql for node "model.supercell.dim_accounts"
[0m19:06:19.241904 [debug] [Thread-4 (]: Began executing node model.supercell.dim_resource
[0m19:06:19.244846 [debug] [Thread-4 (]: Writing runtime sql for node "model.supercell.dim_resource"
[0m19:06:19.245304 [debug] [Thread-3 (]: Using duckdb connection "model.supercell.dim_accounts"
[0m19:06:19.245726 [debug] [Thread-3 (]: On model.supercell.dim_accounts: BEGIN
[0m19:06:19.246075 [debug] [Thread-2 (]: Using duckdb connection "model.supercell.fact_bill_generation"
[0m19:06:19.246391 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m19:06:19.246682 [debug] [Thread-2 (]: On model.supercell.fact_bill_generation: BEGIN
[0m19:06:19.247290 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m19:06:19.247854 [debug] [Thread-4 (]: Using duckdb connection "model.supercell.dim_resource"
[0m19:06:19.248273 [debug] [Thread-4 (]: On model.supercell.dim_resource: BEGIN
[0m19:06:19.248661 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m19:06:19.249121 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m19:06:19.249475 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m19:06:19.249835 [debug] [Thread-2 (]: Using duckdb connection "model.supercell.fact_bill_generation"
[0m19:06:19.250319 [debug] [Thread-3 (]: Using duckdb connection "model.supercell.dim_accounts"
[0m19:06:19.250639 [debug] [Thread-2 (]: On model.supercell.fact_bill_generation: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.fact_bill_generation"} */

  
    
    

    create  table
      "supercell"."main"."fact_bill_generation__dbt_tmp"
  
    as (
      


select
    md5(concat(linked_account_id, '_', service_code, '_', instance_type, '_', region, '_', CAST(usage_start_date AS VARCHAR), '_', CAST(usage_end_date AS VARCHAR))) AS resource_id,
    usage_start_date as start_date,
    usage_end_date as bill_date,
    usage_amount as bill_amount,
    operation
from "supercell"."main"."cleaned_usagelogs"
    );
  
  
[0m19:06:19.250995 [debug] [Thread-3 (]: On model.supercell.dim_accounts: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.dim_accounts"} */

  
    
    

    create  table
      "supercell"."main"."dim_accounts__dbt_tmp"
  
    as (
      


select
    linked_account_id as linked_account_id,
    tag_keys as tag_keys,
    tag_values as tag_values
from "supercell"."main"."cleaned_usagelogs"
    );
  
  
[0m19:06:19.251300 [debug] [Thread-4 (]: SQL status: OK in 0.002 seconds
[0m19:06:19.251913 [debug] [Thread-4 (]: Using duckdb connection "model.supercell.dim_resource"
[0m19:06:19.252302 [debug] [Thread-4 (]: On model.supercell.dim_resource: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.dim_resource"} */

  
    
    

    create  table
      "supercell"."main"."dim_resource__dbt_tmp"
  
    as (
      


select
    md5(concat(linked_account_id, '_', service_code, '_', instance_type, '_', region, '_', CAST(usage_start_date AS VARCHAR), '_', CAST(usage_end_date AS VARCHAR))) AS resource_id,
    linked_account_id as linked_account_id,
    region,
    service_code as product,
    instance_type as instance_type,
    pricing_model as pricing_model,
    tag_keys as tag_keys,
    tag_values as tag_values
from "supercell"."main"."cleaned_usagelogs"
    );
  
  
[0m19:06:19.269489 [debug] [Thread-3 (]: SQL status: OK in 0.018 seconds
[0m19:06:19.274046 [debug] [Thread-3 (]: Using duckdb connection "model.supercell.dim_accounts"
[0m19:06:19.274663 [debug] [Thread-3 (]: On model.supercell.dim_accounts: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.dim_accounts"} */
alter table "supercell"."main"."dim_accounts__dbt_tmp" rename to "dim_accounts"
[0m19:06:19.277127 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m19:06:19.280553 [debug] [Thread-3 (]: On model.supercell.dim_accounts: COMMIT
[0m19:06:19.281232 [debug] [Thread-3 (]: Using duckdb connection "model.supercell.dim_accounts"
[0m19:06:19.281640 [debug] [Thread-3 (]: On model.supercell.dim_accounts: COMMIT
[0m19:06:19.294564 [debug] [Thread-3 (]: SQL status: OK in 0.012 seconds
[0m19:06:19.296709 [debug] [Thread-3 (]: Using duckdb connection "model.supercell.dim_accounts"
[0m19:06:19.297141 [debug] [Thread-3 (]: On model.supercell.dim_accounts: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.dim_accounts"} */
drop table if exists "supercell"."main"."dim_accounts__dbt_backup" cascade
[0m19:06:19.297867 [debug] [Thread-3 (]: SQL status: OK in 0.000 seconds
[0m19:06:19.299109 [debug] [Thread-3 (]: On model.supercell.dim_accounts: Close
[0m19:06:19.299999 [info ] [Thread-3 (]: 2 of 5 OK created sql table model main.dim_accounts ............................ [[32mOK[0m in 0.08s]
[0m19:06:19.300606 [debug] [Thread-3 (]: Finished running node model.supercell.dim_accounts
[0m19:06:19.317908 [debug] [Thread-2 (]: SQL status: OK in 0.066 seconds
[0m19:06:19.320612 [debug] [Thread-2 (]: Using duckdb connection "model.supercell.fact_bill_generation"
[0m19:06:19.321051 [debug] [Thread-2 (]: On model.supercell.fact_bill_generation: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.fact_bill_generation"} */
alter table "supercell"."main"."fact_bill_generation__dbt_tmp" rename to "fact_bill_generation"
[0m19:06:19.321828 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m19:06:19.323553 [debug] [Thread-2 (]: On model.supercell.fact_bill_generation: COMMIT
[0m19:06:19.323842 [debug] [Thread-2 (]: Using duckdb connection "model.supercell.fact_bill_generation"
[0m19:06:19.324052 [debug] [Thread-2 (]: On model.supercell.fact_bill_generation: COMMIT
[0m19:06:19.335794 [debug] [Thread-2 (]: SQL status: OK in 0.011 seconds
[0m19:06:19.338058 [debug] [Thread-2 (]: Using duckdb connection "model.supercell.fact_bill_generation"
[0m19:06:19.338461 [debug] [Thread-2 (]: On model.supercell.fact_bill_generation: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.fact_bill_generation"} */
drop table if exists "supercell"."main"."fact_bill_generation__dbt_backup" cascade
[0m19:06:19.339155 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m19:06:19.340382 [debug] [Thread-2 (]: On model.supercell.fact_bill_generation: Close
[0m19:06:19.341954 [info ] [Thread-2 (]: 4 of 5 OK created sql table model main.fact_bill_generation .................... [[32mOK[0m in 0.12s]
[0m19:06:19.342542 [debug] [Thread-2 (]: Finished running node model.supercell.fact_bill_generation
[0m19:06:19.356333 [debug] [Thread-4 (]: SQL status: OK in 0.104 seconds
[0m19:06:19.358353 [debug] [Thread-4 (]: Using duckdb connection "model.supercell.dim_resource"
[0m19:06:19.358633 [debug] [Thread-4 (]: On model.supercell.dim_resource: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.dim_resource"} */
alter table "supercell"."main"."dim_resource__dbt_tmp" rename to "dim_resource"
[0m19:06:19.359225 [debug] [Thread-4 (]: SQL status: OK in 0.000 seconds
[0m19:06:19.360379 [debug] [Thread-4 (]: On model.supercell.dim_resource: COMMIT
[0m19:06:19.360632 [debug] [Thread-4 (]: Using duckdb connection "model.supercell.dim_resource"
[0m19:06:19.360848 [debug] [Thread-4 (]: On model.supercell.dim_resource: COMMIT
[0m19:06:19.386100 [debug] [Thread-4 (]: SQL status: OK in 0.025 seconds
[0m19:06:19.387679 [debug] [Thread-4 (]: Using duckdb connection "model.supercell.dim_resource"
[0m19:06:19.387937 [debug] [Thread-4 (]: On model.supercell.dim_resource: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.dim_resource"} */
drop table if exists "supercell"."main"."dim_resource__dbt_backup" cascade
[0m19:06:19.388562 [debug] [Thread-4 (]: SQL status: OK in 0.000 seconds
[0m19:06:19.389485 [debug] [Thread-4 (]: On model.supercell.dim_resource: Close
[0m19:06:19.390627 [info ] [Thread-4 (]: 3 of 5 OK created sql table model main.dim_resource ............................ [[32mOK[0m in 0.17s]
[0m19:06:19.391001 [debug] [Thread-4 (]: Finished running node model.supercell.dim_resource
[0m19:06:19.391889 [debug] [Thread-1 (]: Began running node model.supercell.total_cost
[0m19:06:19.392564 [info ] [Thread-1 (]: 5 of 5 START sql table model main.total_cost ................................... [RUN]
[0m19:06:19.393069 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.supercell.cleaned_usagelogs, now model.supercell.total_cost)
[0m19:06:19.393471 [debug] [Thread-1 (]: Began compiling node model.supercell.total_cost
[0m19:06:19.397950 [debug] [Thread-1 (]: Writing injected SQL for node "model.supercell.total_cost"
[0m19:06:19.399257 [debug] [Thread-1 (]: Began executing node model.supercell.total_cost
[0m19:06:19.405892 [debug] [Thread-1 (]: Writing runtime sql for node "model.supercell.total_cost"
[0m19:06:19.407124 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.total_cost"
[0m19:06:19.407496 [debug] [Thread-1 (]: On model.supercell.total_cost: BEGIN
[0m19:06:19.407698 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:06:19.408565 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:06:19.408967 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.total_cost"
[0m19:06:19.409238 [debug] [Thread-1 (]: On model.supercell.total_cost: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.total_cost"} */

  
    
    

    create  table
      "supercell"."main"."total_cost__dbt_tmp"
  
    as (
      

with base as (
    select
        fact_bill_generation.resource_id,
        date_trunc('month', fact_bill_generation.bill_date) as month,
        fact_bill_generation.bill_amount,
        dim_resource.instance_type,
        dim_resource.product,
        dim_resource.region,
        dim_resource.pricing_model,
        dim_resource.tag_keys,
        dim_resource.tag_values
    from "supercell"."main"."fact_bill_generation" as fact_bill_generation
    left join "supercell"."main"."dim_resource" as dim_resource
        on fact_bill_generation.resource_id = dim_resource.resource_id
)

select
    month,
    sum(bill_amount) as total_cost,
    instance_type,
    product,
    region,
    pricing_model,
    tag_keys,
    tag_values
from base
group by
    month,
    instance_type,
    product,
    region,
    pricing_model,
    tag_keys,
    tag_values
order by
    month,
    instance_type,
    product,
    region,
    pricing_model,
    tag_keys,
    tag_values
    );
  
  
[0m19:06:19.471041 [debug] [Thread-1 (]: SQL status: OK in 0.061 seconds
[0m19:06:19.473183 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.total_cost"
[0m19:06:19.473459 [debug] [Thread-1 (]: On model.supercell.total_cost: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.total_cost"} */
alter table "supercell"."main"."total_cost__dbt_tmp" rename to "total_cost"
[0m19:06:19.474014 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m19:06:19.475024 [debug] [Thread-1 (]: On model.supercell.total_cost: COMMIT
[0m19:06:19.475283 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.total_cost"
[0m19:06:19.475491 [debug] [Thread-1 (]: On model.supercell.total_cost: COMMIT
[0m19:06:19.636241 [debug] [Thread-1 (]: SQL status: OK in 0.160 seconds
[0m19:06:19.637879 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.total_cost"
[0m19:06:19.638161 [debug] [Thread-1 (]: On model.supercell.total_cost: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.total_cost"} */
drop table if exists "supercell"."main"."total_cost__dbt_backup" cascade
[0m19:06:19.638670 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m19:06:19.639568 [debug] [Thread-1 (]: On model.supercell.total_cost: Close
[0m19:06:19.642392 [info ] [Thread-1 (]: 5 of 5 OK created sql table model main.total_cost .............................. [[32mOK[0m in 0.25s]
[0m19:06:19.642777 [debug] [Thread-1 (]: Finished running node model.supercell.total_cost
[0m19:06:19.644098 [debug] [MainThread]: Using duckdb connection "master"
[0m19:06:19.644492 [debug] [MainThread]: On master: BEGIN
[0m19:06:19.644704 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:06:19.645282 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m19:06:19.645531 [debug] [MainThread]: On master: COMMIT
[0m19:06:19.645733 [debug] [MainThread]: Using duckdb connection "master"
[0m19:06:19.645931 [debug] [MainThread]: On master: COMMIT
[0m19:06:19.646454 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m19:06:19.646773 [debug] [MainThread]: On master: Close
[0m19:06:19.647292 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:06:19.647478 [debug] [MainThread]: Connection 'model.supercell.total_cost' was properly closed.
[0m19:06:19.647631 [debug] [MainThread]: Connection 'model.supercell.dim_accounts' was properly closed.
[0m19:06:19.647778 [debug] [MainThread]: Connection 'model.supercell.dim_resource' was properly closed.
[0m19:06:19.647929 [debug] [MainThread]: Connection 'model.supercell.fact_bill_generation' was properly closed.
[0m19:06:19.648224 [info ] [MainThread]: 
[0m19:06:19.648490 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 0.78 seconds (0.78s).
[0m19:06:19.649442 [debug] [MainThread]: Command end result
[0m19:06:19.659392 [debug] [MainThread]: Wrote artifact WritableManifest to /home/harsha/data_actions/supercell_cloudops/target/manifest.json
[0m19:06:19.660463 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/harsha/data_actions/supercell_cloudops/target/semantic_manifest.json
[0m19:06:19.664233 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/harsha/data_actions/supercell_cloudops/target/run_results.json
[0m19:06:19.664488 [info ] [MainThread]: 
[0m19:06:19.664725 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:06:19.664911 [info ] [MainThread]: 
[0m19:06:19.665113 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m19:06:19.665690 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.1274412, "process_in_blocks": "1736", "process_kernel_time": 0.185883, "process_mem_max_rss": "207100", "process_out_blocks": "57096", "process_user_time": 2.089689}
[0m19:06:19.665997 [debug] [MainThread]: Command `dbt run` succeeded at 19:06:19.665934 after 1.13 seconds
[0m19:06:19.666220 [debug] [MainThread]: Flushing usage events


============================== 19:16:34.029511 | 2edb25ab-18b4-402c-b42a-67baebcfc669 ==============================
[0m19:16:34.029511 [info ] [MainThread]: Running with dbt=1.9.4
[0m19:16:34.031585 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/harsha/data_actions/supercell_cloudops', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/harsha/data_actions/supercell_cloudops/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt docs generate', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'False'}
[0m19:16:34.032097 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality

User config should be moved from the 'config' key in profiles.yml to the 'flags' key in dbt_project.yml.
[0m19:16:34.182482 [info ] [MainThread]: Registered adapter: duckdb=1.9.3
[0m19:16:34.220196 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m19:16:34.259416 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:16:34.259682 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:16:34.263818 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.supercell.example
[0m19:16:34.285305 [info ] [MainThread]: Found 5 models, 428 macros
[0m19:16:34.286625 [info ] [MainThread]: 
[0m19:16:34.286985 [info ] [MainThread]: Concurrency: 4 threads (target='default')
[0m19:16:34.287192 [info ] [MainThread]: 
[0m19:16:34.287515 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m19:16:34.291492 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_supercell_main'
[0m19:16:34.316718 [debug] [ThreadPool]: Using duckdb connection "list_supercell_main"
[0m19:16:34.317012 [debug] [ThreadPool]: On list_supercell_main: BEGIN
[0m19:16:34.317233 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:16:34.321260 [debug] [ThreadPool]: DuckDB adapter: Error running SQL: BEGIN
[0m19:16:34.321491 [debug] [ThreadPool]: DuckDB adapter: Rolling back transaction.
[0m19:16:34.322164 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:16:34.322406 [debug] [MainThread]: Connection 'list_supercell_main' was properly closed.
[0m19:16:34.322689 [error] [MainThread]: Encountered an error:
Runtime Error
  IO Error: Could not set lock on file "/home/harsha/data_actions/supercell_cloudops/supercell.duckdb": Conflicting lock is held in /usr/bin/python3.12 (PID 2720043) by user harsha. See also https://duckdb.org/docs/connect/concurrency
[0m19:16:34.323490 [debug] [MainThread]: Resource report: {"command_name": "generate", "command_success": false, "command_wall_clock_time": 0.3253908, "process_in_blocks": "248", "process_kernel_time": 0.087735, "process_mem_max_rss": "132452", "process_out_blocks": "40", "process_user_time": 1.045844}
[0m19:16:34.324048 [debug] [MainThread]: Command `dbt docs generate` failed at 19:16:34.323937 after 0.33 seconds
[0m19:16:34.324366 [debug] [MainThread]: Flushing usage events


============================== 19:16:46.006635 | 3bae7eaf-228e-4f0c-a346-84e8bc21f6f0 ==============================
[0m19:16:46.006635 [info ] [MainThread]: Running with dbt=1.9.4
[0m19:16:46.009593 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/harsha/data_actions/supercell_cloudops', 'debug': 'False', 'warn_error': 'None', 'log_path': '/home/harsha/data_actions/supercell_cloudops/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt docs generate', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'False'}
[0m19:16:46.009942 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality

User config should be moved from the 'config' key in profiles.yml to the 'flags' key in dbt_project.yml.
[0m19:16:46.164223 [info ] [MainThread]: Registered adapter: duckdb=1.9.3
[0m19:16:46.203277 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m19:16:46.245308 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:16:46.245606 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:16:46.250257 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.supercell.example
[0m19:16:46.270123 [info ] [MainThread]: Found 5 models, 428 macros
[0m19:16:46.271416 [info ] [MainThread]: 
[0m19:16:46.271680 [info ] [MainThread]: Concurrency: 4 threads (target='default')
[0m19:16:46.271854 [info ] [MainThread]: 
[0m19:16:46.272120 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m19:16:46.275437 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_supercell_main'
[0m19:16:46.297975 [debug] [ThreadPool]: Using duckdb connection "list_supercell_main"
[0m19:16:46.298301 [debug] [ThreadPool]: On list_supercell_main: BEGIN
[0m19:16:46.298503 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:16:46.306116 [debug] [ThreadPool]: SQL status: OK in 0.008 seconds
[0m19:16:46.306396 [debug] [ThreadPool]: Using duckdb connection "list_supercell_main"
[0m19:16:46.306572 [debug] [ThreadPool]: On list_supercell_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "connection_name": "list_supercell_main"} */
select
      'supercell' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'supercell'
  
[0m19:16:46.314997 [debug] [ThreadPool]: SQL status: OK in 0.008 seconds
[0m19:16:46.315920 [debug] [ThreadPool]: On list_supercell_main: ROLLBACK
[0m19:16:46.316584 [debug] [ThreadPool]: Failed to rollback 'list_supercell_main'
[0m19:16:46.316785 [debug] [ThreadPool]: On list_supercell_main: Close
[0m19:16:46.319459 [debug] [Thread-1 (]: Began running node model.supercell.cleaned_usagelogs
[0m19:16:46.321545 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_supercell_main, now model.supercell.cleaned_usagelogs)
[0m19:16:46.321951 [debug] [Thread-1 (]: Began compiling node model.supercell.cleaned_usagelogs
[0m19:16:46.328432 [debug] [Thread-1 (]: Writing injected SQL for node "model.supercell.cleaned_usagelogs"
[0m19:16:46.329034 [debug] [Thread-1 (]: Began executing node model.supercell.cleaned_usagelogs
[0m19:16:46.329733 [debug] [Thread-1 (]: Finished running node model.supercell.cleaned_usagelogs
[0m19:16:46.330551 [debug] [Thread-3 (]: Began running node model.supercell.dim_accounts
[0m19:16:46.330988 [debug] [Thread-4 (]: Began running node model.supercell.dim_resource
[0m19:16:46.331443 [debug] [Thread-3 (]: Acquiring new duckdb connection 'model.supercell.dim_accounts'
[0m19:16:46.331941 [debug] [Thread-2 (]: Began running node model.supercell.fact_bill_generation
[0m19:16:46.332494 [debug] [Thread-4 (]: Acquiring new duckdb connection 'model.supercell.dim_resource'
[0m19:16:46.332942 [debug] [Thread-3 (]: Began compiling node model.supercell.dim_accounts
[0m19:16:46.333585 [debug] [Thread-2 (]: Acquiring new duckdb connection 'model.supercell.fact_bill_generation'
[0m19:16:46.334129 [debug] [Thread-4 (]: Began compiling node model.supercell.dim_resource
[0m19:16:46.336445 [debug] [Thread-3 (]: Writing injected SQL for node "model.supercell.dim_accounts"
[0m19:16:46.336985 [debug] [Thread-2 (]: Began compiling node model.supercell.fact_bill_generation
[0m19:16:46.339323 [debug] [Thread-4 (]: Writing injected SQL for node "model.supercell.dim_resource"
[0m19:16:46.339910 [debug] [Thread-3 (]: Began executing node model.supercell.dim_accounts
[0m19:16:46.341941 [debug] [Thread-2 (]: Writing injected SQL for node "model.supercell.fact_bill_generation"
[0m19:16:46.342802 [debug] [Thread-3 (]: Finished running node model.supercell.dim_accounts
[0m19:16:46.343267 [debug] [Thread-4 (]: Began executing node model.supercell.dim_resource
[0m19:16:46.344203 [debug] [Thread-4 (]: Finished running node model.supercell.dim_resource
[0m19:16:46.344835 [debug] [Thread-2 (]: Began executing node model.supercell.fact_bill_generation
[0m19:16:46.345224 [debug] [Thread-2 (]: Finished running node model.supercell.fact_bill_generation
[0m19:16:46.346067 [debug] [Thread-1 (]: Began running node model.supercell.total_cost
[0m19:16:46.346473 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.supercell.cleaned_usagelogs, now model.supercell.total_cost)
[0m19:16:46.346807 [debug] [Thread-1 (]: Began compiling node model.supercell.total_cost
[0m19:16:46.349271 [debug] [Thread-1 (]: Writing injected SQL for node "model.supercell.total_cost"
[0m19:16:46.349769 [debug] [Thread-1 (]: Began executing node model.supercell.total_cost
[0m19:16:46.350405 [debug] [Thread-1 (]: Finished running node model.supercell.total_cost
[0m19:16:46.351641 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:16:46.351872 [debug] [MainThread]: Connection 'model.supercell.total_cost' was properly closed.
[0m19:16:46.352045 [debug] [MainThread]: Connection 'model.supercell.dim_accounts' was properly closed.
[0m19:16:46.352222 [debug] [MainThread]: Connection 'model.supercell.dim_resource' was properly closed.
[0m19:16:46.352358 [debug] [MainThread]: Connection 'model.supercell.fact_bill_generation' was properly closed.
[0m19:16:46.352881 [debug] [MainThread]: Command end result
[0m19:16:46.380801 [debug] [MainThread]: Wrote artifact WritableManifest to /home/harsha/data_actions/supercell_cloudops/target/manifest.json
[0m19:16:46.381769 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/harsha/data_actions/supercell_cloudops/target/semantic_manifest.json
[0m19:16:46.385457 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/harsha/data_actions/supercell_cloudops/target/run_results.json
[0m19:16:46.388072 [debug] [MainThread]: Acquiring new duckdb connection 'generate_catalog'
[0m19:16:46.388256 [info ] [MainThread]: Building catalog
[0m19:16:46.394240 [debug] [ThreadPool]: Acquiring new duckdb connection 'supercell.information_schema'
[0m19:16:46.400912 [debug] [ThreadPool]: Using duckdb connection "supercell.information_schema"
[0m19:16:46.401382 [debug] [ThreadPool]: On supercell.information_schema: BEGIN
[0m19:16:46.401629 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:16:46.402128 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m19:16:46.402349 [debug] [ThreadPool]: Using duckdb connection "supercell.information_schema"
[0m19:16:46.402513 [debug] [ThreadPool]: On supercell.information_schema: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "connection_name": "supercell.information_schema"} */
with relations AS (
      select
        t.table_name
        , t.database_name
        , t.schema_name
        , 'BASE TABLE' as table_type
        , t.comment as table_comment
      from duckdb_tables() t
      WHERE t.database_name = 'supercell'
      UNION ALL
      SELECT v.view_name as table_name
      , v.database_name
      , v.schema_name
      , 'VIEW' as table_type
      , v.comment as table_comment
      from duckdb_views() v
      WHERE v.database_name = 'supercell'
    )
    select
        'supercell' as table_database,
        r.schema_name as table_schema,
        r.table_name,
        r.table_type,
        r.table_comment,
        c.column_name,
        c.column_index as column_index,
        c.data_type as column_type,
        c.comment as column_comment,
        '' as table_owner
    FROM relations r JOIN duckdb_columns() c ON r.schema_name = c.schema_name AND r.table_name = c.table_name
    WHERE (upper(r.schema_name) = upper('main'))
    ORDER BY
        r.schema_name,
        r.table_name,
        c.column_index
[0m19:16:46.407357 [debug] [ThreadPool]: SQL status: OK in 0.005 seconds
[0m19:16:46.418303 [debug] [ThreadPool]: On supercell.information_schema: ROLLBACK
[0m19:16:46.418804 [debug] [ThreadPool]: Failed to rollback 'supercell.information_schema'
[0m19:16:46.418977 [debug] [ThreadPool]: On supercell.information_schema: Close
[0m19:16:46.432861 [debug] [MainThread]: Wrote artifact CatalogArtifact to /home/harsha/data_actions/supercell_cloudops/target/catalog.json
[0m19:16:46.441526 [debug] [MainThread]: Wrote artifact WritableManifest to /home/harsha/data_actions/supercell_cloudops/target/manifest.json
[0m19:16:46.442423 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/harsha/data_actions/supercell_cloudops/target/semantic_manifest.json
[0m19:16:46.442660 [info ] [MainThread]: Catalog written to /home/harsha/data_actions/supercell_cloudops/target/catalog.json
[0m19:16:46.443264 [debug] [MainThread]: Resource report: {"command_name": "generate", "command_success": true, "command_wall_clock_time": 0.4676059, "process_in_blocks": "3344", "process_kernel_time": 0.097948, "process_mem_max_rss": "144508", "process_out_blocks": "5216", "process_user_time": 1.275333}
[0m19:16:46.443625 [debug] [MainThread]: Command `dbt docs generate` succeeded at 19:16:46.443553 after 0.47 seconds
[0m19:16:46.443842 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m19:16:46.444012 [debug] [MainThread]: Connection 'supercell.information_schema' was properly closed.
[0m19:16:46.444229 [debug] [MainThread]: Flushing usage events


============================== 19:17:19.372156 | 5efb5d46-79b8-4d84-aaf5-b1b53c8b2780 ==============================
[0m19:17:19.372156 [info ] [MainThread]: Running with dbt=1.9.4
[0m19:17:19.374325 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/harsha/data_actions/supercell_cloudops', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/harsha/data_actions/supercell_cloudops/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt docs serve --port 8001', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'False'}
[0m19:17:19.374542 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality

User config should be moved from the 'config' key in profiles.yml to the 'flags' key in dbt_project.yml.
[0m19:17:43.958484 [error] [MainThread]: Encountered an error:

[0m19:17:43.964547 [error] [MainThread]: Traceback (most recent call last):
  File "/home/harsha/data_actions/supercell_cloudops/supercell_env/lib/python3.12/site-packages/dbt/cli/requires.py", line 153, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "/home/harsha/data_actions/supercell_cloudops/supercell_env/lib/python3.12/site-packages/dbt/cli/requires.py", line 103, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/harsha/data_actions/supercell_cloudops/supercell_env/lib/python3.12/site-packages/dbt/cli/requires.py", line 235, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/harsha/data_actions/supercell_cloudops/supercell_env/lib/python3.12/site-packages/dbt/cli/requires.py", line 264, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/harsha/data_actions/supercell_cloudops/supercell_env/lib/python3.12/site-packages/dbt/cli/requires.py", line 311, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/harsha/data_actions/supercell_cloudops/supercell_env/lib/python3.12/site-packages/dbt/cli/main.py", line 301, in docs_serve
    results = task.run()
              ^^^^^^^^^^
  File "/home/harsha/data_actions/supercell_cloudops/supercell_env/lib/python3.12/site-packages/dbt/task/docs/serve.py", line 29, in run
    httpd.serve_forever()
  File "/usr/lib/python3.12/socketserver.py", line 235, in serve_forever
    ready = selector.select(poll_interval)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/selectors.py", line 415, in select
    fd_event_list = self._selector.poll(timeout)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
KeyboardInterrupt

[0m19:17:43.966613 [debug] [MainThread]: Resource report: {"command_name": "serve", "command_success": false, "command_wall_clock_time": 24.625301, "process_in_blocks": "520", "process_kernel_time": 0.087959, "process_mem_max_rss": "114828", "process_out_blocks": "3368", "process_user_time": 0.939562}
[0m19:17:43.967659 [debug] [MainThread]: Command `dbt docs serve` failed at 19:17:43.967444 after 24.63 seconds
[0m19:17:43.968431 [debug] [MainThread]: Flushing usage events


============================== 19:18:18.564868 | d1443664-e96f-4ff8-a469-b90856fa6677 ==============================
[0m19:18:18.564868 [info ] [MainThread]: Running with dbt=1.9.4
[0m19:18:18.567839 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/home/harsha/data_actions/supercell_cloudops', 'log_path': '/home/harsha/data_actions/supercell_cloudops/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt docs generate', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'False'}
[0m19:18:18.568301 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality

User config should be moved from the 'config' key in profiles.yml to the 'flags' key in dbt_project.yml.
[0m19:18:18.727579 [info ] [MainThread]: Registered adapter: duckdb=1.9.3
[0m19:18:18.765745 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m19:18:18.806703 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 0 files added, 0 files changed.
[0m19:18:18.807000 [debug] [MainThread]: Partial parsing: deleted file: supercell://models/supercell_models/dim_accounts.sql
[0m19:18:18.835245 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.supercell.example
[0m19:18:18.846648 [info ] [MainThread]: Found 4 models, 428 macros
[0m19:18:18.847972 [info ] [MainThread]: 
[0m19:18:18.848260 [info ] [MainThread]: Concurrency: 4 threads (target='default')
[0m19:18:18.848456 [info ] [MainThread]: 
[0m19:18:18.848758 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m19:18:18.852129 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_supercell_main'
[0m19:18:18.874022 [debug] [ThreadPool]: Using duckdb connection "list_supercell_main"
[0m19:18:18.874348 [debug] [ThreadPool]: On list_supercell_main: BEGIN
[0m19:18:18.874527 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:18:18.881793 [debug] [ThreadPool]: SQL status: OK in 0.007 seconds
[0m19:18:18.882073 [debug] [ThreadPool]: Using duckdb connection "list_supercell_main"
[0m19:18:18.882299 [debug] [ThreadPool]: On list_supercell_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "connection_name": "list_supercell_main"} */
select
      'supercell' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'supercell'
  
[0m19:18:18.890522 [debug] [ThreadPool]: SQL status: OK in 0.008 seconds
[0m19:18:18.891510 [debug] [ThreadPool]: On list_supercell_main: ROLLBACK
[0m19:18:18.892178 [debug] [ThreadPool]: Failed to rollback 'list_supercell_main'
[0m19:18:18.892398 [debug] [ThreadPool]: On list_supercell_main: Close
[0m19:18:18.895286 [debug] [Thread-1 (]: Began running node model.supercell.cleaned_usagelogs
[0m19:18:18.895813 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_supercell_main, now model.supercell.cleaned_usagelogs)
[0m19:18:18.896216 [debug] [Thread-1 (]: Began compiling node model.supercell.cleaned_usagelogs
[0m19:18:18.902235 [debug] [Thread-1 (]: Writing injected SQL for node "model.supercell.cleaned_usagelogs"
[0m19:18:18.902642 [debug] [Thread-1 (]: Began executing node model.supercell.cleaned_usagelogs
[0m19:18:18.903019 [debug] [Thread-1 (]: Finished running node model.supercell.cleaned_usagelogs
[0m19:18:18.903818 [debug] [Thread-3 (]: Began running node model.supercell.dim_resource
[0m19:18:18.904493 [debug] [Thread-4 (]: Began running node model.supercell.fact_bill_generation
[0m19:18:18.905030 [debug] [Thread-3 (]: Acquiring new duckdb connection 'model.supercell.dim_resource'
[0m19:18:18.905753 [debug] [Thread-4 (]: Acquiring new duckdb connection 'model.supercell.fact_bill_generation'
[0m19:18:18.906291 [debug] [Thread-3 (]: Began compiling node model.supercell.dim_resource
[0m19:18:18.906786 [debug] [Thread-4 (]: Began compiling node model.supercell.fact_bill_generation
[0m19:18:18.909324 [debug] [Thread-3 (]: Writing injected SQL for node "model.supercell.dim_resource"
[0m19:18:18.911798 [debug] [Thread-4 (]: Writing injected SQL for node "model.supercell.fact_bill_generation"
[0m19:18:18.912562 [debug] [Thread-4 (]: Began executing node model.supercell.fact_bill_generation
[0m19:18:18.913259 [debug] [Thread-4 (]: Finished running node model.supercell.fact_bill_generation
[0m19:18:18.913742 [debug] [Thread-3 (]: Began executing node model.supercell.dim_resource
[0m19:18:18.914410 [debug] [Thread-3 (]: Finished running node model.supercell.dim_resource
[0m19:18:18.915162 [debug] [Thread-1 (]: Began running node model.supercell.total_cost
[0m19:18:18.915423 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.supercell.cleaned_usagelogs, now model.supercell.total_cost)
[0m19:18:18.915611 [debug] [Thread-1 (]: Began compiling node model.supercell.total_cost
[0m19:18:18.917251 [debug] [Thread-1 (]: Writing injected SQL for node "model.supercell.total_cost"
[0m19:18:18.917570 [debug] [Thread-1 (]: Began executing node model.supercell.total_cost
[0m19:18:18.917905 [debug] [Thread-1 (]: Finished running node model.supercell.total_cost
[0m19:18:18.918919 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:18:18.919154 [debug] [MainThread]: Connection 'model.supercell.total_cost' was properly closed.
[0m19:18:18.919324 [debug] [MainThread]: Connection 'model.supercell.dim_resource' was properly closed.
[0m19:18:18.919463 [debug] [MainThread]: Connection 'model.supercell.fact_bill_generation' was properly closed.
[0m19:18:18.919957 [debug] [MainThread]: Command end result
[0m19:18:18.947497 [debug] [MainThread]: Wrote artifact WritableManifest to /home/harsha/data_actions/supercell_cloudops/target/manifest.json
[0m19:18:18.948376 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/harsha/data_actions/supercell_cloudops/target/semantic_manifest.json
[0m19:18:18.952125 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/harsha/data_actions/supercell_cloudops/target/run_results.json
[0m19:18:18.953559 [debug] [MainThread]: Acquiring new duckdb connection 'generate_catalog'
[0m19:18:18.953749 [info ] [MainThread]: Building catalog
[0m19:18:18.959799 [debug] [ThreadPool]: Acquiring new duckdb connection 'supercell.information_schema'
[0m19:18:18.965207 [debug] [ThreadPool]: Using duckdb connection "supercell.information_schema"
[0m19:18:18.965456 [debug] [ThreadPool]: On supercell.information_schema: BEGIN
[0m19:18:18.965616 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:18:18.966266 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m19:18:18.966474 [debug] [ThreadPool]: Using duckdb connection "supercell.information_schema"
[0m19:18:18.966649 [debug] [ThreadPool]: On supercell.information_schema: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "connection_name": "supercell.information_schema"} */
with relations AS (
      select
        t.table_name
        , t.database_name
        , t.schema_name
        , 'BASE TABLE' as table_type
        , t.comment as table_comment
      from duckdb_tables() t
      WHERE t.database_name = 'supercell'
      UNION ALL
      SELECT v.view_name as table_name
      , v.database_name
      , v.schema_name
      , 'VIEW' as table_type
      , v.comment as table_comment
      from duckdb_views() v
      WHERE v.database_name = 'supercell'
    )
    select
        'supercell' as table_database,
        r.schema_name as table_schema,
        r.table_name,
        r.table_type,
        r.table_comment,
        c.column_name,
        c.column_index as column_index,
        c.data_type as column_type,
        c.comment as column_comment,
        '' as table_owner
    FROM relations r JOIN duckdb_columns() c ON r.schema_name = c.schema_name AND r.table_name = c.table_name
    WHERE (upper(r.schema_name) = upper('main'))
    ORDER BY
        r.schema_name,
        r.table_name,
        c.column_index
[0m19:18:18.971553 [debug] [ThreadPool]: SQL status: OK in 0.005 seconds
[0m19:18:18.982782 [debug] [ThreadPool]: On supercell.information_schema: ROLLBACK
[0m19:18:18.983358 [debug] [ThreadPool]: Failed to rollback 'supercell.information_schema'
[0m19:18:18.983538 [debug] [ThreadPool]: On supercell.information_schema: Close
[0m19:18:18.997730 [debug] [MainThread]: Wrote artifact CatalogArtifact to /home/harsha/data_actions/supercell_cloudops/target/catalog.json
[0m19:18:19.006687 [debug] [MainThread]: Wrote artifact WritableManifest to /home/harsha/data_actions/supercell_cloudops/target/manifest.json
[0m19:18:19.007581 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/harsha/data_actions/supercell_cloudops/target/semantic_manifest.json
[0m19:18:19.007810 [info ] [MainThread]: Catalog written to /home/harsha/data_actions/supercell_cloudops/target/catalog.json
[0m19:18:19.008436 [debug] [MainThread]: Resource report: {"command_name": "generate", "command_success": true, "command_wall_clock_time": 0.47693092, "process_in_blocks": "0", "process_kernel_time": 0.112833, "process_mem_max_rss": "144720", "process_out_blocks": "6048", "process_user_time": 1.212211}
[0m19:18:19.008829 [debug] [MainThread]: Command `dbt docs generate` succeeded at 19:18:19.008752 after 0.48 seconds
[0m19:18:19.009076 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m19:18:19.009282 [debug] [MainThread]: Connection 'supercell.information_schema' was properly closed.
[0m19:18:19.009480 [debug] [MainThread]: Flushing usage events


============================== 19:18:22.980945 | 01208032-6ab4-4ed1-8df4-39cfe8602c98 ==============================
[0m19:18:22.980945 [info ] [MainThread]: Running with dbt=1.9.4
[0m19:18:22.984005 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/home/harsha/data_actions/supercell_cloudops/logs', 'debug': 'False', 'profiles_dir': '/home/harsha/data_actions/supercell_cloudops', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt docs serve --port 8001', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'False'}
[0m19:18:22.984518 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality

User config should be moved from the 'config' key in profiles.yml to the 'flags' key in dbt_project.yml.
[0m19:20:20.878194 [error] [MainThread]: Encountered an error:

[0m19:20:20.882061 [error] [MainThread]: Traceback (most recent call last):
  File "/home/harsha/data_actions/supercell_cloudops/supercell_env/lib/python3.12/site-packages/dbt/cli/requires.py", line 153, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "/home/harsha/data_actions/supercell_cloudops/supercell_env/lib/python3.12/site-packages/dbt/cli/requires.py", line 103, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/harsha/data_actions/supercell_cloudops/supercell_env/lib/python3.12/site-packages/dbt/cli/requires.py", line 235, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/harsha/data_actions/supercell_cloudops/supercell_env/lib/python3.12/site-packages/dbt/cli/requires.py", line 264, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/harsha/data_actions/supercell_cloudops/supercell_env/lib/python3.12/site-packages/dbt/cli/requires.py", line 311, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/harsha/data_actions/supercell_cloudops/supercell_env/lib/python3.12/site-packages/dbt/cli/main.py", line 301, in docs_serve
    results = task.run()
              ^^^^^^^^^^
  File "/home/harsha/data_actions/supercell_cloudops/supercell_env/lib/python3.12/site-packages/dbt/task/docs/serve.py", line 29, in run
    httpd.serve_forever()
  File "/usr/lib/python3.12/socketserver.py", line 235, in serve_forever
    ready = selector.select(poll_interval)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/selectors.py", line 415, in select
    fd_event_list = self._selector.poll(timeout)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
KeyboardInterrupt

[0m19:20:20.884094 [debug] [MainThread]: Resource report: {"command_name": "serve", "command_success": false, "command_wall_clock_time": 117.93379, "process_in_blocks": "0", "process_kernel_time": 0.068615, "process_mem_max_rss": "115024", "process_out_blocks": "3360", "process_user_time": 0.985843}
[0m19:20:20.884778 [debug] [MainThread]: Command `dbt docs serve` failed at 19:20:20.884673 after 117.93 seconds
[0m19:20:20.885113 [debug] [MainThread]: Flushing usage events


============================== 19:20:33.081750 | e7058d58-5e13-4f92-a4c2-16b8489eac79 ==============================
[0m19:20:33.081750 [info ] [MainThread]: Running with dbt=1.9.4
[0m19:20:33.083845 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/harsha/data_actions/supercell_cloudops', 'version_check': 'True', 'debug': 'False', 'log_path': '/home/harsha/data_actions/supercell_cloudops/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt run', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'False'}
[0m19:20:33.084097 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality

User config should be moved from the 'config' key in profiles.yml to the 'flags' key in dbt_project.yml.
[0m19:20:33.236908 [info ] [MainThread]: Registered adapter: duckdb=1.9.3
[0m19:20:33.273527 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m19:20:33.311947 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 1 files changed.
[0m19:20:33.312292 [debug] [MainThread]: Partial parsing: added file: supercell://models/supercell_models/Supercell_usagelogs.sql
[0m19:20:33.312549 [debug] [MainThread]: Partial parsing: updated file: supercell://models/supercell_models/cleaned_usagelogs.sql
[0m19:20:33.446997 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.supercell.example
[0m19:20:33.477788 [debug] [MainThread]: Wrote artifact WritableManifest to /home/harsha/data_actions/supercell_cloudops/target/manifest.json
[0m19:20:33.478750 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/harsha/data_actions/supercell_cloudops/target/semantic_manifest.json
[0m19:20:33.485050 [info ] [MainThread]: Found 5 models, 428 macros
[0m19:20:33.486665 [info ] [MainThread]: 
[0m19:20:33.486990 [info ] [MainThread]: Concurrency: 4 threads (target='default')
[0m19:20:33.487216 [info ] [MainThread]: 
[0m19:20:33.487548 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m19:20:33.491735 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_supercell'
[0m19:20:33.512400 [debug] [ThreadPool]: Using duckdb connection "list_supercell"
[0m19:20:33.512693 [debug] [ThreadPool]: On list_supercell: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "connection_name": "list_supercell"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"supercell"'
    
  
  
[0m19:20:33.512907 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:20:33.520845 [debug] [ThreadPool]: SQL status: OK in 0.008 seconds
[0m19:20:33.521838 [debug] [ThreadPool]: On list_supercell: Close
[0m19:20:33.522528 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_supercell, now create_supercell_main)
[0m19:20:33.522849 [debug] [ThreadPool]: Creating schema "database: "supercell"
schema: "main"
"
[0m19:20:33.526687 [debug] [ThreadPool]: Using duckdb connection "create_supercell_main"
[0m19:20:33.526900 [debug] [ThreadPool]: On create_supercell_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "connection_name": "create_supercell_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='supercell'
        and type='sqlite'
    
  
[0m19:20:33.527094 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:20:33.527730 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m19:20:33.528473 [debug] [ThreadPool]: Using duckdb connection "create_supercell_main"
[0m19:20:33.528670 [debug] [ThreadPool]: On create_supercell_main: BEGIN
[0m19:20:33.529025 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m19:20:33.529242 [debug] [ThreadPool]: Using duckdb connection "create_supercell_main"
[0m19:20:33.529406 [debug] [ThreadPool]: On create_supercell_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "connection_name": "create_supercell_main"} */

    
    
        create schema if not exists "supercell"."main"
    
[0m19:20:33.529727 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m19:20:33.530218 [debug] [ThreadPool]: On create_supercell_main: COMMIT
[0m19:20:33.530419 [debug] [ThreadPool]: Using duckdb connection "create_supercell_main"
[0m19:20:33.530599 [debug] [ThreadPool]: On create_supercell_main: COMMIT
[0m19:20:33.530866 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m19:20:33.531059 [debug] [ThreadPool]: On create_supercell_main: Close
[0m19:20:33.532121 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_supercell_main, now list_supercell_main)
[0m19:20:33.535385 [debug] [ThreadPool]: Using duckdb connection "list_supercell_main"
[0m19:20:33.535598 [debug] [ThreadPool]: On list_supercell_main: BEGIN
[0m19:20:33.535776 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:20:33.536249 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m19:20:33.536452 [debug] [ThreadPool]: Using duckdb connection "list_supercell_main"
[0m19:20:33.536638 [debug] [ThreadPool]: On list_supercell_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "connection_name": "list_supercell_main"} */
select
      'supercell' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'supercell'
  
[0m19:20:33.544599 [debug] [ThreadPool]: SQL status: OK in 0.008 seconds
[0m19:20:33.545536 [debug] [ThreadPool]: On list_supercell_main: ROLLBACK
[0m19:20:33.546245 [debug] [ThreadPool]: Failed to rollback 'list_supercell_main'
[0m19:20:33.546460 [debug] [ThreadPool]: On list_supercell_main: Close
[0m19:20:33.547463 [debug] [MainThread]: Using duckdb connection "master"
[0m19:20:33.547674 [debug] [MainThread]: On master: BEGIN
[0m19:20:33.547859 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:20:33.548258 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m19:20:33.548448 [debug] [MainThread]: On master: COMMIT
[0m19:20:33.548637 [debug] [MainThread]: Using duckdb connection "master"
[0m19:20:33.548806 [debug] [MainThread]: On master: COMMIT
[0m19:20:33.549092 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m19:20:33.549309 [debug] [MainThread]: On master: Close
[0m19:20:33.551498 [debug] [Thread-1 (]: Began running node model.supercell.Supercell_usagelogs
[0m19:20:33.552061 [info ] [Thread-1 (]: 1 of 5 START sql table model main.Supercell_usagelogs .......................... [RUN]
[0m19:20:33.552526 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_supercell_main, now model.supercell.Supercell_usagelogs)
[0m19:20:33.552981 [debug] [Thread-1 (]: Began compiling node model.supercell.Supercell_usagelogs
[0m19:20:33.560188 [debug] [Thread-1 (]: Writing injected SQL for node "model.supercell.Supercell_usagelogs"
[0m19:20:33.560868 [debug] [Thread-1 (]: Began executing node model.supercell.Supercell_usagelogs
[0m19:20:33.573950 [debug] [Thread-1 (]: Compilation Error in model Supercell_usagelogs (models/supercell_models/Supercell_usagelogs.sql)
  When searching for a relation, dbt found an approximate match. Instead of guessing 
  which relation to use, dbt will move on. Please delete "supercell"."main"."supercell_usagelogs", or rename it to be less ambiguous.
  Searched for: "supercell"."main"."Supercell_usagelogs"
  Found: "supercell"."main"."supercell_usagelogs"
  
  > in macro load_cached_relation (macros/adapters/relation.sql)
  > called by macro materialization_table_duckdb (macros/materializations/table.sql)
  > called by model Supercell_usagelogs (models/supercell_models/Supercell_usagelogs.sql)
[0m19:20:33.575148 [error] [Thread-1 (]: 1 of 5 ERROR creating sql table model main.Supercell_usagelogs ................. [[31mERROR[0m in 0.02s]
[0m19:20:33.575579 [debug] [Thread-1 (]: Finished running node model.supercell.Supercell_usagelogs
[0m19:20:33.576250 [debug] [Thread-7 (]: Marking all children of 'model.supercell.Supercell_usagelogs' to be skipped because of status 'error'.  Reason: Compilation Error in model Supercell_usagelogs (models/supercell_models/Supercell_usagelogs.sql)
  When searching for a relation, dbt found an approximate match. Instead of guessing 
  which relation to use, dbt will move on. Please delete "supercell"."main"."supercell_usagelogs", or rename it to be less ambiguous.
  Searched for: "supercell"."main"."Supercell_usagelogs"
  Found: "supercell"."main"."supercell_usagelogs"
  
  > in macro load_cached_relation (macros/adapters/relation.sql)
  > called by macro materialization_table_duckdb (macros/materializations/table.sql)
  > called by model Supercell_usagelogs (models/supercell_models/Supercell_usagelogs.sql).
[0m19:20:33.577911 [debug] [Thread-3 (]: Began running node model.supercell.cleaned_usagelogs
[0m19:20:33.578725 [info ] [Thread-3 (]: 2 of 5 SKIP relation main.cleaned_usagelogs .................................... [[33mSKIP[0m]
[0m19:20:33.579323 [debug] [Thread-3 (]: Finished running node model.supercell.cleaned_usagelogs
[0m19:20:33.580326 [debug] [Thread-2 (]: Began running node model.supercell.dim_resource
[0m19:20:33.581087 [debug] [Thread-1 (]: Began running node model.supercell.fact_bill_generation
[0m19:20:33.580821 [info ] [Thread-2 (]: 3 of 5 SKIP relation main.dim_resource ......................................... [[33mSKIP[0m]
[0m19:20:33.581904 [debug] [Thread-2 (]: Finished running node model.supercell.dim_resource
[0m19:20:33.581370 [info ] [Thread-1 (]: 4 of 5 SKIP relation main.fact_bill_generation ................................. [[33mSKIP[0m]
[0m19:20:33.582340 [debug] [Thread-1 (]: Finished running node model.supercell.fact_bill_generation
[0m19:20:33.582937 [debug] [Thread-3 (]: Began running node model.supercell.total_cost
[0m19:20:33.583362 [info ] [Thread-3 (]: 5 of 5 SKIP relation main.total_cost ........................................... [[33mSKIP[0m]
[0m19:20:33.583761 [debug] [Thread-3 (]: Finished running node model.supercell.total_cost
[0m19:20:33.585118 [debug] [MainThread]: Using duckdb connection "master"
[0m19:20:33.585400 [debug] [MainThread]: On master: BEGIN
[0m19:20:33.585663 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:20:33.586841 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m19:20:33.587281 [debug] [MainThread]: On master: COMMIT
[0m19:20:33.587506 [debug] [MainThread]: Using duckdb connection "master"
[0m19:20:33.587706 [debug] [MainThread]: On master: COMMIT
[0m19:20:33.588307 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m19:20:33.588603 [debug] [MainThread]: On master: Close
[0m19:20:33.588976 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:20:33.589197 [debug] [MainThread]: Connection 'model.supercell.Supercell_usagelogs' was properly closed.
[0m19:20:33.589511 [info ] [MainThread]: 
[0m19:20:33.589815 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 0.10 seconds (0.10s).
[0m19:20:33.590407 [debug] [MainThread]: Command end result
[0m19:20:33.600075 [debug] [MainThread]: Wrote artifact WritableManifest to /home/harsha/data_actions/supercell_cloudops/target/manifest.json
[0m19:20:33.600924 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/harsha/data_actions/supercell_cloudops/target/semantic_manifest.json
[0m19:20:33.604769 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/harsha/data_actions/supercell_cloudops/target/run_results.json
[0m19:20:33.605091 [info ] [MainThread]: 
[0m19:20:33.605408 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m19:20:33.605749 [info ] [MainThread]: 
[0m19:20:33.605985 [error] [MainThread]:   Compilation Error in model Supercell_usagelogs (models/supercell_models/Supercell_usagelogs.sql)
  When searching for a relation, dbt found an approximate match. Instead of guessing 
  which relation to use, dbt will move on. Please delete "supercell"."main"."supercell_usagelogs", or rename it to be less ambiguous.
  Searched for: "supercell"."main"."Supercell_usagelogs"
  Found: "supercell"."main"."supercell_usagelogs"
  
  > in macro load_cached_relation (macros/adapters/relation.sql)
  > called by macro materialization_table_duckdb (macros/materializations/table.sql)
  > called by model Supercell_usagelogs (models/supercell_models/Supercell_usagelogs.sql)
[0m19:20:33.606227 [info ] [MainThread]: 
[0m19:20:33.606443 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=4 TOTAL=5
[0m19:20:33.607231 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.55567575, "process_in_blocks": "384", "process_kernel_time": 0.093075, "process_mem_max_rss": "146168", "process_out_blocks": "2672", "process_user_time": 1.258024}
[0m19:20:33.607538 [debug] [MainThread]: Command `dbt run` failed at 19:20:33.607480 after 0.56 seconds
[0m19:20:33.607750 [debug] [MainThread]: Flushing usage events


============================== 19:21:42.994995 | 1c90654d-7508-4810-9100-e32d4cb52070 ==============================
[0m19:21:42.994995 [info ] [MainThread]: Running with dbt=1.9.4
[0m19:21:42.998019 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/harsha/data_actions/supercell_cloudops', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/harsha/data_actions/supercell_cloudops/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'False'}
[0m19:21:42.998416 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality

User config should be moved from the 'config' key in profiles.yml to the 'flags' key in dbt_project.yml.
[0m19:21:43.152540 [info ] [MainThread]: Registered adapter: duckdb=1.9.3
[0m19:21:43.190044 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m19:21:43.228862 [debug] [MainThread]: Partial parsing enabled: 1 files deleted, 1 files added, 1 files changed.
[0m19:21:43.229224 [debug] [MainThread]: Partial parsing: added file: supercell://models/supercell_models/raw_usagelogs.sql
[0m19:21:43.229568 [debug] [MainThread]: Partial parsing: deleted file: supercell://models/supercell_models/Supercell_usagelogs.sql
[0m19:21:43.229778 [debug] [MainThread]: Partial parsing: updated file: supercell://models/supercell_models/cleaned_usagelogs.sql
[0m19:21:43.369012 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.supercell.example
[0m19:21:43.400406 [debug] [MainThread]: Wrote artifact WritableManifest to /home/harsha/data_actions/supercell_cloudops/target/manifest.json
[0m19:21:43.401427 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/harsha/data_actions/supercell_cloudops/target/semantic_manifest.json
[0m19:21:43.408813 [info ] [MainThread]: Found 5 models, 428 macros
[0m19:21:43.409929 [info ] [MainThread]: 
[0m19:21:43.410248 [info ] [MainThread]: Concurrency: 4 threads (target='default')
[0m19:21:43.410462 [info ] [MainThread]: 
[0m19:21:43.410809 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m19:21:43.414508 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_supercell'
[0m19:21:43.435335 [debug] [ThreadPool]: Using duckdb connection "list_supercell"
[0m19:21:43.435628 [debug] [ThreadPool]: On list_supercell: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "connection_name": "list_supercell"} */

    
    select schema_name
    from system.information_schema.schemata
    
    where lower(catalog_name) = '"supercell"'
    
  
  
[0m19:21:43.435842 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:21:43.443509 [debug] [ThreadPool]: SQL status: OK in 0.008 seconds
[0m19:21:43.444400 [debug] [ThreadPool]: On list_supercell: Close
[0m19:21:43.444973 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_supercell, now create_supercell_main)
[0m19:21:43.445281 [debug] [ThreadPool]: Creating schema "database: "supercell"
schema: "main"
"
[0m19:21:43.449053 [debug] [ThreadPool]: Using duckdb connection "create_supercell_main"
[0m19:21:43.449283 [debug] [ThreadPool]: On create_supercell_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "connection_name": "create_supercell_main"} */

    
        select type from duckdb_databases()
        where lower(database_name)='supercell'
        and type='sqlite'
    
  
[0m19:21:43.449475 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:21:43.450073 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m19:21:43.450843 [debug] [ThreadPool]: Using duckdb connection "create_supercell_main"
[0m19:21:43.451045 [debug] [ThreadPool]: On create_supercell_main: BEGIN
[0m19:21:43.451492 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m19:21:43.451672 [debug] [ThreadPool]: Using duckdb connection "create_supercell_main"
[0m19:21:43.451839 [debug] [ThreadPool]: On create_supercell_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "connection_name": "create_supercell_main"} */

    
    
        create schema if not exists "supercell"."main"
    
[0m19:21:43.452257 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m19:21:43.452779 [debug] [ThreadPool]: On create_supercell_main: COMMIT
[0m19:21:43.452992 [debug] [ThreadPool]: Using duckdb connection "create_supercell_main"
[0m19:21:43.453169 [debug] [ThreadPool]: On create_supercell_main: COMMIT
[0m19:21:43.453432 [debug] [ThreadPool]: SQL status: OK in 0.000 seconds
[0m19:21:43.453621 [debug] [ThreadPool]: On create_supercell_main: Close
[0m19:21:43.454752 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly create_supercell_main, now list_supercell_main)
[0m19:21:43.459704 [debug] [ThreadPool]: Using duckdb connection "list_supercell_main"
[0m19:21:43.460038 [debug] [ThreadPool]: On list_supercell_main: BEGIN
[0m19:21:43.460378 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:21:43.460926 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m19:21:43.461155 [debug] [ThreadPool]: Using duckdb connection "list_supercell_main"
[0m19:21:43.461348 [debug] [ThreadPool]: On list_supercell_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "connection_name": "list_supercell_main"} */
select
      'supercell' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'supercell'
  
[0m19:21:43.469227 [debug] [ThreadPool]: SQL status: OK in 0.008 seconds
[0m19:21:43.470057 [debug] [ThreadPool]: On list_supercell_main: ROLLBACK
[0m19:21:43.470714 [debug] [ThreadPool]: Failed to rollback 'list_supercell_main'
[0m19:21:43.470913 [debug] [ThreadPool]: On list_supercell_main: Close
[0m19:21:43.471843 [debug] [MainThread]: Using duckdb connection "master"
[0m19:21:43.472047 [debug] [MainThread]: On master: BEGIN
[0m19:21:43.472244 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:21:43.472631 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m19:21:43.472833 [debug] [MainThread]: On master: COMMIT
[0m19:21:43.473005 [debug] [MainThread]: Using duckdb connection "master"
[0m19:21:43.473173 [debug] [MainThread]: On master: COMMIT
[0m19:21:43.473461 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m19:21:43.473647 [debug] [MainThread]: On master: Close
[0m19:21:43.475736 [debug] [Thread-1 (]: Began running node model.supercell.raw_usagelogs
[0m19:21:43.476307 [info ] [Thread-1 (]: 1 of 5 START sql table model main.raw_usagelogs ................................ [RUN]
[0m19:21:43.476750 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_supercell_main, now model.supercell.raw_usagelogs)
[0m19:21:43.477111 [debug] [Thread-1 (]: Began compiling node model.supercell.raw_usagelogs
[0m19:21:43.483840 [debug] [Thread-1 (]: Writing injected SQL for node "model.supercell.raw_usagelogs"
[0m19:21:43.484340 [debug] [Thread-1 (]: Began executing node model.supercell.raw_usagelogs
[0m19:21:43.502583 [debug] [Thread-1 (]: Writing runtime sql for node "model.supercell.raw_usagelogs"
[0m19:21:43.502997 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.raw_usagelogs"
[0m19:21:43.503253 [debug] [Thread-1 (]: On model.supercell.raw_usagelogs: BEGIN
[0m19:21:43.503447 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:21:43.503999 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:21:43.504241 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.raw_usagelogs"
[0m19:21:43.504415 [debug] [Thread-1 (]: On model.supercell.raw_usagelogs: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.raw_usagelogs"} */

  
    
    

    create  table
      "supercell"."main"."raw_usagelogs__dbt_tmp"
  
    as (
      

select * from supercell_usagelogs
    );
  
  
[0m19:21:43.587857 [debug] [Thread-1 (]: SQL status: OK in 0.083 seconds
[0m19:21:43.591776 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.raw_usagelogs"
[0m19:21:43.592068 [debug] [Thread-1 (]: On model.supercell.raw_usagelogs: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.raw_usagelogs"} */
alter table "supercell"."main"."raw_usagelogs__dbt_tmp" rename to "raw_usagelogs"
[0m19:21:43.592743 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m19:21:43.600343 [debug] [Thread-1 (]: On model.supercell.raw_usagelogs: COMMIT
[0m19:21:43.600595 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.raw_usagelogs"
[0m19:21:43.600806 [debug] [Thread-1 (]: On model.supercell.raw_usagelogs: COMMIT
[0m19:21:43.739886 [debug] [Thread-1 (]: SQL status: OK in 0.139 seconds
[0m19:21:43.743037 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.raw_usagelogs"
[0m19:21:43.743305 [debug] [Thread-1 (]: On model.supercell.raw_usagelogs: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.raw_usagelogs"} */
drop table if exists "supercell"."main"."raw_usagelogs__dbt_backup" cascade
[0m19:21:43.743816 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m19:21:43.745220 [debug] [Thread-1 (]: On model.supercell.raw_usagelogs: Close
[0m19:21:43.748121 [info ] [Thread-1 (]: 1 of 5 OK created sql table model main.raw_usagelogs ........................... [[32mOK[0m in 0.27s]
[0m19:21:43.748520 [debug] [Thread-1 (]: Finished running node model.supercell.raw_usagelogs
[0m19:21:43.749313 [debug] [Thread-3 (]: Began running node model.supercell.cleaned_usagelogs
[0m19:21:43.749743 [info ] [Thread-3 (]: 2 of 5 START sql table model main.cleaned_usagelogs ............................ [RUN]
[0m19:21:43.750153 [debug] [Thread-3 (]: Acquiring new duckdb connection 'model.supercell.cleaned_usagelogs'
[0m19:21:43.750417 [debug] [Thread-3 (]: Began compiling node model.supercell.cleaned_usagelogs
[0m19:21:43.753714 [debug] [Thread-3 (]: Writing injected SQL for node "model.supercell.cleaned_usagelogs"
[0m19:21:43.754642 [debug] [Thread-3 (]: Began executing node model.supercell.cleaned_usagelogs
[0m19:21:43.757031 [debug] [Thread-3 (]: Writing runtime sql for node "model.supercell.cleaned_usagelogs"
[0m19:21:43.757535 [debug] [Thread-3 (]: Using duckdb connection "model.supercell.cleaned_usagelogs"
[0m19:21:43.757751 [debug] [Thread-3 (]: On model.supercell.cleaned_usagelogs: BEGIN
[0m19:21:43.757955 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m19:21:43.758882 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m19:21:43.759252 [debug] [Thread-3 (]: Using duckdb connection "model.supercell.cleaned_usagelogs"
[0m19:21:43.759481 [debug] [Thread-3 (]: On model.supercell.cleaned_usagelogs: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.cleaned_usagelogs"} */

  
    
    

    create  table
      "supercell"."main"."cleaned_usagelogs__dbt_tmp"
  
    as (
      


SELECT
    CAST("LinkedAccountId" AS VARCHAR) AS linked_account_id,
    CAST("bill/PayerAccountId" AS VARCHAR) AS payer_account_id,
    CAST("lineItem/UsageStartDate" AS TIMESTAMP) AS usage_start_date,
    CAST("lineItem/UsageEndDate" AS TIMESTAMP) AS usage_end_date,
    CAST("lineItem/UsageAmount" AS DECIMAL(18, 6)) AS usage_amount,
    CAST("lineItem/Operation" AS VARCHAR) AS operation,
    CAST("pricing/PricingModel" AS VARCHAR) AS pricing_model,
    CAST("resourceTags/TagKeys" AS VARCHAR) AS tag_keys,
    CAST("resourceTags/TagValues" AS VARCHAR) AS tag_values,
    CAST("product/Region" AS VARCHAR) AS region,
    CAST("product/ServiceCode" AS VARCHAR) AS service_code,
    CAST("product/InstanceType" AS VARCHAR) AS instance_type,
    CAST("amortized_cost" AS DECIMAL(18, 6)) AS amortized_cost,
    CAST("product/Description" AS VARCHAR) AS description
FROM "supercell"."main"."raw_usagelogs"
WHERE
    "LinkedAccountId" IS NOT NULL
    AND "bill/PayerAccountId" IS NOT NULL
    AND "lineItem/UsageStartDate" IS NOT NULL
    AND "lineItem/UsageEndDate" IS NOT NULL
    AND "lineItem/UsageAmount" IS NOT NULL
    AND "lineItem/Operation" IS NOT NULL
    AND "pricing/PricingModel" IS NOT NULL
    AND "resourceTags/TagKeys" IS NOT NULL
    AND "resourceTags/TagValues" IS NOT NULL
    AND "product/Region" IS NOT NULL
    AND "product/ServiceCode" IS NOT NULL
    AND "product/InstanceType" IS NOT NULL
    AND "amortized_cost" IS NOT NULL
    AND "product/Description" IS NOT NULL
    );
  
  
[0m19:21:43.838082 [debug] [Thread-3 (]: SQL status: OK in 0.078 seconds
[0m19:21:43.839875 [debug] [Thread-3 (]: Using duckdb connection "model.supercell.cleaned_usagelogs"
[0m19:21:43.840131 [debug] [Thread-3 (]: On model.supercell.cleaned_usagelogs: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.cleaned_usagelogs"} */
alter table "supercell"."main"."cleaned_usagelogs" rename to "cleaned_usagelogs__dbt_backup"
[0m19:21:43.840666 [debug] [Thread-3 (]: SQL status: OK in 0.000 seconds
[0m19:21:43.842225 [debug] [Thread-3 (]: Using duckdb connection "model.supercell.cleaned_usagelogs"
[0m19:21:43.842452 [debug] [Thread-3 (]: On model.supercell.cleaned_usagelogs: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.cleaned_usagelogs"} */
alter table "supercell"."main"."cleaned_usagelogs__dbt_tmp" rename to "cleaned_usagelogs"
[0m19:21:43.842813 [debug] [Thread-3 (]: SQL status: OK in 0.000 seconds
[0m19:21:43.845175 [debug] [Thread-3 (]: On model.supercell.cleaned_usagelogs: COMMIT
[0m19:21:43.845387 [debug] [Thread-3 (]: Using duckdb connection "model.supercell.cleaned_usagelogs"
[0m19:21:43.845566 [debug] [Thread-3 (]: On model.supercell.cleaned_usagelogs: COMMIT
[0m19:21:43.933687 [debug] [Thread-3 (]: SQL status: OK in 0.088 seconds
[0m19:21:43.935210 [debug] [Thread-3 (]: Using duckdb connection "model.supercell.cleaned_usagelogs"
[0m19:21:43.935440 [debug] [Thread-3 (]: On model.supercell.cleaned_usagelogs: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.cleaned_usagelogs"} */
drop table if exists "supercell"."main"."cleaned_usagelogs__dbt_backup" cascade
[0m19:21:43.937254 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m19:21:43.938064 [debug] [Thread-3 (]: On model.supercell.cleaned_usagelogs: Close
[0m19:21:43.939988 [info ] [Thread-3 (]: 2 of 5 OK created sql table model main.cleaned_usagelogs ....................... [[32mOK[0m in 0.19s]
[0m19:21:43.940321 [debug] [Thread-3 (]: Finished running node model.supercell.cleaned_usagelogs
[0m19:21:43.940974 [debug] [Thread-2 (]: Began running node model.supercell.dim_resource
[0m19:21:43.941531 [debug] [Thread-1 (]: Began running node model.supercell.fact_bill_generation
[0m19:21:43.941971 [info ] [Thread-2 (]: 3 of 5 START sql table model main.dim_resource ................................. [RUN]
[0m19:21:43.942589 [info ] [Thread-1 (]: 4 of 5 START sql table model main.fact_bill_generation ......................... [RUN]
[0m19:21:43.943110 [debug] [Thread-2 (]: Acquiring new duckdb connection 'model.supercell.dim_resource'
[0m19:21:43.943636 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.supercell.raw_usagelogs, now model.supercell.fact_bill_generation)
[0m19:21:43.944020 [debug] [Thread-2 (]: Began compiling node model.supercell.dim_resource
[0m19:21:43.944517 [debug] [Thread-1 (]: Began compiling node model.supercell.fact_bill_generation
[0m19:21:43.948253 [debug] [Thread-2 (]: Writing injected SQL for node "model.supercell.dim_resource"
[0m19:21:43.950467 [debug] [Thread-1 (]: Writing injected SQL for node "model.supercell.fact_bill_generation"
[0m19:21:43.951351 [debug] [Thread-1 (]: Began executing node model.supercell.fact_bill_generation
[0m19:21:43.951823 [debug] [Thread-2 (]: Began executing node model.supercell.dim_resource
[0m19:21:43.954419 [debug] [Thread-1 (]: Writing runtime sql for node "model.supercell.fact_bill_generation"
[0m19:21:43.957160 [debug] [Thread-2 (]: Writing runtime sql for node "model.supercell.dim_resource"
[0m19:21:43.957627 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.fact_bill_generation"
[0m19:21:43.957876 [debug] [Thread-2 (]: Using duckdb connection "model.supercell.dim_resource"
[0m19:21:43.958107 [debug] [Thread-1 (]: On model.supercell.fact_bill_generation: BEGIN
[0m19:21:43.958315 [debug] [Thread-2 (]: On model.supercell.dim_resource: BEGIN
[0m19:21:43.958507 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m19:21:43.958698 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m19:21:43.959251 [debug] [Thread-2 (]: SQL status: OK in 0.001 seconds
[0m19:21:43.959471 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:21:43.959674 [debug] [Thread-2 (]: Using duckdb connection "model.supercell.dim_resource"
[0m19:21:43.959870 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.fact_bill_generation"
[0m19:21:43.960067 [debug] [Thread-2 (]: On model.supercell.dim_resource: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.dim_resource"} */

  
    
    

    create  table
      "supercell"."main"."dim_resource__dbt_tmp"
  
    as (
      


select
    md5(concat(linked_account_id, '_', service_code, '_', instance_type, '_', region, '_', CAST(usage_start_date AS VARCHAR), '_', CAST(usage_end_date AS VARCHAR))) AS resource_id,
    linked_account_id as linked_account_id,
    region,
    service_code as product,
    instance_type as instance_type,
    pricing_model as pricing_model,
    tag_keys as tag_keys,
    tag_values as tag_values
from "supercell"."main"."cleaned_usagelogs"
    );
  
  
[0m19:21:43.960294 [debug] [Thread-1 (]: On model.supercell.fact_bill_generation: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.fact_bill_generation"} */

  
    
    

    create  table
      "supercell"."main"."fact_bill_generation__dbt_tmp"
  
    as (
      


select
    md5(concat(linked_account_id, '_', service_code, '_', instance_type, '_', region, '_', CAST(usage_start_date AS VARCHAR), '_', CAST(usage_end_date AS VARCHAR))) AS resource_id,
    usage_start_date as start_date,
    usage_end_date as bill_date,
    usage_amount as bill_amount,
    operation
from "supercell"."main"."cleaned_usagelogs"
    );
  
  
[0m19:21:44.013054 [debug] [Thread-1 (]: SQL status: OK in 0.052 seconds
[0m19:21:44.015020 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.fact_bill_generation"
[0m19:21:44.015377 [debug] [Thread-1 (]: On model.supercell.fact_bill_generation: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.fact_bill_generation"} */
alter table "supercell"."main"."fact_bill_generation" rename to "fact_bill_generation__dbt_backup"
[0m19:21:44.015988 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m19:21:44.017588 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.fact_bill_generation"
[0m19:21:44.017835 [debug] [Thread-1 (]: On model.supercell.fact_bill_generation: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.fact_bill_generation"} */
alter table "supercell"."main"."fact_bill_generation__dbt_tmp" rename to "fact_bill_generation"
[0m19:21:44.018281 [debug] [Thread-1 (]: SQL status: OK in 0.000 seconds
[0m19:21:44.019421 [debug] [Thread-1 (]: On model.supercell.fact_bill_generation: COMMIT
[0m19:21:44.019665 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.fact_bill_generation"
[0m19:21:44.019866 [debug] [Thread-1 (]: On model.supercell.fact_bill_generation: COMMIT
[0m19:21:44.032338 [debug] [Thread-1 (]: SQL status: OK in 0.012 seconds
[0m19:21:44.035660 [debug] [Thread-1 (]: Using duckdb connection "model.supercell.fact_bill_generation"
[0m19:21:44.036080 [debug] [Thread-1 (]: On model.supercell.fact_bill_generation: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.fact_bill_generation"} */
drop table if exists "supercell"."main"."fact_bill_generation__dbt_backup" cascade
[0m19:21:44.037965 [debug] [Thread-1 (]: SQL status: OK in 0.001 seconds
[0m19:21:44.039303 [debug] [Thread-1 (]: On model.supercell.fact_bill_generation: Close
[0m19:21:44.040979 [info ] [Thread-1 (]: 4 of 5 OK created sql table model main.fact_bill_generation .................... [[32mOK[0m in 0.10s]
[0m19:21:44.041708 [debug] [Thread-1 (]: Finished running node model.supercell.fact_bill_generation
[0m19:21:44.060964 [debug] [Thread-2 (]: SQL status: OK in 0.100 seconds
[0m19:21:44.062797 [debug] [Thread-2 (]: Using duckdb connection "model.supercell.dim_resource"
[0m19:21:44.063037 [debug] [Thread-2 (]: On model.supercell.dim_resource: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.dim_resource"} */
alter table "supercell"."main"."dim_resource" rename to "dim_resource__dbt_backup"
[0m19:21:44.063533 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m19:21:44.065051 [debug] [Thread-2 (]: Using duckdb connection "model.supercell.dim_resource"
[0m19:21:44.065290 [debug] [Thread-2 (]: On model.supercell.dim_resource: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.dim_resource"} */
alter table "supercell"."main"."dim_resource__dbt_tmp" rename to "dim_resource"
[0m19:21:44.065665 [debug] [Thread-2 (]: SQL status: OK in 0.000 seconds
[0m19:21:44.066636 [debug] [Thread-2 (]: On model.supercell.dim_resource: COMMIT
[0m19:21:44.066878 [debug] [Thread-2 (]: Using duckdb connection "model.supercell.dim_resource"
[0m19:21:44.067072 [debug] [Thread-2 (]: On model.supercell.dim_resource: COMMIT
[0m19:21:44.090456 [debug] [Thread-2 (]: SQL status: OK in 0.023 seconds
[0m19:21:44.091909 [debug] [Thread-2 (]: Using duckdb connection "model.supercell.dim_resource"
[0m19:21:44.092142 [debug] [Thread-2 (]: On model.supercell.dim_resource: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.dim_resource"} */
drop table if exists "supercell"."main"."dim_resource__dbt_backup" cascade
[0m19:21:44.214622 [debug] [Thread-2 (]: SQL status: OK in 0.122 seconds
[0m19:21:44.215648 [debug] [Thread-2 (]: On model.supercell.dim_resource: Close
[0m19:21:44.218086 [info ] [Thread-2 (]: 3 of 5 OK created sql table model main.dim_resource ............................ [[32mOK[0m in 0.28s]
[0m19:21:44.218497 [debug] [Thread-2 (]: Finished running node model.supercell.dim_resource
[0m19:21:44.218974 [debug] [Thread-3 (]: Began running node model.supercell.total_cost
[0m19:21:44.219316 [info ] [Thread-3 (]: 5 of 5 START sql table model main.total_cost ................................... [RUN]
[0m19:21:44.219685 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.supercell.cleaned_usagelogs, now model.supercell.total_cost)
[0m19:21:44.220015 [debug] [Thread-3 (]: Began compiling node model.supercell.total_cost
[0m19:21:44.222368 [debug] [Thread-3 (]: Writing injected SQL for node "model.supercell.total_cost"
[0m19:21:44.223297 [debug] [Thread-3 (]: Began executing node model.supercell.total_cost
[0m19:21:44.226232 [debug] [Thread-3 (]: Writing runtime sql for node "model.supercell.total_cost"
[0m19:21:44.226776 [debug] [Thread-3 (]: Using duckdb connection "model.supercell.total_cost"
[0m19:21:44.226992 [debug] [Thread-3 (]: On model.supercell.total_cost: BEGIN
[0m19:21:44.227187 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m19:21:44.227716 [debug] [Thread-3 (]: SQL status: OK in 0.001 seconds
[0m19:21:44.227919 [debug] [Thread-3 (]: Using duckdb connection "model.supercell.total_cost"
[0m19:21:44.228116 [debug] [Thread-3 (]: On model.supercell.total_cost: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.total_cost"} */

  
    
    

    create  table
      "supercell"."main"."total_cost__dbt_tmp"
  
    as (
      

with base as (
    select
        fact_bill_generation.resource_id,
        date_trunc('month', fact_bill_generation.bill_date) as month,
        fact_bill_generation.bill_amount,
        dim_resource.instance_type,
        dim_resource.product,
        dim_resource.region,
        dim_resource.pricing_model,
        dim_resource.tag_keys,
        dim_resource.tag_values
    from "supercell"."main"."fact_bill_generation" as fact_bill_generation
    left join "supercell"."main"."dim_resource" as dim_resource
        on fact_bill_generation.resource_id = dim_resource.resource_id
)

select
    month,
    sum(bill_amount) as total_cost,
    instance_type,
    product,
    region,
    pricing_model,
    tag_keys,
    tag_values
from base
group by
    month,
    instance_type,
    product,
    region,
    pricing_model,
    tag_keys,
    tag_values
order by
    month,
    instance_type,
    product,
    region,
    pricing_model,
    tag_keys,
    tag_values
    );
  
  
[0m19:21:44.280782 [debug] [Thread-3 (]: SQL status: OK in 0.052 seconds
[0m19:21:44.282752 [debug] [Thread-3 (]: Using duckdb connection "model.supercell.total_cost"
[0m19:21:44.283018 [debug] [Thread-3 (]: On model.supercell.total_cost: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.total_cost"} */
alter table "supercell"."main"."total_cost" rename to "total_cost__dbt_backup"
[0m19:21:44.283503 [debug] [Thread-3 (]: SQL status: OK in 0.000 seconds
[0m19:21:44.285104 [debug] [Thread-3 (]: Using duckdb connection "model.supercell.total_cost"
[0m19:21:44.285327 [debug] [Thread-3 (]: On model.supercell.total_cost: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.total_cost"} */
alter table "supercell"."main"."total_cost__dbt_tmp" rename to "total_cost"
[0m19:21:44.285708 [debug] [Thread-3 (]: SQL status: OK in 0.000 seconds
[0m19:21:44.286728 [debug] [Thread-3 (]: On model.supercell.total_cost: COMMIT
[0m19:21:44.286971 [debug] [Thread-3 (]: Using duckdb connection "model.supercell.total_cost"
[0m19:21:44.287181 [debug] [Thread-3 (]: On model.supercell.total_cost: COMMIT
[0m19:21:44.290023 [debug] [Thread-3 (]: SQL status: OK in 0.003 seconds
[0m19:21:44.291157 [debug] [Thread-3 (]: Using duckdb connection "model.supercell.total_cost"
[0m19:21:44.291364 [debug] [Thread-3 (]: On model.supercell.total_cost: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "node_id": "model.supercell.total_cost"} */
drop table if exists "supercell"."main"."total_cost__dbt_backup" cascade
[0m19:21:44.293073 [debug] [Thread-3 (]: SQL status: OK in 0.002 seconds
[0m19:21:44.293874 [debug] [Thread-3 (]: On model.supercell.total_cost: Close
[0m19:21:44.295058 [info ] [Thread-3 (]: 5 of 5 OK created sql table model main.total_cost .............................. [[32mOK[0m in 0.08s]
[0m19:21:44.295391 [debug] [Thread-3 (]: Finished running node model.supercell.total_cost
[0m19:21:44.296542 [debug] [MainThread]: Using duckdb connection "master"
[0m19:21:44.296992 [debug] [MainThread]: On master: BEGIN
[0m19:21:44.297319 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:21:44.298008 [debug] [MainThread]: SQL status: OK in 0.001 seconds
[0m19:21:44.298364 [debug] [MainThread]: On master: COMMIT
[0m19:21:44.298674 [debug] [MainThread]: Using duckdb connection "master"
[0m19:21:44.298986 [debug] [MainThread]: On master: COMMIT
[0m19:21:44.299853 [debug] [MainThread]: SQL status: OK in 0.000 seconds
[0m19:21:44.300275 [debug] [MainThread]: On master: Close
[0m19:21:44.300783 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:21:44.301091 [debug] [MainThread]: Connection 'model.supercell.fact_bill_generation' was properly closed.
[0m19:21:44.301401 [debug] [MainThread]: Connection 'model.supercell.total_cost' was properly closed.
[0m19:21:44.301674 [debug] [MainThread]: Connection 'model.supercell.dim_resource' was properly closed.
[0m19:21:44.302124 [info ] [MainThread]: 
[0m19:21:44.302590 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 0.89 seconds (0.89s).
[0m19:21:44.303237 [debug] [MainThread]: Command end result
[0m19:21:44.355793 [debug] [MainThread]: Wrote artifact WritableManifest to /home/harsha/data_actions/supercell_cloudops/target/manifest.json
[0m19:21:44.356851 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/harsha/data_actions/supercell_cloudops/target/semantic_manifest.json
[0m19:21:44.360445 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/harsha/data_actions/supercell_cloudops/target/run_results.json
[0m19:21:44.360692 [info ] [MainThread]: 
[0m19:21:44.360913 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:21:44.361087 [info ] [MainThread]: 
[0m19:21:44.361290 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m19:21:44.361895 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 1.3981944, "process_in_blocks": "0", "process_kernel_time": 0.212881, "process_mem_max_rss": "211084", "process_out_blocks": "57064", "process_user_time": 2.182782}
[0m19:21:44.362270 [debug] [MainThread]: Command `dbt run` succeeded at 19:21:44.362198 after 1.40 seconds
[0m19:21:44.362493 [debug] [MainThread]: Flushing usage events


============================== 19:22:30.482860 | db1ebc2a-d645-484c-85ce-cfd8484eb5f5 ==============================
[0m19:22:30.482860 [info ] [MainThread]: Running with dbt=1.9.4
[0m19:22:30.484898 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'profiles_dir': '/home/harsha/data_actions/supercell_cloudops', 'log_path': '/home/harsha/data_actions/supercell_cloudops/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt docs generate', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'False'}
[0m19:22:30.485159 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality

User config should be moved from the 'config' key in profiles.yml to the 'flags' key in dbt_project.yml.
[0m19:22:30.634538 [info ] [MainThread]: Registered adapter: duckdb=1.9.3
[0m19:22:30.670967 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m19:22:30.710421 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:22:30.710686 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:22:30.714884 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.supercell.example
[0m19:22:30.734055 [info ] [MainThread]: Found 5 models, 428 macros
[0m19:22:30.735160 [info ] [MainThread]: 
[0m19:22:30.735445 [info ] [MainThread]: Concurrency: 4 threads (target='default')
[0m19:22:30.735607 [info ] [MainThread]: 
[0m19:22:30.735863 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m19:22:30.739343 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_supercell_main'
[0m19:22:30.759897 [debug] [ThreadPool]: Using duckdb connection "list_supercell_main"
[0m19:22:30.760236 [debug] [ThreadPool]: On list_supercell_main: BEGIN
[0m19:22:30.760462 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:22:30.763829 [debug] [ThreadPool]: DuckDB adapter: Error running SQL: BEGIN
[0m19:22:30.764073 [debug] [ThreadPool]: DuckDB adapter: Rolling back transaction.
[0m19:22:30.764673 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:22:30.765014 [debug] [MainThread]: Connection 'list_supercell_main' was properly closed.
[0m19:22:30.765400 [error] [MainThread]: Encountered an error:
Runtime Error
  IO Error: Could not set lock on file "/home/harsha/data_actions/supercell_cloudops/supercell.duckdb": Conflicting lock is held in /usr/bin/python3.12 (PID 2740971) by user harsha. See also https://duckdb.org/docs/connect/concurrency
[0m19:22:30.765919 [debug] [MainThread]: Resource report: {"command_name": "generate", "command_success": false, "command_wall_clock_time": 0.31521973, "process_in_blocks": "0", "process_kernel_time": 0.090761, "process_mem_max_rss": "132548", "process_out_blocks": "40", "process_user_time": 1.061206}
[0m19:22:30.766238 [debug] [MainThread]: Command `dbt docs generate` failed at 19:22:30.766170 after 0.32 seconds
[0m19:22:30.766437 [debug] [MainThread]: Flushing usage events


============================== 19:22:41.331514 | 8bf6c5cf-5a03-4a10-87f6-8f36de9cc8f4 ==============================
[0m19:22:41.331514 [info ] [MainThread]: Running with dbt=1.9.4
[0m19:22:41.334084 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/home/harsha/data_actions/supercell_cloudops', 'fail_fast': 'False', 'debug': 'False', 'log_path': '/home/harsha/data_actions/supercell_cloudops/logs', 'version_check': 'True', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt docs generate', 'static_parser': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'False'}
[0m19:22:41.334359 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality

User config should be moved from the 'config' key in profiles.yml to the 'flags' key in dbt_project.yml.
[0m19:22:41.489100 [info ] [MainThread]: Registered adapter: duckdb=1.9.3
[0m19:22:41.537337 [debug] [MainThread]: checksum: b5597158181700c50f5bc1c71fe28b37a6fb85633dc5323885263678b6bc782c, vars: {}, profile: , target: , version: 1.9.4
[0m19:22:41.579228 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m19:22:41.579478 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m19:22:41.584057 [warn ] [MainThread]: [[33mWARNING[0m]: Configuration paths exist in your dbt_project.yml file which do not apply to any resources.
There are 1 unused configuration paths:
- models.supercell.example
[0m19:22:41.604232 [info ] [MainThread]: Found 5 models, 428 macros
[0m19:22:41.605453 [info ] [MainThread]: 
[0m19:22:41.605707 [info ] [MainThread]: Concurrency: 4 threads (target='default')
[0m19:22:41.605896 [info ] [MainThread]: 
[0m19:22:41.606260 [debug] [MainThread]: Acquiring new duckdb connection 'master'
[0m19:22:41.609885 [debug] [ThreadPool]: Acquiring new duckdb connection 'list_supercell_main'
[0m19:22:41.631642 [debug] [ThreadPool]: Using duckdb connection "list_supercell_main"
[0m19:22:41.631949 [debug] [ThreadPool]: On list_supercell_main: BEGIN
[0m19:22:41.632142 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:22:41.639996 [debug] [ThreadPool]: SQL status: OK in 0.008 seconds
[0m19:22:41.640285 [debug] [ThreadPool]: Using duckdb connection "list_supercell_main"
[0m19:22:41.640466 [debug] [ThreadPool]: On list_supercell_main: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "connection_name": "list_supercell_main"} */
select
      'supercell' as database,
      table_name as name,
      table_schema as schema,
      CASE table_type
        WHEN 'BASE TABLE' THEN 'table'
        WHEN 'VIEW' THEN 'view'
        WHEN 'LOCAL TEMPORARY' THEN 'table'
        END as type
    from system.information_schema.tables
    where lower(table_schema) = 'main'
    and lower(table_catalog) = 'supercell'
  
[0m19:22:41.649523 [debug] [ThreadPool]: SQL status: OK in 0.009 seconds
[0m19:22:41.650603 [debug] [ThreadPool]: On list_supercell_main: ROLLBACK
[0m19:22:41.651284 [debug] [ThreadPool]: Failed to rollback 'list_supercell_main'
[0m19:22:41.651498 [debug] [ThreadPool]: On list_supercell_main: Close
[0m19:22:41.654639 [debug] [Thread-1 (]: Began running node model.supercell.raw_usagelogs
[0m19:22:41.656680 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_supercell_main, now model.supercell.raw_usagelogs)
[0m19:22:41.657078 [debug] [Thread-1 (]: Began compiling node model.supercell.raw_usagelogs
[0m19:22:41.663532 [debug] [Thread-1 (]: Writing injected SQL for node "model.supercell.raw_usagelogs"
[0m19:22:41.664109 [debug] [Thread-1 (]: Began executing node model.supercell.raw_usagelogs
[0m19:22:41.664614 [debug] [Thread-1 (]: Finished running node model.supercell.raw_usagelogs
[0m19:22:41.665334 [debug] [Thread-3 (]: Began running node model.supercell.cleaned_usagelogs
[0m19:22:41.665874 [debug] [Thread-3 (]: Acquiring new duckdb connection 'model.supercell.cleaned_usagelogs'
[0m19:22:41.666231 [debug] [Thread-3 (]: Began compiling node model.supercell.cleaned_usagelogs
[0m19:22:41.668577 [debug] [Thread-3 (]: Writing injected SQL for node "model.supercell.cleaned_usagelogs"
[0m19:22:41.669113 [debug] [Thread-3 (]: Began executing node model.supercell.cleaned_usagelogs
[0m19:22:41.669703 [debug] [Thread-3 (]: Finished running node model.supercell.cleaned_usagelogs
[0m19:22:41.670429 [debug] [Thread-2 (]: Began running node model.supercell.dim_resource
[0m19:22:41.670899 [debug] [Thread-2 (]: Acquiring new duckdb connection 'model.supercell.dim_resource'
[0m19:22:41.671259 [debug] [Thread-1 (]: Began running node model.supercell.fact_bill_generation
[0m19:22:41.671594 [debug] [Thread-2 (]: Began compiling node model.supercell.dim_resource
[0m19:22:41.672146 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly model.supercell.raw_usagelogs, now model.supercell.fact_bill_generation)
[0m19:22:41.674423 [debug] [Thread-2 (]: Writing injected SQL for node "model.supercell.dim_resource"
[0m19:22:41.674889 [debug] [Thread-1 (]: Began compiling node model.supercell.fact_bill_generation
[0m19:22:41.676439 [debug] [Thread-1 (]: Writing injected SQL for node "model.supercell.fact_bill_generation"
[0m19:22:41.676806 [debug] [Thread-1 (]: Began executing node model.supercell.fact_bill_generation
[0m19:22:41.677178 [debug] [Thread-1 (]: Finished running node model.supercell.fact_bill_generation
[0m19:22:41.677676 [debug] [Thread-2 (]: Began executing node model.supercell.dim_resource
[0m19:22:41.678349 [debug] [Thread-2 (]: Finished running node model.supercell.dim_resource
[0m19:22:41.679110 [debug] [Thread-3 (]: Began running node model.supercell.total_cost
[0m19:22:41.679397 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly model.supercell.cleaned_usagelogs, now model.supercell.total_cost)
[0m19:22:41.679605 [debug] [Thread-3 (]: Began compiling node model.supercell.total_cost
[0m19:22:41.681124 [debug] [Thread-3 (]: Writing injected SQL for node "model.supercell.total_cost"
[0m19:22:41.681445 [debug] [Thread-3 (]: Began executing node model.supercell.total_cost
[0m19:22:41.681790 [debug] [Thread-3 (]: Finished running node model.supercell.total_cost
[0m19:22:41.682655 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:22:41.682873 [debug] [MainThread]: Connection 'model.supercell.fact_bill_generation' was properly closed.
[0m19:22:41.683045 [debug] [MainThread]: Connection 'model.supercell.total_cost' was properly closed.
[0m19:22:41.683230 [debug] [MainThread]: Connection 'model.supercell.dim_resource' was properly closed.
[0m19:22:41.683769 [debug] [MainThread]: Command end result
[0m19:22:41.712453 [debug] [MainThread]: Wrote artifact WritableManifest to /home/harsha/data_actions/supercell_cloudops/target/manifest.json
[0m19:22:41.713460 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/harsha/data_actions/supercell_cloudops/target/semantic_manifest.json
[0m19:22:41.717372 [debug] [MainThread]: Wrote artifact RunExecutionResult to /home/harsha/data_actions/supercell_cloudops/target/run_results.json
[0m19:22:41.718799 [debug] [MainThread]: Acquiring new duckdb connection 'generate_catalog'
[0m19:22:41.719001 [info ] [MainThread]: Building catalog
[0m19:22:41.725133 [debug] [ThreadPool]: Acquiring new duckdb connection 'supercell.information_schema'
[0m19:22:41.731865 [debug] [ThreadPool]: Using duckdb connection "supercell.information_schema"
[0m19:22:41.732233 [debug] [ThreadPool]: On supercell.information_schema: BEGIN
[0m19:22:41.732682 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:22:41.733199 [debug] [ThreadPool]: SQL status: OK in 0.001 seconds
[0m19:22:41.733410 [debug] [ThreadPool]: Using duckdb connection "supercell.information_schema"
[0m19:22:41.733577 [debug] [ThreadPool]: On supercell.information_schema: /* {"app": "dbt", "dbt_version": "1.9.4", "profile_name": "supercell", "target_name": "default", "connection_name": "supercell.information_schema"} */
with relations AS (
      select
        t.table_name
        , t.database_name
        , t.schema_name
        , 'BASE TABLE' as table_type
        , t.comment as table_comment
      from duckdb_tables() t
      WHERE t.database_name = 'supercell'
      UNION ALL
      SELECT v.view_name as table_name
      , v.database_name
      , v.schema_name
      , 'VIEW' as table_type
      , v.comment as table_comment
      from duckdb_views() v
      WHERE v.database_name = 'supercell'
    )
    select
        'supercell' as table_database,
        r.schema_name as table_schema,
        r.table_name,
        r.table_type,
        r.table_comment,
        c.column_name,
        c.column_index as column_index,
        c.data_type as column_type,
        c.comment as column_comment,
        '' as table_owner
    FROM relations r JOIN duckdb_columns() c ON r.schema_name = c.schema_name AND r.table_name = c.table_name
    WHERE (upper(r.schema_name) = upper('main'))
    ORDER BY
        r.schema_name,
        r.table_name,
        c.column_index
[0m19:22:41.739109 [debug] [ThreadPool]: SQL status: OK in 0.005 seconds
[0m19:22:41.752568 [debug] [ThreadPool]: On supercell.information_schema: ROLLBACK
[0m19:22:41.753080 [debug] [ThreadPool]: Failed to rollback 'supercell.information_schema'
[0m19:22:41.753298 [debug] [ThreadPool]: On supercell.information_schema: Close
[0m19:22:41.767533 [debug] [MainThread]: Wrote artifact CatalogArtifact to /home/harsha/data_actions/supercell_cloudops/target/catalog.json
[0m19:22:41.776067 [debug] [MainThread]: Wrote artifact WritableManifest to /home/harsha/data_actions/supercell_cloudops/target/manifest.json
[0m19:22:41.776866 [debug] [MainThread]: Wrote artifact SemanticManifest to /home/harsha/data_actions/supercell_cloudops/target/semantic_manifest.json
[0m19:22:41.777076 [info ] [MainThread]: Catalog written to /home/harsha/data_actions/supercell_cloudops/target/catalog.json
[0m19:22:41.777712 [debug] [MainThread]: Resource report: {"command_name": "generate", "command_success": true, "command_wall_clock_time": 0.47717577, "process_in_blocks": "0", "process_kernel_time": 0.094874, "process_mem_max_rss": "144836", "process_out_blocks": "5216", "process_user_time": 1.17444}
[0m19:22:41.778102 [debug] [MainThread]: Command `dbt docs generate` succeeded at 19:22:41.778019 after 0.48 seconds
[0m19:22:41.778400 [debug] [MainThread]: Connection 'generate_catalog' was properly closed.
[0m19:22:41.778576 [debug] [MainThread]: Connection 'supercell.information_schema' was properly closed.
[0m19:22:41.778757 [debug] [MainThread]: Flushing usage events


============================== 19:22:47.305028 | 2e1f212d-88f8-4b27-b492-f897df619024 ==============================
[0m19:22:47.305028 [info ] [MainThread]: Running with dbt=1.9.4
[0m19:22:47.307214 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/home/harsha/data_actions/supercell_cloudops/logs', 'debug': 'False', 'profiles_dir': '/home/harsha/data_actions/supercell_cloudops', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt docs serve --port 8001', 'static_parser': 'True', 'introspect': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'False'}
[0m19:22:47.307420 [warn ] [MainThread]: [[33mWARNING[0m]: Deprecated functionality

User config should be moved from the 'config' key in profiles.yml to the 'flags' key in dbt_project.yml.
[0m20:24:58.108045 [error] [MainThread]: Encountered an error:

[0m20:24:58.112955 [error] [MainThread]: Traceback (most recent call last):
  File "/home/harsha/data_actions/supercell_cloudops/supercell_env/lib/python3.12/site-packages/dbt/cli/requires.py", line 153, in wrapper
    result, success = func(*args, **kwargs)
                      ^^^^^^^^^^^^^^^^^^^^^
  File "/home/harsha/data_actions/supercell_cloudops/supercell_env/lib/python3.12/site-packages/dbt/cli/requires.py", line 103, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/harsha/data_actions/supercell_cloudops/supercell_env/lib/python3.12/site-packages/dbt/cli/requires.py", line 235, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/harsha/data_actions/supercell_cloudops/supercell_env/lib/python3.12/site-packages/dbt/cli/requires.py", line 264, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/harsha/data_actions/supercell_cloudops/supercell_env/lib/python3.12/site-packages/dbt/cli/requires.py", line 311, in wrapper
    return func(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^
  File "/home/harsha/data_actions/supercell_cloudops/supercell_env/lib/python3.12/site-packages/dbt/cli/main.py", line 301, in docs_serve
    results = task.run()
              ^^^^^^^^^^
  File "/home/harsha/data_actions/supercell_cloudops/supercell_env/lib/python3.12/site-packages/dbt/task/docs/serve.py", line 29, in run
    httpd.serve_forever()
  File "/usr/lib/python3.12/socketserver.py", line 235, in serve_forever
    ready = selector.select(poll_interval)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/selectors.py", line 415, in select
    fd_event_list = self._selector.poll(timeout)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
KeyboardInterrupt

[0m20:24:58.115158 [debug] [MainThread]: Resource report: {"command_name": "serve", "command_success": false, "command_wall_clock_time": 3390.1855, "process_in_blocks": "272", "process_kernel_time": 0.179034, "process_mem_max_rss": "114716", "process_out_blocks": "3360", "process_user_time": 1.332115}
[0m20:24:58.116441 [debug] [MainThread]: Command `dbt docs serve` failed at 20:24:58.116207 after 3390.19 seconds
[0m20:24:58.117201 [debug] [MainThread]: Flushing usage events
